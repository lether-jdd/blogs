(window.webpackJsonp=window.webpackJsonp||[]).push([[87,14,61,65,67],{"../client/src/assets/img/create-from-catalog.png":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACQCAYAAADA6GNQAAAAAXNSR0IArs4c6QAAFvFJREFUeAHtmk2rZFlahW9+oGKVljosrV/RULRCDwQdOFC6CroabFrBgYottH+lBwo96YGCojUo0EELDnQgogX9K0prVCiJSSGaH551Ip7Ilevuc/beJ/aJe01jQ8R69/uu93PvODfuzby5ua7rBK4T+P87gQedrffyO8Nf6YMm8LI1TuuBrvHWbK11XHnbJ7B22Gu2OWPL4SXH9y5vb+Hqee4E/KBdVtzcv5ardoBpZy90+bWg181FJ8ABC132ItC7bpYf39IsKzj0B5999tlXHj58+JfPnj37hen1aNnlatl7Ao8fP34+vf71xYsX33zvvfd+NOXjsMHVEvgUl0hue+3wp2T/9M477zx8++23bx49up5/aXiX0j1//vzm6dOnN0+ePHkxfSh/yS6BLoBfApdP5T08ScsCF2G+BPrk6/Cn1/Xwl2d2MYs+gDoLnYnOZkrMh1U1cHaL9bRcAAIp2EM99vXJv677NQGdic5GZzS9/BKsFtp7AR7oZ/71sb860zsx6kyO38c4/OqnX4W2XAACEfhOGrwmbZ6AnxNnt+hc+y2AAIm3An755Zc3L1++vHnw4MGMtwiTAptQK/k1++xkbzV+zW6himLNv2bPoDV+ze7x3nrrLd+67GelL37aF78Ayql2AcRhKRDB0Z1Qh6kFngwdAr5gxqsNqGbvjUcdYPqjB9Oufc8iDihfl7O/hdir55Q+PRcgfV/bq7hcKp6iZaMZEFvJFz4c9o7Y8M98zpVc4/faFXNtZT30DWa+jFXzT/6Wfe8FuH3Kx6w05UX0Nljjpz0HpNxeRy/fa2+RS/ndL/O7TXL61/g1+zH+4hllfu17L0ApxqxTcblqDeID1viKDzdzYSMG9h4+vkKWy+hAYoPowYwnHjpx8AOxkTP57kOOc3HYBVAhtQbSnsXXGk7/5Ke9Fj/5GS/9a/xee8Yv5ZeOlfHRn4PDLoAX50WXZNdl8W7zmPCkW1r4giX/Jd8WPXHBjC89OuLB1R4ZhOPoNmIJWS6jOweHXQAKB1VUqQEvVlw4JX7a3Rd5LV/6k4shpl0xe+LBBWv+1Axm/pb68B2Fwy6AF89AEktFw5ENGXRdyTd1+IHpjx5Me8ar7b1nYqFj71iKV6qlpCv5jtC1/CWwKY+KpnmhXlqgy1vtc0B7I/Ze8bwnDgVUGchCvVQH6LVRsutcbrXDG4m7PgFUKENyuaRrsYvjizigbCUZnR8QXHTsHVPW3he+HKbyoINHbu2RQde5vGQXZ/Qa+gRQcV58rVgGJ3QZP9e5jL0XqU3ocm8c+B7DZew19J5cxs91LmMfgcOeAKViVLQGQ/GSP/mXiTn9dPjgq4fL8sk/lzzR8SsQKL3L8I4ok37yQEE+/DQK8pZtBoyEsb2VId2N8MFXD0VzkWRCBl1nrmeJu14ACgdV6fzVYH47NDxfjoN4+leL4/ZWY3mhbhEUwWKf5FlXYMcjuxZffcBRNGThvLho4MSfaxBqURt8qSUfzTPnwm+7XoBSLx9On3w61kA//MVXN/0w0IfzYEu++L3CEsuniQzeL371QpXKHawb9h2gVBeffKHLcPnkCF3Gft/Qe3B5qU7nuAzfe3YZ+yVw1ydAqSl0l2hOQ1c+ho+8tQb8QPXgcvaEDazx0/8S+12fANkAByF0OXlLe/dxeYnP4IUuw/cYLmMfjZ7D5dY8W3xqsYc9AVSchgyWEpcOAZ348v2rf3w+fzH66GuP53gfa9/6LUk/6vUFjB/5Uz1T0MMXrUl9MBjhFt8oBfoptkLE+uhrj4b0zwwVHpkZJUYJm7bDLkCpOC6DsLRKDc5xpgG/ijd5PjhMfHpuTGcwXbLjCaf/nMMPZ5YV7JCdu0A5L18cL+yE81KZL6YX5SILWUeqtt7fq3pfEdyOu2PWX4qBzv1GysMuQKkoigeTkwMS75vHT764suuTJdSSHZ9ZEW/Y7gufvsEo99TLUr29/WT8lv2w7wA0ASo5stBlCmMwQpex96LHcHkpjnNchu81SxYHdFk65y75Sw9Psud0WbZLrWFPgC0NMEwfijfuQ0ZPHu17/ZOf8dNODnInUgsou8vJz30pn3OyPtl64nusJXnYBVAzuWoN0AyY/lsG5DHSP+up2T2W5OSnPfeZT3bvFRlM/9586d+yH3YBSk1saeDP//6/57p/85d/bMa/+If/0eQPvej7lUS+ZyHfvntH/kSU7/ToLi5sxE+S/ODIhgw/7NmvslLiHHri09e8b3hTTJZmTA505+KwC0BhYKmwlgZOQ9Nwj0vf1k/LxFnne8k+ccnyPc6w+FvEZDxd3or/Kdaxnvk+TDJn9EIHNKc8FjXBS6sH3inf3ED7G7MVjlrDLoAfrhdYkl2XjXzr+MlHv/aJ8ZziKy46/B2xCbVqfPctyVvjrfVfyuO6c3w9DvKwC0BhIAkcc2BukyxfONojC7XSTi4Qzkye3mr+vfzeeNQBpj96MPtLftrxOweHXQAVkQVnYS0NlA4TXcavxcMPVD0uZ325Vz4tsJTP42V9Ga/kX+KgIzZYi49fDw69ABQKlgpZsyU/G5YvOrgeD5tQq8THr4TEAtc4a7at/hnz3H4yXmk/9AJkgi0N/Onf/dcc5rd+9SfmA2Q/K/XlR4cr1EI+HvisR3dgvP6O7cRXjOl1+k4lwRTB18F++1d+fPWJ4Am39O/+XCRQNpedu1Xe9QJQLFhrgE+ujuA0PO+MgwNlM/nBJM/Hd9RxlEKt+XgnG+ct2kF3sB8u1CQf/ef7Ft/y5zhcQMU0+RjlBNjA9D0Rj8Kp51P+20+89Dl3v+sF6C1Og9In39dvx95tb5rMRQHVn8t79Dvs3wJU3OkTPN1gl/covCWm1+Byi+8WjudweUusS/kMfQJwW0E14fKlmiIPucG96yEPuHc++jwHhz4BaoUwGKHLNb83xe49u3yX/Q19AtQaKT0W0dV8f/C3X04/Y25ufufXfnKm/uCH0z6+tN9SzN/yJtLxS1WVf/oNgK+NlapEO9ZAXWse9AqK6/Ka7162YRdAN1rNgCMKJtb8aTmeCTrFn8/3iId8HJzhLB72D6Y/zM//o2j+A73u0+E3gsPvDnPEQ5j5Iuhsj/z5lOEfdAcil+vwRNu1/ynh6PjqYdgF4CaDCs5hzQc47bOBmp1YQj5h6LRPf+X0lfncVpIzXo8/dYGKX4tXsxMLVEyXtT93DbsAKqTWkDjeADKYdu19tcR3vmSPnbaWeO5f49fsWQ+xwbTX6k37lv3QC0Aj4LkNKQ5D9VjExybEjk575CX77DTwjbpAhXY5U2V9aZcvHI+1FjNj1PbDLgCFgkqMLNTa0pA3W4tHjjnZMZ/rev2JA1ILWItXsxMHJI+j2zKe87bKwy6ACs0CXacC3f79v/nP6Ubc3Pzeb/zUXPv3/3raH79RH79zbe3p/vjpu+exp9/99bdf67+lyJxfi08vZ9gFKCXWgWuB3tB0Xw6zkXBcs33SCrX8wmjv/tr3rqZv9fNvAIe65xvKCU7J+uuZ4sy9bP8tgVmoV2Swt/8Sf+gFoDAwE/oAf3/65IuHruUT4nzFxldYWufyM2bmy/jJ971zqdd14mZ895ec/LRv2Q+7ADS1VkSpAemWVvJzQGnPODV+2ukBzHjauw0ZLPFdV6r3nP499lZ52AUoFZANa1DoSnzpWofp3DUftyGD1LJ0COLBUT5k+GkXx1cvX77U5nH2lIddAG+WJhKdQ7PotEcWluzoZuP0lnz0YB5Q8tOOH1jj1+x790+d5+CwC+DD1GC0XMfecUmW3x9/8kQnfPOdD39mPug/0V4/6xVbOC29KxPfAJAP2cXYeVHLsV/V9Z0P3pnrVeZz+pd/7YKJc+4adgHOLST9D7M9HrQOfHrlQNAJteaLd+Rpnwdwy1+klVX7rSHjH/8JYSVin0nxtcCUZ+OZb0MvAIWCWXAegHjoso8//PDVJ0mcP/j6T9860PS5L/sR/asXZiPUWpvXTNjw9kb9fwAGJXR5w1xmF4/h8tZ4XAyhy1vjjfAb+gQYUZDHKA0JnfOQsYHSuwxvCXXI4nPYyB7D5aU4o/TkAhXX5RF5LvoEOLdgDkbo8rlx8We4Qpex3zXu0fO9fQJ87+P/mOb98ua73/i5ee7f+/jfJ9SXIr7rz+oLv5Gb3zOynpr9Vbnf/cbPvto0Sntcynt7AXTbafgwn1dfGPkk1OYmf4+D3Opfjs/hy4oMuk6Pa32RO+BsiR8x0vWs7KfHd4l7by/AH310+ORT+NZPDIeuOMhbL0AewLnx6K0VqRts9Vvj7fodgE+w0OW1gkbaGJRQLz/ALfVkPNWKrlS353C5xL0r3a5PAIYDqkmXs2k/ILjoktuyx5fhKzc6/L0ebPDhgCV/bCUkNiiOy+mT+XvzZbyW/dALkA1kAbWGGA4of5czXubL+PiCtXjwwMxX88960l9x4aTNY3t+l0s+5+qGXgCKBbM4mhdqiYdOe2Ts0vlKPnnA9E9+2j225OSnPf2TTx1gr3/GT//Ml/Yt+2EXwItnAK5TcaUG4JaKT34tHrHAGj9zbuErhvy0euvFZ3YuvNXiFVy6VcMugBe7NBBVx+FIbhm48+Xjizyg1+C8VplcoPxKsus8dm8/vXzPNUoedgFKBXEwoAZH0yV+6uD2+C8dTsbWPuMnJ+tNftrTn7rBGr/kj49syMJRa9gF8OEsFeicUkO99hzCuQNK/6xH+aRjIYPpDw/MeMnvtRP3HBx2AUpFZEPiMKwSv1fXO0DFl8/SojYw46dfqT/nlOzEdt5dykMvAM2BaszlHKhs6BiC89EtIVxQvJLsOo9FbiG+6JyHrDhp99jIIDHxx3ctn/vitycOuwA05cWqGZqWnuZAbPgm32OV5PRPTsZLftrlT20Zq7TPeMnJ+MQG0z/5GW+P/bALQFNZ5JJePGyg61zuscvPl/u6viS3HIjHQwZLMVtszinJJV0p1xbd0H8L0AC1hC5TmOtcxl5D93F5yc85kjVIkKGCioEsdJn4GU96dC5Lhx5ssYuztogFrnFbbcOeAEpYGhq6FnsWrUblT8PIpZjpuyVfKYbryAt6Dpe32j2X5Jb+06d3P/QJUEvOQQpdxs91kjVIkKGC+Dimv2zonNcq4yt0udU/eR7DZXiuk9zbP3F6cOgToJaYwwPFL8klXS22x9rqnzmIA3qO5LbsiQNmPPRg2lty9HIu+gToLe7K338C1wuw/4zvdYahF4BHl9Dlez2BgcV5zy4PTDE81NALkF9iVC26lsp9aC63+LZwPKbLLb4tHHoVutziK47X5HKr/xbesAswomAfmstbGiv5eEyX4XoPLmNPdI7LyWvde00ut/pv4Q27AFsK9qG53NqI+7iMv+tcxp7oPbicPPbOcRl7Db0ml2t+I+3DLkCpKG/K5RK3pHMfl+H60F1utXtMl/FPdI7LyWPvHJex19B9XK759diH/R1ABeoQQBWRh4KNZpJfs3tMyTV+zZ717R2/Vk/NnvVpf+4adgFKw+wtrhQDnWLVBlSzK0ZPPLhg+qMH0659zyIOKF+Xs7+e2EvcYRdAxeVS8RQtG82A2Eq+8OGwd8SGf+ZzruQav9eumGsr66FvMPNlrJp/8rfsh10AmvIiehus8dOeA1Jur6OX77W3yKX87pf53SY5/Wv8mj3jt+yHXQAlywJrDYqPn7DGd67kXJlfdnIkFxs5tUcWslxGt4SZP+OlndrAGl954S7V0KsfdgG8OYbmOhWWDZaKxXfJRkzZkYVatfg1ftrnoPaW8ZPfa7fQJ7Gn/5PTGcKwC+DNcyCqqyS7bq12jwlvbUDEBUv+xNmCxAUzvvToiA9Xe2QQzhISS8hyGd05OOwC0BSookoNeLHiwinx0+6+yGv50p9cDDHtitkTDy5Y86dmMPO31IfvKBx2Abx4BpJYKhqObMig60q+qcMPTH/0YNozXm3vPRMLHXvHUrxSLSVdyXeEbthfAlU0zQv10gJd3mqfA9obsfeK5z1xKKDKQBbqpTpAr42SXedyqx3eSNz1CaBCGZLLJV2LXZyeRR7QD0hxpEfH3jFl7X3hy2FmPHHJ7XJJ12IXZ/Qa+gRQcd5crVgGJ3QZP9e5jJ1cQpexJzrH5eS17j2Gy63+3pPL+LvOZewjcNgFKBXjRbsM14fmcqsd3n1F79ll6vWeXW61wzsHh/0IKBWx1lSJ/6bp/i/0v+sToHagPiCXa35vit17dvmS/d3pBfDHosuXHEBPLj8kl3tiONd7dtk5e8t3egH2bs4PyeWtef2QXN4a7z74XfQC+CG43DoI93F5yd8PyWX4HsNl7KPRc7jcmmeLTy32sAvQUpwfgssU6TFcxu4+ksUBS3z8lvDceJ7T5dZ84lGDZI/hsmxacMGD9rz3Yb8FUBSostSE9jSTpWLDJ1F8dOnrNue4nPllQ7clXvqQC/SaJJNrr/6zni37YReglJzBgMnJAYmHTlxkBpj23njiey17xPeayAW6TXItf82e8bbsd/0RwMEJXaZQBiN0GXsvegyXl+I4x2X4XrNkcUCXpXPukr/08CR7Tpdlu9Qa9gTY0gDD9KF44z5k9OTRvtc/+Rk/7eQgdyK1gLK7nPzcl/I5J+uTrSe+x1qSh10ANZOr1gDNgOm/ZUAeI/2znprdY0lOftpzn/lk916RwfTvzZf+LfthF6DUxIgGFIOlHMSUDhlO2vFrReKAtXg1e9bXWofzqEW6Wj73a5WHXQBvVoWW1rkNeA7Fz3jn2rPm0fGy3sxX22c9NX6LfdgF8OZUKKskuw5eK/b4wgW9RuWTHt1SfnzhO+IrRI9uVkxva/5wetDj9fgtcYddAAoDSwkZDgNLjnzhyIYMP+3kAuXjcs2/l98bT/F9pb/bJGd/yU97+m/ZD7sASp4FZ0EtDfgBIoMZvxYPP1D1uJz15V75tMBSPo+X9WW8kn+Jg47YYC0+fj049AJQKFgqZM2W/GxYvujgejxsQq3k1+zEAsnh2GJr4XjMJblW75Jfj37YH4JKSTkIocslbknHIIUul7jSOcdl+K6T7ANuqc85LhM/0TkuJ29pn/WKh27Jp1e/6wWgWKHLS0X6kFzei6+alKe1Pu/B5aX6nOPyEt97dnmJP0I/9EfAuQWVhoSuFBsbKI7L6YMNrPHTf+89dYGXqG/oE8Bvrct7D24pvtfg8hL/XL3ncPncuHv6D30CcHNBFe7yno2UYpMb3Lse8oB75yv13Ksb+gSoJWcwQpdrfm+K3Xt2+S77u+gF8Meiy6MG4EN1eSm+c1wexc843rPLybvkftgFaBlgb2Me0+WlOD5Ul/fiqyblEbbUt1THkt5jurzE36If9h3g8eNhobb0cfXZOIHeJ0D5n/k2Jr+67TKBrjPqvQA30yf9+bR2qfwadPsEdCY6m94IPRdAN+vlo0eP/u3p06e9ea78nSegM9HZ6IyOr6aMtQvA4+SEX3zxxbeePHnyYnrdXJ8ETTPelaQz0FnoTHQ2dvinM1sr4NX/3LjNwibUReH16NNPP/3Ku++++2dT8p9/9uzZo9uuV82lJqDHvj75n3/++bfff//9H0159WPghb1WLwKHXKoXm/DWJZh0uhDonVuKddWNnYAfqg5be2Hp8J17q4rW390UhCQE0V4HTwIuAfYr7jsB5u4XgE++bNhXq2i5AArkB60kWui15/DBmXB9220CHK7QX1wGt68WUTswt0suvZTAeasJr8ahE/CD9ouATDJ47E/Y8gSATBAhF0G26+EzobtBPxeXm6ppObzk+N7lpoRX0i4T4OAV3OXS/rUCWg9wjbdmey3ZdbPLBPLAPcmabeb1Hl4v34u5ypebQPXgKeV/AQCDc+pCSAmHAAAAAElFTkSuQmCC"},"../client/src/assets/img/create-from-template.png":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACQCAYAAADA6GNQAAAAAXNSR0IArs4c6QAAGr9JREFUeAHtnVmPJFl1x7N6lp7pGWs2I80CGMnyk7eRkHhABhkJyx/BsgF/BD9ifwZ/DXjhE1gytgx+4AGBbclPvKCZgVksM5s8PSvd5fhF1a/qX6dvZCwZWdVdVVeKPOee/Z5z4kZkRmXWZnM9rjNwnYGrm4GDgaUP0QfELwX58FKsYuYiaqHrPM1t46Xcg4BvK/Y23oOwtlkxZlETx0jOE5/l4D4WttDCDLVFS/6lwS2s0IU5ByYu/0GHFhiYeK5LetIuHf5wY0UW/eBXv/rVl2/cuPGD3/72t5/vjocasg8s6datWz9+4YUX/qJbwFATkIdL3wQW20I674t/9+7dnzz11FM3nnzyyc1DDz249T88PFvHbl2bN954gzX9+0svvfTNaIJsBnNyVlnqJYE3Yh0Un9E3AWc+xe+OB7L4FN3jaFmnr93aNi+++OLmzp07X3/99df/peOQh5PmP5XsMfNSyJdjmg3AikzCDbZ9zvwHcdQzPtdwcHCw4ShN8MNOhlxkI5xRy8llwoca4IBr/oO47Y8V3+LZBN19gDsBTcAJcKWaIBvArc5dwFw90NDLgDAXQxPQ5DRB1/BcDq5cE/guIItPjpxnvnr8ww8/7K+tJG/obJMHZCAnjbn4EB+ZHGPyybfQ0LjZYxgn2/4TTzzR+9c+cjbBm2+++fXunc8Pv/CFL/DugJPjyMDZdwMs6tLcGOYOcJKTDhlsAJMpVGkOVBeYuDYoCgPIgYww8SE+urX4zLuzfPPBBx+c+ESOgZ2HH3643wk6ub4JIHfHpb8ctBqAnAwOk54QYeaOLGqrYKmrnhAbY/ppM/GWXezZDMBPP/108/7770M+M9BlJ3j++eeRvzJNMNQAp9U8k6aj4pD0PEiehahFSJ46mAQfGugwtKXtqfraBlr87i3fScyfffZZ0zWXCHaCq9QEQw3QTFAWxeJMKfBYQdNGyg4FkTKJK2+jVEgz0AhcCobGVWuC2Q1A4vIMA68FTFotQvLQGyqgfnaRxwb2KTx2gB7whsZVaoLZDTClIFlUi5yQxCsDjk1h4j1xx5csvGc/cGxclSaY3QAWTkgis2jg9UiZxJXDFjiwdaCzzV/V1xaQM57hLgBtSgOgcxWaYHYDkECGENzitIqXPGQZSUv8iDv+mjqJqwnN+BJ3+7cplN8GL3sTzG4AEyo00cJtyZSnLDBx+RWmTOJVrjVPeXCboCU7RLvMTTC7AUiixQdyMIRDSUy6slP158rXolt4oEfGMwVf2AQk5zyPKUs5IzO7AbIYZyztMKkFw5S0JWYzxsQt/lLbA01ADvljCSDHeRW8c3XP0Pc9jCHC7AYYMrQLPYuU+C421bXYFh/6nHsA7QhrE7z22ms+Sj7vJqjNZohAGmHSuC8aYFKkOwjZBJhIfKnJbILO3te6JvjnzhYNwMM1YDYDOd7HQZFtgg69p+iTmsCngRhYZbz37rur2FlqxDPdmz3f+/PpHwcfA2/7JHCq32yCt95662uvvvrq7W7090LwONzNtFnn0pfA7iPrO93x626df9U9vfx5Z8PP1oWTzK7SACyMxK+5wEnRX7BQaYLNc889t+FP6MjDvpuga+yHuiebv9c92PpJ9wj7q8dNYEZsAnYBcXln4OwGyGK7nSZ8+plnzjg4j0mNibOfmFpn/1o7gOuqTQCdJvA+o+4Ea50oPLnETzdudDvPDzr4B0y6QcFHC99Ldi+z7wGy2Bqp0J0AmHiVG5qnTuJD8hlT4sqnDXBl5O8Kswk+/vjj/nEzPrwMVX91vot//m6zu6R9vrPh/cCka78+ZzcACawHxkwyuAsEJg6Poax2kgaeOuDICVMX2dZImdTFhnZaervQLqoJ2Am6BuCmk8J7TF7K7AYwiQkzyeD1IBpoDnQZ2hDvid2LstpBDnwtef2sDS+qCY7XkcU/TfbIImffA2DPYlioLNBFvwto3YMYJ9DYR/KymJ1N0L076C8DN2/e7P3C42BkHManU3nSM7/8TePAsOjAyfcBs3eADM4zMmkDwZ0bOZNFXBlbxrvPgLIJ+BO0Tz75pG8Ebko5jMMYmK8wcgeYbG72DmCwwurpmWefraTRObYsVEtYHrA1Un8orpbePmnZBOwEDHYC4jNe11Njdi4cW/8u65jdAAadTl2QASdvCj5lgem3+qv63H1D8+1g8sWnxLWrTKsJHn300ZMmgE88xiRe/db1Vv7xvH12DAhLnn0JIJh61AW4kKmQYJB1YJ+hH/Ge2L0oq33o0hIf4yO775FNwOWAg1HXRqzQ/PzAHCDr2oTQ1hqzG8AghK1ADL4uUtnKV06IbXBg4vKxA+4Qn8pXXv19w9oE3BMQg/cE+Gfuet3BXE/CtWOdfQkwUKEBETzj3XfekXQh0GSRRA6T7CeAwvMOzibga2jdN5D6Yns5IE74jmx6aTy/YC00Tx1PP/305vv/evv/pFubHm4O3tzcOPhR9wnBd7/9jVu/VkY4uwEstFBDDwI0ZuF5x2yRbQL82wQUi0FsWUBoXDYef/zx/iZyKPa7d293ku6K2OBvITu4OXxhc/fwrzvkL7//bx/+aW2C2Q1AQHVkwLwPz0VU2X3PiYUjdwDOHg7O/ovaAVy3TcDvE7ATMGiCLGzinPUU/7HHHtNEE7Je9Y7qcfYy2Sk9e/jZ3X/s4N+kgdN9J6kzcR0DE59pZm/ixgWkABZhbw5HDBsDO4E3hhSQwtVBA/D2cWygevcuje8JcO/N+uHdwz+vdlbZAarR+2GeRRcn8eK/+MUv+l3BnWKoAK21YIOhLSC2+Vze4vIVM+YcjzzySP/kLguJHIOd4JVXXullsGMT6OPobD59h9QrNV4o/OBAHfZBdzko49I2gOtsFckkUyTOMAsoXd0xmLYrnrrY5VvJyLDdO9RxjhwH9LnjLnr9s6DTdxQn6zlpgHutrt4A98u7AJP5VHeHTEI546B5ppoKeMoK5Q3BLJA4dsE5EpePbf5iyF2h2mYHQo+BrHpVbmjOPV93AThis6bOXmekn3dbf28PWMfqDVAdXMTc5JlIEgueAxqHl4DKT9kxHH95UGTmFhvc4g7Zwr8H8uDAqYN1nIyDbq1HW/4Riam0E6EjZHYDZHCtpE15FpA2CMPFtuzBnyOvDSAHiUHfJgByTWbrzwZA5kwScXw8pvhHJg9sc0ADMsCHhvEO8cfoeQnoi49C9nziYWx2A2SCtcPCoA8tUF7Vdd7H2ukPDeWEVb76R85YEnpmWmjkKA6QA/6SkT7A88gmUG7Ih3rwx2SrDW4CT/qrW0s/AY6M2Q3QskfyGMIqw2LguShx5cf4c+xpUx1s6xeac4pNIyCfOuBT40m76S/9IGNj2QzKJjQOoE0JnDo6NQrQi/N60OFHs+0WZjdAJsfEJQ13mUTnCSvOfM7QrxDdxLVlgYwHukVIGnTnwMThja3PgulPnRaE1hqp2+KP0YjZezx2AnAgo67niHr0OrsBMMYQHpk5fX3n7bdPJxeEZWzPdn+qzZlOkdz6xS1sDXNbwqosc+1YRPRtCvjgDPjK9IR4Sfpc/5jJzwGOS9TV6NRB5uSUevRNlpyP4hmowksCVnff0GLYBPgDZ1seSorFs3BjMepDexY6c5V4yx66qSfekm3R+nuAYwZ15+S3/uLHG8IZ9cU7QFohWBfAGbfr0FYmVBq2xbfxlTOWTKiFhaaca2AuPsTvleJlSsNoK9ROUHj6dE2uUfo2fQwd3QQOrKfj0wzde5Kjhw8oHI/ZDZABGazGhAY/xFduCKYPZKq9qXwLU/WrX+VsDOSlISuefGOAD56w5Q9aa6irjnb1yU7FI+Cxh0Hon/rghORzgeOG6Mvfvc09OPxRjWF2AxioUIMuhLm4UJk5cI6uskJjMyEm0wK24lAXnrgQO9qAL572lG3pQ3O05OC16ND4uPqjjz7q1f3rYm0lzP6i+OgeNQFt0DXCwd13bh7e/G7qgM9uAAMVVoPMawGqzFFw098W6kuIvcSrv2p/rvxce3V9Vb/yh+boeSjDWig8Tw1pBPitcXQTKM/iU3i2fc78m9/9u28/9+uqO7sBMLBtgRf9LKAucO059zjb1o+/VgNOiQO91oEun15y8LcBdfzyl7/c/MPf/v7vdHR+AJGfQGP/pxs8OrQ9FjUAQTKEbdOXl+q6ha2VbuO15C+KtqgBarB5RvAsgMVLq7IXMTcWIGMsvn3LX0QOhnxO/6xxyMJxQmGTWDtf2FKzEMDEW7LQUibxIflKN5ap8e1bvsZ3kfNVdoC5C8gEqyvNeUJ5QniJp+w1Pi8Dq+wA81xeS99PGVh9B7gfngVMSfAan1hO8bOGDLsdl7597HrXO8AaFSo2LBQw8SJ2z3Su/D0GFhBW3wHO48wiUXlGiHuDWPOwb/nqzzh46OR3EqTxP5dy/NN/8ff+z/ekXMdjjxxuPvf0weaPvni4uXX8V+HaSP1d8dkNkMlcK6C0yYIyEa0F6leoTks2eUPyY/7H+C2/+OL3gvjght/xwUZrDH2j56PuO6Sv/e/h5q3um3bffHmzeeKxe/+usWVvLm32JcAkCnHo4oCJG0zSEpevLWDi8lMHvB7IKZO4cklLXD4+wYf8Z0yJY4uhb+1B48z3Gz3yodfBLtG57w8+zgUH9sedrok+Pdz89yunJ0XV33U+ewfAoclyYZlAAzJRzMWFSVM+4RT7KV/t6Uc4xZ6y2BqTH+NjgwaY8p9Xj4p/9AEVeszr+J93ebjz8EkeK3+X+aIGMFnCTMjHxw8spBGcOHDKwK46Lf21+TUmfRtv9bdN/rFuy0denSpb50cPcSr1eE66uoa4/clRVxjPgPQi8uwGyOSwyClDOeGYTvpA1mSmfguXNle/xqMd4RR71cbUef45N/701esfNwBPc41lqt2pcrMbIIMkWEbSxG9232aVPxYMOp90N0xAziCToL42gYzKr/bnylf9Oh+zB9/4la02huZTv9FjLobsLKXPbgADEeJYHMhhEoCtkTItvnrCKj/X/q7y1T8xQ3OIA5WVNwa5CTwZfnsHyOiA3+hxDUeM9V5nN4BFGQrBQIVDciYNvngmcFsiUx59fQ3FNiavnlDf6o3ZNwaheszHRl4C+qf3KOR5c4zPsTnmM/mzG2AsEPhjCUuZfr3HOwV6qauvpGXw4i170pAR116F2kmojPoJU05ceSDxTh3cBJ5sJugxaeibg6l2p8rNboCWYYMDJm5SWjrJEwcmrl6LJk+oDHNxYcYkX5r6CeUBp8ojh7y6veKEl97FsR+8DX2jx7VMMDlLZHYDuEAh3gwOyCEPKF8ac/Ehfq8UL/uQN+Zwc4LKE475Vw7I4bpODG5BkO02gX50qpO/0bPF5CzW7AbIxQ55aslIQ0dcmAlOXH6FaaMVw5h8+tCWtCX2qo7+K701z88Bjs+XroFOJYlrn2N2AxCMyTI4FixtSbAmDJj4VFv6nhpP9TFXf678tnX09wDHApSa9xaWXBy4r7GoAWoCCU7akkAtHDCTO9WmcsK58agnHNNXTtiSh+datuXk6CbwqMTKA3ub3QvYk92DoH7ONWLlMfth0Mr+e3MmEpj4Pnydl02+0NH6Ucfqn2LzWYAPhYT0AG8RgS/87tHvFtgY1cYu80U7wC4Or4ouf8O/xjd6bj56uPnqH27/jcBdcnrdALtkb4suOxmPg/lhyiXf6Hni8Rubz3/u4c2f/cmtzZOPz393sSW0M6xVGoDFev3SOk8Fl4ylekt87UOn5oKfheOrXeYnfyYO/3//nc2Gb/bwH8D4IigH3znEjgdy+9j+sbvoHoDAGAbo4vYVZO/sAXkxB0LCFhe2lgLPfFaIvDlv6e5CW7QDuBAhASTOnKd6Q4PFuGBkwD3zt+lNsffR8d/cPX7r1j0xDelXOvFVO8ZcZZ0bv/O5UPvkouZSHnDtsWgHqEEYmBB+4lXeBbYWm7rY0I6w2mKe9uRDm6qvjlB7zMWFyiTM2MSFKbcN3xavvoXb7MzlLdoBqhMDE8IHNwni8qFLU7banDOv9tCVph19J8/4lGlB7QhbMmnbdQmRF0+5aidjEQeKV/m15osagKBc1FAgysjPxYsLlRFKF2rLZECXho5yQmlT5bWV8kOxQK/yylZejSflWjjyHsnf5i/lluCLLgEuzGATGgQ0AjepQvji8p1XnrYqVF791KuyyRuSr+vRftXVdpV3Dt91C7Ul1EYLGl+FyE7Rb9kco81uAAMRZnCVRhJMjrAVUPLAsSNMHFrrSBntS0OeIQSHJ0y8JzZeUiZxRaVpE1/QjBV6+lcvYfLF5+inrTn47EsAQbk4F540nUtzXqG6ld6aKyvcJpM85Y0F2BrIKQM/5RJXd0y+8tXbBo0VGXFg4tv0l/JmN0DLUStIaCZPXDmTnXztKiOEXuWVFVb70tO+NuQllJfy8tO2fHnCjLUlnzR15sAa3xzdMdnZDZCLMSFJ06Hvo51PhUv1qv2LtEM+GMKK98zGC/k0pxY9ddNeQ30RafY9wCIvV1wpi7otFRTYIgu3ya/Bm70D4NTghEkzqPwkDrnsaGWE8PwkrfW9AOWmQM98/Dv0bSHG4kGvZUd7Lag8vCX+WjalTYlX2blw0Q5gIoGJV+cEzsEQVpkl8/SZeLVlfJlA4xCikzbEq62cK6P95IFrG5h4lavzIfn0V3V2ne9tB5gTmElCR1zYsiNPmHopP8QnofBMrHjKp52KKyes/KVzG2puPEv9obfXHWBpYBbGhGBHWsumPOGYvIUDJt6y3aLpByjekltKy5gSX2pvm959sQPUAFuLllZlmcsTJq0lvytNP8Jd7dV4aSpsZ3MlvoY/bSzaAVTeFzSxwMT35e9+sGvRXXNC4jMPa8e6aAeYEkTeFU+RV2aJHsnJBILzrmLpWWOygdrRh3GuDbVPzDVuecC1xyo7gIEBE1872CF7JszkEQP40niqPfxKa8WQa068JTtE2xavvoVDNpbQV9kBDAw45S96skAEjZ60JYtQ1+SP2avy1eeYfpXPOboMYfKm4q4DKD5Vd67cogbYNYEmR0jQiddFVH/ISkvdtJF4tSdPWPlps8XTN7A1sKtMi9+iKY/utrhaurvQFjWAAQprAC7GBCEnDVlx+VW/yutHWPWrfOWP2a/8ql/tG4dwrn6VZ64PfNejJb8WbXYDZHJMQNJyMfKlDQXt4pUfs6eccEy++l0ijw30GHPjVadXnvAyZn+CickisxsggxtKCN4tDviUhKc8Ojn0I8wYUm4qri8hei08aWl77nqqfNoSd23MxYGJK7smnN0ALec1SBIHbSiB1Yay2pmiP9U2vqr96r/6q/KVX/WNWzgmX/XH5mvbS3+zGyCTQ2CtkTLw6wLm8quPaq/yx+ZVv8aDPjSHuLDqKyes9sbk1UOOg6EOuH6F0NYasxug5bguGJk1gzUZJqf6q3z8Kwteh7EJW/qpU/0lD7zF13aV3TZHRz3hNvk1eIsawOCEBJJ4TSg8aQad8tKGoLJC5Fp40tKWvoHqSnOesBcqL2lbXFh1tT3kr5i+0OnsBnBRGTWJcNGZDBMkT90qn7ZaeNWvMtVela/8jBF8TL7yx/y7buGYfrV3nvPZDeCiapBDdOTkCZOW+Bw+ejlaui0aOrUgyEnTZks3acoJp/C2yWjnvOGiZwEkiwFM3OCTlrj8MZg6iQ/ppUziQ/IWApi48mkj8bX42hmCGVPiQ/K70GfvADhrBSVtCn8sYG0J02ZLVznhmHzLRtK0I6z2pAvn8tNXC6fpsG3zIZN4S2cpbdEOMObMYIGJq5e0xOWfN8wYEl8aR9pIfMweRW8d6GWzjdmZw1+0A4w5MFgh8i28RRuzvQ++cQhrvHN9akc41R7N4pE+sQM97SV/F3wvO8AuAV1lXQpskYXkY84uMjd/F9IALm5owXMXsav8/R6PeTLOXdeb+osuAQSSW5K4nZoOWrhyQmQSrzq7+qv26lzfQviJV/l9xKNN/G7zXWPZdT67Afj9u+uxfgYoOk3QOtb3dmpxqAHaT3lO9a6xlTNA4R02w3nsBIP3AN1Pnd7phjFdwz1lgBzz24DZAOLnsRu0GoCz/7AL6vUPPvhgT8u+NmsGyDE/HmmxpSd0JxAmb1fcBnDLP4G/+c1vvvX+++/f7Y7N9U6wa5rv1Sen5Pa99947aYChAueOcK+l3Sh5D0DxuRD1O8DLL7/8nz/96U+/0e0E3+sCfan7T5hHP1m9m79r7eMMsO1z5vPfRb0EtH4idt8JywbAV1/8Y3j3K1/5yn90+B93B43BbuGdirAj9YO5MjTKwz/72c9e/dKXvtQz84UfT37QBmcmZ6FnqLhnZl3PkDwFZqBnsYHi0IdsVh9rzYcaIP6ZXd8UFNfLA3gd0DhYYS/H7+Vz1GESK/2qzC2wRbcBnMs/r3xkhShcFtomkM7c4guNk3nqHrAgtrY6zvyjxMq85HOLC8yjFl+580gHDWCB8defveHYoltwYYj0qA1wKXcACuK2zmrFl+5mFjibIHGTq5zzfcDcAbRvE9gYFl2oXEIbQN3BHaC1K6Shq4JbXAvPuqWZgzqXvia0ASy2tp0DE5dfoQ0AHfyO17YqeD0/zUAWOHEk6vxUaxCjTrOHDYCihdZIGqw8ZSpErj+6ZwZ3uut9d8Lfex9Qla7ifFuBt/Fqrvg8gU9tK33qPBsAHYve2u7lbbONTH/f0AX1+u3bt7/Iv0K5HtMyMKfwWuSTxO4ke72b9yee9KmwNoB6U4qtLM2CvBD64dtvv/2tbgf4cbeoG37YAeN6rJMBznyKz6e177777rc6q9aswq0OW2f6VoUGUxtA3gV4PNR9kvjlF1988XtdsNefJDYStwuJbZ8z/4033vhO94HdzztbXAbYfT0mNYLF2yUWbQDvaYKORkNIT9ldfF5V3SwqhWYObBU/ZQfzNXQJGFQYYeDUoBRlTuENyCaQfw3nZcA8ZgPkWS9/ktU1G6AWmqAY0plbfGEvcP0yOQMWF5iHzZD8SUbXKkTaAW8dBJRykwK8FmpmIAudjSCuknLO74Fr7gAa1ynQRoB3XXwztA7MPCc+y/qaRam2cp74rACvhbdmwMIjlHhr3jS0dmG22dvGawZ3TdyagVrwFN7GS7m9bcvXxT6T5nObTC68Ef0/FTz/RGVuClcAAAAASUVORK5CYII="},"../client/src/assets/img/doc_recycled.png":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAkKADAAQAAAABAAAAkAAAAAA/PwqIAAAKN0lEQVR4Ae2dbYxcVRnHn3vntbuzu52d3WqJVugnLS4WiC2yrVC3CKUgiCUlREgQARujEU38YEw08YPBbyR+MBJ8QUJIRYNRFkG0TV2LIC+VETAUBq10W7qz3W53u53ZmbnHc3Y703nbeblzzrnnPvOcptl7z8vzPOf//HLvnbn33AGgQgqQAqQAKUAKkAKkAClACpACpAApQAqQAqQAKdANCliKJ2kfSiZv7e/t/XIwFPoMY8xW7M9o86fn5+8c2bDhV0YH2WZwKgGyU6nUM5FodHssFoNgMNhmaLi6O44DMzMzMDs3hwoiZQDxI8/u4UTi8eHhYbAsZW58Rdni4iJMT0+jgkjZKaWvp+ceceQheM4zHg6HIZFIwEBf3yPJN96443yLf7eUARQKh7d1+2mrHhbYIFIGULdfMNeDp1iHCSJlABXFor/1FcACEQFUP79aajFARABpQWVlJ36HiABaObfaWvwMEQGkDZPGjvwKEQHUOK9aW/0IEQGkFZHmzvwGEQHUPKfae/gJIgJIOx6tOfQLRARQa/n0pJcfICKAPEGjdaemQ0QAtZ5Lz3qaDBEB5BkW7Tk2FSICqL08etrbRIgIIE+RaN+5aRARQO3n0PMRJkFEAHmOg7sATIGIAHKXPyNGmQARAWQECu6D8BoiAsh97owZ6SVEBJAxGHQWiFcQEUCd5c2o0QKieDwO/bHYI7oCI4B0Ka3Jj23rTaleb5pEJDf6FCCA9GmN0hMBhDKt+iZFAOnTGqUnAghlWvVNigDSpzVKTwQQyrTqmxQBpE9rlJ4IIJRp1TcpAkif1ig9EUAo06pvUijfvZvPF/QpuIKnQMDuiheMogJo8ngafvzwb+BEemaFtOqrDgYDcO3Vm+DzO6/S59QDT6hOYU//+Xkj4BF5FEfBp557HmZPz3uQVn0uUQF0ZiGrT7kWPZ1ZyLTY05/dUAHkzxT4O2pcANEvKminERVAF6xJaBewkcNIOASJwYFGXXzfhupT2A3XjkKB/yrO5PvTwPg/L0uUP588tuUyEBBhLqgAikbCsPvmMcz5Mm5uqE5hxqnbBQERQF2QZJVTRHUKcxwG+w++ApPH0sB/LUilbk1ti9Pp6OZL4IIPDjXt6+cOqAAa599EPzl+wJh8HHzpX/Cj730VQvy2BtaC6hT27pFjRuVpbn4B0tOnjIpJdjCoAGL8FGZa8fpUqloPVACpFovs1yqACqBI2LxLOnExjbmgAmjb1svBpIRtvmwDDMb7MfMDym4//vfIETY0NATilSM6y+JiDqZPndbpsq6vCJ/34Oq+um0qK8Vv06fTafjIunXKclsev3nH/PLoXGyH+b2ntYbdVHUxDd8MQXUK843qiAJFdwRazOVhembW8xR5dQrTPXFUAB1OvQcPPrQXMplF3TrW9bfp0o/BvXfeVLcNSyWqU9i+iZeNgUcA8uKrb8LJGe8v6FXCigqgTDanUitXtjNZM46GroJvYRAqgFqYL3WRrAAqgCxby1cfbaXAssyLqa0JNOmMCqCL1q1tMl29zX2xHhhKrNbrVLM3VJ/CdoxdAauiETjGlzh7fRe8+EAZ5meBBKuoAArwl2yP8fthVPQpgOoUpk828lRUgAAqKkF/XSmA6hSW5Xfif/f0ATh63N3CQos/nLB2zSDctGPr0rWUK0W7bBAqgP7wzAQ8u/8fHaXw9X+nQCxqve2W7R3Z6ZbBqE5hR/mSZhll8oQcOzJiMd0GKoBkLYf3+isA06Epjw8XQOUzo20tCqACqLcnIkW03p6oFDvdYATVRfSOsU/B2/85ClNp94v5hvj7fHZec6URuWfpE+C88DdgyX8CzPBPltPppbisBF8uHU+ANfIJsDePgjW0xrN4ld3p8+qheqFkoeC4vpUh3q7qdXGSh8B59GFwXn+tpVDsiy8B+4t3gz2yEXQ/VI8SoJZUN7HT7CnIPfgAsBcPuopOHI2cr3wD0vyxXlqV4UpC/w5iqbch/4PvAJt63/UkxOkO3jkMwT3fdG2j3YF0BGpXMQX92TtvQe7bXwPINnglcHwQrMTwknc2PcWviU6uGAkLRyDMcpeHf//XV1bsJKmBAJIkpGszHITc/fcCS3MoqsvqOARuuQ3s0avA+kDls07s+CQ4Bw9A4bePA5yqfTM/f5DtvVVW8JPW+P7j1WZl7hNAMtV0YSv33W8BO/RSzcjAzpsh8KU9AJEmXylkzkLh5z+BwlNP1tgAsJ7r/ePENXUapFWh+h5ImiqaDLGXX6gPz31fh8Ce+5vDI+KMrlrqG+Bjagvbnrl+y3W19fJqCCB5WrZtKf/Ln9aMCXxuFwRu/EJNfbMKMUaMrS4Fxn5YXSdznwCSqWYbttiRd0F88iov4gvBwF33lVe1tb009tyFdmkgg43ZG0cvLu1L3iCAJAvaqjnn7/wjd1Wxd98BEOrgbSZi7K7bq6wCOHlb2fJYAqhGbj0VzmuvVjriy38CV366ss7N3hVb+LVz5Wcjh7Ftbky1MoYAakUlFX34fa7yYn34QoABCUuAuI382g+Vm+bPWbLKiorWznYIoM70cz2anVy+MVoywF/GJas48XiFKQZW5ZdIFa2d7RBAnennfvTCQsVYqydWsd/RTrSnajgbqKqQtksASZOyOw0RQN2Zd2mzJoCkSdmdhgig7sy7tFlXfmEgzSyAl08kSpyGFFPs6P+g8MRjAGfPluw5E/tK22LDGhoG66Mfr6hzs+PwX2x03kyCXfW4B180+euiPWbBXMCCB6LjE28V69z+RfVMtFsRVI8T8Dh/Gm/oRjzOwaqgajigQWO90wr/CdBbS0P4wsnC8ivC7y7Vudyo58ulKRq2ogJlR54V+2husBhIeQs6AaQ5cdjcEUDYMqp5PgSQZsGxuSOAsGVU83zoU5hmwd26C9x+F1jrLlwaLh5GKzz2C7empI4jgKTKqc6YzZcxWyOXLjlgyQH+MdyMQqcwM/Lg2ygIIN+mzozACSAz8uDbKAgg36bOjMAJIDPy4NsoCCDfps6MwAkgM/Lg2ygIIN+mzozACSAz8uDbKJQBxN9P4/hWFQq8ZQWUAZTP5f6Sz+dbDoQ6+lMBZQCdPnPmofn5eddvS/WnnN0XtbKbqRtHRp5IpVLPTk1NfTYWi0EwqMyV+VnjD7p3WnKP/oyvnT+3ZHm29pV2ndp3O15lVp3169fvOJRM7spmMvcEQ6Gr+W9QqPTnVgPl4/qzWejgpS3L8bX4zmjlk6lyoDqhDj8S7eU+xf+uLQvXbdnLF0KcXxWBSAll10CINKKpNFCAAGogDjU1V4AAaq4R9WigAAHUQBxZTZbFkrJsybLDLHZYhi1la+NlBIfJxsINWzfZjPUvzYnx1emiML5CXRT73L7YLrVV9RFtgWLd8t8Cf/WYqAbbPp/H0vjlNqu4L/qdG28zmItsCu2zvr+fvukVulAhBUgBUoAUIAVIAVKAFCAFSAFSgBQgBUgBUoAUIAVIAVKAFDBYgf8Dh6GAQ/l+vaUAAAAASUVORK5CYII="},"../client/src/assets/img/guide/perm/1.png":function(e,t,n){e.exports=n.p+"1.8b39037648159ddf34091bfd27d29b31.png"},"../client/src/assets/img/guide/perm/2.png":function(e,t,n){e.exports=n.p+"2.b3c9631d7bd818ce34f209975127b5fe.png"},"../client/src/assets/img/guide/perm/3.png":function(e,t,n){e.exports=n.p+"3.22261b8c2016b68c4abcd688f66dbc57.png"},"../client/src/assets/img/guide/perm/4.png":function(e,t,n){e.exports=n.p+"4.b0a420fbd0b3f574d29f9bddbf75b694.png"},"../client/src/assets/svg/add.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},this.props),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M544 480h352v64H544v352h-64V544H128v-64h352V128h64z"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/clock-o.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},this.props),o.a.createElement("path",{d:"M143.47 665.56l59.09-24.62c50.86 124.59 173.23 212.4 316.14 212.4 188.5 0 341.33-152.82 341.33-341.34S707.2 170.67 518.7 170.67c-91.48 0-174.53 35.96-235.82 94.55l65.15 65.13-241.36 60.35L167 149.33l70.61 70.62A403.99 403.99 0 0 1 518.7 106.67c223.85 0 405.33 181.48 405.33 405.33S742.55 917.33 518.7 917.33c-169.52 0-314.73-104.06-375.25-251.77zM113.37 512h64-64zm419.96 8.09l139.95 139.94-45.23 45.27-149.33-149.33a32 32 0 0 1-9.39-22.64V320h64v200.09z"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/close.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},this.props),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M557.25 512l279.08 279.06-45.27 45.27L512 557.23l-279.06 279.1-45.27-45.29L466.77 512l-279.1-279.06 45.27-45.27L512 466.77l279.06-279.1 45.27 45.27z"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/dot.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({width:"8",height:"8",viewBox:"0 0 8 8",xmlns:"http://www.w3.org/2000/svg"},this.props),o.a.createElement("g",{id:"\\u7B2C\\u4E00\\u671F+\\u9876\\u90E8\\u5BFC\\u822A\\u4F18\\u5316",fill:"none",fillRule:"evenodd"},o.a.createElement("g",{id:"04\\u3001\\u7A7A\\u95F4\\u7BA1\\u7406\\u7ED3\\u6784-\\u7A7A\\u95F4\\u4FE1\\u606F",transform:"translate(-40 -332)"},o.a.createElement("g",{id:"\\u5DE6\\u4FA7\\u5BFC\\u822A\\u680F"},o.a.createElement("path",{id:"Rectangle-6",d:"M0 0h262v900H0z"}),o.a.createElement("g",{id:"\\u56E2\\u5C0F\\u7F8E\\u7684\\u7A7A\\u95F4",transform:"translate(0 273)",fill:"#AAA"},o.a.createElement("g",{id:"Group-7",transform:"translate(40 54)"},o.a.createElement("circle",{id:"Oval-3",cx:"4",cy:"8",r:"1"})))))))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/ellipsis-large.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M234.67 448a64 64 0 1 1 0 128 64 64 0 0 1 0-128zM512 448a64 64 0 1 1 0 128 64 64 0 0 1 0-128zm277.33 0a64 64 0 1 1 0 128 64 64 0 0 1 0-128z",fill:"#212121"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/export.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M341.33 480h256v64h-256v96L128 512l213.33-128v96zM234.67 234.67h-64v-128A21.33 21.33 0 0 1 192 85.33h469.33l192 192v640A21.33 21.33 0 0 1 832 938.67H192a21.33 21.33 0 0 1-21.33-21.34v-128h64v85.34h554.66V303.85L634.82 149.33H234.67v85.34z",fill:"#212121"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/inHerit.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M266.67 426.67V320C266.67 184.51 376.5 74.67 512 74.67S757.33 184.5 757.33 320h-64a181.33 181.33 0 1 0-362.66 0v106.67H832A21.33 21.33 0 0 1 853.33 448v469.18A21.33 21.33 0 0 1 832 938.52h-.04l-640-1.18a21.33 21.33 0 0 1-21.3-21.33V448A21.33 21.33 0 0 1 192 426.67h74.67zm-32 447.78l554.66.22v-384H234.67v383.78zM480 576h64v213.33h-64V576z",fill:"#212121"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/lock.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M256 426.67v-96c0-141.38 114.62-256 256-256s256 114.62 256 256v96h64A21.33 21.33 0 0 1 853.33 448v469.18A21.33 21.33 0 0 1 832 938.52h-.04l-640-1.18a21.33 21.33 0 0 1-21.3-21.33V448A21.33 21.33 0 0 1 192 426.67h64zm85.33 0h341.34v-96a170.67 170.67 0 1 0-341.34 0v96zm138.67 128v256h64v-256h-64z",fill:"#FF5F57"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/triangle-down.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),o.a.createElement("path",{d:"M521.9 666.77a10.67 10.67 0 0 1-18.45 0L329.98 368.02A10.67 10.67 0 0 1 339.2 352h346.94a10.67 10.67 0 0 1 9.22 16.02L521.9 666.77z",opacity:".4"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/assets/svg/triangle-right.svg":function(e,t,n){"use strict";n.d(t,"a",function(){return p});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),o.a.createElement("path",{d:"M667.41 502.83a10.67 10.67 0 0 1 0 18.45L368.64 694.74a10.67 10.67 0 0 1-16-9.21V338.56a10.67 10.67 0 0 1 16-9.24l298.77 173.49z",opacity:".4"}))}}])&&c(n.prototype,r),a&&c(n,a),t}()},"../client/src/components/CommonUI/like/style.styl":function(e,t,n){},"../client/src/components/DocDemo/Adapter/style.styl":function(e,t,n){},"../client/src/components/DocDemo/Laserpen/style.styl":function(e,t,n){},"../client/src/components/DocDemo/style.styl":function(e,t,n){},"../client/src/components/DocOps/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/popover/style/index.js");var r=n("./antd/lib/popover/index.js"),o=n.n(r),a=(n("./antd/lib/tooltip/style/index.js"),n("./antd/lib/tooltip/index.js")),i=n.n(a),c=(n("./core-js/modules/es6.regexp.match.js"),n("./core-js/modules/es7.array.includes.js"),n("./core-js/modules/es6.string.includes.js"),n("./react/index.js")),s=n.n(c),l=n("./mobx-react/index.module.js"),u=n("./classnames/index.js"),p=n.n(u),f=n("../client/src/assets/svg/edit.svg"),d=n("../client/src/assets/svg/star-o.svg"),m=n("../client/src/assets/svg/star.svg"),h=n("../client/src/assets/svg/export.svg"),y=n("../client/src/assets/svg/ellipsis-large.svg"),b=n("../client/src/assets/svg/history.svg");n("./core-js/modules/es6.object.assign.js");function v(e){return(v="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return!t||"object"!==v(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,O(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",g({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),s.a.createElement("defs",null,s.a.createElement("style",null)),s.a.createElement("path",{d:"M192 298.67V85.33h640v213.34h85.33A21.33 21.33 0 0 1 938.67 320v405.33a21.33 21.33 0 0 1-21.34 21.34H832v192H192v-192h-85.33a21.33 21.33 0 0 1-21.34-21.34V320a21.33 21.33 0 0 1 21.34-21.33H192zm64 0h512V149.33H256v149.34zm618.67 64H149.33v320H192v-85.34h640v85.34h42.67v-320zM256 661.33v213.34h512V661.33H256zM256 448h128v64H256v-64z",fill:"#212121"}))}}])&&w(n.prototype,r),o&&w(n,o),t}();function P(e){return(P="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return!t||"object"!==P(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),C(this,T(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",k({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),s.a.createElement("defs",null,s.a.createElement("style",null)),s.a.createElement("path",{d:"M170.67 106.67h682.66A21.33 21.33 0 0 1 874.67 128v320H149.33V128a21.33 21.33 0 0 1 21.34-21.33zm42.66 64V384h597.34V170.67H213.33zm-64 341.33h341.34v405.33h-320A21.33 21.33 0 0 1 149.33 896V512zm64 64v277.33h213.34V576H213.33zm341.34-64h320v64h-320v-64zm0 170.67h320v64h-320v-64zm0 170.66h320v64h-320v-64z",fill:"#212121",fillOpacity:".87"}))}}])&&x(n.prototype,r),o&&x(n,o),t}(),D=n("../client/src/assets/svg/sort.svg"),N=n("../client/src/assets/svg/lock.svg");function M(e){return(M="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return!t||"object"!==M(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),B(this,R(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",_({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),s.a.createElement("defs",null,s.a.createElement("style",null)),s.a.createElement("path",{d:"M767.79 320h-85.44a170.67 170.67 0 0 0-341.02 10.67v96H832A21.33 21.33 0 0 1 853.33 448v469.18A21.33 21.33 0 0 1 832 938.52l-640.04-1.18a21.33 21.33 0 0 1-21.3-21.33V448A21.33 21.33 0 0 1 192 426.67h64v-96c0-141.38 114.62-256 256-256 137.81 0 250.2 108.88 255.79 245.33zM480 554.67v256h64v-256h-64z",fill:"#FF5F57"}))}}])&&L(n.prototype,r),o&&L(n,o),t}(),z=n("../client/src/assets/svg/inHerit.svg"),W=n("../client/src/assets/svg/move-small.svg"),F=n("../client/src/assets/svg/copy.svg"),U=n("../client/src/assets/svg/followed.svg"),K=n("../client/src/assets/svg/follow.svg"),q=n("../client/src/assets/svg/delete-small.svg");function G(e){return(G="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return!t||"object"!==G(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $,ee=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Y(this,J(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",Q({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},this.props),s.a.createElement("defs",null,s.a.createElement("style",null)),s.a.createElement("path",{d:"M480 682.67H149.33V149.33h-64v-64h853.34v64h-64v533.34H544v192h138.67v64H341.33v-64H480v-192zm-266.67-64h597.34V149.33H213.33v469.34zM416 256l213.33 128L416 512V256z"}))}}])&&X(n.prototype,r),o&&X(n,o),t}(),te=n("../client/src/utils/report/lx.js"),ne=n("../client/src/utils/report/lxConfig.js"),re=n("../client/src/utils/tools.js"),oe=n("../client/src/utils/config.js"),ae=n("../client/src/containers/ManagePage/const.js"),ie=n("../client/src/consts/index.js"),ce=n("../client/src/utils/screenManager.js"),se=n("../client/src/history.js");n("../client/src/components/DocOps/style.styl");function le(e){return(le="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return he});var me=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=document.getElementsByClassName("tableHeadFixed");if(t&&t[0]){var n=t[0];n.style.display=e?"none":""}},he=Object(l.inject)("store")($=Object(l.observer)($=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=pe(t).call(this,e),(n=!o||"object"!==le(o)&&"function"!==typeof o?fe(r):o).interpolatePrintHotKey=function(e){var t=Object(re.q)().os,r=n.props.store.ui,o=function(){me(!0),r.setPrint(!0,function(){return me(!1)}),r.canPrint||r.loadAllPics()};t.includes("Mac")?e.metaKey&&"p"===e.key.toLowerCase()&&(e.preventDefault(),o()):t.includes("Window")&&e.metaKey&&"p"===e.key.toLowerCase()&&(e.preventDefault(),o())},n.handleClick=function(e){var t=n.props,r=t.onShowHistory,o=t.onExportViewData,a=t.onMove,i=t.onSort,c=t.onCopy,s=t.onDelete,l=t.onFollow,u=t.placement,p=t.onSetTemplate,f=t.onDemo,d=t.store.ui,m="view-page-".concat("viewpage-navbar"===u?"top":"right");switch(e){case"history":r(),Object(te.a)(ne.a["".concat(m,"-history")]);break;case"demo":f(),Object(te.a)(ne.a["".concat(m,"-demo")]),ce.a.resetFullScreen();break;case"export":o(),Object(te.a)(ne.a["".concat(m,"-export")]);break;case"print":me(!0),d.setPrint(!0,function(){return me(!1)}),d.canPrint||d.loadAllPics();break;case"sort":i(),Object(te.a)(ne.a["".concat(m,"-sort")]);break;case"move":a(),Object(te.a)(ne.a["".concat(m,"-move")]);break;case"copy":c(),Object(te.a)(ne.a["".concat(m,"-copy")]);break;case"delete":s(),Object(te.a)(ne.a["".concat(m,"-delete")]);break;case"setTemplate":p();break;case"follow":l()}n.handleHidePopOver()},n.toViewPage=function(){if(n.props.store.doc.manageVisible)return n.props.store.doc.setManageVisible(!1);var e=se.a.location.pathname.match(/\/(diff|manage\/page)\/(\d+)/)[2];se.a.push("".concat(oe.a.primaryPath,"/page/").concat(e))},n.getParentAddPerm=function(){var e=n.props.store.sideBar,t=e.pageId;if(t){var r=e.getParentData(t);if(r)return"page"===r.type?r.hasAddPerm:r.hasAddFirstLevelDocPerm}},n.handleCollect=function(){n.collectTip.onVisibleChange(!1),n.props.onCollect()},n.handleHidePopOver=n.handleHidePopOver.bind(fe(n)),n.state={visible:!1},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(t,c["Component"]),n=t,(r=[{key:"handleHidePopOver",value:function(){if(this.docOpsRef){var e=this.docOpsRef.tooltip,t=e.onVisibleChange;e.state.visible&&t(!1)}}},{key:"componentDidMount",value:function(){var e=document.getElementById("viewPageScrollWrapper");e&&e.addEventListener("scroll",this.handleHidePopOver),document.body.addEventListener("keydown",this.interpolatePrintHotKey)}},{key:"componentWillUnmount",value:function(){var e=document.getElementById("viewPageScrollWrapper");document.body.removeEventListener("keydown",this.interpolatePrintHotKey),e&&e.removeEventListener("scroll",this.handleHidePopOver)}},{key:"genCollectIcon",value:function(e){return e?m.a:d.a}},{key:"render",value:function(){var e=this,t=this.props,n=t.hasBeenCollect,r=t.onShowPermPage,a=t.placement,c="view-page-".concat("viewpage-navbar"===a?"top":"right"),l=this.props.store,u=l.ui,d=l.doc,m=l.sideBar,v=u.isInDiffPage,g=u.isInDocPermPage,w=d.docPermType,j=d.collectionType,O=d.hasParentAddPerm,S=d.page.isFollow,P=d.perm,k=P.hasDeletePerm,x=P.hasEditPerm,C=P.hasAdmPerm,T=this.getParentAddPerm()||O,I=this.genCollectIcon(n),M=m.selectedKey&&-1!==m.selectedKey.indexOf("collect"),_=n&&j===ie.b.COMMON_DOC&&M,L=s.a.createElement("ul",{className:"more-list"},s.a.createElement("li",{key:"history",className:"more-ops-item",onClick:function(){e.handleClick("history")}},s.a.createElement(b.a,{className:"icon"})," \u6587\u6863\u5386\u53f2"),C&&s.a.createElement("li",{key:"export",className:"more-ops-item",onClick:function(){e.handleClick("export")}},s.a.createElement(h.a,{className:"icon"})," \u5bfc\u51fa\u6d4f\u89c8\u6570\u636e"),s.a.createElement("li",{key:"setTemplate",className:"more-ops-item",onClick:function(){e.handleClick("setTemplate")}},s.a.createElement(A,{className:"icon"})," \u8bbe\u7f6e\u4e3a\u4e2a\u4eba\u6a21\u677f"),(x||C)&&s.a.createElement("li",{key:"divding1",className:"more-ops-divding"}),(x||C)&&s.a.createElement("li",{className:"more-ops-item export",onClick:function(){e.handleClick("print")}},s.a.createElement(E,{className:"icon"}),"\u6253\u5370"),(x||C)&&!_&&s.a.createElement("li",{className:"more-ops-item",onClick:function(){e.handleClick("sort")}},s.a.createElement(D.a,{className:"icon"}),"\u6587\u6863\u6392\u5e8f"),k&&!_&&s.a.createElement("li",{className:"more-ops-item",onClick:function(){e.handleClick("move")}},s.a.createElement(W.a,{className:"icon"})," \u79fb\u52a8"),x&&T&&!_&&s.a.createElement("li",{key:"copy",className:"more-ops-item",onClick:function(){e.handleClick("copy")}},s.a.createElement(F.a,{className:"icon"})," \u590d\u5236"),k&&[s.a.createElement("li",{key:"divding2",className:"more-ops-divding"}),s.a.createElement("li",{key:"delete",className:"more-ops-item",onClick:function(){e.handleClick("delete")}},s.a.createElement(q.a,{className:"icon"})," \u5220\u9664")]);return s.a.createElement("div",{className:"doc-ops-bar"},v||g?s.a.createElement("div",{className:"doc-ops diff-ops"},s.a.createElement("span",{className:"ops-item back",onClick:this.toViewPage},"\u8fd4\u56de\u6d4f\u89c8")):s.a.createElement("div",{className:"doc-ops"},x&&s.a.createElement(i.a,{placement:"bottom",title:"\u7f16\u8f91",mouseEnterDelay:.6},s.a.createElement("button",{className:"ops-item ops-icon-wrapper",onClick:function(){Object(te.a)(ne.a["".concat(c,"-edit")]),e.props.onEdit()}},s.a.createElement(f.a,{className:"ops-icon"}))),s.a.createElement(i.a,{placement:"bottom",title:"\u6f14\u793a",mouseEnterDelay:.6},s.a.createElement("button",{className:"ops-item ops-icon-wrapper",onClick:function(){e.handleClick("demo")}},s.a.createElement(ee,{className:"ops-icon"}))),s.a.createElement(i.a,{mouseEnterDelay:.6,placement:"bottom",title:n?"\u53d6\u6d88\u6536\u85cf":"\u6536\u85cf",ref:function(t){e.collectTip=t}},s.a.createElement("button",{className:"ops-item ops-icon-wrapper",id:"doc-ops-bar-star-".concat(a),onClick:function(){Object(te.a)(ne.a["".concat(c,"-collect")]),e.handleCollect()}},s.a.createElement(I,{className:p()("collect-icon","ops-icon",{collect:n})}))),s.a.createElement(i.a,{mouseEnterDelay:.6,placement:"bottom",title:S?"\u53d6\u6d88\u5173\u6ce8":"\u5173\u6ce8",ref:function(t){e.followTip=t}},s.a.createElement("button",{className:"ops-item ops-icon-wrapper",id:"doc-ops-bar-star-".concat(a),onClick:function(){e.handleClick("follow")}},S?s.a.createElement(U.a,{className:"ops-icon"}):s.a.createElement(K.a,{className:"ops-icon"}))),s.a.createElement(i.a,{placement:"bottom",title:"\u6743\u9650\u7ba1\u7406",mouseEnterDelay:.6},s.a.createElement("button",{className:"ops-item ops-icon-wrapper",onClick:function(){Object(te.a)(ne.a["".concat(c,"-manage")]),r()}},function(e){switch(ae.g[e]){case ae.b:return s.a.createElement(z.a,{className:"inherit ops-icon"});case ae.a:return s.a.createElement(H,{className:"except ops-icon"});case ae.d:return s.a.createElement(N.a,{className:"lock ops-icon"});default:return s.a.createElement(z.a,{className:"inherit ops-icon"})}}(w))),s.a.createElement(o.a,{overlayClassName:"doc-ops-more",content:L,trigger:"click",placement:"bottomRight",onVisibleChange:function(t){e.setState({visible:t})},ref:function(t){e.docOpsRef=t}},s.a.createElement("button",{className:"ops-item ops-icon-wrapper"},s.a.createElement(y.a,{className:"ops-icon ellipsis"})))))}}])&&ue(n.prototype,r),a&&ue(n,a),t}())||$)||$},"../client/src/components/DocOps/style.styl":function(e,t,n){},"../client/src/components/DocPageLike/style.styl":function(e,t,n){},"../client/src/components/DocRecycled/index.jsx":function(e,t,n){"use strict";n("./core-js/modules/es6.promise.js"),n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.function.name.js"),n("./regenerator-runtime/runtime.js");var r=n("./react/index.js"),o=n.n(r),a=n("../client/src/assets/img/doc_recycled.png"),i=n.n(a),c=n("../client/src/components/Pop/PopNameCard/index.js"),s=n("../client/src/utils/request.js");n("../client/src/components/DocRecycled/style.styl");function l(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.a=function(e){var t=e.mis,n=e.isMobile,a=void 0!==n&&n,p=u(Object(r.useState)(null),2),f=p[0],d=p[1],m=Object(r.useCallback)(function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.c)("/api/users?mis=".concat(t,"&tenantId=1"));case 2:(n=e.sent)[t]&&d(n[t]);case 4:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),[t]);return Object(r.useEffect)(function(){m(t)},[]),f?o.a.createElement("div",{className:"doc-recycle-container"},o.a.createElement("img",{src:i.a}),o.a.createElement("p",{className:"title"},"\u6587\u6863\u5df2\u9501\u5b9a\uff0c\u5982\u9700\u67e5\u770b\u8bf7\u91cd\u65b0\u7533\u8bf7\u6743\u9650"),o.a.createElement("p",{className:"content"},"\u56e0\u6d89\u53ca\u654f\u611f\u5185\u5bb9\uff0c\u672c\u6587\u6863\u5df2\u6682\u65f6\u65e0\u6cd5\u8bbf\u95ee"),o.a.createElement("div",{className:"row"},o.a.createElement("p",{className:"content"},"\u5982\u9700\u89e3\u9501\uff0c\u8bf7\u54a8\u8be2\u516c\u53f8\u4e8b\u52a1\u5e73\u53f0\u5bf9\u63a5\u4eba",a?o.a.createElement("p",{className:"link"},"@".concat(f.name).concat(f.account)):""),a?null:o.a.createElement(c.a,{userInfo:f},o.a.createElement("p",{className:"name"},"@".concat(f.name).concat(f.account)))),o.a.createElement("p",{className:"content"},"\u6216\u901a\u8fc7\u90ae\u4ef6\u8054\u7cfb\u5b89\u5168\u59d4\u5458\u4f1a",o.a.createElement("span",null,"cap.aqfk@meituan.com"))):null}},"../client/src/components/DocRecycled/style.styl":function(e,t,n){},"../client/src/components/GuideToolTip/index.js":function(e,t,n){"use strict";n("../client/src/components/GuideToolTip/index.styl"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/popover/style/index.js");var r=n("./antd/lib/popover/index.js"),o=n.n(r),a=n("./react/index.js"),i=n.n(a),c=n("./classnames/index.js"),s=n.n(c),l=n("../client/src/components/GuideToolTip/ComponentMixin.js");function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=m(this,(e=h(t)).call.apply(e,[this].concat(o)))).timer=null,n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,l["a"]),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.props.children&&(this.props.mouseEnterDelay?this.timer=setTimeout(function(){e.updateVisible(e.getLocalStorageValue())},this.props.mouseEnterDelay):this.updateVisible(this.getLocalStorageValue()))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"render",value:function(){var e,t=s()((f(e={},this.props.className,!!this.props.className),f(e,"ct-guide-tooltip",!0),e));return i.a.createElement(o.a,p({},this.props,{visible:this.state.visible,overlayClassName:t,content:i.a.createElement("p",null,this.props.content,i.a.createElement("span",{className:"ct-icon-close",onClick:this.handleClose},"\u5173\u95ed"))}))}}])&&d(n.prototype,r),a&&d(n,a),t}();b.defaultProps={localStorageVersion:"1",placement:"top",title:"",localStorageKey:"",mouseEnterDelay:300},n.d(t,"a",function(){return b})},"../client/src/components/GuideToolTip/index.styl":function(e,t,n){},"../client/src/components/Modal/GuideModal/index.js":function(e,t,n){"use strict";n("../client/src/components/Modal/GuideModal/style.styl"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es7.object.get-own-property-descriptors.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.object.keys.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/modal/style/index.js");var r=n("./antd/lib/modal/index.js"),o=n.n(r),a=n("./react/index.js"),i=n.n(a),c=n("./prop-types/index.js"),s=n.n(c),l=n("./classnames/index.js"),u=n.n(l),p=(n("../client/src/components/CommonUI/Loading/index.js"),n("../client/src/components/GuideToolTip/ComponentMixin.js")),f=n("../client/src/assets/svg/guide-tip.svg"),d=(n("./core-js/modules/es6.regexp.to-string.js"),n("./antd/lib/button/style/index.js"),n("./antd/lib/button/index.js")),m=n.n(d),h=(n("./antd/lib/carousel/style/index.js"),n("./antd/lib/carousel/index.js")),y=n.n(h),b=n("./react-jss/dist/react-jss.esm.js");function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach(function(t){j(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O={display:"flex",flexDirection:"column",alignItems:"center"},S=Object(b.a)({guidCardContainer:w({},O),textArea:w({},O,{marginTop:"20px"}),mainText:{fontSize:"28px",lineHeight:"36px",height:"36px",marginBottom:"9px"},description:{fontSize:"13px",lineHeight:"22px",height:"22px"},btnArea:{display:"flex",justifyContent:"space-around",width:"188px",margin:"36px auto 28px","@global .ant-btn":{width:"88px",height:"32px"}}}),E=function(e){var t=e.items,n=e.onOk,r=v(Object(a.useState)(0),2),o=r[0],c=r[1],s=Object(a.useRef)(null),l=Object(a.useCallback)(function(){s.current.goTo(o+1),c(o+1)},[s,o]),u=Object(a.useCallback)(function(){s.current.goTo(o-1),c(o-1)},[s,o]),p=Object(a.useCallback)(function(e){c(e)},[o,s]),f=S(),d=1===t.length;return i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{draggable:!0,swipe:!0,ref:s,dots:!0,dotPosition:"bottom",afterChange:p},t.map(function(e,t){var n=e.image,r=e.mainText,o=e.description;return i.a.createElement("div",{className:f.guidCardContainer},i.a.createElement("img",{src:n,alt:"\u80cc\u666f\u56fe",width:"100%",height:"249px"}),i.a.createElement("div",{className:f.textArea},i.a.createElement("p",{className:f.mainText},r),i.a.createElement("p",{className:f.description},o)))})),i.a.createElement("div",{className:f.btnArea},d&&i.a.createElement(m.a,{type:"primary",onClick:n},"\u6211\u77e5\u9053\u4e86"),!d&&i.a.createElement(i.a.Fragment,null,0===o?i.a.createElement(m.a,{onClick:n},"\u8df3\u8fc7"):i.a.createElement(m.a,{onClick:u},"\u4e0a\u4e00\u4e2a"),o===t.length-1?i.a.createElement(m.a,{type:"primary",onClick:n},"\u5b8c\u6210"):i.a.createElement(m.a,{type:"primary",onClick:l},"\u4e0b\u4e00\u4e2a"))))};n("./core-js/modules/es6.object.assign.js");function P(e){return(P="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return!t||"object"!==P(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),C(this,T(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",k({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},this.props),i.a.createElement("defs",null,i.a.createElement("style",null)),i.a.createElement("path",{d:"M557.25 512l173.48 173.48-45.25 45.25L512 557.25 338.52 730.73l-45.25-45.25L466.75 512 293.27 338.52l45.25-45.25L512 466.75l173.48-173.48 45.25 45.25z",fill:"#ffffffde"}))}}])&&x(n.prototype,r),o&&x(n,o),t}();function D(e){return(D="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach(function(t){_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return!t||"object"!==D(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H={load:1,loading:2,error:3},z=function(e,t,n){return i.a.createElement("div",{className:"dot-container"},t.map(function(t,r){return i.a.createElement("i",{key:Math.random(),onClick:function(){return n(r)},className:u()({active:r===e})})}))},W=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=B(this,(e=R(t)).call.apply(e,[this].concat(o)))).state={activeIndex:0,loadingCache:{}},n.errorRetryTime=3,n.errorCounts={},n.renderFooter=function(e){var t=n.state.activeIndex,r=n.props,o=r.stepList,a=r.showIcon,c=void 0===a||a,s=r.tipIcon,l=void 0===s?i.a.createElement(f.a,null):s,u=r.renderBottomTip,p=void 0===u?function(){}:u,d=r.showDot,m=void 0!==d&&d;return i.a.createElement("div",{className:"guide-footer"},i.a.createElement("div",{className:"guide-tips"},i.a.createElement("h2",{className:"guide-title"},e.title),c&&i.a.createElement("span",{className:"guide-icon"},l),i.a.createElement("span",{className:"guide-text"},e.description)),m&&z(t,o,n.updateActiveIndex),i.a.createElement("div",{className:"btn-group"},i.a.createElement("button",{className:"ct-btn",onClick:n.handleClose},"\u8df3\u8fc7"),t>0&&i.a.createElement("button",{className:"ct-btn-primary",onClick:n.handlePrev},"\u4e0a\u4e00\u6b65"),t<o.length-1&&1!==o.length&&i.a.createElement("button",{className:"ct-btn-primary",onClick:n.handleNext},"\u4e0b\u4e00\u6b65"),t===o.length-1&&i.a.createElement("button",{className:"ct-btn-primary",onClick:n.handleClose},"\u786e\u5b9a")),p(t,o,n.handleClose))},n.handleNext=function(){var e=n.state.activeIndex+1;n.updateActiveIndex(e)},n.handlePrev=function(){n.updateActiveIndex(n.state.activeIndex-1)},n.updateActiveIndex=function(e){var t=n.state.loadingCache[e];t&&t!==H.error||n.loadImage(e);var r=n.props.onPageChange;n.setState({activeIndex:e},function(){r&&r(e,n.state.stepList)})},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,p["a"]),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;null!==this.props.delay?setTimeout(function(){e.updateVisible(e.getLocalStorageValue())},this.props.delay):this.updateVisible(this.getLocalStorageValue()),this.loadImage(0)}},{key:"loadImage",value:function(e){var t=this,n=document.createElement("img"),r=this.props.stepList[e];if(r){n.src=r.img;var o=e+1;this.state.loadingCache[e]!==H.loading&&(this.setState({loadingCache:M({},this.state.loadingCache,_({},e,H.loading))}),n.onload=function(){t.setState({loadingCache:M({},t.state.loadingCache,_({},e,H.load))}),t.state.activeIndex===e&&t.loadImage(o)},n.onerror=function(){var n=t.errorCounts;if(n[e]=n[e]||0,n[e]+=1,n[e]>t.errorRetryTime)return t.setState({loadingCache:M({},t.state.loadingCache,_({},e,H.error))}),null;t.loadImage(e)})}}},{key:"getActiveItem",value:function(){return this.props.stepList[this.state.activeIndex]||{}}},{key:"isShowLoading",value:function(){var e=this.state,t=e.activeIndex;return e.loadingCache[t]!==H.load}},{key:"render",value:function(){this.getActiveItem(),this.isShowLoading();var e=this.props,t=e.className,n=e.stepList,r=i.a.createElement(A,null);return i.a.createElement(o.a,{title:"",className:u()("ct-guide-modal",_({},t,t)),width:600,visible:this.state.visible,footer:null,maskClosable:!1,onCancel:this.handleClose,closeIcon:r},i.a.createElement(E,{items:n,onOk:this.handleClose}))}}])&&L(n.prototype,r),a&&L(n,a),t}();W.propTypes={stepList:s.a.arrayOf(s.a.any).isRequired,delay:s.a.number},W.defaultProps={delay:null,localStorageVersion:"1"},n.d(t,"a",function(){return W})},"../client/src/components/Modal/GuideModal/style.styl":function(e,t,n){},"../client/src/components/Modal/HistoryModal/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es7.object.get-own-property-descriptors.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.object.keys.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/table/style/index.js");var r=n("./antd/lib/table/index.js"),o=n.n(r),a=n("./react/index.js"),i=n.n(a),c=n("../client/src/components/UserName/index.js"),s=[{title:"\u7248\u672c",dataIndex:"versionFormatted",key:"version",width:70},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"modifyTimeFormatted",key:"modifyTime",width:150},{title:"\u66f4\u65b0\u4eba",dataIndex:"modifiername",key:"modifiername",width:120,render:function(e,t){var n=t.modifier;return i.a.createElement(c.b,{mis:n})}},{title:"\u66f4\u65b0\u5185\u5bb9",dataIndex:"whatUpdateFormatted",key:"whatUpdate",width:285}],l=n("../client/src/components/ui/detailTable/index.js"),u=n("../client/src/components/ui/popConfirm/index.js"),p=n("../client/src/utils/tools.js"),f=n("../client/src/components/ui/modal/index.js"),d=n("../client/src/stores/index.js"),m=n("../client/src/history.js");n("../client/src/components/Modal/HistoryModal/style.styl");function h(e){return(h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return!t||"object"!==h(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return E});var S=o.a.Column,E=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=w(this,j(t).call(this,e))).onCancel=function(){var e=n.props.onClose,t=n.state.dataSource.map(function(e){return e.showPop=!1,e});n.setState({dataSource:t},function(){e()})},n.toVersionPage=function(e){var t=n.props.sideBar.pageId;m.a.push("/diff/".concat(t,"?ver=").concat(e.version))},n.onChange=function(e){(0,n.props.onFetch)(e-1).then(function(e){return n.chunkData(e)}).then(function(e){return n.setState(b({},e))}).then(function(){return n.setState({curPage:e})}).catch(function(e){return console.error(e.message)})},n.action=function(){return i.a.createElement(S,{title:"\u64cd\u4f5c",key:"action",width:110,render:function(e,t){if(t.curVersion)return i.a.createElement("span",{className:"current-version-rect"},i.a.createElement("b",null,"\u5f53\u524d\u7248\u672c"));var r=d.b.doc,o=d.b.user,a=r.perm,c=a.hasEditPerm,s=a.hasAdmPerm,l=o.userInfo.account;return i.a.createElement("span",null,c&&i.a.createElement(u.a,{inTable:!0,title:"\u786e\u5b9a\u8fd8\u539f\u6b64\u7248\u672c\uff1f\u8fd8\u539f\u540e\u5c06\u6839\u636e\u7248\u672c\u5185\u5bb9\u65b0\u589e\u4e00\u4e2a\u7248\u672c\u3002",onConfirm:function(e){return n.recover(t,e)},type:"warning"},i.a.createElement("a",{className:"ct-recover-action"},"\u8fd8\u539f")),(s||l===t.modifier)&&i.a.createElement(u.a,{inTable:!0,title:"\u786e\u5b9a\u5220\u9664\u6b64\u7248\u672c?",type:"error",okType:"\u5220\u9664",onConfirm:function(e){return n.remove(t,e)}},i.a.createElement("a",null,"\u5220\u9664")))}})},n.state={dataSource:[],total:0,curPage:1,isLoading:!1},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.show,r=this.props.onFetch;n&&n!==this.props.show&&(this.setState({isLoading:!0,curPage:1}),r(0).then(function(e){return t.chunkData(e)}).then(function(e){return t.setState(b({},e,{isLoading:!1}))}).catch(function(e){return console.error(e.message)}))}},{key:"toggleRecoverPop",value:function(e){var t=this.state.dataSource.map(function(t){return t.key===e.key?t.showPop=!e.showPop:t.showPop=!1,t});this.setState({dataSource:t})}},{key:"hideRecoverPop",value:function(){var e=this.state.dataSource.map(function(e){return e.showPop=!1,e});this.setState({dataSource:e})}},{key:"recover",value:function(e,t){t.stopPropagation(),this.props.recover(e),this.toggleRecoverPop(e),this.props.onClose()}},{key:"remove",value:function(e,t){var n=this;t.stopPropagation(),this.hideRecoverPop(e);var r=this.state.curPage,o=this.props,a=o.onFetch,i=o.remove,c=this;i(e,function(){return n.setState({isLoading:!0})}).then(function(){return a(r-1)}).then(function(e){return c.chunkData(e)}).then(function(e){e.dataSource.length?c.setState(b({},e,{isLoading:!1})):c.onChange(r,10)}).catch(function(e){return console.error(e.message)})}},{key:"chunkData",value:function(e){var t=this.props,n=t.userInfos,r=t.checkUserInfo,o=e.total,a=e.models,i=void 0===a?[]:a;return r(i.map(function(e){return e.modifier})).then(function(){var e=i.map(function(e){return b({},e,{versionFormatted:"v".concat(e.version),modifyTimeFormatted:Object(p.g)(e.modifyTime,!0),whatUpdateFormatted:e.whatUpdate||"-",key:e.contentId,showPop:!1,curVersion:e.validVersion===e.contentId,modifiername:e.modifier,modifierInfo:n.get(e.modifier)})});return{total:o,dataSource:e}})}},{key:"render",value:function(){var e=this,t=this.props.show,n=this.state,r=n.total,o=n.dataSource,a=n.curPage,c=n.isLoading;return i.a.createElement(f.a,{type:"large",title:"\u6587\u6863\u5386\u53f2",visible:t,onCancel:this.onCancel,footer:null,className:"ct-history-version-modal"},i.a.createElement(l.a,{isLoading:c,title:s,dataSource:o,action:this.action,total:r,current:a,onPageChange:this.onChange,onRow:function(t){return{onClick:function(){return e.toVersionPage(t)}}}}))}}])&&g(n.prototype,r),o&&g(n,o),t}()},"../client/src/components/Modal/HistoryModal/style.styl":function(e,t,n){},"../client/src/components/Modal/SecretSettingModal/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./core-js/modules/es6.regexp.to-string.js");var r=n("./react/index.js"),o=n.n(r),a=n("./mobx-react/index.module.js"),i=n("../client/src/components/ui/modal/index.js");n("./core-js/modules/es6.object.assign.js");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d,m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,p(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",s({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15"},this.props),o.a.createElement("path",{d:"M420.86 596.7L782.9 234.66l90.52 90.51-437.46 437.47a21.33 21.33 0 0 1-30.17 0L149.33 506.2l90.52-90.52 181.01 181.03z",fill:"#FFF"}))}}])&&l(n.prototype,r),a&&l(n,a),t}(),h=n("../client/src/utils/tools.js"),y=n("../client/src/components/Toastr/index.js"),b=n("../client/src/utils/config.js"),v=n("../client/src/containers/ViewPage/index.js"),g=n("../client/src/utils/request.js"),w=n("../client/src/consts/index.js");n("../client/src/components/Modal/SecretSettingModal/style.styl");function j(e){return(j="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return k});var k=Object(a.inject)("store")(d=Object(a.observer)(d=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return r=this,a=(e=S(t)).call.apply(e,[this].concat(s)),(n=!a||"object"!==j(a)&&"function"!==typeof a?E(r):a).state={selectedSecret:3},n.onChangeSelectedSecret=function(e){n.setState({selectedSecret:e})},n.toManagePage=function(){n.props.store.doc.setManageVisible(!0)},n.secretConfirmModal=function(e){var t=e.onOk,n=e.selectedSecret,r=e.onCancel,o=e.content;return i.a.warning({title:"\u5bc6\u7ea7\u53d8\u66f4\u63d0\u9192",content:o||"\u662f\u5426\u5c06\u6240\u6709\u5b50\u6587\u6863\u5bc6\u7ea7\u7edf\u4e00\u8bbe\u7f6e\u4e3aC-".concat(n),onCancel:r,onOk:t})},n.updateSecretLevel=function(e){var t=n.props.store.doc,r=n.props.pageId;return t.getIsConfirmSecret(r).then(function(o){return o?n.setDocSecret(e).then(function(){var o=t.page,a=-1===o.parentId;n.hasChildren(o)?n.secretConfirmModal({selectedSecret:e,content:a?"\u662f\u5426\u5c06\u6240\u6709\u4e00\u7ea7\u5b50\u6587\u6863\u5bc6\u7ea7\u7edf\u4e00\u8bbe\u7f6e\u4e3aC-".concat(e):"",onOk:function(o){return t.setAllChildDocSecret(r,{secretLevel:e,contentId:r}).then(function(){o(),y.a.success("\u8bbe\u7f6e\u5b50\u6587\u6863\u5bc6\u7ea7\u6210\u529f"),n.hasAllPerm(r,e)}).catch(function(e){601===e.status?y.a.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bbe\u7f6e\u5b50\u6587\u6863\u5bc6\u7ea7\u5931\u8d25"):Object(h.t)(e)})},onCancel:function(){n.hasAllPerm(r,e)}}):n.hasAllPerm(r,e)}):Object(v.a)(t,r,e,n.setDocSecret)})},n.setDocSecret=function(e){var t=n.props.store.doc,r=n.props,o=r.pageId,a=r.onChange,i=r.handleCancel;return t.setSecretLevel(o,e).then(function(){a(e),y.a.success("\u5bc6\u7ea7\u8bbe\u7f6e\u6210\u529f"),i()})},n.handleOk=function(){var e=E(n).props,t=e.pageId,r=e.onChange,o=e.handleCancel,a=n.state.selectedSecret;if(!(e.hasEditPerm||e.store.doc.perm.hasEditPerm))return y.a.error("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u6ca1\u6709\u7f16\u8f91\u6587\u6863\u7684\u6743\u9650");t?n.updateSecretLevel(a).catch(function(e){601===e.status?y.a.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bbe\u7f6e\u6587\u6863\u5bc6\u7ea7\u5931\u8d25"):Object(h.t)(e)}):(r(a),o())},n.renderSecretItem=function(){var e=n.state.selectedSecret;return w.o.map(function(t){return o.a.createElement("div",{key:t.level,className:"secret-item-outter ".concat(e===t.level?"active-level":""," "),onClick:function(){n.onChangeSelectedSecret(t.level)}},o.a.createElement("div",{className:"secret-item secret-level-".concat(t.level)},o.a.createElement("p",{className:"level"},"C-".concat(t.level)),o.a.createElement("p",{className:"level-name"},t.levelText),e===t.level?o.a.createElement("div",{className:"check-secret-rect"},o.a.createElement(m,{className:"check-secret-level"})):null),o.a.createElement("div",{className:"explanation",dangerouslySetInnerHTML:{__html:t.explanation}}))})},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props,r=n.spaceId,o=n.currentSecretLevel;e.visible&&!this.props.visible&&r&&(o?this.onChangeSelectedSecret(o):this.props.store.doc.getDefaultSecretLevel(r).then(function(e){return t.onChangeSelectedSecret(e)}).catch(function(e){return console.error(e.message)}))}},{key:"hasAllPerm",value:function(e,t){var n=this;4===t&&Object(g.c)("/api/perm/judge/hasmtperm/".concat(e)).then(function(e){e&&i.a.warning({title:"\u786e\u5b9a\u53d8\u66f4\u6587\u6863\u5bc6\u7ea7?",content:"\u5f53\u524d\u6587\u6863\u5bc6\u7ea7\u4e3aC4\uff0c\u4f46\u8be5\u6587\u6863\u516c\u53f8\u6240\u6709\u4eba\u53ef\u89c1\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u9700\u8981\u53d8\u66f4\u6743\u9650",onOk:function(e){e(),n.toManagePage()}})}).catch(function(e){throw new Error(e)})}},{key:"hasChildren",value:function(e){var t=-1===e.parentId,n=this.props.store,r=n.sideBar,o=n.user;return t?e.spaceId.toString()===o.spaceId.toString()?r.getDataByKey("/space").children:r.getDataByKey(e.spaceId.toString()).children:e.childCount}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.handleCancel;return o.a.createElement(i.a,{title:"\u5b89\u5168\u5bc6\u7ea7",wrapClassName:"ct-modal ct-secret-modal",visible:t,onCancel:n,onOk:this.handleOk},o.a.createElement("p",{className:"title"},"\u6839\u636e\u516c\u53f8",o.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:b.a.secretDocUrl},"\u6570\u636e\u5b89\u5168\u7ba1\u7406\u89c4\u5b9a"),"\u7684\u8981\u6c42\uff0c\u5b66\u57ce\u5185\u65b0\u5efa\u6587\u6863\u5747\u9700\u8981\u6807\u8bc6\u5bc6\u7ea7\u3002"),o.a.createElement("p",{className:"sub-title"},"\u8bf7\u9009\u62e9\u672c\u6587\u6863\u5bc6\u7ea7\uff0c\u5177\u4f53\u7ea7\u522b\u8981\u6c42\u5982\u4e0b:"),o.a.createElement("div",{className:"secret-level"},this.renderSecretItem()))}}])&&O(n.prototype,r),a&&O(n,a),t}())||d)||d},"../client/src/components/Modal/SecretSettingModal/style.styl":function(e,t,n){},"../client/src/components/Modal/SelectTemplateModal/style.styl":function(e,t,n){},"../client/src/components/Notification/index.js":function(e,t,n){"use strict";n("./antd/lib/notification/style/index.js");var r=n("./antd/lib/notification/index.js"),o=n.n(r),a=n("../client/src/components/ui/notification/index.js");n("./antd/lib/button/style/index.js");var i=n("./antd/lib/button/index.js"),c=n.n(i),s=n("./react/index.js"),l=n.n(s);n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,m(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,l.a.Component),n=t,(r=[{key:"render",value:function(){return l.a.createElement("svg",p({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),l.a.createElement("defs",null,l.a.createElement("style",null)),l.a.createElement("path",{d:"M0 512a512 512 0 1 1 1024 0A512 512 0 0 1 0 512zm96 0a416 416 0 1 0 832 0 416 416 0 0 0-832 0zm416-339.2c42.43 0 76.8 34.82 76.8 76.54v309.57a76.52 76.52 0 0 1-76.8 76.55c-42.43 0-76.8-34.76-76.8-76.55V249.34A76.52 76.52 0 0 1 512 172.8zm0 678.4a76.8 76.8 0 1 1 0-153.6 76.8 76.8 0 0 1 0 153.6z",fill:"#FDC446"}))}}])&&f(n.prototype,r),o&&f(n,o),t}(),b=n("../client/src/utils/config.js");n("../client/src/components/Notification/style.styl");var v={draft:function(e,t,n,r){return a.a.close(e),a.a.info({message:"\u63d0\u793a",description:"\u60a8\u5728\u5176\u4ed6\u5730\u65b9\u7f16\u8f91\u4e86\u6b64\u6587\u6863,\u53ef\u4ee5\u7ee7\u7eed\u7f16\u8f91\u3002\u5982\u65e0\u9700\u4fdd\u5b58\u5185\u5bb9,\u53ef\u4ee5\u9000\u51fa\u7f16\u8f91\u3002",duration:null,onCancel:function(){n(),a.a.close(e)},onOk:function(){r(),a.a.close(e)},okText:"\u7ee7\u7eed\u7f16\u8f91",cancelText:"\u9000\u51fa\u7f16\u8f91",key:e}),a.a},expired:function(e,t){return o.a.close(e),o.a.open({icon:l.a.createElement(y,null),message:"\u767b\u5f55\u4fe1\u606f\u5931\u6548",description:"\u8bf7\u653e\u5fc3\uff0c\u60a8\u7684\u6570\u636e\u8fd8\u5728~~\u8bf7\u653e\u5fc3\u70b9\u51fb\u767b\u5f55\uff0c\u5728\u65b0\u6807\u7b7e\u9875\u91cd\u65b0\u767b\u5f55\u540e\uff0c\u672c\u5f39\u7a97\u5c06\u81ea\u52a8\u5173\u95ed\uff0c\u60a8\u53ef\u7ee7\u7eed\u7f16\u8f91/\u4fdd\u5b58\u5185\u5bb9\u3002",duration:null,btn:l.a.createElement(c.a,{onClick:function(){var e=window.open("".concat(window.location.origin).concat(b.a.primaryPath,"/login"));t(e.close.bind(e))}},"\u767b\u5f55"),key:e}),o.a},operator:function(e,t){return a.a.close(e),a.a.success({title:"\u591a\u4eba\u7f16\u8f91\u63d0\u793a",description:"".concat(t.join("\u3001"),"\u6b63\u5728\u5171\u540c\u7f16\u8f91\u6b64\u6587\u6863\u3002\u4e3a\u51cf\u5c11\u5185\u5bb9\u88ab\u4ed6\u4eba\u8986\u76d6\u7684\u98ce\u9669\uff0c\u5efa\u8bae\u5728\u5176\u4ed6\u6587\u6863\u4e2d\u7f16\u8f91\u597d\u540e\u518d\u590d\u5236\u8fdb\u6765\u3002"),duration:null,key:e,okText:"\u6211\u77e5\u9053\u4e86",okButtonProps:{type:"default"}}),a.a},close:o.a.close.bind(o.a)};t.a=v},"../client/src/components/Notification/style.styl":function(e,t,n){},"../client/src/components/QuickStart/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r),a=n("./mobx-react/index.module.js"),i=(n("./antd/lib/button/style/index.js"),n("./antd/lib/button/index.js")),c=n.n(i),s=(n("./core-js/modules/es6.promise.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.string.iterator.js"),n("./moment/moment.js")),l=n.n(s),u=n("../client/src/components/ui/modal/index.js"),p=n("../client/src/components/Toastr/index.js"),f=n("../client/src/consts/index.js"),d=n("../client/src/components/CommonUI/Loading/index.js"),m=n("../client/src/assets/img/deleted.png"),h=n.n(m),y=n("./lodash.throttle/index.js"),b=n.n(y),v=n("../client/src/utils/safe.js"),g=n("../client/src/events/index.js"),w=n("../client/src/events/type.js"),j=n("../client/src/containers/ViewPage/PluginsToView/tableToView.js"),O=n("../client/src/containers/ViewPage/PluginsToView/imgToView.js"),S=n("../client/src/containers/ViewPage/PluginsToView/plantumlToView.js"),E=n("../client/src/containers/ViewPage/PluginsToView/lazyload.js"),P=n("../client/src/containers/ViewPage/PluginsToView/mentionToView.js"),k=n("../client/src/stores/index.js"),x=n("../client/src/editor/toView.js");function C(e){return(C="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return!t||"object"!==C(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var N,M=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=I(this,A(t).call(this,e))).handleScrollListen=b()(function(){return Object(E.a)(document.querySelector(".ct-template-preview"))},100),n.setDestroyEvents=function(e){n.destroyEvents.push(e)},n.setBody=function(){var e=document.getElementById("template-body-wrapper");if(e){e.innerHTML=Object(v.a)(n.body);try{!function(e){var t=e.container,n=void 0===t?"template-body-wrapper":t,r=e.lazyload,o=void 0!==r&&r,a=e.setDestroyEvents,i=void 0===a?function(){}:a,c=e.contentId,s=void 0===c?null:c,l=e.isTemplate,u=void 0===l||l,p=document.getElementById(n),f=p.cloneNode(!0);k.b.doc.catalogInfo=Object(x.catalogToView)({bodyWrapper:f}),Object(x.statusToView)({bodyWrapper:f}),Object(j.tableToView)({cloneWrapper:f,originWrapper:p,theadFixed:!0}),Object(O.default)({cloneWrapper:f,originWrapper:p,lazyload:o}),Object(S.a)({cloneWrapper:f,originWrapper:p,lazyload:o}),Object(x.attachmentToView)({bodyWrapper:f,isTemplate:u}),Object(x.noteToView)({bodyWrapper:f}),Object(x.audioToView)(f,u),Object(x.videoToView)(f,u),Object(x.collapseToView)({bodyWrapper:f}),Object(x.linkToView)({bodyWrapper:f,rootStore:k.b}),Object(x.calendarToView)({pmBodyWrapper:f,setDestroyEvents:i,isMobile:!1,contentId:s}),Object(x.ganttToView)({pmBodyWrapper:f,setDestroyEvents:i,isMobile:!1,contentId:s}),Object(x.htmlToView)({bodyWrapper:f}),Object(x.notSupportToView)(f),Object(x.includeToView)(f),Object(x.pageTreeToView)({pmBodyWrapper:f,isMobile:!1}),Object(P.a)(f),Object(x.timeToView)(f),Object(x.spaceUpdateToView)(f),Object(x.data2chartToView)({bodyWrapper:f,isMobile:!1,contentId:s}),p.parentNode.replaceChild(f,p),Object(E.a)(document.querySelector(".ct-template-preview")),Object(x.codeToView)({bodyWrapper:f})}({lazyload:!0,setDestroyEvents:n.setDestroyEvents,contentId:n.props.templateId})}catch(t){console.error(t)}}},n.lastBody=null,n.body=e.body,n.destroyEvents=[],n}var n,a,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,r["Component"]),n=t,(a=[{key:"componentWillReceiveProps",value:function(e){this.lastBody=this.props.body,this.body=e.body}},{key:"componentDidMount",value:function(){document.querySelector(".ct-template-preview")&&(g.a.on(w.o,this.handleScrollListen),this.body&&this.setBody())}},{key:"shouldComponentUpdate",value:function(e){return e.body!==this.props.body}},{key:"componentDidUpdate",value:function(){this.body&&this.body!==this.lastBody&&this.setBody()}},{key:"componentWillUnmount",value:function(){this.destroyAllEventsInToView()}},{key:"destroyAllEventsInToView",value:function(){this.destroyEvents.forEach(function(e){"function"===typeof e&&e()})}},{key:"render",value:function(){return o.a.createElement("div",{id:"template-body-wrapper",className:"pm-body-wrapper template-body-wrapper"})}}])&&T(n.prototype,a),i&&T(n,i),t}();n("../client/src/components/TemplatePreview/style.styl");function _(e){return(_="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return!t||"object"!==_(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H,z,W,F=f.t.PENDING,U=f.t.DONE,K=f.t.ERROR,q=Object(a.inject)("store")(N=Object(a.observer)(N=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=B(this,(e=R(t)).call.apply(e,[this].concat(o)))).loadTemplate=function(){var e=n.props.store.template,t=e.currentTemplateContent;e.updateLoadTemplateState(F),e.getTemplateDetail(t.templateId).then(function(t){e.updateLoadTemplateState(U),e.updateCurrentTemplateContent(t)}).catch(function(t){637!==t.status?e.updateLoadTemplateState(K):e.updateLoadTemplateState("DELETED")})},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.store.template,n=t.currentTemplateContent,r=t.opsState.loadTemplateState;if(!n.templateId)return o.a.createElement("div",{className:"ct-template-preview"},o.a.createElement("div",{className:"no-template"},"\u8bf7\u9009\u62e9\u6a21\u677f"));if(r===F)return o.a.createElement("div",{className:"ct-template-preview"},o.a.createElement(d.a,null));if("DELETED"===r)return o.a.createElement("div",{className:"ct-page-content"},o.a.createElement("div",{className:"ct-notfound"},o.a.createElement("img",{src:h.a,alt:"deleted"}),o.a.createElement("div",{className:"text"},"\u5f53\u524d\u6a21\u677f\u5df2\u88ab\u5220\u9664")));if(r===K)return o.a.createElement("div",{className:"ct-template-preview"},o.a.createElement("div",{className:"ct-network-error"},o.a.createElement("div",{className:"network-error-img"}),o.a.createElement("div",{className:"text"},"\u52a0\u8f7d\u5931\u8d25\u8bf7\u91cd\u8bd5"),o.a.createElement(c.a,{className:"ct-btn-primary reload-btn",onClick:function(){e.loadTemplate(e.props)},style:{width:"auto"}},"\u91cd\u65b0\u52a0\u8f7d")));if(!n)return null;var a=n.titleAddNumber,i=n.title,s=n.templateBody,l=n.type,u=n.templateId;return o.a.createElement("div",{className:"ct-template-preview"},o.a.createElement("div",{className:"document-editor"},o.a.createElement("div",{className:"tmp-title"},l===f.u.USER?a:i),o.a.createElement(M,{body:s,templateId:u})))}}])&&L(n.prototype,r),a&&L(n,a),t}())||N)||N,G=n("../client/src/history.js"),Q=(n("./antd/lib/tooltip/style/index.js"),n("./antd/lib/tooltip/index.js")),X=n.n(Q),Y=n("../client/src/assets/svg/triangle-right.svg"),J=n("../client/src/assets/svg/triangle-down.svg"),Z=n("../client/src/assets/svg/dot.svg");function $(e){return($="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t){return!t||"object"!==$(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oe,ae,ie,ce=f.t.PENDING,se=f.t.ERROR,le=Object(a.inject)("store")(H=Object(a.observer)((W=z=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=te(this,(e=ne(t)).call.apply(e,[this].concat(a)))).state={selectTemplateId:null},n.handleTogger=function(e){e.status="fold"===e.status?"expand":"fold"},n.handleRowClick=function(e,t){n.props.store.template.updateCurrentTemplateIdAndType(e,t),n.props.loadTemplate(e)},n.noTempalteTip=function(e){var t=n.props.store,r=t.user,a=t.doc;if("mytemplate"===e)return o.a.createElement("p",{className:"no-template-tip"},"\u6682\u65e0\u6a21\u677f"," ",o.a.createElement("a",{onClick:function(){window.open("/template","_blank")}},"\u524d\u5f80\u521b\u5efa"));if("spacetemplate"===e){var i=n.props.spaceId;return o.a.createElement("p",{className:"no-template-tip"},"\u6682\u65e0\u6a21\u677f"," ",a.isSpaceAdmin&&o.a.createElement("a",{onClick:function(){window.open("/manage/space/".concat(i,"?type=template"),"_blank")}},"\u524d\u5f80\u521b\u5efa"))}return"systemtemplate"===e?o.a.createElement("p",{className:"no-template-tip"},"\u6682\u65e0\u6a21\u677f"," ",r.hasRootPerm&&o.a.createElement("a",{onClick:function(){window.open("/admin?type=template","_blank")}},"\u524d\u5f80\u521b\u5efa")):void 0},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.store.template,n=t.templateTreeData,r=t.opsState,a=t.currentTemplateContent;if(r.loadTemplateTreeState===ce)return o.a.createElement("ul",{className:"template-tree"},o.a.createElement(d.a,null));if(r.loadTemplateTreeState===se)return o.a.createElement("ul",{className:"template-tree"},o.a.createElement("div",{className:"tree-error"},o.a.createElement("p",null,"\u6a21\u677f\u5217\u8868\u52a0\u8f7d\u5931\u8d25"),o.a.createElement(c.a,{className:"ct-btn-primary reload-btn",onClick:this.props.loadTemplateTree},"\u91cd\u65b0\u52a0\u8f7d")));var i=a.templateId;return o.a.createElement("ul",{className:"template-tree"},n.map(function(t){return o.a.createElement("li",{className:"group",key:t.key},o.a.createElement("div",{className:"item",onClick:function(){e.handleTogger(t)}},o.a.createElement("div",{className:"icon-wrapper"},"fold"===t.status?o.a.createElement(Y.a,{className:"trigger-icon"}):o.a.createElement(J.a,{className:"trigger-icon"})),o.a.createElement("span",{className:"title"},t.text)),"expand"===t.status&&o.a.createElement("ul",{className:"item-list"},(t.children||[]).map(function(t){var n=t.templateId,r=t.titleAddNumber,a=t.title,c=t.type,s=c===f.u.USER?r:a;return o.a.createElement(X.a,{placement:"right",title:s,key:n},o.a.createElement("li",{className:"item child ".concat(n===i?"active":""),onClick:function(){e.handleRowClick(n,c)}},o.a.createElement("div",{className:"icon-wrapper"},o.a.createElement(Z.a,{className:"doc-icon"})),o.a.createElement("span",{className:"title"},s)))}),(!t.children||!(t.children&&t.children.length))&&e.noTempalteTip(t.key)))}))}}])&&ee(n.prototype,r),a&&ee(n,a),t}(),z.defaultProps={visible:!0},H=W))||H)||H;n("../client/src/components/Modal/SelectTemplateModal/style.styl");function ue(e){return(ue="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t){return!t||"object"!==ue(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var he,ye=f.t.PENDING,be=f.t.DONE,ve=f.t.ERROR,ge=Object(a.inject)("store")(oe=Object(a.observer)((ie=ae=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=fe(this,(e=de(t)).call.apply(e,[this].concat(a)))).resetData=function(){var e=n.props.store.template;e.resetTemplateTree(),e.updateCurrentTemplateContent({}),e.updateCurrentTemplateIdAndType(null,null)},n.setTemplateTree=function(){var e=n.props.store,t=e.template,r=e.doc,o=n.props.spaceId;r.perm.hasEditPerm=!0,t.updateLoadTemplateTreeState(ye),Promise.all([t.getTemplateListForTree(f.u.USER),t.getTemplateListForTree(f.u.SPACE,o),t.getTemplateListForTree(f.u.SYSTEM)]).then(function(){t.sortTemplateTree(),n.handleSelectFirst(),n.loadTemplate(),t.updateLoadTemplateTreeState(be)}).catch(function(e){console.error("err",e),t.updateLoadTemplateTreeState(ve)})},n.loadTemplate=function(e){var t=n.props.store.template,r=t.currentTemplateContent;t.updateLoadTemplateState(ye);var o=e||r.templateId;t.getTemplateDetail(o).then(function(e){t.updateLoadTemplateState(be),t.updateCurrentTemplateContent(e)}).catch(function(e){637!==e.status?t.updateLoadTemplateState(ve):t.updateLoadTemplateState("DELETED")})},n.handleSelectFirst=function(){var e=n.props.store.template,t={user:0,space:0,system:0};if(e.templateTreeData.filter(function(e){return e}).forEach(function(e){"mytemplate"===e.key?t.user=e.children&&e.children.length:"spacetemplate"===e.key?t.space=e.children&&e.children.length:t.system=e.children&&e.children.length}),t.user||t.space||t.system){var r=e.templateTreeData[0],o=r.children&&r.children[0],a=o.templateId,i=o.templateType;n.handleTemplateChange(a,i),e.templateTreeData[0].status="expand",e.templateTreeData[1].status="fold",e.templateTreeData[2].status="fold"}else e.templateTreeData[0].status="fold",e.templateTreeData[1].status="fold",e.templateTreeData[2].status="fold"},n.handleTemplateChange=function(e,t){n.props.store.template.updateCurrentTemplateIdAndType(e,t)},n.supplyTitle=function(e){if("\u5468\u62a5"===e.substr(-2)){var t=l()().startOf("week").format("MM.DD"),n=l()().endOf("week").format("MM.DD");e+="(".concat(t,"~").concat(n,")")}return e},n.handleApply=function(){var e=n.props.store.template.currentTemplateContent,t=e.title,r=e.titleAddNumber,o=e.templateBody,a=e.type===f.u.USER?r:t;n.props.applyTemplate(n.supplyTitle(a),o),n.props.hideQuickStart()},n.handleManage=function(e,t){var r=n.props.store.template,o=n.props.spaceId;r.getTemplateDetail(e).catch(function(e){637===e.status&&p.a.error("\u8be5\u6a21\u677f\u5df2\u88ab\u5220\u9664")}),t===f.u.USER?G.a.push("/template"):t===f.u.SYSTEM?G.a.push("/admin?type=template"):G.a.push("/manage/space/".concat(o,"?type=template"))},n.footerButton=function(e,t){var r=[],a=n.props.store,i=a.user,s=a.doc;return e&&r.push(o.a.createElement(c.a,{key:"apply",onClick:n.handleApply,type:"primary"},"\u786e\u5b9a")),(i.hasRootPerm||t===f.u.USER||t===f.u.SPACE&&s.isSpaceAdmin)&&r.unshift(o.a.createElement(c.a,{key:"manage",onClick:function(){n.handleManage(e,t)}},"\u7ba1\u7406")),r},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillMount",value:function(){this.setTemplateTree()}},{key:"componentWillReceiveProps",value:function(e){e.visible&&this.setTemplateTree()}},{key:"componentWillUnmount",value:function(){this.resetData()}},{key:"render",value:function(){var e=this.props,t=e.visible,n=e.spaceId,r=this.props.store.template.currentTemplateContent,a=r.templateId,i=r.type,s=o.a.createElement("div",{className:"modal-footer"},o.a.createElement("div",{className:"btn-wrapper"},o.a.createElement(c.a,{onClick:this.props.hideSelectTemplate},"\u53d6\u6d88"),this.footerButton(a,i)));return o.a.createElement(u.a,{type:"super",title:"\u6587\u6863\u6a21\u677f",className:"ct-select-template-modal",visible:t,footer:s,onCancel:this.props.hideSelectTemplate,maskClosable:!1},o.a.createElement("div",{className:"template-wrapper"},o.a.createElement(le,{loadTemplateTree:this.setTemplateTree,loadTemplate:this.loadTemplate,spaceId:n}),o.a.createElement(q,null)))}}])&&pe(n.prototype,r),a&&pe(n,a),t}(),ae.defaultProps={visible:!0},oe=ie))||oe)||oe,we=n("../client/src/assets/img/create-from-catalog.png"),je=n.n(we),Oe=n("../client/src/assets/img/create-from-template.png"),Se=n.n(Oe);n("../client/src/components/QuickStart/style.styl");function Ee(e){return(Ee="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t){return!t||"object"!==Ee(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return Te});var Te=Object(a.inject)("store")(he=Object(a.observer)(he=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=ke(this,(e=xe(t)).call.apply(e,[this].concat(o)))).state={selectTemplateModalVisible:!1},n.showSelectTemplate=function(e){e.stopPropagation(),n.setState({selectTemplateModalVisible:!0})},n.hideSelectTemplate=function(){n.setState({selectTemplateModalVisible:!1})},n.handleHideQuickStart=function(e){e.target.closest(".ct-modal")||n.props.hideQuickStart()},n.handleCreateCatalogTree=function(){var e=n.props.store.doc,t=n.props.currentPageId||e.newContentId,r='<div class="ct-page-tree" data-time="'.concat(new Date,'" data-space-id="" data-page-id="').concat(t,'" data-max-depth="0" contenteditable="false"></div>');n.props.applyTemplate("",r),n.props.hideQuickStart()},n}var n,a,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.spaceId,n=e.applyTemplate,r=e.hideQuickStart,a=this.state.selectTemplateModalVisible;return o.a.createElement("div",{className:"create-page-from-template",onClick:this.props.editorFocus},o.a.createElement("div",{className:"tip"},"\u5728\u6b64\u5904\u8f93\u5165\u5185\u5bb9\u65b0\u5efa\u6587\u6863"),o.a.createElement("div",{className:"quick-start"},o.a.createElement("div",{className:"item",onClick:this.showSelectTemplate},o.a.createElement("div",{className:"img-wrapper"},o.a.createElement("img",{src:Se.a,alt:""})),o.a.createElement("p",{className:"title"},"\u4ece\u6a21\u677f\u521b\u5efa")),o.a.createElement("div",{className:"item"},o.a.createElement("div",{className:"img-wrapper",onClick:this.handleCreateCatalogTree},o.a.createElement("img",{src:je.a,alt:""})),o.a.createElement("p",{className:"title"},"\u521b\u5efa\u76ee\u5f55\u6587\u6863"))),o.a.createElement(ge,{visible:a,hideSelectTemplate:this.hideSelectTemplate,hideQuickStart:r,applyTemplate:n,spaceId:t}))}}])&&Pe(n.prototype,a),i&&Pe(n,i),t}())||he)||he},"../client/src/components/QuickStart/style.styl":function(e,t,n){},"../client/src/components/SecretTag/index.js":function(e,t,n){"use strict";n("./antd/lib/tooltip/style/index.js");var r=n("./antd/lib/tooltip/index.js"),o=n.n(r),a=(n("./core-js/modules/es6.array.find.js"),n("./react/index.js")),i=n.n(a),c=n("../client/src/consts/index.js");n("../client/src/components/SecretTag/style.styl");t.a=function(e){var t=e.level,n=e.hasEditPerm,r=e.showSecretSetting,a=e.isDocDeleted;return t?i.a.createElement(o.a,{placement:a?"topLeft":"top",arrowPointAtCenter:!0,title:c.o.find(function(e){return e.level===+t}).definition},i.a.createElement("span",{onClick:r,className:"secret-tag secret-level-".concat(t)},"C-".concat(t))):n?i.a.createElement(o.a,{placement:a?"topLeft":"top",title:"\u5bc6\u7ea7\u672a\u8bbe\u7f6e",arrowPointAtCenter:!0},i.a.createElement("span",{onClick:r,className:"secret-tag secret-no-level"},"\u672a\u8bbe\u5bc6\u7ea7")):null}},"../client/src/components/SecretTag/style.styl":function(e,t,n){},"../client/src/components/Select/SearchMultiSelect/style.styl":function(e,t,n){},"../client/src/components/Select/utils/index.js":function(e,t,n){"use strict";n.d(t,"a",function(){return r});n("./core-js/modules/es6.array.find-index.js");var r=function(e,t){var n=t.key,r=t.item,o=t.type,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,c=e.findIndex(function(e){return e.key===n});if("clear"===o)e[c].selectedItems=[];else{var s=e[c].selectedItems.some(function(t,n){return"".concat(t.key)==="".concat(r.key)&&(e[c].selectedItems.splice(n,1),!0)});if(!s){if(a.some(function(e){return"".concat(e)==="".concat(r.key)}))return i&&i(r),null;e[c].selectedItems.push(r),e[c].isEmpty=!1}}return e}},"../client/src/components/TemplatePreview/style.styl":function(e,t,n){},"../client/src/components/ui/detailTable/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/tooltip/style/index.js");var r=n("./antd/lib/tooltip/index.js"),o=n.n(r),a=(n("./antd/lib/table/style/index.js"),n("./antd/lib/table/index.js")),i=n.n(a),c=n("./react/index.js"),s=n.n(c),l=n("./classnames/index.js"),u=n.n(l),p=n("../client/src/components/CommonUI/Loading/index.js");n("../client/src/components/ui/detailTable/index.styl");function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=i.a.Column,g=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=h(this,(e=y(t)).call.apply(e,[this].concat(o)))).handleSelect=function(e,t){(0,n.props.onSelect)(e,t)},n.handleSelectAll=function(e,t){(0,n.props.onSelectAll)(e,t)},n.onChange=function(e,t,r){(0,n.props.onSorterChange)(r.order)},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.title,n=e.dataSource,r=e.selectedRowKeys,a=e.rowKey,c=e.checkable,l=e.scroll,f=e.size,m=e.pagination,h=e.action,y=e.isLoading,b=e.disabledKey,g=e.emptyText,w=e.bordered,j=e.onRow,O=void 0===j?function(){}:j,S=t.map(function(e,t){return s.a.createElement(v,d({},e,{key:t,render:function(t,n,r){return e.render?e.render(t,n,r):e.popover?s.a.createElement(o.a,{title:"prompt text"},t):s.a.createElement("span",null,t)},title:e.title}))}),E={onSelect:this.handleSelect,selectedRowKeys:r,onSelectAll:this.handleSelectAll,getCheckboxProps:function(e){return{disabled:!!b&&e[b]}}};return s.a.createElement("div",{className:u()("ct-detail-table","ct-detail-table-".concat(f))},s.a.createElement(i.a,{onRow:O,size:f,scroll:l,rowKey:a,bordered:w,dataSource:n,loading:{spinning:y,indicator:s.a.createElement("div",{className:"ct-detail-table-loading"},s.a.createElement(p.a,null))},locale:{emptyText:g||"\u6682\u65e0\u6570\u636e"},rowSelection:c?E:null,pagination:m||this.defaultPagination,onChange:this.onChange},S,h?h():null))}},{key:"defaultPagination",get:function(){var e=this.props,t=e.total,n=e.onPageChange,r=e.current;return t>10&&{pageSize:10,total:t,onChange:n,current:r,size:"default"}}}])&&m(n.prototype,r),a&&m(n,a),t}();g.defaultProps={selectedRowKeys:[],rowKey:"id",pageSize:10,current:1,total:0,size:"middle",action:null,isLoading:!1,checkable:!1,disabledKey:"",emptyText:null,bordered:!1,scroll:{},onSorterChange:function(){}},t.a=g},"../client/src/components/ui/detailTable/index.styl":function(e,t,n){},"../client/src/components/ui/notification/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.object.get-own-property-descriptors.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.object.keys.js"),n("./antd/lib/button/style/index.js");var r=n("./antd/lib/button/index.js"),o=n.n(r),a=(n("./antd/lib/notification/style/index.js"),n("./antd/lib/notification/index.js")),i=n.n(a),c=(n("./core-js/modules/web.dom.iterable.js"),n("./react/index.js")),s=n.n(c);n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,d(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",u({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},this.props),s.a.createElement("path",{d:"M813.7 813.7c-166.62 166.6-436.78 166.6-603.4 0-166.6-166.62-166.6-436.78 0-603.4 166.62-166.6 436.78-166.6 603.4 0 166.6 166.62 166.6 436.78 0 603.4zM458.35 567.62L337.66 446.93l-60.33 60.33 181.02 181.02 286.61-286.62-60.33-60.33-226.28 226.29z",fill:"#24BD78"}))}}])&&p(n.prototype,r),o&&p(n,o),t}();function y(e){return(y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return!t||"object"!==y(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),g(this,w(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",b({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},this.props),s.a.createElement("path",{d:"M512 938.67C276.35 938.67 85.33 747.65 85.33 512S276.35 85.33 512 85.33 938.67 276.35 938.67 512 747.65 938.67 512 938.67zm-42.67-277.34v85.34h85.34v-85.34h-85.34zm0-384v320h85.34v-320h-85.34z",fill:"#1C6CDC"}))}}])&&v(n.prototype,r),o&&v(n,o),t}(),S=[{type:"success",icon:s.a.createElement(h,null)},{type:"info",icon:s.a.createElement(O,null)}],E=n("../client/src/assets/svg/close-icon.svg");n("../client/src/components/ui/notification/index.styl");function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}S.forEach(function(e){i.a[e.type]=function(t){var n=t.title,r=void 0===n?"":n,a=t.message,c=void 0===a?"":a,l=t.onOk,u=t.onCancel,p=t.okText,f=void 0===p?"\u786e\u5b9a":p,d=t.cancelText,m=void 0===d?"\u53d6\u6d88":d,h=t.okButtonProps,y=void 0===h?{type:"primary"}:h,b=t.description,v=t.key,g=C(t,["title","message","onOk","onCancel","okText","cancelText","okButtonProps","description","key"]),w=function(){i.a.close(v)},j=e.icon,O=e.type,S=[s.a.createElement(o.a,{size:"small",onClick:u||w},m),s.a.createElement(o.a,x({},y,{onClick:l||w,size:"small"}),f)],T=[s.a.createElement(o.a,x({},y,{size:"small",onClick:l||w}),f)];return i.a.open(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach(function(t){k(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({key:v,className:"ct-notification",description:s.a.createElement("div",null,s.a.createElement("div",{className:"ct-notification-title"},s.a.createElement("div",{className:"ct-notification-message"},r||c),s.a.createElement("div",{className:"ct-notification-close-icon",onClick:w},s.a.createElement(E.a,null)),s.a.createElement("div",{className:"ct-notification-icon"},j)),s.a.createElement("div",{className:"ct-notification-description"},b)),placement:"topRight",onClick:function(){},width:348,btn:"info"===O?S:T},g,{icon:null}))}});t.a=i.a},"../client/src/components/ui/notification/index.styl":function(e,t,n){},"../client/src/containers/EditPage/EditPageCommon.js":function(e,t,n){"use strict";n.d(t,"a",function(){return w});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./core-js/modules/es6.array.find.js");var r,o=n("./react/index.js"),a=n.n(o),i=n("./mobx-react/index.module.js"),c=n("./classnames/index.js"),s=n.n(c),l=n("../client/src/consts/index.js"),u=n("../client/src/editor/index.js"),p=n("../client/src/components/CrumbsNavBar/index.js"),f=n("../client/src/assets/svg/clock-o.svg"),d=n("../client/src/components/Modal/SecretSettingModal/index.js"),m=n("../client/src/components/GuideToolTip/index.js");function h(e){return(h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return!t||"object"!==h(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=Object(i.inject)("store")(r=Object(i.observer)(r=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=b(this,(e=v(t)).call.apply(e,[this].concat(o)))).state={secretSettingVisible:!1,isInMT:!1},n.showSecretSetting=function(){n.setState({secretSettingVisible:!0})},n.hideSecretSetting=function(){n.setState({secretSettingVisible:!1})},n.handleSecretChange=function(e){var t=n.props,r=t.handleSecretChange,o=t.store;r?r(e):o.doc.updateSecretLevel(e)},n.renderSecret=function(e){return e?a.a.createElement("div",{className:"secret-tag secret-level-".concat(e),onClick:n.showSecretSetting},a.a.createElement("div",null,"C-".concat(e)),a.a.createElement("div",null,l.o.find(function(t){return t.level===+e}).levelText)):a.a.createElement("div",{onClick:n.showSecretSetting,className:"secret-tag secret-no-level"},"\u672a\u8bbe\u5bc6\u7ea7")},n.checkIsInMT=function(e){var t=n.props.store,r=t.sideBar,o=t.space,a=r.spaceId,i=function(e){o.checkIsInMT(e).then(function(e){return n.isMount&&n.setState({isInMT:e})}).catch(function(e){return console.error(e)})};if(!a)return r.getSpaceId(e).then(function(e){return i(e)});i(a)},n}var n,r,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentWillMount",value:function(){this.isMount=!0;var e=this.props.pageId;this.checkIsInMT(e)}},{key:"componentWillUnmount",value:function(){this.isMount=!1}},{key:"render",value:function(){var e=this.state,t=e.secretSettingVisible,n=e.isInMT,r=this.props.store,o=r.doc,i=r.sideBar,c=r.ui,l=o.navTrack,h=o.page.hasRowNum,y=i.spaceId,b=this.props,v=b.type,g=void 0===v?"edit":v,w=b.editorRef,j=b.descInputRef,O=b.editorConfig,S=(b.networkError,b.draftErrorCount),E=b.draftText,P=b.disabled,k=b.isSpacePage,x=b.pageId,C=b.title,T=b.body,I=b.secretLevel,A=b.onSave,D=b.onCancel,N=b.onTitleEnter,M=b.fixedWidth,_=void 0!==M&&M,L=b.sensitiveChecking,B=void 0!==L&&L,R=b.titleWarning,V=void 0!==R&&R;return a.a.createElement("div",{className:s()("ct-edit-page",{"fixed-width":_,create:""===g})},a.a.createElement("div",{className:"nav"},a.a.createElement("div",{className:"nav-left"},a.a.createElement(p.a,{track:k?[{title:C,url:"/space/".concat(y)}]:l,sideBar:i,ui:c,spaceId:y,isEditPage:"edit"===g,isCreatePage:"create"===g,isSpacePage:k,title:C}),a.a.createElement("div",{className:"ct-bottom-autosave"},a.a.createElement(f.a,null),S>2?a.a.createElement("span",null,"\u8349\u7a3f\u4fdd\u5b58\u5931\u8d25\uff0c\u5185\u5bb9\u5df2\u4fdd\u5b58\u5728\u672c\u5730\uff0c\u8bf7\u5728\u7f51\u7edc/\u670d\u52a1\u7a33\u5b9a\u540e\u91cd\u8bd5\uff0c\u8bf7\u52ff\u5173\u95ed/\u5237\u65b0\u672c\u9875\u9762\uff0c\u5426\u5219\u5f53\u524d\u7f16\u8f91\u5185\u5bb9\u5c06\u4e22\u5931"):a.a.createElement(m.a,{content:"\u81ea\u52a8\u4fdd\u5b58\u8349\u7a3f\uff0c\u6587\u6863\u4e0d\u4f1a\u4e22\u5931\uff01",placement:"bottomLeft",localStorageKey:"guide-page-autosave",onClose:function(){return w.current.store.pm.focus()}},E))),a.a.createElement("div",{className:"nav-right"},a.a.createElement("input",{ref:j,className:"ct-input ct-bottom-desc",placeholder:"\u66f4\u6539\u4e86\u4ec0\u4e48\uff1f",autoComplete:"off"}),a.a.createElement("button",{type:"button","data-action":"save-click",disabled:P||B,className:"ct-btn-primary ct-bottom-btn ".concat(P?"saving":""),onClick:A},P&&a.a.createElement("div",{className:"save-loading"}),"\u4fdd\u5b58".concat(P?"\u4e2d":"")),a.a.createElement("button",{type:"button","data-action":"cancel-click",className:"ct-btn ct-bottom-btn",onClick:D},"\u53d6\u6d88"))),a.a.createElement(u.a,{ref:w,config:O,defaultBody:T,defaultTitle:C,titleEditable:!k,onTitleEnter:N,fixedWidth:this.props.fixedWidth,hasRowNum:h,menuTop:47,secret:n&&this.renderSecret(I),titleWarning:V},this.props.children),a.a.createElement(d.a,{hasEditPerm:!0,spaceId:y,pageId:x,currentSecretLevel:I,visible:t,handleCancel:this.hideSecretSetting,onChange:this.handleSecretChange}))}}])&&y(n.prototype,r),i&&y(n,i),t}())||r)||r},"../client/src/containers/EditPage/EditPageMixin.js":function(e,t,n){"use strict";n.d(t,"a",function(){return u});n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js");var r=n("./react/index.js"),o=n.n(r),a=n("../client/src/components/Toastr/index.js");n("../client/src/containers/EditPage/style.styl");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=c(this,s(t).call(this,e))).isMount=!0,n.isSaving=!1,n.isDocSaving=!1,n.isDraftChanged=!1,n.setMountingState=function(e){n.isMount&&(void 0!==e.disabled&&(n.isDocSaving=e.disabled),n.setState(e))},n.checkBase64Img=function(){var e=document.querySelector(".ProseMirror").querySelector('img[src^="data:"]');e?(e.scrollIntoView(),a.a.error("\u6587\u6863\u8fc7\u5927\uff0c\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u5220\u9664base64\u6587\u4ef6\u518d\u4fdd\u5b58")):a.a.error("\u6587\u6863\u8fc7\u5927\uff0c\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u62c6\u5206\u6210\u591a\u4e2a\u6587\u6863\u518d\u4fdd\u5b58")},n.editorRef=o.a.createRef(),n.descInputRef=o.a.createRef(),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,r["Component"]),t}()},"../client/src/containers/EditPage/index.js":function(e,t,n){"use strict";n.r(t);n("./core-js/modules/es7.object.get-own-property-descriptors.js"),n("./core-js/modules/es6.object.keys.js"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/es6.regexp.replace.js"),n("./regenerator-runtime/runtime.js"),n("./core-js/modules/es6.function.name.js"),n("./antd/lib/button/style/index.js");var r=n("./antd/lib/button/index.js"),o=n.n(r),a=(n("./core-js/modules/es6.regexp.split.js"),n("./core-js/modules/es6.promise.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.string.iterator.js"),n("./core-js/modules/es6.regexp.match.js"),n("./react/index.js")),i=n.n(a),c=n("./mobx/lib/mobx.module.js"),s=n("./mobx-react/index.module.js"),l=n("../client/src/utils/logger.js"),u=n("../client/src/components/CommonUI/NotFound/index.js"),p=n("../client/src/components/CommonUI/Deleted/index.js"),f=n("../client/src/components/CommonUI/NetWorkError/index.js"),d=n("../client/src/components/ui/modal/index.js"),m=n("../client/src/components/Notification/index.js"),h=n("../client/src/components/Toastr/index.js"),y=n("../client/src/components/List/TableList/index.js"),b=n("../client/src/components/QuickStart/index.js"),v=n("../client/src/utils/userInfo.js"),g=n("../client/src/utils/report/lx.js"),w=n("../client/src/utils/tools.js"),j=(n("./core-js/modules/es7.array.includes.js"),n("./core-js/modules/es6.string.includes.js"),n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/es6.array.find.js"),n("./core-js/modules/es6.array.find-index.js"),n("./@mtfe/citadel-editor/es/utils/index.js")),O=n("./lodash.intersection/index.js"),S=n.n(O),E=(n("./core-js/modules/es6.string.ends-with.js"),n("./string-similarity/compare-strings.js")),P=n.n(E);function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var x=["h1","h2","h3","h4","h5","h6"],C=function(e){return e.querySelectorAll("*:empty").forEach(function(e){e.tagName&&["span","font"].includes(e.tagName.toLowerCase())&&e.remove()}),function(e){return e.querySelectorAll("br").forEach(function(e){e.remove()}),e}(e)},T=function(e){var t=document.createElement("body");return t.innerHTML=e.replace(/\u200B/g,"").replace(/<a[^>]* class="ct-link"[^>]*><\/a>/gi,"").replace(/<div class="ct-collapse-title">([^>]*)<\/div>/gi,'<div class="ct-collapse-title"><p>$1</p></div>').replace(/<div class="ct-note-title">([^>]*)<\/div>/gi,'<div class="ct-note-title"><p>$1</p></div>'),t},I=function(e,t){var n=e.cloneNode(!0);return t.forEach(function(e){n.removeAttribute(e)}),n},A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["id"],r=/style="(.*?)"/g;if(x.includes(e.tagName.toLowerCase())){var o=I(e,n).outerHTML,a=I(t,n).outerHTML;return r.test(o)&&(o=o.replace(r,function(e,t){return e.replace(t,"")})),r.test(a)&&(a=a.replace(r,function(e,t){return e.replace(t,"")})),o===a}if(e.outerHTML===t.outerHTML)return!0;if("p"!==e.tagName.toLowerCase())return!1;var i=C(e.cloneNode(!0)),c=i.outerHTML,s=C(t.cloneNode(!0)),l=s.outerHTML;return r.test(c)&&(c=c.replace(r,function(e,t){return e.replace(t,"")})),r.test(l)&&(l=l.replace(r,function(e,t){return e.replace(t,"")})),t.querySelector(".ct-link")&&(l=l.replace(/href="(.*?)"/g,function(e,t){return t.endsWith("/")?'href="'.concat(t.slice(0,-1),'"'):'href="'.concat(t,'"')})),e.querySelector(".ct-link")&&(c=c.replace(/href="(.*?)"/g,function(e,t){return t.endsWith("/")?'href="'.concat(t.slice(0,-1),'"'):'href="'.concat(t,'"')})),c===l},D=function(e,t,n,r){return(e.getAttribute("colspan")||"1")!==(t.getAttribute("colspan")||"1")?{isSame:!1,mergedCellIds:function(e,t,n,r){var o=e.getAttribute("data-cell-diff-id"),a=Array.from(n.querySelectorAll(":scope > *")).map(function(e){return e.getAttribute("data-cell-diff-id")}),i=Array.from(r.querySelectorAll(":scope > *")).map(function(e){return e.getAttribute("data-cell-diff-id")}),c=a.findIndex(function(e){return e===o}),s=[a[c]];for(c++;c<a.length&&!i.includes(a[c]);)s.push(a[c]),c++;return s}(e,0,n,r)}:{isSame:A(e,t,["style"])}},N=function(e){var t={status:"\u328e"};return e.innerHTML.replace(/<img[^>]* src=['"]([^'"]+)[^>]*>/gi,"$1").replace(/<a[^>]* href=['"]([^'"]+)[^>]*>([^<]+)<\/a>/gi,"$2|$1").replace(/<span[^>]* class=['"]ct-status[^>]*><\/span>/gi,t.status).replace(/<(td|th|li)[^>]*>/gi,function(e,n){return t[n.toLowerCase()]}).replace(/<[^>]+>/g,"")},M=function(e,t){return P.a.compareTwoStrings(e,t)},_=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"data-diff-id",o=t.cloneNode(!0),a=n.cloneNode(!0),i=N(t),c=N(n),s=N(e),l=M(s,i),u=M(s,c),p={"data-diff-id":"ct-diff-id-".concat(Object(j.J)()),"data-row-diff-id":"ct-tr-diff-id-".concat(Object(j.J)()),"data-list-item-diff-id":"ct-list-item-diff-id-".concat(Object(j.J)())};return l>=u?o.setAttribute(r,p[r]):a.setAttribute(r,p[r]),[a,o]},L=function(e,t){if(e.isEqualNode(t))return!0;var n=e.cloneNode(!0),r=t.cloneNode(!0);if(1===n.nodeType&&n.nodeType===r.nodeType&&n.classList.contains("ct-image")&&r.classList.contains("ct-image")){var o=n.querySelector("img"),a=r.querySelector("img"),i=k((o.getAttribute("data-src")||"").split("?"),1)[0],c=k((a.getAttribute("data-src")||"").split("?"),1)[0];return c&&c===i}return!!(1===n.nodeType&&n.nodeType===r.nodeType&&n.style&&n.style.color&&r.style&&r.style.color)&&(n.style.color="",r.style.color="",n.isEqualNode(r))};function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function R(e){return(R="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var V=0,H=1,z=2,W=function(e,t){for(var n=e,r=0,o=function(){var e=n.shift();r++;var o=t.findIndex(function(t){return t.getAttribute("data-cell-diff-id")===e});if(-1!==o)return{v:[o,r,e]}};n.length;){var a=o();if("object"===R(a))return a.v}},F=function(e,t){for(var n=[],r=[],o=e,a=t,i=Array.from(o.querySelectorAll(":scope > *")),c=Array.from(a.querySelectorAll(":scope > *")),s=function(){var o=c.shift(),a=o.getAttribute("data-cell-diff-id"),s=i.find(function(e){return e.getAttribute("data-cell-diff-id")===a}),l=c.filter(function(e){return i.some(function(t){return t.getAttribute("data-cell-diff-id")===e.getAttribute("data-cell-diff-id")})}).map(function(e){return e.getAttribute("data-cell-diff-id")}),u=r.filter(function(e){return i.some(function(t){return t.getAttribute("data-cell-diff-id")===e.getAttribute("data-cell-diff-id")})}).map(function(e){return e.getAttribute("data-cell-diff-id")}).reverse();if(s){var p=D(s,o,e,t),f=p.isSame,d=p.mergedCellIds;f?n.push({id:a,row:o,type:V,base:s,nearAfterIds:l,nearBeforeIds:u}):n.push({id:a,row:o,type:z,base:s,nearAfterIds:l,nearBeforeIds:u,mergedCellIds:d})}else n.push({row:o,type:H,nearAfterIds:l,nearBeforeIds:u});r.push(o)};c.length;)s();return n};function U(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function q(e){return(q="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var G=0,Q=1,X=2,Y=function(e,t){for(var n=e,r=0,o=function(){var e=n.shift();r++;var o=t.findIndex(function(t){return t.getAttribute("data-row-diff-id")===e});if(-1!==o)return{v:[o,r,e]}};n.length;){var a=o();if("object"===q(a))return a.v}},J=function(e,t){var n=e.base,r=t.row.cloneNode(),o=F(n,e.row),a=F(n,t.row);return function(e,t){var n=e.filter(function(e){return e.mergedCellIds}).map(function(e){return e.mergedCellIds}),r=t.filter(function(e){return e.mergedCellIds}).map(function(e){return e.mergedCellIds});return!!n.some(function(e){return r.some(function(t){return S()(t,e).length})})}(o,a)?_(e.base,e.row,t.row,"data-row-diff-id"):(r.innerHTML=function(e,t,n){for(var r=[],o=n,a=Array.from(o.querySelectorAll(":scope > *")).map(function(e){return e.getAttribute("data-cell-diff-id")}),i=e.map(function(e){return e.row.getAttribute("data-cell-diff-id")}),c=a.filter(function(e){return!i.includes(e)}),s=t.filter(function(e){return c.includes(e.row.getAttribute("data-cell-diff-id"))}).filter(function(e){return e.type===z}).reverse(),l=function(){var n=e.shift(),o=n.row.getAttribute("data-cell-diff-id");if(n.type===H)return r.push(n.row),"continue";var a=t.find(function(e){return e.row.getAttribute("data-cell-diff-id")===o});if(n.type===V){if(!a)return"continue";a.type===V?r.push(n.row):r.push(a.row)}if(n.type===z)if(a)if(a.type===V)r.push(n.row);else{var i=n.row.cloneNode(),c=Se(a.base.innerHTML,a.row.innerHTML),s=Se(a.base.innerHTML,n.row.innerHTML);i.innerHTML=Ee(c,s,a.base.innerHTML),r.push(i)}else r.push(n.row)};e.length;)l();for(var u=t.filter(function(e){return e.type===H}).concat(s),p=a.reduce(function(e,t){return e[t]=1,e},{});u.length;){var f=u.shift(),d=f.nearAfterIds,m=f.nearBeforeIds,h=W(m,r),y=W(d,r);if(h&&y){var b=B(h,3),v=b[0],g=b[1],w=b[2],j=B(y,2),O=j[0],S=j[1];if(g<=S){r.splice(v+p[w],0,f.row),p[w]++;continue}if(g>S){r.splice(O,0,f.row);continue}}else{if(h){var E=B(h,3),P=E[0],k=(E[1],E[2]);r.splice(P+p[k],0,f.row),p[k]++;continue}if(y){var x=B(y,1)[0];r.splice(x,0,f.row);continue}}r.splice(0,0,f.row)}return r.map(function(e){var t=document.createElement("div");return t.appendChild(e),t}).map(function(e){return e.innerHTML}).join("")}(o,a,n),[r])},Z=function(e,t){for(var n=[],r=[],o=e,a=t,i=Array.from(o.querySelectorAll(":scope > *")),c=Array.from(a.querySelectorAll(":scope > *")),s=function(){var e=c.shift(),t=e.getAttribute("data-row-diff-id"),o=i.find(function(e){return e.getAttribute("data-row-diff-id")===t}),a=c.filter(function(e){return i.some(function(t){return t.getAttribute("data-row-diff-id")===e.getAttribute("data-row-diff-id")})}).map(function(e){return e.getAttribute("data-row-diff-id")}),s=r.filter(function(e){return i.some(function(t){return t.getAttribute("data-row-diff-id")===e.getAttribute("data-row-diff-id")})}).map(function(e){return e.getAttribute("data-row-diff-id")}).reverse();o?o.outerHTML===e.outerHTML?n.push({id:t,row:e,type:G,base:o,nearAfterIds:a,nearBeforeIds:s}):n.push({id:t,row:e,type:X,base:o,nearAfterIds:a,nearBeforeIds:s}):n.push({row:e,type:Q,nearAfterIds:a,nearBeforeIds:s}),r.push(e)};c.length;)s();return n},$=function(e,t,n){var r=e.cloneNode(),o=e.querySelector("tbody"),a=t.querySelector("tbody"),i=n.querySelector("tbody"),c=Z(i,o),s=Z(i,a);return r.innerHTML=function(e,t,n){for(var r=[],o=n,a=Array.from(o.querySelectorAll(":scope > *")).map(function(e){return e.getAttribute("data-row-diff-id")}),i=e.map(function(e){return e.row.getAttribute("data-row-diff-id")}),c=a.filter(function(e){return!i.includes(e)}),s=t.filter(function(e){return c.includes(e.row.getAttribute("data-row-diff-id"))}).filter(function(e){return e.type===X}).reverse(),l=function(){var n=e.shift(),o=n.row.getAttribute("data-row-diff-id");if(n.type===Q)return r.push(n.row),"continue";var a=t.find(function(e){return e.row.getAttribute("data-row-diff-id")===o});if(n.type===G){if(!a)return"continue";a.type===G?r.push(n.row):r.push(a.row)}if(n.type===X)if(a)if(a.type===G)r.push(n.row);else{var i=J(n,a);r.push.apply(r,U(i))}else r.push(n.row)};e.length;)l();for(var u=t.filter(function(e){return e.type===Q}).concat(s),p=a.reduce(function(e,t){return e[t]=1,e},{});u.length;){var f=u.shift(),d=f.nearAfterIds,m=f.nearBeforeIds,h=Y(m,r),y=Y(d,r);if(h&&y){var b=K(h,3),v=b[0],g=b[1],w=b[2],j=K(y,2),O=j[0],S=j[1];if(g<=S){r.splice(v+p[w],0,f.row),p[w]++;continue}if(g>S){r.splice(O,0,f.row);continue}}else{if(h){var E=K(h,3),P=E[0],k=(E[1],E[2]);r.splice(P+p[k],0,f.row),p[k]++;continue}if(y){var x=K(y,1)[0];r.splice(x,0,f.row);continue}}r.splice(0,0,f.row)}return r.map(function(e){var t=document.createElement("div");return t.appendChild(e),t}).map(function(e){return e.innerHTML}).join("")}(c,s,i),[r]};function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function te(e){return(te="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ne=0,re=2,oe=function(e,t){for(var n=e.childNodes,r=t.childNodes,o=[],a=0;a<n.length;a++){var i=n[a],c=r[a];L(i,c)?o.push({node:c,type:ne}):o.push({node:c,type:re})}return o},ae=function(e,t){if(e.length===t.length){for(var n=function(n){var r=e[n].nodeType,o=t[n].nodeType;if(r!==o)return{v:!1};if(r===o&&1===o){if(e[n].nodeName!==t[n].nodeName)return{v:!1};if(Array.from(e[n].classList).every(function(e){return!Array.from(t[n].classList).includes(e)}))return{v:!1}}},r=0;r<e.length;r++){var o=n(r);if("object"===te(o))return o.v}return!0}return!1};function ie(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function se(e){return(se="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var le=0,ue=1,pe=2,fe=function(e,t){for(var n=e,r=0,o=function(){var e=n.shift();r++;var o=t.findIndex(function(t){return t.getAttribute("data-list-item-diff-id")===e});if(-1!==o)return{v:[o,r,e]}};n.length;){var a=o();if("object"===se(a))return a.v}},de=function(e,t){for(var n=[],r=[],o=e.cloneNode(!0),a=t.cloneNode(!0),i=Array.from(o.querySelectorAll(":scope > *")),c=Array.from(a.querySelectorAll(":scope > *")),s=function(){var e=c.shift(),t=e.getAttribute("data-list-item-diff-id"),o=i.find(function(e){return e.getAttribute("data-list-item-diff-id")===t}),a=c.filter(function(e){return i.some(function(t){return t.getAttribute("data-list-item-diff-id")===e.getAttribute("data-list-item-diff-id")})}).map(function(e){return e.getAttribute("data-list-item-diff-id")}),s=r.filter(function(e){return i.some(function(t){return t.getAttribute("data-list-item-diff-id")===e.getAttribute("data-list-item-diff-id")})}).map(function(e){return e.getAttribute("data-list-item-diff-id")}).reverse();o?A(o,e)?n.push({id:t,row:e,type:le,nearAfterIds:a,nearBeforeIds:s}):n.push({id:t,row:e,type:pe,nearAfterIds:a,nearBeforeIds:s}):n.push({row:e,type:ue,nearAfterIds:a,nearBeforeIds:s}),r.push(e)};c.length;)s();return n},me=function(e,t,n){for(var r=[],o=n,a=Array.from(o.querySelectorAll(":scope > *")).map(function(e){return e.getAttribute("data-list-item-diff-id")}),i=t.map(function(e){return e.row.getAttribute("data-list-item-diff-id")}),c=a.filter(function(e){return!i.includes(e)}),s=e.filter(function(e){return c.includes(e.row.getAttribute("data-list-item-diff-id"))}).filter(function(e){return e.type===pe}).reverse(),l=function(){var o=t.shift(),a=o.row.getAttribute("data-list-item-diff-id");if(o.type===ue)return r.push(o.row),"continue";var i=e.find(function(e){return e.row.getAttribute("data-list-item-diff-id")===a});if(o.type===le){if(!i)return"continue";i.type===le?r.push(o.row):r.push(i.row)}if(o.type===pe)if(i)if(i.type===le)r.push(o.row);else{var c=function(e,t,n){var r=e.getAttribute("data-list-item-diff-id"),o=Array.from(n.querySelectorAll(":scope > *")).find(function(e){return e.getAttribute("data-list-item-diff-id")===r}),a=e.classList,i=t.classList;if([a,i].some(function(e){return e.contains("ct-task-li-checked")})&&![a,i].every(function(e){return e.contains("ct-task-li")}))return _(o,e,t,"data-list-item-diff-id");var c=Se(o.innerHTML,t.innerHTML),s=Se(o.innerHTML,e.innerHTML),l=e.cloneNode();return l.innerHTML=Ee(c,s,o.innerHTML),[l]}(o.row,i.row,n);r.push.apply(r,ie(c))}else r.push(o.row)};t.length;)l();for(var u=e.filter(function(e){return e.type===ue}).concat(s),p=a.reduce(function(e,t){return e[t]=1,e},{});u.length;){var f=u.shift(),d=f.nearAfterIds,m=f.nearBeforeIds,h=fe(m,r),y=fe(d,r);if(h&&y){var b=ce(h,3),v=b[0],g=b[1],w=b[2],j=ce(y,2),O=j[0],S=j[1];if(g<=S){r.splice(v+p[w],0,f.row),p[w]++;continue}if(g>S){r.splice(O,0,f.row);continue}}else{if(h){var E=ce(h,3),P=E[0],k=(E[1],E[2]);r.splice(P+p[k],0,f.row),p[k]++;continue}if(y){var x=ce(y,1)[0];r.splice(x,0,f.row);continue}}r.splice(0,0,f.row)}return r.map(function(e){var t=document.createElement("div");return t.appendChild(e),t}).map(function(e){return e.innerHTML}).join("")};function he(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function be(e){return(be="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ve=0,ge=1,we=2,je=function(e,t){for(var n=e,r=0,o=function(){var e=n.shift();r++;var o=t.findIndex(function(t){return t.getAttribute("data-diff-id")===e});if(-1!==o)return{v:[o,r,e]}};n.length;){var a=o();if("object"===be(a))return a.v}},Oe=function(e,t,n){var r=T(n),o=e.getAttribute("data-diff-id"),a=Array.from(r.querySelectorAll(":scope > *")).find(function(e){return e.getAttribute("data-diff-id")===o});if(e.tagName!==t.tagName)return _(a,e,t);if("p"===e.tagName.toLowerCase()||x.includes(e.tagName.toLowerCase()))return function(e,t,n){var r=C(n.cloneNode(!0)),o=C(e.cloneNode(!0)),a=C(t.cloneNode(!0)),i=o.cloneNode(),c=!1;if(ae(r.childNodes,o.childNodes)&&ae(r.childNodes,a.childNodes)){for(var s=[],l=oe(r,o),u=oe(r,a),p=0;p<l.length;p++){var f=l[p],d=u[p];if(f.type===ne&&(d.type===ne&&s.push(f.node),d.type===re&&s.push(d.node)),f.type===re&&(d.type===ne&&s.push(f.node),d.type===re))if(3===f.node.nodeType&&3===d.node.nodeType)f.node.nodeValue.includes(d.node.nodeValue)?s.push(f.node):d.node.nodeValue.includes(f.node.nodeValue)?s.push(d.node):c=!0;else if(1===f.node.nodeType&&1===d.node.nodeType)if(f.node.classList.contains("ct-image")&&d.node.classList.contains("ct-image")){var m=f.node.querySelector("img"),h=d.node.querySelector("img"),y=ee((m.getAttribute("data-src")||"").split("?"),1)[0],b=ee((h.getAttribute("data-src")||"").split("?"),1)[0];b&&b===y?s.push(f.node):s.push(f.node,d.node)}else s.push(f.node,d.node);else c=!0}if(c){var v=N(o),g=N(a),w=N(r);return M(w,v)>=M(w,g)?a.setAttribute("data-diff-id","ct-diff-id-".concat(Object(j.J)())):o.setAttribute("data-diff-id","ct-diff-id-".concat(Object(j.J)())),[o,a]}return i.innerHTML=s.reduce(function(e,t){return 3===t.nodeType&&(e+=t.nodeValue),1===t.nodeType&&(e+=t.outerHTML),e},""),[i]}var O=N(o),S=N(a),E=N(r);return M(E,O)>=M(E,S)?a.setAttribute("data-diff-id","ct-diff-id-".concat(Object(j.J)())):o.setAttribute("data-diff-id","ct-diff-id-".concat(Object(j.J)())),[o,a]}(e,t,a);if(e.classList.contains("ct-collapse"))return function(e,t,n){var r=e.querySelector(".ct-collapse-content"),o=t.querySelector(".ct-collapse-content"),a=n.querySelector(".ct-collapse-content"),i=Se(a.innerHTML,r.innerHTML),c=Se(a.innerHTML,o.innerHTML),s=Ee(c,i,a.innerHTML),l=e.cloneNode(!0),u=r.cloneNode();return u.innerHTML=s,l.replaceChild(u,l.lastElementChild),[l]}(e,t,a);if(e.classList.contains("ct-note"))return function(e,t,n){var r=e.querySelector(".ct-note-content"),o=t.querySelector(".ct-note-content"),a=n.querySelector(".ct-note-content"),i=Se(a.innerHTML,r.innerHTML),c=Se(a.innerHTML,o.innerHTML),s=Ee(c,i,a.innerHTML),l=e.cloneNode(!0),u=r.cloneNode();return u.innerHTML=s,l.replaceChild(u,l.lastElementChild),[l]}(e,t,a);if(e.classList.contains("ct-code"))return _(a,e,t);if("table"===e.tagName.toLowerCase())return $(e,t,a);if("blockquote"===e.tagName.toLowerCase())return function(e,t,n){var r=Se(n.innerHTML,e.innerHTML),o=Se(n.innerHTML,t.innerHTML),a=Ee(o,r,n.innerHTML),i=e.cloneNode();return i.innerHTML=a,[i]}(e,t,a);if(e.classList.contains("ct-calendar"))return[e];if(e.classList.contains("ct-attachment"))return[e];var i=e.classList,c=t.classList;return["ul","ol"].includes(e.tagName.toLowerCase())&&[i,c].some(function(e){return e.contains("ct-task-list")})&&![i,c].every(function(e){return e.contains("ct-task-list")})?_(a,e,t):["ul","ol"].includes(e.tagName.toLowerCase())?function(e,t,n){var r=e.cloneNode(),o=de(n,e),a=de(n,t);return r.innerHTML=me(a,o,n),[r]}(e,t,a):_(a,e,t)},Se=function(e,t){for(var n=[],r=[],o=T(e),a=T(t),i=Array.from(o.querySelectorAll(":scope > *")),c=Array.from(a.querySelectorAll(":scope > *")),s=function(){var e=c.shift(),t=e.getAttribute("data-diff-id"),o=i.find(function(e){return e.getAttribute("data-diff-id")===t}),a=c.filter(function(e){return i.some(function(t){return t.getAttribute("data-diff-id")===e.getAttribute("data-diff-id")})}).map(function(e){return e.getAttribute("data-diff-id")}),s=r.filter(function(e){return i.some(function(t){return t.getAttribute("data-diff-id")===e.getAttribute("data-diff-id")})}).map(function(e){return e.getAttribute("data-diff-id")}).reverse();if(o)if(A(o,e))n.push({id:t,row:e,type:ve,nearAfterIds:a,nearBeforeIds:s});else if(function(e){var t=e.cloneNode(!0);return t.removeAttribute("data-diff-id"),"<p></p>"===t.outerHTML}(o)){var l=e.cloneNode(!0);l.setAttribute("data-diff-id","ct-diff-id-".concat(Object(j.J)())),n.push({row:l,type:ge,nearAfterIds:a,nearBeforeIds:s})}else n.push({id:t,row:e,type:we,nearAfterIds:a,nearBeforeIds:s});else n.push({row:e,type:ge,nearAfterIds:a,nearBeforeIds:s});r.push(e)};c.length;)s();return n},Ee=function(e,t,n){for(var r=[],o=T(n),a=Array.from(o.querySelectorAll(":scope > *")).map(function(e){return e.getAttribute("data-diff-id")}),i=t.map(function(e){return e.row.getAttribute("data-diff-id")}),c=a.filter(function(e){return!i.includes(e)}),s=e.filter(function(e){return c.includes(e.row.getAttribute("data-diff-id"))}).filter(function(e){return e.type===we}).reverse(),l=function(){var o=t.shift(),a=o.row.getAttribute("data-diff-id");if(o.type===ge)return r.push(o.row),"continue";var i=e.find(function(e){return e.row.getAttribute("data-diff-id")===a});if(o.type===ve){if(!i)return"continue";i.type===ve?r.push(o.row):r.push(i.row)}if(o.type===we)if(i)if(i.type===ve)r.push(o.row);else{var c=Oe(o.row,i.row,n);r.push.apply(r,he(c))}else r.push(o.row)};t.length;)l();for(var u=e.filter(function(e){return e.type===ge}).concat(s),p=a.reduce(function(e,t){return e[t]=1,e},{}),f=0;u.length;){var d=u.shift(),m=d.nearAfterIds,h=d.nearBeforeIds,y=je(h,r),b=je(m,r);if(y&&b){var v=ye(y,3),g=v[0],w=v[1],j=v[2],O=ye(b,2),S=O[0],E=O[1];if(w<=E){r.splice(g+p[j],0,d.row),p[j]++;continue}if(w>E){r.splice(S,0,d.row);continue}}else{if(y){var P=ye(y,3),k=P[0],x=(P[1],P[2]);r.splice(k+p[x],0,d.row),p[x]++;continue}if(b){var C=ye(b,1)[0];r.splice(C,0,d.row);continue}}r.splice(f,0,d.row),f++}return r.map(function(e){var t=document.createElement("div");return t.appendChild(e),t}).map(function(e){return e.innerHTML}).join("")},Pe=n("../client/src/api/index.js"),ke=n("../client/src/editor/index.js"),xe=n("../client/src/events/index.js"),Ce=n("../client/src/events/type.js"),Te=n("../client/src/history.js"),Ie=n("../client/src/consts/index.js"),Ae=n("../client/src/containers/EditPage/utils.js"),De=n("../client/src/containers/EditPage/EditPageCommon.js"),Ne=n("../client/src/containers/EditPage/EditPageMixin.js"),Me=n("./dexie/dist/dexie.es.js"),_e=n("../client/src/utils/citadelDB.js");function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(n,!0).forEach(function(t){Re(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ve,He=v.a.login,ze=_e.a&&_e.a.doc,We={getDoc:function(e){return ze.get("".concat(He,"_").concat(e)).then(function(e){return e}).catch(function(e){return Me.default.delete("citadel"),console.warn(e),Promise.resolve(null)})},addDoc:function(e,t){return ze.add(Be({contentId:"".concat(He,"_").concat(e)},t))},updateDoc:function(e,t){return ze.put(Be({contentId:"".concat(He,"_").concat(e),saveTime:Date.now()},t))},deleteDoc:function(e){return ze.delete("".concat(He,"_").concat(e))}};function Fe(e){return(Fe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Ke(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Ue(a,r,o,i,c,"next",e)}function c(e){Ue(a,r,o,i,c,"throw",e)}i(void 0)})}}function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(n,!0).forEach(function(t){Qe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $e(e,t){return($e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"default",function(){return at});var et=Ie.t.DONE,tt=3,nt=6e4,rt=4e3,ot=20,at=Object(s.inject)("store","editor")(Ve=Object(s.observer)(Ve=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),p=0;p<s;p++)u[p]=arguments[p];return r=this,a=(e=Je(t)).call.apply(e,[this].concat(u)),(n=!a||"object"!==Fe(a)&&"function"!==typeof a?Ze(r):a).pollTimer=null,n.updateTitleTimer=null,n.pageId=0,n.disposers=[],n.hadExpired=!1,n.expiredCloseTab=null,n.mutationObserver=null,n.notitionKey=4e3*Math.random(),n.draftErrorCount=0,n.state={notFound:!1,hadDeleted:!1,draftText:"\u53d8\u66f4\u5c06\u81ea\u52a8\u4fdd\u5b58\u81f3\u8349\u7a3f",disabled:!1,networkError:!1,showQuickStart:!1,draftTime:null,sensitiveChecking:!1,titleWarning:!1},n.browserNotice=function(){if("Chrome"!==Object(w.q)().browser){var e=Ze(n).setInit,t=Ze(n).toViewPage;return d.a.confirm({title:"\u6d4f\u89c8\u5668\u63d0\u9192",content:i.a.createElement("div",null,i.a.createElement("p",null,"\u5bf9\u4e0d\u8d77\uff0c\u56e0\u9879\u76ee\u5f00\u53d1\u8d44\u6e90\u8f83\u5c11\uff0c\u6682\u672a\u9002\u914d\u672c\u6d4f\u89c8\u5668\u5e73\u53f0\u3002"),i.a.createElement("p",null,"\u4e3a\u9632\u6b62\u5f02\u5e38\u95ee\u9898\u5bfc\u81f4\u60a8\u7684\u6570\u636e\u4e22\u5931\uff0c\u5efa\u8bae\u60a8\u4f7f\u7528PC\u7aefChrome\u6d4f\u89c8\u5668\u8fdb\u884c\u7f16\u8f91\u3002")),okText:"\u7ee7\u7eed\u7f16\u8f91",cancelText:"\u8fd4\u56de\u67e5\u770b",onOk:function(t){e(),t()},onCancel:function(){t()}})}},n.setInit=function(){var e=n.props.store,t=e.doc,r=e.ui,o=e.sideBar,a=n.props.match.params.pageId;(0,t.updataCrumbsNavBar)(a),n.subscribeCancelEdit(),r.setWaterMarkOpacity(.5),xe.a.on(Ce.k,n.handleNotFound),xe.a.on(Ce.l,n.handleNoPerm),window.history.pushState("forward",null,"#"),window.addEventListener("popstate",n.onBackConfirm),window.addEventListener("beforeunload",n.onBeforeUnload),window.addEventListener("unload",n.freeLock),window.addEventListener("message",n.handleMessageReceive,!1),document.addEventListener("keydown",n.handleKeyDownSave,!1),document.getElementById("page-wrapper").classList.add("full-scroll"),document.getElementsByClassName("ct-main")[0].classList.add("edit-mode"),t.draftChoice?n.fromDraftPage():n.verifyEdit(),o.getSpaceId(a).then(function(e){o.setCurrent(e,a)}).catch(function(e){t.opsState.loadPageState=Ie.t.ERROR,console.error(e)})},n.verifyEdit=function(){var e=Object(c.autorun)(function(){var t=n.props.store,r=t.doc,o=t.sideBar.spaceId,a=n.props.match.params.pageId;r.perm.hasEditPerm?a&&o&&n.pageId!==a?(n.pageId=a,Promise.all([r.loadDraft(o,a,!0),We.getDoc(a),r.loadDoc(o,a,Ie.h.EDIT)]).then(function(t){var o=Xe(t,3),i=o[0],c=o[1],s=o[2];if(e(),!s.hasEditPerm)return h.a.error("\u60a8\u65e0\u6b64\u6587\u6863\u7684\u7f16\u8f91\u6743\u9650\uff0c\u5df2\u81ea\u52a8\u8df3\u8f6c\u5230\u8be5\u6587\u6863\u7684\u6d4f\u89c8\u9875"),void n.toViewPage(!0);var l=n.getDraftRes(i,c);n.afterVerified(l,s),r.updataCollectCrumbsNavBar(a)}).catch(function(e){n.handleLoadPageError(e)})):o||setTimeout(function(){n.verifyEdit()},1e3):n.hadToViewPage||(h.a.error("\u60a8\u65e0\u6b64\u6587\u6863\u7684\u7f16\u8f91\u6743\u9650\uff0c\u5df2\u81ea\u52a8\u8df3\u8f6c\u5230\u8be5\u6587\u6863\u7684\u6d4f\u89c8\u9875"),n.toViewPage(!0))});n.disposers.push(e)},n.getDraftRes=function(e,t){var r,o=n.props.store.doc;return(r=e?t&&t.saveTime>e.createTime?n.useLocalDraft(t):e:t?n.useLocalDraft(t):null)&&(o.page.contentId=r.contentId,o.page.spaceId=r.spaceId),r},n.useLocalDraft=function(e){var t=n.props.store.doc,r=e.saveTime,o=Xe(e.contentId.split("_"),2),a=o[0],i=o[1],c=Ge({},e,{createTime:r,v:e.version,contentId:i,mis:a});return t.draft=Ge({},e,{modifyTime:r}),c},n.afterVerified=function(e,t){n.props.store.doc.setLock(),n.loadOperators(),e?e.v&&(e.createTime>t.modifyTime||e.mis!==t.modifier)?n.handleDraft(e,t):n.beginEdit("page",e,t):n.handleDraftError(t)},n.handleDraftError=function(e){var t=n.props.store,r=t.doc,o=t.sideBar.spaceId,a=n.props.match.params.pageId;d.a.confirm({title:"\u8349\u7a3f\u83b7\u53d6\u5931\u8d25\u63d0\u9192",content:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,"\u7f51\u7edc/\u670d\u52a1\u5f02\u5e38\uff0c\u65e0\u6cd5\u83b7\u53d6\u8349\u7a3f\uff0c\u5982\u65e0\u8349\u7a3f/\u65e0\u9700\u4f7f\u7528\u8349\u7a3f\uff0c\u53ef\u70b9\u51fb\u7ee7\u7eed\u7f16\u8f91\uff0c\u76f4\u63a5\u5728\u5f53\u524d\u6587\u6863\u57fa\u7840\u4e0a\u7f16\u8f91\u5185\u5bb9\u3002"),i.a.createElement("p",null,"\u5982\u5e0c\u671b\u4f7f\u7528\u4e4b\u524d\u8349\u7a3f\uff0c\u8bf7\u5f85\u7f51\u7edc/\u670d\u52a1\u6062\u590d\u540e\u518d\u884c\u7f16\u8f91")),okText:"\u7ee7\u7eed\u7f16\u8f91",cancelText:"\u53d6\u6d88\u7f16\u8f91",onOk:function(t){We.deleteDoc(a),r.deleteDraft(o,a),r.pageRes=e,n.beginEdit("page",r.draftRes,e),t()},onCancel:function(){n.toViewPage(!0)}})},n.handleDraft=function(e,t){var r=n.props.store.doc;r.draftRes=e,r.pageRes=t;var a=d.a.warning({title:"\u662f\u5426\u4f7f\u7528\u8349\u7a3f?",content:i.a.createElement("span",null,"\u6b64\u8349\u7a3f\u4fdd\u5b58\u4e8e",Object(w.g)(e.createTime),"\u3002 \xa0",i.a.createElement("a",{onClick:function(){n.toDraftPage(),a.destroy()}},"\u67e5\u770b\u8349\u7a3f")),footer:[i.a.createElement(o.a,{onClick:function(){n.toViewPage(),a.destroy()}},"\u53d6\u6d88"),i.a.createElement(o.a,{onClick:function(){n.cancelDraft(),a.destroy()}},"\u4e0d\u4f7f\u7528"),i.a.createElement(o.a,{type:"primary",onClick:function(){n.applyDraft(),a.destroy()}},"\u4f7f\u7528")]})},n.fromDraftPage=function(){var e=n.props.store.doc;"cancel"===e.draftChoice&&n.cancelDraft(),n.applyDraft(),e.draftChoice=null},n.cancelDraft=function(e){var t=n.props.store,r=t.doc,o=t.sideBar.spaceId,a=n.props.match.params.pageId;We.deleteDoc(a),r.deleteDraft(o,a).then(function(){n.beginEdit("page",r.draftRes,r.pageRes),e&&e()}).catch(function(t){console.error(t),n.beginEdit("page",r.draftRes,r.pageRes),h.a.error("\u5e9f\u5f03\u670d\u52a1\u7aef\u8349\u7a3f\u5931\u8d25"),e&&e()})},n.applyDraft=function(e){var t=n.props.store.doc;n.beginEdit("draft",t.draftRes,t.pageRes),e&&e()},n.beginEdit=function(e,t,r){var o=n.props,a=o.store.doc,i=o.editor.rowNumExtension,c=n.props.match.params.pageId;"page"===e?(a.updateDocData(r),a.syncDraftFromPage(r),a.updatePageTitle({pageId:c,title:r.title,activeId:c})):a.syncPageFromDraft(),document.title="\u7f16\u8f91-".concat(a.page.title),setTimeout(n.scrollToViewPos,0),setTimeout(function(){n.draftErrorCount=0,n.pollTimer||(n.pollTimer=setTimeout(n.pollHandler,rt))},1e3),setTimeout(function(){t.paragraphNumber&&(i.hideRowNum(),i.showRowNum())},0),n.pollUpdateTitle()},n.loadOperators=function(){var e=n.props.store,t=e.doc,r=e.user,o=r.userInfo.account;t.loadOperators().then(function(e){var t=e.filter(function(e){return e.editor!==o});if(0!==t.length){var a=t.map(function(e){return e.editor});r.checkUserInfo(a).then(function(){var e=a.map(function(e){return"".concat(r.userInfos.get(e).name)});m.a.operator(n.notitionKey,e)}).catch(function(e){return console.error(e)})}}).catch(function(e){console.error(e)})},n.scrollToViewPos=function(){var e=n.props.store.ui;e.viewPageScrollTop&&(document.getElementById("page-wrapper").scrollTop=e.viewPageScrollTop,e.viewPageScrollTop=null)},n.pollHandler=function(){if(n.pollErrorCount>tt?n.pollTimer=setTimeout(n.pollHandler,nt):n.pollTimer=setTimeout(n.pollHandler,rt),!document.hidden){n.beforeSave(function(){return n.saveDraft({isAuto:!0})})}},n.beforeSave=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.pollTimer&&!n.isSaving?n.checkEditState(t,e):l.a.info({disabled:n.state.disabled,isSaving:n.isSaving,pollTimer:n.pollTimer})},n.checkEditState=function(e,t){n.props.store.doc.getPollState().then(function(e){if(n.isMount){var r=e.remote,o=e.local;r.draftTime&&r.draftTime>o.pageTime&&r.draftTime>o.draftTime?n.isDraftChanged||(m.a.draft(n.notitionKey,n.isDocSaving,function(){return n.toViewPage(!0)},function(){return n.saveDraft({isAuto:!0,isForced:!0})}),n.isDraftChanged=!0):n.isDraftChanged&&(n.isDraftChanged=!1,m.a.close(n.notitionKey)),n.checkCookieExpired(),n.setMountingState({networkError:!1}),t()}}).catch(function(t){return n.handlePollError(t,e)})},n.isPageChanged=function(){return new Promise(function(){var e=Ke(regeneratorRuntime.mark(function e(t){var r,o,a,i,c,s,l,u,p,f,d,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.props.store.doc,o=n.editorRef.current){e.next=4;break}return e.abrupt("return",t({isChanged:!1}));case 4:return a=o.serialize,i=o.store,c=i.core.historyUtils,s=i.state,e.next=7,a();case 7:l=e.sent,u=l.title,p=l.body,f=u!==r.draft.title,d=p!==r.draft.body&&(c.undoDepth(s)||c.redoDepth(s)),m=(p||"").replace(/\sdata-diff-id=".*?"/g,""),t({isChanged:!(("\u65e0\u6807\u9898"===u||!u)&&("<p></p>"===m||!p))&&(f||d),title:u,body:p});case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},n.saveDraft=Ke(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l,u,p,f,d,m,y,b,v,g,j,O,S,E,P,k=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k.length>0&&void 0!==k[0]?k[0]:{},r=t.isAuto,o=void 0!==r&&r,a=t.isForced,i=void 0!==a&&a,c=t.onSuccess,s=void 0===c?function(){}:c,l=t.onError,u=void 0===l?function(){}:l,p=n.props.store,f=p.doc,d=p.sideBar,m=d.spaceId,y=n.props.match.params.pageId,b=f.opsState,v=b.loadDraftState,g=b.loadPageState,v===et&&g===et){e.next=7;break}return e.abrupt("return");case 7:if(!n.isDraftChanged||i){e.next=10;break}return n.addDocToLocal(),e.abrupt("return");case 10:return e.next=12,n.isPageChanged();case 12:j=e.sent,O=j.isChanged,S=j.title,E=j.body,i||O?(P=n.props.editor.rowNumExtension.rowNumStatus,n.setMountingState({draftText:"\u6b63\u5728\u4fdd\u5b58..."}),f.setLock(),f.updateDraft(m,y,S,E,P).then(function(e){var t=n.state.draftTime;(e>t||!t)&&(n.checkCookieExpired(),n.draftErrorCount=0,f.updatePollState(e),f.updateDraftState(S,E,P),s(),o||h.a.success("\u53d8\u66f4\u5df2\u4fdd\u5b58\u5230\u8349\u7a3f"),n.setMountingState({draftText:"\u8349\u7a3f\u4fdd\u5b58\u4e8e".concat(Object(w.g)(new Date))}),n.setState({draftTime:e}))}).catch(function(e){return n.handleSaveDraftError(e,u)})):(s(),o||h.a.success("\u53d8\u66f4\u5df2\u4fdd\u5b58\u5230\u8349\u7a3f"));case 17:case"end":return e.stop()}},e)})),n.beforeSaveDoc=Ke(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l,u,p,f,d=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]&&d[0],r=n.editorRef.current,o=n.props.editor.rowNumExtension.rowNumStatus,r){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,r.serialize(!0);case 7:if(a=e.sent,i=a.status,c=a.title,s=a.body,l=a.bodyText,u=a.extension,p=a.uploadingDOM,!i){e.next=19;break}return i===ke.a.STATUS.UPLOADING?(p.scrollIntoView(),h.a.error("\u4ecd\u6709\u5185\u5bb9\u5728\u4e0a\u4f20/\u5185\u5bb9\u4e0a\u4f20\u5931\u8d25\uff0c\u65e0\u6cd5\u4fdd\u5b58")):i===ke.a.STATUS.WASH&&h.a.error("\u5185\u5bb9\u4e2d\u6709\u5185\u5bb9\u9700\u8981\u6e05\u6d17\uff0c\u65e0\u6cd5\u4fdd\u5b58"),n.setMountingState({disabled:!1}),n.isSaving=!1,e.abrupt("return");case 19:f=n.props.store.doc.draft.version,t&&(n.isSaving=!0),n.saveDoc({title:c,body:s,bodyText:l,extension:u,version:f,paragraphNumber:o?1:0});case 22:case"end":return e.stop()}},e)})),n.saveDoc=function(e){var t=e.title,r=e.body,o=e.bodyText,a=e.extension,i=e.version,c=e.paragraphNumber,s=e.otherExtension;if(n.isSaving){var u=n.props.store,p=u.doc,f=u.sideBar,d=f.spaceId,m=n.props.match.params.pageId,y=n.descInputRef.current&&n.descInputRef.current.value,b=(r||"").replace(/\sdata-diff-id=".*?"/g,"");if(("\u65e0\u6807\u9898"===t||!t)&&("<p></p>"===b||!r))return h.a.error("\u8bf7\u52ff\u4fdd\u5b58\u7a7a\u6587\u6863"),n.setMountingState({disabled:!1}),void(n.isSaving=!1);p.updateDoc({spaceId:d,pageId:m,title:t,body:r,whatUpdate:y,bodyText:o,extendFieldVO:a,linkResourcesVO:Ge({},s),version:i,paragraphNumber:c}).then(function(e){l.a.info("\u6587\u6863\u4fdd\u5b58\u6210\u529f,pageId:".concat(m,",error:").concat("object"===Fe(e)?JSON.stringify(e):e)),n.setMountingState({disabled:!1}),clearTimeout(n.pollTimer),n.pollTimer=null,n.checkCookieExpired(),n.toViewPage(),f.updateTreeDataByKey(m,"updateTitle",t),f.updateTreeDataOrderWithNoOrder(m),p.deleteDraft(d,m),We.deleteDoc(m)}).catch(function(e){n.handleSaveError(e)})}},n.setSensitiveChecking=Ke(regeneratorRuntime.mark(function e(){var t,r,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.store.doc,r=n.editorRef.current,e.next=4,r.serialize(!0);case 4:o=e.sent,a=o.title,i=o.body,r.editor.sensitiveWordStore.hide(),t.updateDocData(Ge({},t.page,{title:a,body:i})),n.setState({sensitiveChecking:!1,titleWarning:!1});case 10:case"end":return e.stop()}},e)})),n.checkSensitiveInfo=Ke(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l,u,p,f,d,m,y,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.store.doc,r=n.props.match.params.pageId,o=t.page.parentId||t.page.spaceId,a=n.editorRef.current){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,a.serialize(!0);case 8:if(i=e.sent,c=i.status,s=i.title,l=i.body,u=i.bodyText,p=i.extension,f=i.uploadingDOM,d=i.otherExtension,!c){e.next=21;break}return n.isSaving=!1,n.setMountingState({disabled:!1}),c===ke.a.STATUS.UPLOADING?(f.scrollIntoView(),h.a.error("\u4ecd\u6709\u5185\u5bb9\u5728\u4e0a\u4f20/\u5185\u5bb9\u4e0a\u4f20\u5931\u8d25\uff0c\u65e0\u6cd5\u4fdd\u5b58")):c===ke.a.STATUS.WASH&&h.a.error("\u5185\u5bb9\u4e2d\u6709\u5185\u5bb9\u9700\u8981\u6e05\u6d17\uff0c\u65e0\u6cd5\u4fdd\u5b58"),e.abrupt("return");case 21:return e.next=23,Object(Ae.b)(s,l,{cId:r,pId:o});case 23:(m=e.sent).hasSensitive?(m.title&&a.editor.sensitiveWordStore.setSensitiveTitle(m.titleHtml),a.editor.sensitiveWordStore.show(),n.setState({body:m.body,sensitiveChecking:!0,disabled:!1,titleWarning:m.title}),t.updateDocBody(m.body),n.isSaving=!1):(y=n.props.editor.rowNumExtension.rowNumStatus,b=t.draft.version,n.saveDoc({title:s,body:l,bodyText:u,extension:p,version:b,paragraphNumber:y?1:0,otherExtension:d}));case 25:case"end":return e.stop()}},e)})),n.freeLock=function(){n.props.store.doc.freeLock()},n.onBackConfirm=Ke(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l,u,p,f,m,h,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ze(n),r=t.freeLock,o=n.props.store.doc,a=n.editorRef.current,i=o.opsState,c=i.loadDraftState,s=i.loadPageState,l=n.state,u=l.notFound,p=l.hadDeleted,f=function(){n.isMount=!1,r(),window.history.back()},a){e.next=8;break}return e.abrupt("return",f());case 8:return e.next=10,a.serialize();case 10:if(m=e.sent,h=m.title,y=m.body,a.beforeUnmount(),!u&&!p&&o.perm.hasEditPerm){e.next=16;break}return e.abrupt("return",!1);case 16:if(c===et&&s===et&&(y!==o.draft.body||h!==o.draft.title)){e.next=18;break}return e.abrupt("return",f());case 18:d.a.warning({title:"\u786e\u5b9a\u79bb\u5f00\u6b64\u7f16\u8f91\u9875\u9762?",content:"\u786e\u5b9a\u540e\uff0c\u5c06\u79bb\u5f00\u9875\u9762\u5e76\u81ea\u52a8\u4fdd\u5b58\u8349\u7a3f\uff0c\u4e0b\u6b21\u7f16\u8f91\u65f6\u53ef\u4f7f\u7528\u6b64\u8349\u7a3f\u3002",onOk:function(e){r(),window.history.back(),e()},onCancel:function(){window.history.pushState("forward",null,"#")}});case 19:case"end":return e.stop()}},e)})),n.onBeforeUnload=function(e){var t=n.state,r=t.notFound,o=t.hadDeleted,a=n.props.store.doc;if(r||o||!a.perm.hasEditPerm||v.a.login!==window.localStorage.getItem("userId"))return!1;var i="\u7cfb\u7edf\u53ef\u80fd\u4e0d\u4f1a\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u66f4\u6539";return(e=e||window.event)&&(e.returnValue=i),i},n.setEditPageScrollTop=function(){var e=n.props.store.ui,t=document.getElementById("page-wrapper");e.editPageScrollTop=t.scrollTop},n.toViewPage=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.props.store,r=t.ui,o=t.sideBar,a=t.doc,i=a.page,c=n.editorRef.current;!e&&c&&c.beforeUnmount(),"workspace"===r.navBarActiveLink||r.isFromCollectCreate||(o.setShouldSetTree(!0),r.setShouldSetNavBarActiveLink(!0)),r.isFromCollectCreate&&(r.isCollectCreateOrEditBack=!0),e||n.freeLock(),n.setEditPageScrollTop(),i.parentId===Ie.q?Te.a.push("/space/".concat(i.spaceId)):Te.a.push(window.location.pathname),n.hadToViewPage=!0},n.toDraftPage=function(){Te.a.push(window.location.pathname.replace("page","draft"))},n.toReviewPage=function(e,t,r){var o=n.props.store.doc,a=n.descInputRef.current&&n.descInputRef.current.value;o.reviewInfo={docRes:e,editorRes:t,mergeRes:r,whatUpdate:a},Te.a.push(window.location.pathname.replace("page","review"))},n.handleKeyDownSave=function(e){if((83===e.which||83===e.keyCode)&&!e.shiftKey&&(e.metaKey||e.ctrlKey))if(e.preventDefault(),e.altKey||e.metaKey&&e.ctrlKey)n.onSave(),Object(g.a)(g.d["save-key"]);else{n.beforeSave(function(){return n.saveDraft()},!1),Object(g.a)(g.d["saveDraft-key"])}},n.onSave=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=n.props.store.ui;e.isEditPageToViewPage=!0,n.setMountingState({disabled:!0}),n.isSaving||(n.isSaving=!0,n.waitTimeout(),n.checkSensitiveInfo())},n.onCancel=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=function(){n.props.store.ui.isEditPageToViewPage=!0,clearTimeout(n.pollTimer),n.pollTimer=null,n.toViewPage()},r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e)return t();n.draftErrorCount<3||d.a.confirm({title:"\u8349\u7a3f\u4fdd\u5b58\u5931\u8d25\u63d0\u9192",content:i.a.createElement("div",null,i.a.createElement("p",null,"\u7f51\u7edc/\u670d\u52a1\u5f02\u5e38\uff0c\u65e0\u6cd5\u4fdd\u5b58\u8349\u7a3f\uff0c\u8bf7\u5728\u7f51\u7edc/\u670d\u52a1\u7a33\u5b9a\u540e\u91cd\u8bd5\uff0c\u5982\u70b9\u51fb\u53d6\u6d88\u7f16\u8f91\uff0c\u5219\u5c06\u4e22\u5931\u5f53\u524d\u672a\u4fdd\u5b58\u5185\u5bb9\u3002")),okText:"\u7ee7\u7eed\u7b49\u5f85",cancelText:"\u53d6\u6d88\u7f16\u8f91",onOk:function(e){e()},onCancel:function(){t()}})};e?t():n.saveDraft({isAuto:!0,onSuccess:t,onError:r})},n.waitTimeout=function(){n.waitTimer=setTimeout(function(){n.state.disabled&&n.isSaving&&n.isMount&&(h.a.error("\u4fdd\u5b58\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5"),n.setState({disabled:!1}),n.isSaving=!1)},5e4)},n.subscribeCancelEdit=function(){var e=Object(c.reaction)(function(){return n.props.store.doc.cancelEditTrigger},function(){return n.onCancel()});n.disposers.push(e)},n.handlePollError=function(e,t){var r=e.status;401!==r&&(n.pollErrorCount=n.pollErrorCount+1),618===r||801===r||802===r?h.a.error("\u60a8\u65e0\u6743\u7f16\u8f91\u6587\u6863\uff0c\u5982\u9700\u4fdd\u5b58\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb"):603===r?h.a.error("\u6587\u6863\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u4fdd\u5b58"):n.isDocSaving?401===r?d.a.expired(function(e){n.expiredCloseModal=e},function(e){n.expiredCloseTab=e}):h.a.error("\u4fdd\u5b58\u5931\u8d25\uff0c\u5185\u5bb9\u5df2\u4fdd\u5b58\u5728\u672c\u5730\uff0c\u8bf7\u5728\u7f51\u7edc/\u670d\u52a1\u7a33\u5b9a\u540e\u91cd\u8bd5\u3002\u8bf7\u52ff\u5173\u95ed/\u5237\u65b0\u672c\u9875\u9762\uff01\uff01"):(!t||n.draftErrorCount<3)&&(n.draftErrorCount++,h.a.error("\u8349\u7a3f\u4fdd\u5b58\u5931\u8d25\uff0c\u5185\u5bb9\u5df2\u4fdd\u5b58\u5728\u672c\u5730\uff0c\u8bf7\u5728\u7f51\u7edc/\u670d\u52a1\u7a33\u5b9a\u540e\u91cd\u8bd5\u3002\u8bf7\u52ff\u5173\u95ed/\u5237\u65b0\u672c\u9875\u9762\uff01\uff01")),n.isSaving=!1,n.checkCookieExpired(e),n.setMountingState({disabled:!1,networkError:!0}),n.addDocToLocal(),console.error(e)},n.handleSaveDraftError=function(e,t){var r=e.status,o=!1;618===r||802===r?(h.a.error("\u60a8\u65e0\u6743\u7f16\u8f91\u6587\u6863\uff0c\u5982\u9700\u4fdd\u5b58\u8349\u7a3f\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb"),o=!0):603===r?(h.a.error("\u6587\u6863\u5df2\u88ab\u5220\u9664"),o=!0):413===r?n.checkBase64Img():n.isDocSaving?401===r?d.a.expired(function(e){n.expiredCloseModal=e},function(e){n.expiredCloseTab=e}):h.a.error("\u4fdd\u5b58\u5931\u8d25\uff0c\u5185\u5bb9\u5df2\u4fdd\u5b58\u5728\u672c\u5730\uff0c\u8bf7\u5728\u7f51\u7edc/\u670d\u52a1\u7a33\u5b9a\u540e\u91cd\u8bd5\u3002\u8bf7\u52ff\u5173\u95ed/\u5237\u65b0\u672c\u9875\u9762\uff01\uff01"):!n.hadExpired&&n.draftErrorCount<3&&(n.draftErrorCount++,h.a.error("\u8349\u7a3f\u4fdd\u5b58\u5931\u8d25\uff0c\u5185\u5bb9\u5df2\u4fdd\u5b58\u5728\u672c\u5730\uff0c\u8bf7\u5728\u7f51\u7edc/\u670d\u52a1\u7a33\u5b9a\u540e\u91cd\u8bd5\u3002\u8bf7\u52ff\u5173\u95ed/\u5237\u65b0\u672c\u9875\u9762\uff01\uff01")),t(o),n.isSaving=!1,n.checkCookieExpired(e),n.setMountingState({disabled:!1,networkError:!0}),n.addDocToLocal(),console.error(e)},n.handleSaveError=function(e){var t=e.status;636!==t&&n.setMountingState({disabled:!1}),618===t?h.a.error("\u60a8\u65e0\u6743\u7f16\u8f91\u6587\u6863\uff0c\u5982\u9700\u4fdd\u5b58\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb"):636===t?n.handleConflict():603===t?h.a.error("\u6587\u6863\u5df2\u88ab\u5220\u9664"):413===t?n.checkBase64Img():401===t?d.a.expired(function(e){n.expiredCloseModal=e},function(e){n.expiredCloseTab=e}):(h.a.error("\u4fdd\u5b58\u5931\u8d25\uff0c\u5185\u5bb9\u5df2\u4fdd\u5b58\u5728\u672c\u5730\uff0c\u8bf7\u5728\u7f51\u7edc/\u670d\u52a1\u7a33\u5b9a\u540e\u91cd\u8bd5\u3002\u8bf7\u52ff\u5173\u95ed/\u5237\u65b0\u672c\u9875\u9762\uff01\uff01"),l.a.error("\u6587\u6863\u4fdd\u5b58\u5931\u8d25","\u6587\u6863\u4fdd\u5b58\u5931\u8d25,error:".concat(e&&e.toString()))),636!==t&&(n.isSaving=!1),n.setMountingState({networkError:!0}),n.checkCookieExpired(e),n.addDocToLocal(),console.error(e)},n.checkCookieExpired=function(e){e?(n.addDocToLocal(),401!==e.status||n.hadExpired||(n.hadExpired=!0,m.a.expired(n.notitionKey,function(e){n.expiredCloseTab=e}))):n.hadExpired&&(n.expiredCloseModal&&n.expiredCloseModal(),m.a.close(n.notitionKey),n.expiredCloseTab&&setTimeout(n.expiredCloseTab,4888),n.hadExpired=!1)},n.handleLoadPageError=function(e){switch(l.a.warn("editview failed to load, beacuse: ",e),e.status){case 619:n.handleNoPerm();break;case 601:n.handleNotFound();break;case 603:n.handleHadDeleted();break;default:n.toViewPage(!0),h.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u52a0\u8f7d\u5931\u8d25")}},n.handleNoPerm=function(){n.props.store.doc.updatePagePerm({hasReadPerm:!1,hasEditPerm:!1,hasAdmPerm:!1}),n.setMountingState({notFound:!1})},n.handleNotFound=function(){n.setMountingState({notFound:!0})},n.handleHadDeleted=function(){var e=n.props.store.sideBar;e.updateTreeDataByKey(e.pageId,"del"),n.setMountingState({hadDeleted:!0})},n.handleMessageReceive=function(e){document.origin===e.origin&&"login"===e.data&&n.checkCookieExpired()},n.handleConflict=Ke(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.store,r=t.doc,o=t.sideBar,a=t.user,i=o.spaceId,c=n.props.match.params.pageId,s=n.editorRef.current,clearTimeout(n.pollTimer),n.pollTimer=null,n.setState({draftText:"\u6b63\u4e0e\u7ebf\u4e0a\u4fdd\u5b58\u7684\u5185\u5bb9\u8fdb\u884c\u5408\u5e76\uff0c\u5982\u6587\u6863\u8f83\u5927\uff0c\u6240\u9700\u65f6\u95f4\u8f83\u957f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5019"}),!s){e.next=13;break}return e.next=10,s.serialize(!0);case 10:l=e.sent,u=r.draft.version>r.draftRes.v?r.draftRes.v:r.draft.version,Promise.all([r.loadDoc(i,c,Ie.h.EDIT,!1),r.loadDocVer(c,u,!1)]).then(function(e){var t=Xe(e,2),r=t[0],o=t[1];n.autoMerge(o,r,l).then(function(e){n.saveDoc(e)}).catch(function(e){a.checkUserInfo([r.modifier]).then(function(){n.toReviewPage(r,l,e)}).catch(function(){})})}).catch(function(){});case 13:case"end":return e.stop()}},e)})),n.autoMerge=function(e,t,n){var r=Se(e.body,t.body),o=Se(e.body,n.body);return n.body=Ee(r,o,e.body),n.version=t.version,Promise.resolve(n)},n.addDocToLocal=Ke(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.store.doc,r=n.props.match.params.pageId,e.next=4,n.isPageChanged();case 4:if(o=e.sent,a=o.isChanged,i=o.title,c=o.body,a){e.next=10;break}return e.abrupt("return");case 10:We.updateDoc(r,Ge({},t.draft,{title:i,body:c}));case 11:case"end":return e.stop()}},e)})),n.pollUpdateTitle=function(){var e=n.props.match.params.pageId;n.updateTitleTimer=setInterval(function(){var t=n.editorRef.current;if(t&&t.titleRef){var r=t.titleRef.value;if(r!==document.title.slice(3)){var o=n.props.store.doc;document.title="\u7f16\u8f91-".concat(r),o.updatePageTitle({pageId:e,title:r,activeId:e})}}},800)},n.handleHideQuickStart=function(){var e=n.editorRef.current;e&&(n.setState({showQuickStart:!1}),e.store.pm.focus())},n.handleEditorFocus=function(){var e=n.editorRef.current;e&&e.store.pm.focus()},n.handleShowQuickStart=function(){n.setState({showQuickStart:!0})},n.toggleQuickStart=function(){var e=document.getElementById("page-wrapper");if(!(n.retryTime>=ot))return e?void(e&&(n.mutationObserver=new MutationObserver(function(){var e=document.querySelector(".ProseMirror");if(e){var t=e.innerHTML.replace(/\sdata-diff-id=".*?"/g,"");"<p></p>"===t||"<p><br></p>"===t?n.state.showQuickStart||n.handleShowQuickStart():"<p></p>"!==t&&"<p><br></p>"!==t&&n.state.showQuickStart&&n.handleHideQuickStart()}}),n.mutationObserver.observe(e,{childList:!0,characterData:!0,attributes:!0,subtree:!0}))):(setTimeout(n.toggleQuickStart,1e3),void n.retryTime++)},n.applyTemplate=function(e,t){var r=t.replace(/&amp;originUrl=/g,"&amp;template=1&amp;originUrl=").replace(/&originUrl=/g,"&template=1&originUrl=").replace(/\?contentType=/g,"?template=1&contentType="),o=n.props.store.doc;"\u65e0\u6807\u9898"!==n.state.title&&""!==n.state.title||(o.page.title=e),o.page.body=r},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$e(e,t)}(t,Ne["a"]),n=t,(r=[{key:"componentWillMount",value:function(){var e=this.props.store,t=e.doc,n=e.sideBar,r=this.props.match.params.pageId;n.pageId!==r&&(n.setCurrent(null,r),t.setCurrentPageId(r)),t.draftChoice||(t.resetPage(),t.resetDraft())}},{key:"componentDidMount",value:function(){var e=this.props.store,t=e.ui,n=e.sideBar;this.isMount=!0,document.title="\u7f16\u8f91\u6587\u6863","workspace"!==t.navBarActiveLink&&(n.setShouldSetTree(!0),t.setShouldSetNavBarActiveLink(!0)),t.setSideBarVisible(!1),t.setNavBarVisible(!1),t.setIsInEditPage(!0),this.browserNotice(),this.setInit(),this.toggleQuickStart(),Object(g.e)("c_rvf9r3k1")}},{key:"componentWillUnmount",value:function(){this.isMount=!1;var e=this.props,t=e.store,n=t.ui,r=t.doc,o=e.editor.rowNumExtension;n.setSideBarVisible(!0),n.setNavBarVisible(!0),n.setIsInEditPage(!1),n.setWaterMarkOpacity(1),r.clearDraftInfo(),clearTimeout(this.pollTimer),this.pollTimer=null,clearInterval(this.updateTitleTimer),this.updateTitleTimer=null,m.a.close(this.notitionKey),this.disposers.forEach(function(e){return e()}),this.mutationObserver&&this.mutationObserver.disconnect(),xe.a.removeListener(Ce.k,this.handleNotFound),xe.a.removeListener(Ce.l,this.handleNoPerm),window.removeEventListener("popstate",this.onBackConfirm),window.removeEventListener("beforeunload",this.onBeforeUnload),window.removeEventListener("unload",this.freeLock),window.removeEventListener("message",this.handleMessageReceive),document.removeEventListener("keydown",this.handleKeyDownSave,!1),document.getElementById("page-wrapper").classList.remove("full-scroll"),document.getElementsByClassName("ct-main")[0].classList.remove("edit-mode"),o.hideRowNum()}},{key:"render",value:function(){var e=this,t=this.state,n=t.notFound,r=t.hadDeleted,o=t.draftText,a=t.disabled,c=t.showQuickStart,s=t.sensitiveChecking,l=t.titleWarning,d=this.props.store,m=d.doc,h=d.sideBar,v=m.page,g=v.title,w=v.body,j=v.secretLevel,O=-1===m.page.parentId,S=this.props.match.params.pageId,E=m.opsState;if(n)return i.a.createElement(u.default,{text:"\u8be5\u6587\u6863\u4e0d\u5b58\u5728"});if(r)return i.a.createElement(p.a,null);if(E.loadPageState===Ie.t.ERROR)return i.a.createElement(f.a,{pageId:S,showButton:!0,text:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"});if(E.loadPageState===Ie.t.PENDING||E.loadDraftState===Ie.t.PENDING)return i.a.createElement(y.a,{isLoading:!0});var P={url:{file:"".concat(Pe.h,"/").concat(this.props.match.params.pageId),image:"".concat(Pe.i,"/").concat(this.props.match.params.pageId),media:"".concat(Pe.j,"/").concat(this.props.match.params.pageId)},pageId:S,spaceId:h.spaceId,pageWrapperId:"page-wrapper",pageType:"edit",isTemplate:!1,sensitiveWord:{onClose:this.setSensitiveChecking,onSave:function(){return e.beforeSaveDoc(!0)}}};return i.a.createElement(De.a,{editorRef:this.editorRef,descInputRef:this.descInputRef,editorConfig:P,draftErrorCount:this.draftErrorCount,draftText:o,disabled:a,isSpacePage:O,pageId:S,title:g,body:w,secretLevel:j,onSave:function(){return e.onSave()},onCancel:function(){return e.onCancel()},fixedWidth:m.getDocType(),sensitiveChecking:s,titleWarning:l},c&&i.a.createElement(b.a,{hideQuickStart:this.handleHideQuickStart,applyTemplate:this.applyTemplate,editorFocus:this.handleEditorFocus,spaceId:h.spaceId,currentPageId:S}))}}])&&Ye(n.prototype,r),a&&Ye(n,a),t}())||Ve)||Ve},"../client/src/containers/EditPage/style.styl":function(e,t,n){},"../client/src/containers/EditPage/utils.js":function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return j});n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.promise.js"),n("./core-js/modules/es7.object.entries.js"),n("./core-js/modules/es6.array.sort.js"),n("./regenerator-runtime/runtime.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.string.iterator.js"),n("./core-js/modules/es6.set.js"),n("./core-js/modules/es7.array.includes.js"),n("./core-js/modules/es6.string.includes.js");var r=n("./react/index.js"),o=n.n(r),a=n("../client/src/utils/request.js"),i=n("../client/src/components/ui/modal/index.js"),c=n("./@mtfe/citadel-editor/es/utils/index.js");function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)})}}function p(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var f=[".ct-latex",".ct-html",".ct-markdown",".ct-code",".ct-link",".ct-status",".ct-attachment",".ct-image",".ct-data2chart",".ct-audio",".ct-video",".ct-metion"],d={},m=["annotation"],h=function(e,t){for(var n=document.createTreeWalker(e,-1),r=new Set,o=null,a=function(){var e=n.currentNode,a=function(e,t){return t.filter(function(t){return e.textContent.includes(t)})}(e,t);3===e.nodeType&&a.length>0&&m.every(function(t){return t!==e.parentNode.tagName})&&(o||(o=e.parentNode),a.forEach(function(e){r.add(e)}))};n.nextNode();)a();return[o,p(r.values())]},y=function(){var e=u(regeneratorRuntime.mark(function e(t,n,r){var c,l,u,p,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return",!1);case 2:return c=[],e.prev=3,e.next=6,Object(a.c)("/api/pages/sensitiveWord");case 6:c=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",!1);case 12:if(l=h(t,c),u=s(l,2),p=u[0],f=u[1],!p){e.next=16;break}return i.a.error({title:"\u654f\u611f\u5185\u5bb9\u4fdd\u5b58\u63d0\u793a",content:o.a.createElement("p",null,"\u60a8\u7684\u5185\u5bb9\u4e2d\u6709\u654f\u611f\u5185\u5bb9\uff0c\u6839\u636e",o.a.createElement("a",{href:"https://km.sankuai.com/page/64383929"},"Wiki\u5b89\u5168\u7ba1\u7406\u89c4\u8303"),"\uff0c\u7981\u6b62\u5728KM/Wiki\u5b58\u50a8\u8d26\u6237\u5bc6\u7801\u4fe1\u606f\uff0c\u8bf7\u6ce8\u610f\u81ea\u67e5\u3002\u5982\u786e\u8ba4\u65e0\u95ee\u9898\uff0c\u8bf7\u7ee7\u7eed\u4fdd\u5b58"," ",o.a.createElement("br",null),"\u654f\u611f\u5185\u5bb9\uff1a",f.join("\uff0c")),okText:"\u6211\u8981\u81ea\u67e5",cancelText:"\u7ee7\u7eed\u4fdd\u5b58",onOk:function(e){p.scrollIntoView(),e()},onCancel:function(){r()}}),e.abrupt("return",!0);case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,null,[[3,9]])}));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(e,t){return function(n,r){var o=n,a=e.length+t.length;return r&&r.forEach(function(n,r){var i=o.substring(0,r*a+n.startPosition),c=o.substring(r*a+n.endPosition,o.length);o="".concat(i).concat(e).concat(n.matchedStr).concat(t).concat(c)}),o}},v=function(e){var t=e,n=document.createElement("div");return n.innerHTML=t,f.forEach(function(e){n.querySelectorAll(e).forEach(function(e){var t="S_".concat(Object(c.J)());d["".concat(t)]=e;var n=document.createElement("span");n.id=t,e.replaceWith(n)})}),n.innerHTML},g=function(e,t){var n=t.param,r=void 0===n?"startPosition":n,o=t.direction,a="desc"===(void 0===o?"decs":o)?1:-1;e.sort(function(e,t){return e[r]<t[r]?a:e[r]>t[r]?-a:0})},w=function(e){var t=e,n=document.createElement("div");n.innerHTML=t;for(var r=0,o=Object.entries(d);r<o.length;r++){var a=s(o[r],2),i=a[0],c=a[1],l=n.querySelector("#".concat(i));l&&l.replaceWith(c),delete d["".concat(i)]}return n.innerHTML},j=function(){var e=u(regeneratorRuntime.mark(function e(t,n,r){var o,i,c,s,l,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.cId,i=void 0===o?0:o,c=r.pId,s=void 0===c?0:c,l=parseInt(i),f=parseInt(s),d=v(n),e.abrupt("return",new Promise(function(){var e=u(regeneratorRuntime.mark(function e(n,r){var o,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={strInfoVOList:[{strType:"title",strContent:t},{strType:"bodyContent",strContent:d}],contentId:l,parentId:f},e.prev=1,e.next=4,Object(a.b)("/api/pages/sensitiveInfo",o);case 4:return i=e.sent,c=i.strSenInfoList,s={hasSensitive:!1},c&&c.forEach(function(e){"title"===e.strType&&e.positionInfoList.length>0?(s.title=!0,s.titleHtml=b('<span style="background:#FEF1CA">',"</span>")(t,e.positionInfoList),s.hasSensitive=!0):"bodyContent"===e.strType&&e.positionInfoList.length>0?(s.body=p(e.positionInfoList),s.hasSensitive=!0):s.body=[]}),s.hasSensitive&&(g(s.body,{param:"startPosition",direction:"decs"}),s.body=b('<span data-type="sensitive">',"</span>")(d,s.body)),s.body=w(s.body),e.abrupt("return",n(s));case 13:return e.prev=13,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",r(e.t0));case 17:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t,n){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}()},"../client/src/containers/ManagePage/PermSetting/MailPermSetting/style.styl":function(e,t,n){},"../client/src/containers/ManagePage/PermSetting/OtherPermSetting/style.styl":function(e,t,n){},"../client/src/containers/ManagePage/component/guide/style.styl":function(e,t,n){},"../client/src/containers/ManagePage/const.js":function(e,t,n){"use strict";var r;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"e",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return u}),n.d(t,"c",function(){return p}),n.d(t,"f",function(){return f});var a={ORG:"org",USER:"user",OTHER:"other",MAIL:"mail"},i="LIMIT",c="EXCEPT",s="INHERIT",l={0:i,1:c,2:s},u=(o(r={},i,0),o(r,c,1),o(r,s,2),r),p=1,f={ADD:0,UPDATE:1,DELETE:2}},"../client/src/containers/ManagePage/index.js":function(e,t,n){"use strict";n.r(t);n("./core-js/modules/es7.object.get-own-property-descriptors.js"),n("./core-js/modules/es6.object.keys.js"),n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./core-js/modules/es6.regexp.match.js"),n("./core-js/modules/es6.reflect.own-keys.js"),n("./antd/lib/button/style/index.js");var r=n("./antd/lib/button/index.js"),o=n.n(r),a=(n("./core-js/modules/es6.function.name.js"),n("./core-js/modules/es6.array.find-index.js"),n("./core-js/modules/es7.array.includes.js"),n("./core-js/modules/es6.string.includes.js"),n("./core-js/modules/es6.promise.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.string.iterator.js"),n("./regenerator-runtime/runtime.js"),n("./react/index.js")),i=n.n(a),c=n("./mobx-react/index.module.js"),s=n("../client/src/components/DocOps/index.js"),l=n("../client/src/utils/userInfo.js"),u=n("../client/src/components/Toastr/index.js"),p=n("../client/src/components/CrumbsNavBar/index.js"),f=n("../client/src/components/CommonUI/Loading/index.js"),d=n("../client/src/components/CommonUI/NotFound/index.js"),m=n("../client/src/components/CommonUI/NoPerm/index.js"),h=n("../client/src/components/CommonUI/Deleted/index.js"),y=n("../client/src/components/ui/modal/index.js"),b=n("../client/src/components/CommonUI/NetWorkError/index.js"),v=n("../client/src/utils/tools.js"),g=n("../client/src/utils/element.js"),w=n("../client/src/utils/config.js"),j=n("../client/src/components/Modal/GuideModal/index.js"),O=n("../client/src/assets/img/guide/perm/1.png"),S=n.n(O),E=n("../client/src/assets/img/guide/perm/2.png"),P=n.n(E),k=n("../client/src/assets/img/guide/perm/3.png"),x=n.n(k),C=n("../client/src/assets/img/guide/perm/4.png"),T=n.n(C),I=n("../client/src/utils/report/lx.js"),A=n("../client/src/utils/report/lxConfig.js");n("../client/src/containers/ManagePage/component/guide/style.styl");function D(e){return(D="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t){return!t||"object"!==D(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var B=[{image:S.a,title:"\u6743\u9650\u7ba1\u7406",description:"\u6743\u9650\u9875\u9762\u4e2d\u7684\u90e8\u95e8 + \u4e2a\u4eba\uff0c\u5c31\u662f\u62e5\u6709\u8be5\u6587\u6863\u6743\u9650\u7684\u7528\u6237"},{image:P.a,title:"\u7ee7\u627f\u6743\u9650",description:"\u6587\u6863\u6743\u9650\u201c\u7ee7\u627f\u201d\u7236\u6587\u6863\u6743\u9650\uff0c\u4e14\u540c\u6b65\u7236\u6587\u6863\u6743\u9650"},{image:x.a,title:"\u65b0\u589e\u6743\u9650",description:"\u65b0\u589e\u5176\u4ed6\u6743\u9650\uff0c\u4e0d\u4f1a\u6539\u53d8\u5df2\u6709\u7684\u7ee7\u627f\u6743\u9650"},{image:T.a,title:"\u4fee\u6539 / \u5220\u9664\u6743\u9650",description:"\u4fee\u6539 / \u5220\u9664\u4efb\u4f55\u4e00\u9879\u7ee7\u627f\u6743\u9650\uff0c\u5f53\u524d\u6587\u6863\u4e0d\u518d\u7ee7\u627f\u7236\u6587\u6863\u6743\u9650"}],R="doc-perm-guide-",V=["".concat(R,"first"),"".concat(R,"second"),"".concat(R,"third"),"".concat(R,"fourth")],H=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=M(this,(e=_(t)).call.apply(e,[this].concat(o)))).report=function(e){n.modal&&n.modal.state.visible&&Object(I.a)(A.a[V[e]])},n.renderBottomTip=function(e,t){return e===t.length-1?i.a.createElement("span",{className:"more-info"},"\u5982\u9700\u4e86\u89e3\u66f4\u591a\u6743\u9650\u76f8\u5173\u95ee\u9898\uff0c\u8bf7\u67e5\u9605",i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:w.a.citadelPermHelper},"\u5b66\u57ce\u6743\u9650\u8bf4\u660e")):""},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e=this;return i.a.createElement(j.a,{showDot:!0,delay:100,onPageChange:this.report,showIcon:!1,className:"guide-perm-modal",localStorageKey:"guide-perm-modal",stepList:B,ref:function(t){e.modal=t}})}}])&&N(n.prototype,r),o&&N(n,o),t}(),z=(n("./core-js/modules/es6.object.assign.js"),n("../client/src/components/List/TableList/index.js")),W=n("../client/src/consts/index.js"),F=n("../client/src/components/Select/utils/index.js"),U=n("../client/src/components/Pop/PopNameCard/index.js"),K=n("../client/src/stores/index.js"),q=n("../client/src/containers/ManageSpace/PermSetting/utils.js"),G=n("../client/src/containers/ManagePage/const.js"),Q=n("../client/src/containers/ManageSpace/PermSetting/consts.js");function X(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Y(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){X(a,r,o,i,c,"next",e)}function c(e){X(a,r,o,i,c,"throw",e)}i(void 0)})}}function J(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Z(e){return(Z="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(n,!0).forEach(function(t){te(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=G.e.ORG,re=G.e.USER,oe=G.e.OTHER,ae=G.e.MAIL,ie=function(e){return e.filter(function(e){return!e.isNew})},ce=function(){return i.a.createElement("span",{className:"inherit-tag",key:"tag"},"\u7ee7\u627f")},se=function(e){var t=e.data,n=e.handleDelete,r=e.handleOption,o=e.clsName,a=e.disabled;return t.isNew?Object(q.c)({data:t,handleOption:r}):a?"":Object(q.d)({data:t,handleDelete:n,clsName:o})},le=function(e,t){if(e&&!e.isNew){var n={};switch(n.tenantId=e.tenantId||l.a.tenantId,n.permGroupType=function(e){switch(e){case"visit":return 0;case"delete":return 1;case"edit":return 2;case"add":return 3;case"manage":return 4;default:return 0}}(e.permGroupType),e.permId&&(n.permId=e.permId),t){case ne:n.orgId=+e.orgId,n.orgRoles=e.orgRoles,n.permMainBodyType=Q.b;break;case re:n.permMainBody=e.permMainBody.toString(),n.permMainBodyType=Q.d;break;case oe:n.permMainBody=e.permMainBody.toString(),n.permMainBodyType=Q.c;break;case ae:n.permMainBody=e.permMainBody.toString(),n.permMainBodyType=Q.a}return n}},ue=function(e,t,n){var r=ee({},e,{key:e.permId,name:e.permMainBody,permGroupType:Object(q.f)(e.permGroupType)});switch(t){case ne:r=ee({},r,{orgId:+e.orgId,fullName:e.orgFullName,name:e.orgName,orgRoles:e.orgRoles||[]});break;case oe:r=ee({},r,{fullName:e.orgFullName,name:n[+e.permMainBody]});break;case ae:r=ee({},r,{name:"".concat(e.emailName,"<").concat(e.permMainBody,">")})}return r},pe=function(e,t,n){return Array.isArray(e)?e.map(function(e){return ue(e,t,n)}):"object"===Z(e)?ue(e,t,n):void 0},fe=function(e,t){var n=t.orgTree.otherAccount,r=[],o=[],a=[],i=[];return(e&&e.dataList||[]).forEach(function(e){var t=e.permMainBodyType;t===Q.b?r.push(pe(e,ne)):t===Q.d?o.push(pe(e,re)):t===Q.c?a.push(pe(e,oe,n)):t===Q.a&&i.push(pe(e,ae))}),[r,o,a,i]},de=function(e,t){var n=t.sideBar,r=t.user.userInfos;return Array.isArray(e)||(e=[e]),e.map(function(e){var t=r.get(e);return t?i.a.createElement(U.a,{sideBar:n,userInfo:t},i.a.createElement("span",{className:"mention-wrapper"},i.a.createElement("span",null,"@"),i.a.createElement("span",null,t.name))):""})},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object.assign.apply(Object,[{}].concat(J(e)));return t.dataList=[],t.count=0,t.setPermCount=0,e.forEach(function(e){var n,r=e.permissionUnitVOS,o=e.count,a=void 0===o?0:o,i=e.setPermCount,c=void 0===i?0:i;r||(r=[]),(n=t.dataList).push.apply(n,J(r)),t.count+=a,t.setPermCount+=c}),t},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length)return Promise.resolve([]);var t=K.b.permission.doDocPermAdd,n=e.shift();return new Promise(function(){var r=Y(regeneratorRuntime.mark(function r(o,a){var i,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t(n.contentId,n.params);case 3:if(i=r.sent,c=[],!e.length){r.next=9;break}return r.next=8,Promise.all(e.map(function(e){var n=e.params,r=e.contentId;return t(r,n)}));case 8:c=r.sent;case 9:o([i].concat(J(c))),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(0),a(r.t0);case 15:case"end":return r.stop()}},r,null,[[0,12]])}));return function(e,t){return r.apply(this,arguments)}}())},ye=(n("./antd/lib/tooltip/style/index.js"),n("./antd/lib/tooltip/index.js")),be=n.n(ye),ve=n("../client/src/components/Select/OrgMultiSelect/index.js"),ge=n("../client/src/containers/ManageSpace/container/OrgRoleSelect/index.js");function we(e){return(we="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(){return(je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Se(e,t){return!t||"object"!==we(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ke,xe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Se(this,Ee(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",je({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18"},this.props),i.a.createElement("defs",null,i.a.createElement("style",null)),i.a.createElement("path",{d:"M64 512a448 448 0 1 1 896 0 448 448 0 0 1-896 0zm448-296.83a66.99 66.99 0 0 0-67.2 67v270.85c0 36.55 30.08 67.01 67.2 67.01a66.95 66.95 0 0 0 67.2-67V282.23c0-36.48-30.08-67-67.2-67zm0 593.6a67.2 67.2 0 1 0 0-134.4 67.2 67.2 0 0 0 0 134.4z",fill:"#F05E50"}))}}])&&Oe(n.prototype,r),o&&Oe(n,o),t}(),Ce={permMainBodyType:Q.b},Te=function(e){var t=!1;return e.isAdmPerm||(t=!0),t},Ie=function(e){var t=e.handleCheck,n=e.handleDelete,r=e.handleOption,o=e.sideBar,a=e.contentId,c=e.handleOrgRoles,s=e.isAdmPerm,l=e.handleSelectedItem,u=e.getOrgRolesStr;return[{title:"\u7ec4\u7ec7\u540d\u79f0",dataIndex:"name",className:"name",width:290,render:function(e,t){var n=t.fullName,r=t.isNew,o=t.permTargetId;return r?i.a.createElement("span",null,i.a.createElement(ve.a,{handleSelectedItem:l,data:t,popupContainer:function(){return document.getElementById("pagePerm")}})):[i.a.createElement(be.a,{key:"tip",title:n,overlayClassName:"space-manage-pop-card",placement:"right",trigger:"hover",mouseEnterDelay:.6},i.a.createElement("div",{className:"text-ov-wrapper"},Object(v.n)(n))),a!==o?ce():"",i.a.createElement("span",{className:"name-text_safe"},i.a.createElement(xe,null),"\u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u6b64\u6743\u9650\u4e0d\u5bf9C4\u6587\u6863\u751f\u6548")]}},{title:"\u804c\u4f4d",dataIndex:"jobFamily",className:"job-family",width:290,render:function(e,t){var n,r=u(t.orgRoles);return n=Te({data:t,isAdmPerm:s})?r:i.a.createElement(ge.a,{data:t,handleOrgRoles:c,isAdmPerm:s,popupContainer:document.getElementById("orgPerm")}),i.a.createElement(be.a,{title:r,placement:"right"},n)}},{title:q.k,dataIndex:"permission",className:"permission",width:190,render:function(e,n){return i.a.createElement("div",{style:{width:"100%",verticalAlign:"middle"}},function(e){var t=e.data,n=e.handleCheck,r=e.isAdmPerm,o=t.permGroupType;return Te({data:t,isAdmPerm:r})?q.j[o]:i.a.createElement(q.a,{value:o,onChange:function(e){return n(t,e)},popupContainer:function(){return document.getElementById("otherPerm")},visible:t.isNew||!1})}({data:n,handleCheck:t,isAdmPerm:s}))}},{key:"operation",dataIndex:"operation",className:"operation",width:190,render:function(e,t){var a=Te({data:t,isAdmPerm:s}),i=t.isDeleting?"delete-loading":"";return se({data:t,handleDelete:n,handleOption:r,sideBar:o,disabled:a,clsName:i})}}]},Ae=n("../client/src/assets/svg/add.svg");function De(e){return(De="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(n,!0).forEach(function(t){Le(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Be(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var We,Fe=Object(c.inject)("store")(ke=Object(c.observer)(ke=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Ve(t).call(this,e),(n=!o||"object"!==De(o)&&"function"!==typeof o?He(r):o).handleDelete=function(e){if(e.key&&!e.isDeleting){var t=n.props.permData,r=n.props.store.permission.doDocPermDelete,o=t.findIndex(function(t){return t.key===e.key}),a=Object.assign({},Object(q.g)(e.permGroupType)),i=n.dealDeleteOrCheckOrg(e,a);n.props.checkShouldAddInherit(function(){t[o].isDeleting=!0,n.props.updateData(t),r(n.props.contentId,i).then(function(){t.splice(o,1),n.props.updateData(t),u.a.success("\u6743\u9650\u5220\u9664\u6210\u529f")}).catch(function(e){t[o].isDeleting=!1,n.props.updateData(t),u.a.error(e.message)})},function(){return[]},e)}},n.handleOrgRoles=function(e){var t=Be(n.props.permData),r=e.type,o=e.data,a=e.originData,i=t.findIndex(function(e){return e.key===a.key});if("new"===r)t[i].orgRoles=o,n.props.updateData(t);else if("change"===r&&t[i].orgRoles&&t[i].orgRoles.join()!==o.join()){n.props.checkShouldAddInherit(function(){return n.dealUpDateOrgRoles(e,i)},function(){return[n.getOrgReqParams(o,a)]},a)}},n.dealUpDateOrgRoles=function(e,t){var r=n.props,o=r.contentId,a=r.store,i=r.permData,c=a.permission,s=e.data,l=e.originData,p=n.getOrgReqParams(s,l);return c.doUpdateDocOrgRoles(o,p).then(function(){i[t].orgRoles=s,n.props.updateData(i),u.a.success("\u6743\u9650\u4fee\u6539\u6210\u529f")}).catch(function(e){return u.a.error(e.message)})},n.getOrgReqParams=function(e,t){return _e({},Object(q.g)(t.permGroupType),{},Ce,{orgId:t.orgId,tenantId:t.tenantId,permId:t.permId,orgRoles:e||[]})},n.handleCheck=function(e,t){var r=e.key,o=e.isNew;if(r){var a=n.props.permData,i=a.findIndex(function(e){return e.key===r});if(o)return n.newSetPerm(t,a,i);var c=Object.assign({},Object(q.g)(t)),s=n.props.store.permission.doDocPermCheck,l=n.dealDeleteOrCheckOrg(e,c);n.props.checkShouldAddInherit(function(){s(n.props.contentId,l).then(function(){a[i].permGroupType=t,n.props.updateData(a),u.a.success("\u6743\u9650\u4fee\u6539\u6210\u529f")}).catch(function(e){return u.a.error(e.message)})},function(){return[l]},e)}},n.newSetPerm=function(e,t,r){t[r].permGroupType=e,n.props.updateData(t)},n.dealDeleteOrCheckOrg=function(e,t){var n=e.permId,r=e.tenantId,o=e.orgId,a=e.orgRoles;return _e({},t,{},Ce,{permId:n,orgRoles:a,tenantId:r,orgId:o})},n.newAdd=function(e){var t=e.data,r=Be(n.props.permData),o=n.props.permData.findIndex(function(e){return e.key===t.key});if(0===t.selectedItems.length)return r[o].isEmpty=!0,n.props.updateData(r),u.a.error("\u8bf7\u5b8c\u5584\u5fc5\u8981\u4fe1\u606f");var a=Object.assign({},Object(q.g)(t.permGroupType));n.handleOrgAdd(t,a,o)},n.handleOrgAdd=function(){var e,t=(e=regeneratorRuntime.mark(function e(t,r,o){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isSaving){e.next=2;break}return e.abrupt("return");case 2:return n.isSaving=!0,e.prev=3,e.next=6,n.getReqArr(r,t);case 6:if(a=e.sent,u.a.success("\u6743\u9650\u65b0\u589e\u6210\u529f"),!n.props.refresh()){e.next=10;break}return e.abrupt("return");case 10:n.isSaving=!1,n.afterAddData({data:t,idx:o,permIds:a}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),n.isSaving=!1,Object(v.u)(e.t0);case 18:case"end":return e.stop()}},e,null,[[3,14]])}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Ne(a,r,o,i,c,"next",e)}function c(e){Ne(a,r,o,i,c,"throw",e)}i(void 0)})});return function(e,n,r){return t.apply(this,arguments)}}(),n.getReqArr=function(e,t){var r=n.props.contentId;return he(t.selectedItems.map(function(n){return{params:_e({},e,{},Ce,{tenantId:l.a.tenantId,orgId:n.key.toString(),orgRoles:t.orgRoles||[]}),contentId:r}}))},n.afterAddData=function(e){var t=e.data,r=e.idx,o=e.permIds,a=Be(n.props.permData),i=n.formatAddData(t,o);r||(r=0),a.splice(r,1),a.unshift.apply(a,Be(i)),n.props.updateData(a)},n.formatAddData=function(e,t){return e.selectedItems.map(function(r,o){return{key:t[o],fullName:r.fullName,name:r.text,orgId:+r.key,permGroupType:e.permGroupType,orgRoles:e.orgRoles||[],tenantId:r.tenantId||l.a.tenantId,permId:t[o],permTargetId:n.props.contentId}})},n.addLine=function(){n.props.checkAdd(function(){var e=Be(n.props.permData),t=Object(q.e)({orgId:+Math.random(),orgRoles:[]});e.unshift(t),n.props.updateData(e)})},n.handleOption=function(e,t){if("add"===e)n.newAdd({data:t});else{var r=Be(n.props.permData),o=r.findIndex(function(e){return e.key===t.key});r.splice(o,1),n.props.updateData(r)}},n.handleSelectedItem=function(e){var t=n.props.permData;(t=Object(F.a)(n.props.permData,e))&&n.props.updateData(t)},n.rowClassInfo=function(e){var t=n.props.store.doc.page;return 2===e.orgId&&0===e.orgRoles.length&&t.secretLevel>3?"invalid-perm":""},n.renderList=function(){var e=He(n),t=e.handleNew,r=e.handleCheck,o=e.handleDelete,a=e.handleOption,c=e.handleSelectedItem,s=e.handleOrgRoles,l=n.props,u=l.isAdmPerm,p=l.store,f=l.permData,d=l.contentId,m=p.sideBar,h=p.orgTree.getOrgRolesStr,y=Ie({handleNew:t,handleCheck:r,handleDelete:o,handleOption:a,permData:f,handleSelectedItem:c,handleOrgRoles:s,isAdmPerm:u,getOrgRolesStr:h,sideBar:m,contentId:d});return i.a.createElement("div",{className:"perm-setting-body",id:"orgPerm"},i.a.createElement("nav",{className:"perm-setting-nav"},i.a.createElement("div",{className:"label"},"\u90e8\u95e8\u6743\u9650"),u&&i.a.createElement("button",{className:"add-perm-btn",onClick:function(){return n.addLine()}},i.a.createElement(Ae.a,null)," \u65b0\u589e")),i.a.createElement(z.a,{prefixCls:"perm-setting",isPageContent:!1,columns:y,dataSource:f,locale:{emptyText:"\u6ca1\u6709\u90e8\u95e8\u6709\u6b64\u6587\u6863\u7684\u6743\u9650"},rowClassName:n.rowClassInfo}))},n.state={opsState:W.t.PENDING},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentWillMount",value:function(){var e=this;this.props.store.orgTree.getJobFamily().then(function(){e.setState({opsState:W.t.DONE})}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return i.a.createElement("div",null," ",this.renderList()," ")}}])&&Re(n.prototype,r),o&&Re(n,o),t}())||ke)||ke,Ue=n("./lodash.chunk/index.js"),Ke=n.n(Ue),qe=n("./@mtfe/brant-pagination/lib/index.js"),Ge=n.n(qe),Qe={permMainBodyType:Q.d},Xe=function(e){var t=e.isAdmPerm,n=e.user,r=e.data,o=e.isSpaceAdm,a=e.permGroupType,i=!1;return t?r.permFrom&&(i=!0):i=!0,t&&n&&n.userInfo.account===r.name&&!n.hasRootPerm&&!o&&(i=!0,a="manage"),{disabled:i,value:a}},Ye=function(e){var t=e.handleCheck,n=e.handleDelete,r=e.sideBar,o=e.user,a=e.isSpaceAdm,c=e.allUserPerm,s=e.handleOption,l=e.isAdmPerm,u=e.handleSelectedItem,p=e.contentId;return[{title:"\u7528\u6237\u540d",dataIndex:"name",className:"name",width:290,render:function(e,t){var n=t.userInfo,o=t.isNew,a=t.permTargetId;if(o)return i.a.createElement(ve.b,{existedData:c.filter(function(e){return e.permTargetId===p}),repeatTipTxt:function(e){return"".concat(e,"\u5df2\u6709\u6743\u9650\uff0c\u5982\u9700\u53d8\u66f4\uff0c\u8bf7\u76f4\u63a5\u4fee\u6539")},popupContainer:function(){return document.getElementById("pagePerm")},handleSelectedItem:u,data:t});if(!n)return e;var s=p!==a,l=n.jobStatusId===W.g.OUTJOB,f={};return s&&l&&(f.maxWidth="calc(100% - 70px)"),o?void 0:[i.a.createElement(U.a,{sideBar:r,userInfo:n},i.a.createElement("div",{className:"text-ov-wrapper",style:f},n.name,"(",n.account,")")),i.a.createElement("span",{style:{verticalAlign:"middle"}},l?"(\u79bb\u804c)":""),s?ce():""]}},{title:"\u6240\u5c5e\u90e8\u95e8",className:"org",dataIndex:"org",width:290,render:function(e,t){var n=t.isNew,r=t.userInfo;if(!n)return i.a.createElement("div",{className:"user-org"},i.a.createElement(be.a,{title:r&&Object(v.c)(r.orgNamePath,r.account),overlayClassName:"space-manage-pop-card",placement:"right",trigger:"hover"},r&&Object(v.c)(Object(v.n)(r.orgNamePath),r.account)))}},{title:q.k,dataIndex:"permission",className:"permission",width:190,render:function(e,n){return i.a.createElement("div",{style:{width:"100%",verticalAlign:"middle"}},function(e){var t=e.data,n=e.handleCheck,r=e.isAdmPerm,o=e.isSpaceAdm,a=e.user,c=t.permGroupType,s=Xe({isAdmPerm:r,user:a,data:t,isSpaceAdm:o,permGroupType:c}),l=s.value;return s.disabled?q.j[l]:i.a.createElement(q.a,{value:l,onChange:function(e){return n(t,e)},popupContainer:function(){return document.getElementById("otherPerm")},visible:t.isNew||!1})}({data:n,handleCheck:t,isAdmPerm:l,isSpaceAdm:a,user:o}))}},{key:"operation",dataIndex:"operation",className:"operation",width:190,render:function(e,t){var i=Xe({isAdmPerm:l,user:o,data:t,isSpaceAdm:a}).disabled,c=t.isDeleting?"delete-loading":"";return se({data:t,handleDelete:n,handleOption:s,sideBar:r,disabled:i,clsName:c})}}]};function Je(e){return(Je="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(n,!0).forEach(function(t){et(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function nt(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function rt(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){nt(a,r,o,i,c,"next",e)}function c(e){nt(a,r,o,i,c,"throw",e)}i(void 0)})}}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var st,lt=Object(c.inject)("store")(We=Object(c.observer)(We=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return r=this,o=(e=at(t)).call.apply(e,[this].concat(c)),(n=!o||"object"!==Je(o)&&"function"!==typeof o?it(r):o).isSaving=!1,n.state={opsState:W.t.DONE,selectModalVisible:!1},n.getAllUserPerm=rt(regeneratorRuntime.mark(function e(){var t,r,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={permMainBodyType:Q.d},r=n.props.store.permission.getDocPermList,e.prev=2,e.next=5,r(n.props.contentId,t);case 5:o=e.sent,a=o.permissionUnitVOS,(i=a||[]).length&&i.forEach(function(e){e.key=e.permMainBody}),n.setState({allUserPerm:i}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0);case 15:case"end":return e.stop()}},e,null,[[2,12]])})),n.dealAllUserPerm=function(e,t){var r=n.state.allUserPerm;if("delete"===t){var o=r.findIndex(function(t){return t.key===e});r.splice(o,1)}else"add"===t&&e.selectedItems.forEach(function(e){e.permTargetId=n.props.contentId,r.push(e)});n.setState({allUserPerm:r})},n.handleCheck=function(e,t){var r=e.key,o=e.isNew;if(r){var a=n.props.permData,i=a.findIndex(function(e){return e.key===r});if(o)return n.newSetPerm(t,a,i);var c=Object.assign({},Object(q.g)(t)),s=n.props.store.permission.doDocPermCheck,l=n.dealDeleteOrCheckUser(e,c);n.props.checkShouldAddInherit(function(){return s(n.props.contentId,l).then(function(){a[i].permGroupType=t,n.props.updateData(a),u.a.success("\u6743\u9650\u4fee\u6539\u6210\u529f")}).catch(function(e){return u.a.error(e.message)})},function(){return[l]},e)}},n.newSetPerm=function(e,t,r){t[r].permGroupType=e,n.props.updateData(t)},n.handleDelete=function(e){if(e.key&&!e.isDeleting){var t=tt(n.props.permData),r=t.findIndex(function(t){return t.key===e.key}),o=Object.assign({},Object(q.g)(e.permGroupType)),a=n.props.store.permission.doDocPermDelete,i=n.dealDeleteOrCheckUser(e,o);n.props.checkShouldAddInherit(function(){t[r].isDeleting=!0,n.props.updateData(t),a(n.props.contentId,i).then(function(){var o=n.props,a=o.pageNo,i=o.onPageChange,c=o.totalCount;1===t.length&&c>1?i(a>1?a-1:a):(t.splice(r,1),n.props.updateData(t),n.dealAllUserPerm(e.permMainBody,"delete")),u.a.success("\u6743\u9650\u5220\u9664\u6210\u529f")}).catch(function(e){t[r].isDeleting=!1,n.props.updateData(t),u.a.error(e.message)})},function(){return[]},e)}},n.dealDeleteOrCheckUser=function(e,t){var r=n.props.store.user,o=e.permId,a=e.tenantId,i=e.key,c=e.permMainBody,s=r.userInfos.get(i.toString());return $e({},t,{},Qe,{permId:o,tenantId:a,newPermMainBody:s&&s.empId,permMainBody:c.toString()})},n.newAdd=function(e){var t=e.data,r=n.props.permData,o=r.findIndex(function(e){return e.key===t.key});if(!n.isSaving)return 0===t.selectedItems.length?(r[o].isEmpty=!0,n.props.updateData(r),u.a.error("\u8bf7\u5b8c\u5584\u5fc5\u8981\u4fe1\u606f")):void(t.selectedItems.length>10?n.dealMultiAdd(t):n.dealAdd(t,o))},n.dealMultiAdd=function(){var e=rt(regeneratorRuntime.mark(function e(t){var r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ke()(t.selectedItems,100),e.prev=1,n.isSaving=!0,o=r.map(function(e){return e.map(function(e){return n.getAddParam(e,t.permGroupType)})}),a=o.map(function(e){return n.props.handleBatchAdd({inheritParam:function(){return e}})}),e.next=7,Promise.all(a);case 7:n.isSaving=!1,u.a.success("\u6743\u9650\u65b0\u589e\u6210\u529f"),n.getAllUserPerm(),n.props.refresh(!0),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),n.isSaving=!1,Object(v.u)(e.t0);case 17:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t){return e.apply(this,arguments)}}(),n.dealAdd=function(){var e=rt(regeneratorRuntime.mark(function e(t,r){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.isSaving=!0,e.next=4,n.getReqArr(t);case 4:if(o=e.sent,u.a.success("\u6743\u9650\u65b0\u589e\u6210\u529f"),!n.props.refresh()){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.afterAddData({data:t,idx:r,permIds:o});case 10:n.isSaving=!1,n.dealAllUserPerm(t,"add"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),n.isSaving=!1,Object(v.u)(e.t0);case 18:case"end":return e.stop()}},e,null,[[0,14]])}));return function(t,n){return e.apply(this,arguments)}}(),n.getReqArr=function(e){var t=n.props.contentId;return he(e.selectedItems.map(function(r){return{params:n.getAddParam(r,e.permGroupType),contentId:t}}))},n.getAddParam=function(e,t){var r=n.props.store.user,o=Object.assign({},Object(q.g)(t)),a=r.userInfos.get(e.key);return $e({},o,{},Qe,{permMainBody:e.key,newPermMainBody:a.empId,tenantId:l.a.tenantId})},n.afterAddData=function(){var e=rt(regeneratorRuntime.mark(function e(t){var r,o,a,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,o=t.idx,a=t.permIds,i=1,o||(o=0),1===n.props.pageNo){e.next=7;break}return i=0,e.next=7,n.props.onPageChange(1);case 7:c=tt(n.props.permData),s=n.formatAddData(r,a),c.splice.apply(c,[o,i].concat(tt(s))),n.props.updateData(c);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.formatAddData=function(e,t){return e.selectedItems.map(function(r,o){return{key:r.key,name:r.key,permMainBody:r.key,permGroupType:e.permGroupType,tenantId:r.tenantId||l.a.tenantId,permId:t[o],permTargetId:n.props.contentId}})},n.handleOption=function(e,t){if("add"===e)n.newAdd({data:t});else{var r=tt(n.props.permData),o=r.findIndex(function(e){return e.key===t.key});r.splice(o,1),n.props.updateData(r)}},n.handleSelectedItem=function(e){var t=n.props.permData,r=n.props.contentId,o=t.filter(function(e){return e.permTargetId===r}).map(function(e){return e.permMainBody});(t=Object(F.a)(n.props.permData,e,o,function(e){var t=e.name;return Object(q.i)(t)}))&&n.props.updateData(t)},n.addLine=function(e,t){n.props.checkAdd(function(){var t=tt(n.props.permData),r=Object(q.e)({tempSelect:[],isShowSelect:e,isShow:!1!==e});n.modalKey=r.key,t.unshift(r),n.props.updateData(t)},t)},n.deleteTempSelect=function(e){var t=e.key,r=e.item,o=tt(n.props.permData),a=o.findIndex(function(e){return e.key===t});o[a].tempSelect.some(function(e,t){return e.key===r.key&&(o[a].tempSelect.splice(t,1),!0)}),n.props.updateData(o)},n.hideModal=function(){n.modalKey=void 0,n.state.selectModalVisible&&n.setState({selectModalVisible:!1},function(){var e=n.props.permData;e=e.filter(function(e){return!1!==e.isShow}),n.props.updateData(e)})},n.showModal=function(){n.state.selectModalVisible||n.addLine(!1,function(){return n.setState({selectModalVisible:!0})})},n.noVal=function(e){var t=tt(n.props.permData),r=t.findIndex(function(t){return t.key===e.key});t[r].warningData=[],t[r].warningTip="\u8bf7\u8f93\u5165mis\u53f7\u91cd\u65b0\u6dfb\u52a0",n.setState({permData:t})},n.renderModal=function(){var e=n.props.permData,t=n.state,r=t.selectModalVisible,o=t.allUserPerm,a=it(n),i=a.hideModal,c=a.deleteTempSelect,s=a.noVal,l={};return e.some(function(e){return e.key===n.modalKey&&(l=e,!0)}),Object(q.l)({modalData:l,selectModalVisible:r,hideModal:i,existData:o,updateData:n.updateModalData,deleteTempSelect:c,noVal:s})},n.updateModalData=function(e){var t=n.props.permData,r=t.findIndex(function(t){return t.key===e.key});t.splice(r,1,e),n.props.updateData(t)},n.renderList=function(){var e=it(n),t=e.handleCheck,r=e.handleDelete,o=e.handleOption,a=e.handleSelectedItem,c=n.state,s=c.selectModalVisible,l=c.allUserPerm,u=n.props,p=u.permData,f=u.isAdmPerm,d=u.isSpaceAdm,m=u.contentId,h=n.props.store,y=h.sideBar,b=h.user,v=p.filter(function(e){return!1!==e.isShow}),g=Ye({handleCheck:t,handleDelete:r,handleOption:o,handleSelectedItem:a,sideBar:y,isAdmPerm:f,isSpaceAdm:d,user:b,allUserPerm:l||[],contentId:m});return i.a.createElement("div",{className:"perm-setting-body"},i.a.createElement("nav",{className:"perm-setting-nav"},i.a.createElement("div",{className:"label"},"\u4e2a\u4eba\u6743\u9650"),f&&[i.a.createElement("button",{className:"add-perm-btn",style:{marginLeft:8},onClick:n.showModal,key:"batch"},i.a.createElement(Ae.a,null)," \u6279\u91cf\u65b0\u589e"),i.a.createElement("button",{className:"add-perm-btn",onClick:n.addLine,key:"add"},i.a.createElement(Ae.a,null)," \u65b0\u589e")]),i.a.createElement(z.a,{prefixCls:"perm-setting",isPageContent:!1,columns:g,dataSource:v.map(function(e){return $e({},e,{userInfo:e.userInfo||b.userInfos.get(e.name)})}),locale:{emptyText:"\u6ca1\u6709\u4eba\u6709\u6b64\u6587\u6863\u7684\u6743\u9650"}}),s&&n.renderModal())},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentWillMount",value:function(){this.getAllUserPerm()}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.isAdmPerm!==this.props.isAdmPerm&&!e.isAdmPerm){var n=this.props.permData;n.some(function(e,r){return!!e.readOnly&&(n.splice(r,1),t.props.updateData(n),!0)})}}},{key:"render",value:function(){var e=this.props,t=e.totalCount,n=e.pageNo,r=e.onPageChange,o=e.pageSize;return i.a.createElement("div",null,this.renderList(),t>o&&i.a.createElement("div",{className:"pagination"},i.a.createElement(Ge.a,{size:"small",total:t,pageSize:o,current:n,onChange:r})))}}])&&ot(n.prototype,r),o&&ot(n,o),t}())||We)||We,ut=n("./lodash.isequal/index.js"),pt=n.n(ut),ft=(n("./antd/lib/select/style/index.js"),n("./antd/lib/select/index.js")),dt=n.n(ft),mt=dt.a.Option,ht={permMainBodyType:Q.c},yt=function(e){var t=e.handleCheck,n=e.handleDelete,r=e.permData,o=e.otherAccount,a=e.changeAccountVal,c=e.handleOption,s=e.sideBar,l=e.editable,u=e.contentId;return[{title:"\u8d26\u6237\u7c7b\u578b",dataIndex:"job-family",className:"job-family",width:290,render:function(e,t){var n=t.isNew,c=t.permTargetId;return n?function(e){var t=e.data,n=e.changeAccountVal,r=e.otherAccount,o=e.permData,a=e.contentId;return i.a.createElement("div",{className:"job-family-select-container"},i.a.createElement(dt.a,{mode:"multiple",dropdownClassName:"job-family-dropdown",className:"job-family-select J-hide ".concat(t.isEmpty?"danger":""),dropdownAlign:{offset:[0,4]},placeholder:"\u8bf7\u9009\u62e9\u8d26\u53f7\u7c7b\u578b",onChange:function(e){n(e,t)},getPopupContainer:function(){return document.getElementById("job".concat(t.key))}},r&&Object.keys(r).map(function(e){var t=!1;return o.findIndex(function(t){return t.permTargetId===a&&t.permMainBody===e})>-1&&(t=!0),i.a.createElement(mt,{value:e,key:e,disabled:t},r[e],"\uff08\u8c28\u614e\u8bbe\u7f6e\uff09")})),i.a.createElement("div",{id:"job".concat(t.key),style:{position:"relative"}}))}({data:t,changeAccountVal:a,otherAccount:o,permData:r,contentId:u}):[i.a.createElement("span",{className:"text-ov-wrapper"},t.name),u!==c?ce():""]}},{className:"org",dataIndex:"org",width:290},{title:q.k,dataIndex:"permission",className:"permission",width:190,render:function(e,n){return i.a.createElement("div",{style:{width:"100%",verticalAlign:"middle"}},function(e){var t=e.data,n=e.handleCheck,r=e.editable,o=t.permGroupType;return!r?q.j[o]:i.a.createElement(q.a,{value:o,onChange:function(e){n(t,e)},popupContainer:function(){return document.getElementById("otherPerm")},visible:t.isNew||!1})}({data:n,handleCheck:t,editable:l}))}},{key:"operation",dataIndex:"operation",className:"operation",width:190,render:function(e,t){var r=!l,o=t.isDeleting?"delete-loading":"";return se({data:t,handleDelete:n,handleOption:c,sideBar:s,disabled:r,clsName:o})}}]};n("../client/src/containers/ManagePage/PermSetting/OtherPermSetting/style.styl");function bt(e){return(bt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vt(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(n,!0).forEach(function(t){jt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ot(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xt,Ct=Object(c.inject)("store")(st=Object(c.observer)(st=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Et(t).call(this),(e=!r||"object"!==bt(r)&&"function"!==typeof r?Pt(n):r).handleCheck=function(t,n){var r=Ot(e.props.permData),o=r.findIndex(function(e){return e.key===t.key});if(t.isNew)return r[o].permGroupType=n,void e.props.updateData(r);var a=t.key,i=t.permId,c=t.permMainBody;if(a){var s=Object.assign({},Object(q.g)(n)),p=e.props,f=p.store,d=p.contentId,m=f.permission,h=wt({},s,{},ht,{tenantId:t.tenantId||l.a.tenantId,permMainBody:c.toString(),permId:i});e.props.checkShouldAddInherit(function(){return m.doDocPermCheck(d,h).then(function(){u.a.success("\u6743\u9650\u4fee\u6539\u6210\u529f"),r[o].permGroupType=n,e.props.updateData(r)}).catch(function(e){return Object(v.u)(e)})},function(){return[h]},t)}},e.handleDelete=function(t){if(t.key&&!t.isDeleting){var n=Ot(e.props.permData),r=n.findIndex(function(e){return e.key===t.key}),o=Object.assign({},Object(q.g)(t.permGroupType));n[r].isDeleting=!0,e.props.updateData(n);e.props.checkShouldAddInherit(function(){n[r].isDeleting=!0,e.props.updateData(n),e.dealDelete(t,o).then(function(){n.splice(r,1),e.props.updateData(n),u.a.success("\u6743\u9650\u5220\u9664\u6210\u529f")}).catch(function(t){n[r].isDeleting=!1,e.props.updateData(n),Object(v.u)(t)})},function(){return[]},t)}},e.dealDelete=function(t,n){var r=t.key,o=t.permId,a=t.permMainBody;if(r){var i=e.props,c=i.store,s=i.contentId,u=c.permission,p=wt({permId:o},n,{},ht,{tenantId:t.tenantId||l.a.tenantId,permMainBody:a.toString()});return u.doDocPermDelete(s,p)}},e.handleAdd=function(t){if(!e.isSaving){var n=e.props.permData;if(0===t.selectVal.length)return n.some(function(e){return e.key.toString()===t.key.toString()&&(e.isEmpty=!0,!0)}),e.props.updateData(n),u.a.error("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u90e8\u95e8");var r=e.props.store.orgTree.otherAccount,o=Object(q.b)(t.selectVal,n,r);if(o)return u.a.error("".concat(o,"\u5df2\u6709\u6743\u9650\uff0c\u5982\u9700\u53d8\u66f4\uff0c\u8bf7\u76f4\u63a5\u4fee\u6539"));e.dealAdd(t)}},e.dealAdd=function(){var t,n=(t=regeneratorRuntime.mark(function t(n){var r,o,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.permData,e.isSaving=!0,t.prev=2,t.next=5,e.getReqArr({data:n});case 5:if(o=t.sent,u.a.success("\u5df2\u6210\u529f\u65b0\u589e\u6743\u9650"),!e.props.refresh()){t.next=9;break}return t.abrupt("return");case 9:a=r.findIndex(function(e){return e.key===n.key}),i=e.formatAddData(n,o),r.splice(a,1),r.unshift.apply(r,Ot(i)),e.props.updateData(r),e.isSaving=!1,t.next=21;break;case 17:t.prev=17,t.t0=t.catch(2),e.isSaving=!1,Object(v.u)(t.t0);case 21:case"end":return t.stop()}},t,null,[[2,17]])}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(e){vt(a,r,o,i,c,"next",e)}function c(e){vt(a,r,o,i,c,"throw",e)}i(void 0)})});return function(e){return n.apply(this,arguments)}}(),e.getReqArr=function(t){var n=t.data,r=e.props.contentId,o=wt({},Object.assign({},Object(q.g)(n.permGroupType)),{},ht,{tenantId:l.a.tenantId});return he(n.selectVal.map(function(e){return{params:wt({},o,{permMainBody:e}),contentId:r}}))},e.formatAddData=function(t,n){var r=e.props.store.orgTree.otherAccount;return n.map(function(n,o){return{permId:n,name:r[t.selectVal[o]],permGroupType:t.permGroupType,key:t.selectVal[o],permMainBody:t.selectVal[o],tenantId:l.a.tenantId,permTargetId:e.props.contentId}})},e.changeAccountVal=function(t,n){var r=e.props.permData,o=r.findIndex(function(e){return e.key===n.key});r[o].selectVal.toString()!==t.toString()&&(r[o].selectVal=t,r[o].isEmpty=!1,e.props.updateData(r))},e.renderList=function(){var t=e.props,n=t.permData,r=t.editable,o=t.contentId,a=t.store,c=a.sideBar,s=a.orgTree.otherAccount,l=e.state.dropdownStyle,u=Pt(e),p=u.handleCheck,f=u.handleDelete,d=u.handleOption,m=u.changeAccountVal,h=yt({handleCheck:p,handleDelete:f,permData:n,handleOption:d,changeAccountVal:m,otherAccount:s,dropdownStyle:l,sideBar:c,editable:r,contentId:o});return i.a.createElement(z.a,{prefixCls:"perm-setting",isPageContent:!1,columns:h,dataSource:n,locale:{emptyText:"\u6ca1\u6709\u5916\u90e8\u4eba\u5458\u6709\u6b64\u9875\u9762\u7684\u6743\u9650"}})},e.addLine=function(){e.props.checkAdd(function(){var t=Ot(e.props.permData);t=[Object(q.e)({selectVal:[]})].concat(Ot(t)),e.props.updateData(t),Array.from(e.operm.querySelectorAll(".ant-select-search__field")).map(function(e){return e.addEventListener("input",function(){e.value=""})})})},e.handleOption=function(t,n){var r=Ot(e.props.permData),o=r.findIndex(function(e){return e.key===n.key});"add"===t?e.handleAdd(r[o]):(r.splice(o,1),e.props.updateData(r))},e.state={opsState:W.t.DONE,selectModalVisible:!1},e.isSaving=!1,e}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){pt()(e.permData,this.props.permData)||this.setState({existKeys:e.permData.map(function(e){return e.key})})}},{key:"componentDidMount",value:function(){this.props.store.orgTree.getOtherAccount()}},{key:"render",value:function(){var e=this,t=this.state.opsState,n=this.props.isRootAdm;return i.a.createElement("div",{className:"perm-setting-body",id:"otherPerm"},i.a.createElement("nav",{className:"perm-setting-nav"},i.a.createElement("div",{className:"label"},"\u5916\u90e8\u6743\u9650"),n&&i.a.createElement("div",{className:"add-perm-btn",onClick:this.addLine},i.a.createElement(Ae.a,null)," \u65b0\u589e")),t===W.t.PENDING?i.a.createElement(f.a,null):i.a.createElement("div",{ref:function(t){e.operm=t}}," ",this.renderList()))}}])&&St(n.prototype,r),o&&St(n,o),t}())||st)||st,Tt=n("../client/src/containers/ManageSpace/container/MailGroupSelect/index.js"),It={permMainBodyType:Q.a},At=function(e){var t=e.handleCheck,n=e.handleDelete,r=e.permData,o=e.dealSelectedItem,a=e.handleOption,c=e.sideBar,s=e.isAdmPerm,l=e.contentId;return[{title:"\u8d26\u6237",dataIndex:"job-family",className:"job-family",width:290,render:function(e,t){var n=t.isNew,a=t.permTargetId;return n?i.a.createElement(Tt.a,{existedKeys:r.filter(function(e){return e.permTargetId===l}).map(function(e){return e.permMainBody}),data:t,dealSelectedItem:o}):[i.a.createElement(be.a,{title:t.name,placement:"right",mouseEnterDelay:.6},i.a.createElement("span",{className:"text-ov-wrapper"},t.name),l!==a?ce():"")]}},{className:"org",dataIndex:"org",width:290},{title:q.k,dataIndex:"permission",className:"permission",width:190,render:function(e,n){return i.a.createElement("div",{style:{width:"100%",verticalAlign:"middle"}},function(e){var t=e.data,n=e.handleCheck,r=e.editable,o=t.permGroupType;return!r?q.j[o]:i.a.createElement(q.a,{value:o,onChange:function(e){n(t,e)},popupContainer:function(){return document.getElementById("otherPerm")},visible:t.isNew||!1})}({data:n,handleCheck:t,editable:s}))}},{dataIndex:"operation",className:"operation",width:190,render:function(e,t){var r=!s,o=t.isDeleting?"delete-loading":"";return se({data:t,handleDelete:n,handleOption:a,sideBar:c,disabled:r,clsName:o})}}]};n("../client/src/containers/ManagePage/PermSetting/MailPermSetting/style.styl");function Dt(e){return(Dt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nt(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(n,!0).forEach(function(t){Lt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vt(e){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zt(e,t){return(zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wt,Ft=Object(c.inject)("store")(xt=Object(c.observer)(xt=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Vt(t).call(this),(e=!r||"object"!==Dt(r)&&"function"!==typeof r?Ht(n):r).handleCheck=function(t,n){var r=Bt(e.props.permData),o=r.findIndex(function(e){return e.key===t.key});if(t.isNew)return r[o].permGroupType=n,void e.props.updateData(r);var a=t.key,i=t.permId,c=t.permMainBody;if(a){var s=Object.assign({},Object(q.g)(n)),p=e.props,f=p.store,d=p.contentId,m=f.permission,h=_t({},s,{},It,{tenantId:t.tenantId||l.a.tenantId,permMainBody:c.toString(),permId:i});e.props.checkShouldAddInherit(function(){return m.doDocPermCheck(d,h).then(function(){u.a.success("\u6743\u9650\u4fee\u6539\u6210\u529f"),r[o].permGroupType=n,e.props.updateData(r)}).catch(function(e){return Object(v.u)(e)})},function(){return[h]},t)}},e.handleDelete=function(t){if(t.key&&!t.isDeleting){var n=Bt(e.props.permData),r=n.findIndex(function(e){return e.key===t.key}),o=Object.assign({},Object(q.g)(t.permGroupType));e.props.updateData(n);e.props.checkShouldAddInherit(function(){n[r].isDeleting=!0,e.props.updateData(n),e.dealDelete(t,o).then(function(){n.splice(r,1),e.props.updateData(n),u.a.success("\u6743\u9650\u5220\u9664\u6210\u529f")}).catch(function(t){n[r].isDeleting=!1,e.props.updateData(n),Object(v.u)(t)})},function(){return[]},t)}},e.dealDelete=function(t,n){var r=t.key,o=t.permId,a=t.permMainBody;if(r){var i=e.props,c=i.store,s=i.contentId,u=c.permission,p=_t({permId:o},n,{},It,{tenantId:t.tenantId||l.a.tenantId,permMainBody:a.toString()});return u.doDocPermDelete(s,p)}},e.handleAdd=function(t){if(!e.isSaving){var n=e.props.permData;if(0===t.selectedItems.length)return n.some(function(e){return e.key.toString()===t.key.toString()&&(e.isEmpty=!0,!0)}),e.props.updateData(n),u.a.error("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u7528\u6237\u7ec4");e.dealAdd(t)}},e.dealAdd=function(){var t,n=(t=regeneratorRuntime.mark(function t(n){var r,o,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.permData,e.isSaving=!0,t.prev=2,t.next=5,e.getReqArr({data:n});case 5:if(o=t.sent,u.a.success("\u5df2\u6210\u529f\u65b0\u589e\u6743\u9650"),e.isSaving=!1,!e.props.refresh()){t.next=10;break}return t.abrupt("return");case 10:a=r.findIndex(function(e){return e.key===n.key}),i=e.formatAddData(n,o),r.splice(a,1),r.unshift.apply(r,Bt(i)),e.props.updateData(r),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(2),e.isSaving=!1,Object(v.u)(t.t0);case 21:case"end":return t.stop()}},t,null,[[2,17]])}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(e){Nt(a,r,o,i,c,"next",e)}function c(e){Nt(a,r,o,i,c,"throw",e)}i(void 0)})});return function(e){return n.apply(this,arguments)}}(),e.getReqArr=function(t){var n=t.data,r=e.props.contentId,o=_t({},Object.assign({},Object(q.g)(n.permGroupType)),{},It,{tenantId:l.a.tenantId});return he(n.selectedItems.map(function(e){return{params:_t({},o,{permMainBody:e.mail}),contentId:r}}))},e.formatAddData=function(t,n){return n.map(function(n,r){return{permId:n,name:"".concat(t.selectedItems[r].name,"<").concat(t.selectedItems[r].mail,">"),permGroupType:t.permGroupType,key:n,permMainBody:t.selectedItems[r].mail,tenantId:l.a.tenantId,permTargetId:e.props.contentId}})},e.dealSelectedItem=function(t,n){var r=e.props.permData,o=e.props.contentId,a=r.filter(function(e){return e.permTargetId===o}).map(function(e){return e.permMainBody});(r=Object(F.a)(r,t,a,function(e){var t=e.name;return Object(q.i)(t)}))&&(e.props.updateData(r),n())},e.renderList=function(){var t=e.props,n=t.permData,r=t.contentId,o=t.store,a=t.isAdmPerm,c=o.sideBar,s=Ht(e),l=s.handleCheck,u=s.handleDelete,p=s.handleOption,f=s.dealSelectedItem,d=At({handleCheck:l,handleDelete:u,permData:n,handleOption:p,dealSelectedItem:f,isAdmPerm:a,sideBar:c,contentId:r});return i.a.createElement(z.a,{prefixCls:"perm-setting",isPageContent:!1,columns:d,dataSource:n,locale:{emptyText:"\u6ca1\u6709\u7528\u6237\u7ec4\u6709\u6b64\u9875\u9762\u7684\u6743\u9650"}})},e.addLine=function(){e.props.checkAdd(function(){var t=Bt(e.props.permData);t=[Object(q.e)()].concat(Bt(t)),e.props.updateData(t)})},e.handleOption=function(t,n){var r=Bt(e.props.permData),o=r.findIndex(function(e){return e.key===n.key});"add"===t?e.handleAdd(r[o]):(r.splice(o,1),e.props.updateData(r))},e.state={opsState:W.t.DONE},e.isSaving=!1,e}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){pt()(e.permData,this.props.permData)||this.setState({existKeys:e.permData.map(function(e){return e.key})})}},{key:"render",value:function(){var e=this.state.opsState,t=this.props.isAdmPerm;return i.a.createElement("div",{className:"perm-setting-body",id:"otherPerm"},i.a.createElement("nav",{className:"perm-setting-nav"},i.a.createElement("div",{className:"label"},"\u7528\u6237\u7ec4\u6743\u9650(\u90ae\u4ef6\u7ec4)",q.h),t&&i.a.createElement("div",{className:"add-perm-btn",onClick:this.addLine},i.a.createElement(Ae.a,null)," \u65b0\u589e")),e===W.t.PENDING?i.a.createElement(f.a,null):this.renderList())}}])&&Rt(n.prototype,r),o&&Rt(n,o),t}())||xt)||xt;n("../client/src/containers/ManagePage/style.styl");function Ut(e){return(Ut="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(n,!0).forEach(function(t){Gt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Yt(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Jt(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Yt(a,r,o,i,c,"next",e)}function c(e){Yt(a,r,o,i,c,"throw",e)}i(void 0)})}}function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $t(e,t){return!t||"object"!==Ut(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function en(e){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tn(e,t){return(tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"default",function(){return un});var nn=G.e.ORG,rn=G.e.USER,on=G.e.OTHER,an=G.e.MAIL,cn=G.f.ADD,sn=G.f.UPDATE,ln=G.f.DELETE,un=Object(c.inject)("store")(Wt=Object(c.observer)(Wt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=$t(this,en(t).call(this,e))).parentSpaceId=null,n.inheritId=null,n.inheritType=null,n.parentTitle="",n.isSaving=!1,n.docTitles={},n.pageSize=20,n.getPermList=Jt(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l,u,p,f,d,m,h,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.store,r=t.ui,n.setState({userPageNo:1}),n.hideList(),e.prev=4,e.next=7,n.doGetPermList();case 7:return o=e.sent,a=me(o),n.setState({userTotalCount:o[1].count,setPermCount:a.setPermCount}),e.next=12,n.initDocPermState(a);case 12:i=fe(a,t),c=Xt(i,4),s=c[0],l=c[1],u=c[2],p=c[3],n.saveData(s,l,u,p),r.sideBarVisible||r.setSideBarVisible(!0),e.next=39;break;case 17:e.prev=17,e.t0=e.catch(4),f=null,d=!0,m=!1,h=!1,y=!1,e.t1=e.t0.status,e.next=623===e.t1?27:619===e.t1?29:627===e.t1?32:603===e.t1?34:36;break;case 27:return f=!1,e.abrupt("break",38);case 29:return d=!1,f=!1,e.abrupt("break",38);case 32:return m=!0,e.abrupt("break",38);case 34:return y=!0,e.abrupt("break",38);case 36:h=!0,Object(v.t)(e.t0);case 38:n.setState({hasReadPerm:d,hasAdmPerm:f,isNotFound:m,isError:h,isDelete:y,isShowList:!0});case 39:case"end":return e.stop()}},e,null,[[4,17]])})),n.getSinglePermList=function(){var e=Jt(regeneratorRuntime.mark(function e(t,r,o){var a,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.store.permission.getDocPermList,i={permMainBodyType:t},r&&(i.pageSize=r,i.pageNo=o),e.prev=3,e.next=6,a(n.state.contentId,i);case 6:return c=e.sent,e.abrupt("return",c);case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",{});case 13:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t,n,r){return e.apply(this,arguments)}}(),n.doGetPermList=function(){return Promise.all([n.getSinglePermList(Q.b),n.getSinglePermList(Q.d,n.pageSize,1),n.getSinglePermList(Q.c),n.getSinglePermList(Q.a)])},n.refreshPermList=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!(!e&&n.state.permType!==G.b)&&(n.getPermList(),!0)},n.initDocPermState=function(){var e=Jt(regeneratorRuntime.mark(function e(t){var r,o,a,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.count,o=t.permType,a=t.setPermCount,i=t.firstHavePermSettingsParentId,c=t.firstHavePermSettingsParentIdTypeEnum,n.setState({permType:G.g[o],totalCount:r,setPermCount:a}),n.inheritId=i,n.inheritType=c,n.props.store.doc.setDocPermType(o),n.inheritType!==G.c){e.next=7;break}return e.abrupt("return",n.getDocTitle([n.inheritId],"parent"));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.isShouldAddUserPerm=Jt(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.store.user.userInfo.account,e.prev=1,e.next=4,n.getSpaceAdm();case 4:if(e.sent.includes(t)){e.next=18;break}return e.next=8,n.getUserPermOfCurrentDoc();case 8:if(r=e.sent,!r.hasAdmPerm){e.next=14;break}n.initHasManPerm(),e.next=16;break;case 14:return e.next=16,n.initNoManPerm();case 16:e.next=19;break;case 18:n.setState({hasAdmPerm:!0});case 19:setTimeout(n.showList),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(1),n.setState({isError:!0}),Object(v.t)(e.t0);case 26:case"end":return e.stop()}},e,null,[[1,22]])})),n.getUserPermOfCurrentDoc=Jt(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.store,r=t.permission,o=t.ui,e.prev=1,e.next=4,r.getUserPermOfDoc(n.state.contentId);case 4:return a=e.sent,i=a.hasAdmPerm,(c=a.hasReadPerm)||o.setSideBarVisible(!1),n.setState({hasAdmPerm:i,hasReadPerm:c}),e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(1),Object(v.t)(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,11]])})),n.getSpaceId=Jt(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.spaceId){e.next=2;break}return e.abrupt("return",n.state.spaceId);case 2:return e.next=4,n.props.store.sideBar.getSpaceId(n.state.contentId);case 4:return t=e.sent,n.setState({spaceId:t}),e.abrupt("return",t);case 7:case"end":return e.stop()}},e)})),n.getSpaceAdm=Jt(regeneratorRuntime.mark(function e(){var t,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.spaceAdm.length){e.next=2;break}return e.abrupt("return",n.state.spaceAdm);case 2:return t=n.props.store.permission.getSpaceAdm,e.prev=3,e.next=6,n.getSpaceId();case 6:return r=e.sent,e.next=9,t(r);case 9:return o=e.sent,e.next=12,n.props.store.space.checkIsInMT(r);case 12:return a=e.sent,n.setState({spaceAdm:o||[],isMT:a}),e.abrupt("return",o);case 17:return e.prev=17,e.t0=e.catch(3),Object(v.t)(e.t0),e.abrupt("return",[]);case 21:case"end":return e.stop()}},e,null,[[3,17]])})),n.initHasManPerm=function(){var e=n.props.store.user.userInfo.account,t=Qt(n.state.userPermData);if(t.findIndex(function(t){return t.name===e})<0&&!n.props.store.user.hasRootPerm){var r=t.findIndex(function(e){return!e.permFrom}),o={key:e,name:e,permGroupType:"manage",tenantId:e.tenantId,permTargetId:n.state.contentId,readOnly:!0};r<0?t.unshift(o):t.splice(r,0,o)}n.setState({userPermData:t})},n.initNoManPerm=Jt(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.store,r=t.user,o=t.doc,!n.state.creator){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,a=[],e.next=7,o.getDocCreatorPerm(n.state.contentId);case 7:return i=e.sent,c=i.hasManagePerm,s=i.creator,c&&(n.setState({creator:s}),a.push(s)),e.next=13,n.getSpaceAdm();case 13:return l=e.sent,e.next=16,r.checkUserInfo([].concat(a,Qt(l)));case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(3),Object(v.t)(e.t0),e.abrupt("return","");case 22:case"end":return e.stop()}},e,null,[[3,18]])})),n.isSpaceAdm=function(){return n.state.spaceAdm.includes(l.a.login)},n.inheritConfirmModal=function(e){return y.a.confirm(qt({title:"\u786e\u5b9a\u53d8\u66f4\u6743\u9650?"},e))},n.changPermType=function(){var e=Jt(regeneratorRuntime.mark(function e(t){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.store.permission.changeDocPermType,e.prev=1,e.next=4,n.getSpaceId();case 4:return o=e.sent,e.next=7,r(o,n.state.contentId,G.h[t]);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),u.a.error("\u6743\u9650\u53d8\u66f4\u5931\u8d25");case 13:n.getPermList();case 14:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),n.renderRestoreBtn=function(){var e=n.state.permType===G.d?"\u6062\u590d\u7ee7\u627f":"\u79fb\u9664\u7ee7\u627f";return i.a.createElement("a",{className:"ct-btn",onClick:n.restore},e)},n.restore=function(){var e=n.state,t=e.permType,r=e.totalCount;switch(t){case G.d:if(r)var a=y.a.warning({title:"\u6062\u590d\u7ee7\u627f\u540e\uff0c\u662f\u5426\u4fdd\u7559\u5df2\u6709\u6743\u9650?",content:i.a.createElement("span",null,"\u4fdd\u7559\u540e\uff0c\u6b64\u6587\u6863\u5c06\u7ee7\u627f",n.renderBackToParent(),"\u7684\u6743\u9650\uff0c\u5e76\u4fdd\u7559\u5df2\u6709\u6743\u9650"),footer:[i.a.createElement(o.a,{onClick:function(){return a.destroy()}},"\u53d6\u6d88"),i.a.createElement(o.a,{onClick:Jt(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.store.permission.judgeCanManageAfterRestore,e.next=3,t(n.state.contentId);case 3:e.sent?n.deleteAllSpecialPerm():n.inheritConfirmModal({content:"\u4e0d\u4fdd\u7559\u5f53\u524d\u6743\u9650\uff0c\u5219\u60a8\u5c06\u65e0\u6b64\u6587\u6863\u7684\u7ba1\u7406\u6743\u9650\uff0c\u662f\u5426\u7ee7\u7eed\u64cd\u4f5c\uff1f",onOk:function(){var e=Jt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(),e.next=3,n.deleteAllSpecialPerm();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}),a.destroy();case 6:case"end":return e.stop()}},e)}))},"\u4e0d\u4fdd\u7559"),i.a.createElement(o.a,{type:"primary",onClick:Jt(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.changPermType(G.a),a.destroy();case 2:case"end":return e.stop()}},e)}))},"\u4fdd\u7559")]});else y.a.warning({title:"\u786e\u5b9a\u6062\u590d\u7ee7\u627f?",content:i.a.createElement("span",null,"\u786e\u5b9a\u540e\uff0c\u6b64\u6587\u6863\u5c06\u7ee7\u627f",n.renderBackToParent(),"\u7684\u6743\u9650"),onOk:function(){var e=Jt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(),e.next=3,n.deleteAllSpecialPerm();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()});break;case G.a:y.a.error({title:"\u786e\u5b9a\u79fb\u9664\u7ee7\u627f?",content:"\u79fb\u9664\u540e\uff0c\u6b64\u6587\u6863\u4e0d\u518d\u7ee7\u627f\u6240\u5728\u7a7a\u95f4\u7684\u6743\u9650\uff0c\u53ea\u4fdd\u7559\u5355\u72ec\u8bbe\u7f6e\u7684\u6743\u9650\u3002",okText:"\u79fb\u9664",onOk:function(){var e=Jt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t(),n.changPermType(G.d);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()})}},n.deleteAllSpecialPerm=function(){var e=Jt(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t(),r=n.props.store.permission.restoreToInherit,e.prev=2,e.next=5,r(n.state.contentId);case 5:u.a.success("\u6743\u9650\u53d8\u66f4\u6210\u529f\uff01"),n.getPermList(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),u.a.error("\u6743\u9650\u53d8\u66f4\u5931\u8d25");case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),n.checkAdd=function(e,t){var r=n.state.permType,o=n.inheritType===G.c;if(r===G.b)return o?y.a.warning({title:"\u786e\u5b9a\u65b0\u589e\u6743\u9650?",onOk:function(){e(),t&&t()},content:i.a.createElement("span",null,"\u786e\u5b9a\u540e\uff0c\u6b64\u6587\u6863\u5c06\u65b0\u589e\u6743\u9650\u3002\u82e5\u4f60\u5e0c\u671b\u65b0\u589e\u7684\u6743\u9650 \u80fd\u5e94\u7528\u4e8e\u5f53\u524d\u7a7a\u95f4\u7684\u6240\u6709\u6587\u6863\uff0c\u8bf7",i.a.createElement("a",{onClick:function(){return window.open("".concat(w.a.primaryPath,"/manage/page/").concat(n.inheritId))}},"\u524d\u5f80\u7236\u6587\u6863"),"\u65b0\u589e\u3002")}):y.a.warning({title:"\u786e\u5b9a\u65b0\u589e\u6743\u9650?",onOk:function(){e(),t&&t()},content:i.a.createElement("span",null,"\u786e\u5b9a\u540e\uff0c\u6b64\u6587\u6863\u5c06\u65b0\u589e\u6743\u9650\u3002\u82e5\u4f60\u5e0c\u671b\u65b0\u589e\u7684\u6743\u9650 \u80fd\u5e94\u7528\u4e8e\u5f53\u524d\u7a7a\u95f4\u7684\u6240\u6709\u6587\u6863\uff0c\u8bf7 \xa0",i.a.createElement("a",{onClick:function(){return window.open("".concat(w.a.primaryPath,"/manage/space/").concat(n.inheritId,"?type=perm"))}},"\u524d\u5f80\u7a7a\u95f4"),"\xa0 \u65b0\u589e\u3002")});e(),t&&t()},n.checkShouldAddInherit=function(e,t,r){if(!n.isSaving)return r.permTargetId===n.state.contentId?e():void y.a.error({title:"\u786e\u5b9a\u4fee\u6539\u6b64\u6743\u9650?",content:"\u4fee\u6539\u540e\uff0c\u6b64\u6587\u6863\u4e0d\u518d\u7ee7\u627f\u6240\u5728\u7a7a\u95f4\u7684\u6743\u9650\uff0c\u53ea\u4fdd\u7559\u5df2\u6709\u6743\u9650\u3002",okText:"\u4fee\u6539",onOk:function(){var e=Jt(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.isSaving=!0,e.next=4,n.handleBatchAdd({curData:r,inheritParam:t});case 4:n.isSaving=!1,n.getPermList(),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),n.isSaving=!1,n.getPermList(),u.a.error(e.t0.message);case 13:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}()})},n.handleBatchAdd=function(e){var t=e.curData,r=e.inheritParam,o=[nn,rn,on,an],a=r(),i=t&&le(t,o[t.permMainBodyType]),c=qt({},n.mergeAddParams(a,i),{firstHavePermSettingsParentId:n.inheritId,firstHavePermSettingsParentIdTypeEnum:n.inheritType});return n.props.store.permission.doBatchAdd(n.state.contentId,c)},n.mergeAddParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={permissionUnitVOS:e,operationType:sn,setContentPermStatus:!0};return e.length||(r.permissionUnitVOS=[t],r.operationType=ln),Reflect.ownKeys(t).length||(r.operationType=cn,[G.d,G.a].includes(n.state.permType)?delete r.setContentPermStatus:r.setContentPermStatus=!1),r},n.getDocTitle=function(){var e=Jt(regeneratorRuntime.mark(function e(t,r){var o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.props.store.doc.getContentTitles,e.next=3,o([t]);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:"parent"===r&&(n.parentTitle=a[0]);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.saveData=function(){var e=Jt(regeneratorRuntime.mark(function e(t,r,o,a){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.props.store.user,e.prev=1,e.next=4,i.checkUserInfo(r.map(function(e){return e.name}));case 4:n.setState({orgPermData:t,userPermData:r,otherPermData:o,mailPermData:a}),n.isShouldAddUserPerm(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(v.t)(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,n,r,o){return e.apply(this,arguments)}}(),n.renderBackToParent=function(){return n.inheritType===G.c?Object(g.c)({title:n.parentTitle,contentId:n.inheritId,maxLength:10}):"\u7a7a\u95f4"},n.emptyDocPermModal=function(){y.a.error({title:"\u786e\u5b9a\u6e05\u7a7a\u6743\u9650?",content:"\u6e05\u7a7a\u540e\uff0c\u53ea\u6709\u4f60\u548c\u7a7a\u95f4\u7ba1\u7406\u5458\u6709\u6b64\u6587\u6863\u7684\u6743\u9650\u3002",okText:"\u6e05\u7a7a",onOk:function(){var e=Jt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t(),e.next=3,n.props.store.permission.emptyDocPerm(n.state.contentId);case 3:n.getPermList();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()})},n.renderTips=function(){var e=n.state,t=e.spaceAdm,r=e.creator,o=e.hasAdmPerm,a=e.isMT,c=n.props.store;if(t&&null!==o&&!o){var s="\u60a8\u65e0\u6743\u5bf9\u672c\u9875\u5185\u5bb9\u8fdb\u884c\u8c03\u6574\u3002\u5982\u9700\u53d8\u66f4\uff0c",l=i.a.createElement("span",null,s,"\u8bf7\u8054\u7cfb\u6709\u6587\u6863\u7ba1\u7406\u7684\u7528\u6237\uff0c\u6216\u8054\u7cfb\u7a7a\u95f4\u7ba1\u7406\u5458\uff1a",de(t,c),a?" \uff0c\u5982\u7528\u6237\u5747\u5df2\u79bb\u804c\uff0c\u8bf7\u8054\u7cfb6000":"");return r&&(l=i.a.createElement("span",null,s,"\u8bf7\u8054\u7cfb\u6587\u6863\u521b\u5efa\u4eba\uff1a",de(r,c),"\uff0c \u6216\u4ee5\u4e0b\u6709\u6587\u6863\u7ba1\u7406\u6743\u9650\u7684\u7528\u6237\uff0c\u6216\u8054\u7cfb\u7a7a\u95f4\u7ba1\u7406\u5458\uff1a",de(t,c),a?"\uff0c\u5982\u7528\u6237\u5747\u5df2\u79bb\u804c\uff0c\u8bf7\u8054\u7cfb6000":"")),i.a.createElement("div",{className:"perm-tips-warning"},l)}},n.renderDocPermHeader=function(){var e=n.state,t=e.permType,r=e.hasAdmPerm,o=e.totalCount;if(null!==r&&r){var a="",c=n.renderBackToParent(),s=!0;switch(1===o&&n.state.userPermData&&1===n.state.userPermData.length?n.state.userPermData[0].permMainBody===l.a.login&&(s=!1):o<1&&(s=!1),t){case G.b:a=i.a.createElement("span",null,"\u5f53\u524d\u6743\u9650\u7ee7\u627f\u81ea",c);break;case G.a:a=i.a.createElement("span",null,"\u5f53\u524d\u975e\u7ee7\u627f\u6743\u9650\u4e3a\u8be5\u6587\u6863\u65b0\u589e\u6743\u9650\uff0c\u5176\u4f59\u5747\u540c\u6b65",c,"\uff0c",c,"\u6743\u9650\u7684\u53d8\u66f4\u5c06\u5f71\u54cd\u5f53\u524d\u6587\u6863\u6743\u9650",n.renderRestoreBtn());break;case G.d:a=o?i.a.createElement("span",null,"\u5f53\u524d\u6743\u9650\u4e3a\u6b64\u6587\u6863\u5355\u72ec\u8bbe\u7f6e\uff0c\u53ef\u70b9\u51fb",n.renderRestoreBtn()):i.a.createElement("span",null,"\u5f53\u524d\u6743\u9650\u4e3a\u7a7a\uff0c\u4ec5\u7a7a\u95f4\u7ba1\u7406\u5458\u53ef\u89c1",n.renderRestoreBtn())}return i.a.createElement("div",{className:"perm-tips-info"},a,s&&i.a.createElement("a",{className:"ct-btn clear",onClick:n.emptyDocPermModal},"\u6e05\u7a7a\u6743\u9650"))}},n.onUserPageChange=function(){var e=Jt(regeneratorRuntime.mark(function e(t){var r,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={permMainBodyType:Q.d,pageSize:n.pageSize,pageNo:t},e.prev=1,e.next=4,n.props.store.permission.getDocPermList(n.state.contentId,r);case 4:return o=e.sent,a=o&&o.permissionUnitVOS||[],i=a.map(function(e){return pe(e,rn)}),n.setState({userPermData:i,userPageNo:t,userTotalCount:o.count}),e.next=10,n.props.store.user.checkUserInfo(i.map(function(e){return e.name}));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),601===e.t0.status?u.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5"):Object(v.t)(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t){return e.apply(this,arguments)}}(),n.showList=function(){return n.setState({isShowList:!0})},n.hideList=function(){return n.setState({isShowList:!1})},n.updateTotalCount=function(e){return n.setState({totalCount:n.state.totalCount+e})},n.updateData=function(e,t){n.updateTotalCount(ie(t).length-ie(n.state["".concat(e,"PermData")]).length),n.setState(Gt({},"".concat(e,"PermData"),Qt(t)))},n.state={orgPermData:[],userPermData:[],otherPermData:[],mailPermData:[],contentId:+e.match.params.pageId,isShowList:!1,hasReadPerm:!0,hasAdmPerm:null,isNotFound:!1,isError:!1,spaceAdm:[],userPageNo:1,totalCount:0,setPermCount:0,isMT:!1,creatorStr:null},n}var n,r,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tn(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentWillMount",value:function(){var e=this.props.store,t=e.orgTree,n=e.sideBar,r=e.ui;n.spaceId||r.setSideBarVisible(!1),t.getOtherAccount(),this.getPermList()}},{key:"componentDidMount",value:function(){document.title="\u6587\u6863\u6743\u9650\u7ba1\u7406";var e=this.props.store.ui;e.setIsInDocPermPage(!0),e.setIsInViewPage(!0)}},{key:"componentWillUnmount",value:function(){var e=this.props.store.ui;e.setIsInDocPermPage(!1),e.setIsInViewPage(!0),e.setViewPageNavBarVisible(!1),e.setSideBarVisible(!0),this.setState({orgPermData:[],userPermData:[],isError:!1})}},{key:"render",value:function(){var e=this.state,t=e.isShowList,n=e.hasAdmPerm,r=e.otherPermData,o=e.orgPermData,a=e.isNotFound,c=e.isError,l=e.isDelete,u=e.isMT,y=e.userPermData,v=e.contentId,g=e.hasReadPerm,w=e.userPageNo,j=e.userTotalCount,O=e.permType,S=e.mailPermData,E=this.props.store,P=E.doc,k=E.sideBar,x=E.ui,C=E.user,T=this.checkShouldAddInherit,I=this.updateData,A=this.isSpaceAdm,D=this.handleBatchAdd,N=this.onUserPageChange,M=this.pageSize,_=this.checkAdd,L=this.refreshPermList,B=C.hasRootPerm,R=P.navTrack;return l?i.a.createElement(h.a,{pageId:v,isViewPage:!1}):a?i.a.createElement(d.default,{text:"\u8be5\u6587\u6863\u4e0d\u5b58\u5728"}):c?i.a.createElement(b.a,{text:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5"}):g||n?i.a.createElement("div",{className:"ct-page-content doc-perm-wrapper viewpage-scroll-wrapper",id:"viewPageScrollWrapper"},t?i.a.createElement("div",{className:"doc-perm-setting-body",id:"pagePerm"},!!g&&i.a.createElement("div",{className:"perm-head"},i.a.createElement("div",{className:"nav"},i.a.createElement(p.a,{track:R,sideBar:k,ui:x})),i.a.createElement("div",{className:"ops"},i.a.createElement(s.a,null))),i.a.createElement("div",{className:"title"},"\u6587\u6863\u6743\u9650"),this.renderTips(),this.renderDocPermHeader(),i.a.createElement(Fe,{checkAdd:_,contentId:v,permData:Qt(o),refresh:L,updateData:function(e){return I(nn,e)},isRootAdm:B,isAdmPerm:n,checkShouldAddInherit:T}),i.a.createElement(lt,{checkAdd:_,permType:O,contentId:v,permData:Qt(y),updateData:function(e){return I(rn,e)},refresh:L,isRootAdm:B,isAdmPerm:n,handleBatchAdd:D,isSpaceAdm:A(),totalCount:j,pageNo:w,pageSize:M,checkShouldAddInherit:T,onPageChange:N}),u&&i.a.createElement(Ft,{checkAdd:_,contentId:v,permData:Qt(S),refresh:L,isAdmPerm:n,updateData:function(e){return I(an,e)},checkShouldAddInherit:T}),(r.length||B)&&i.a.createElement(Ct,{checkAdd:_,contentId:v,permData:Qt(r),refresh:L,updateData:function(e){return I(on,e)},checkShouldAddInherit:T,isRootAdm:B,editable:A()||B})):i.a.createElement(f.a,null),i.a.createElement(H,null)):(x.sideBarVisible&&x.setSideBarVisible(!1),i.a.createElement(m.a,{pageId:this.state.contentId}))}}])&&Zt(n.prototype,r),c&&Zt(n,c),t}())||Wt)||Wt},"../client/src/containers/ManagePage/style.styl":function(e,t,n){},"../client/src/containers/ManageSpace/PermSetting/consts.js":function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i});var r=0,o=1,a=2,i=3},"../client/src/containers/ManageSpace/container/MailGroupSelect/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.promise.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/tooltip/style/index.js");var r=n("./antd/lib/tooltip/index.js"),o=n.n(r),a=(n("./core-js/modules/es6.function.name.js"),n("./core-js/modules/es6.regexp.replace.js"),n("./core-js/modules/es6.regexp.search.js"),n("./regenerator-runtime/runtime.js"),n("./react/index.js")),i=n.n(a),c=n("../client/src/stores/index.js"),s=(n("./core-js/modules/es6.string.iterator.js"),n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/web.dom.iterable.js"),n("./antd/lib/input/style/index.js"),n("./antd/lib/input/index.js")),l=n.n(s),u=n("./classnames/index.js"),p=n.n(u),f=n("../client/src/components/CommonUI/Loading/index.js"),d=n("../client/src/components/CommonUI/Empty/index.js"),m=n("../client/src/utils/tools.js"),h=n("../client/src/assets/svg/cross.svg"),y=n("../client/src/assets/svg/error-circle-gray.svg"),b=n("./lodash.throttle/index.js"),v=n.n(b),g=n("./lodash.debounce/index.js"),w=n.n(g),j=n("./lodash.clonedeep/index.js"),O=n.n(j),S=n("../client/src/consts/index.js");n("../client/src/components/Select/OrgMultiSelect/style.styl"),n("../client/src/components/Select/SearchMultiSelect/style.styl");function E(e){return(E="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=T(t).call(this,e),(n=!a||"object"!==E(a)&&"function"!==typeof a?I(r):a).prevScrollPos=0,n.initShowSelect=function(e){return!0===e},n.notFoundContent=function(){return n.props.notFoundContent?n.props.notFoundContent():i.a.createElement(d.a,{text:"\u65e0\u641c\u7d22\u7ed3\u679c"})},n.preventD=function(e){return e.preventDefault()},n.dealSelectedItem=function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=n.props).dealSelectedItem.apply(e,r.concat([n.clearSearch]))},n.handleShow=function(e){if(e){var t=n.state,r=t.isShowSelect,o=t.isEditing;if(e.target.closest(".input-select")!==n.container)(r||o)&&(n.setState({isShowSelect:!1,isEditing:!1}),document.removeEventListener("keydown",n.deleteLastItem),n.props.onBlur&&n.props.onBlur());else{var a=e.target.closest(".select-container");if(!r||!o)n.state.searchResult.length&&n.setState({isShowSelect:!0}),n.setState({isEditing:!0});setTimeout(function(){return a&&n.focusInput()})}}},n.focusInput=function(){var e=n.searchInput&&n.searchInput.input;e&&(e.focus(),document.addEventListener("keydown",n.deleteLastItem))},n.handleSearchInput=function(e,t){e.persist();var r=e.target.value.trim();r?(n.setState({isSearching:!0,searchKeyWord:r,searchResult:[],isEditing:!0}),n.state.isShowSelect||n.setState({isShowSelect:!0}),n.setState({searchState:S.t.PENDING}),t?n.doSearch(r):n.searchDebounce(r)):n.clearSearch();n.setState({currentVal:r})},n.doSearch=function(e){(0,n.props.search)(e).then(function(t){e===n.state.searchKeyWord&&(t||(t=[]),n.setState({searchResult:t,searchState:S.t.DONE}))}).catch(function(t){e===n.state.searchKeyWord&&n.setState({searchState:S.t.ERROR}),console.error(t)})},n.onWrapperScroll=function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r,o,a,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target){e.next=2;break}return e.abrupt("return");case 2:if(r=t.target,o=r.offsetHeight,a=r.scrollTop,i=r.scrollHeight,!(screenTop<n.prevScrollPos)){e.next=5;break}return e.abrupt("return");case 5:if(c=n.state.searchKeyWord,n.prevScrollPos=screenTop,!(i-o-a<5)){e.next=13;break}if(!n.props.onReachBottom){e.next=13;break}return e.next=11,n.props.onReachBottom(c);case 11:s=e.sent,c===n.state.searchKeyWord&&s&&n.setState({searchResult:[].concat(k(n.state.searchResult),k(s))});case 13:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){x(a,r,o,i,c,"next",e)}function c(e){x(a,r,o,i,c,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),n.clearSearch=function(){var e=!1;return n.state.isSearching&&(e=!0,n.setState({isSearching:!1,searchKeyWord:"",searchResult:[],currentVal:"",isShowSelect:!1})),Promise.resolve(e)},n.resetSelect=function(){var e=n.props.data.key;n.dealSelectedItem({key:e,type:"clear"}),n.clearSearch()},n.getItemClassName=function(e){var t,r=n.props,o=r.rowClassName,a=r.data,i=r.existedKeys,c=void 0===i?[]:i;return p()("search-result-item",(P(t={},o,!!o),P(t,"exist",c.some(function(t){return t===e.key})),P(t,"selected",a.selectedItems.some(function(t){return t.key===e.key})),t))},n.renderSelect=function(){var e=n.state.searchResult;e=O()(e);var t,r=n.state,o=r.searchState,a=r.searchKeyWord,c=r.isSearching,s=n.props,l=s.renderSearchItem,u=s.data;return t=c&&o===S.t.PENDING?i.a.createElement(f.a,null):e.length?e.map(function(e){return i.a.createElement("div",{className:n.getItemClassName(e),key:e.key,onClick:function(){return n.dealSelectedItem({key:u.key,item:e})}},l(e,a))}):n.notFoundContent(),i.a.createElement("div",{className:"select-wrapper",onScroll:n.onWrapperScroll},i.a.createElement("div",{className:"tree-wrapper"},t))},n.deleteLastItem=function(e){var t=n.searchInput&&n.searchInput.input;if(!(t&&t.value.length>0)){var r=e.keyCode||e.which;if(8===r||46===r){var o=n.props.data,a=o.selectedItems;if(!a.length)return;var i=a.slice().pop();n.dealSelectedItem({key:o.key,item:i})}}},n.renderInput=function(){var e=n.state,t=e.currentVal,r=e.isEditing,a=n.props,c=a.placeholder,s=a.data,u=a.unit,p=a.popupContainer,f=a.inputStyle,d=void 0===f?{}:f,m=s.selectedItems,y=m.length,b=[],v=!1;return y>0&&(b=m.map(function(e){return i.a.createElement(o.a,{key:e.key,title:e.key,getPopupContainer:p},i.a.createElement("div",{className:"select-item"},e.name.replace(/<.*[^>]>/g,""),i.a.createElement(h.a,{className:"delete",onClick:function(t){n.dealSelectedItem({key:s.key,item:e}),t.stopPropagation()}})))})),!r&&(n.inputContainer&&n.inputContainer.clientHeight>=58&&y||y>5)&&(v=!0,b.push(i.a.createElement("div",{className:"total",key:"total"},"\u7b49",m.length,u))),i.a.createElement("div",{ref:function(e){n.inputContainer=e},className:"input-container ".concat(v&&(r?"expand":"collapse"))},b,i.a.createElement("div",{className:"input-wrapper",style:d},i.a.createElement(l.a,{placeholder:c,value:t,className:"input-search",autoComplete:"off",spellCheck:"false",onChange:n.handleSearchInput,onKeyUp:function(e){13===e.keyCode&&n.handleSearchInput(e,!0)},ref:function(e){n.searchInput=e}})))},n.state={isShowSelect:n.initShowSelect(e.isShowSelect),isSearching:!1,searchKeyWord:"",searchResult:[],searchState:S.t.DONE,currentVal:"",isEditing:n.initShowSelect(e.isShowSelect)},n.searchDebounce=w()(n.doSearch,500),n.onWrapperScroll=v()(n.onWrapperScroll,100);var c=Object(m.q)().isMobile;return n.evType=c?"touchstart":"mousedown",e.getSelector&&e.getSelector(I(n)),n}var n,r,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener(this.evType,this.handleShow),"mouseup"===this.evType&&this.searchInput.input.addEventListener("mousewheel",this.preventD),this.focusInput()}},{key:"componentWillUnmount",value:function(){document.removeEventListener(this.evType,this.handleShow),"mouseup"===this.evType&&this.searchInput.input.removeEventListener("mousewheel",this.preventD)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isEditing,r=t.isShowSelect,o=this.props.data.isEmpty;return i.a.createElement("div",{className:"input-select search-multi-select",ref:function(t){e.container=t}},i.a.createElement("div",{className:"select-container ".concat(r?"focus":""," ").concat(o?"danger":"")},this.renderInput(),!0===n&&i.a.createElement(y.a,{className:"delete icon",onClick:this.resetSelect})),r&&this.renderSelect())}}])&&C(n.prototype,r),c&&C(n,c),t}();function N(e){return(N="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function _(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){M(a,r,o,i,c,"next",e)}function c(e){M(a,r,o,i,c,"throw",e)}i(void 0)})}}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return!t||"object"!==N(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return H});var H=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=B(this,(e=R(t)).call.apply(e,[this].concat(a)))).searchValue=null,n.isSearching=!1,n.pageNo=0,n.searchResult=[],n.search=function(){var e=_(regeneratorRuntime.mark(function e(t){var r,o,a,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:0,n.checkSearchState(t,r),o=c.b.permission.searchMailGroup,e.prev=3,e.next=6,o({value:t,pageNo:n.pageNo});case 6:return a=e.sent,e.abrupt("return",a.map(function(e){return e.key=e.mail,e}));case 10:e.prev=10,e.t0=e.catch(3),Object(m.t)(e.t0);case 13:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),n.onReachBottom=function(){var e=_(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isSearching){e.next=2;break}return e.abrupt("return");case 2:return n.isSearching=!0,e.next=5,n.search(t,++n.pageNo);case 5:return r=e.sent,n.isSearching=!1,e.abrupt("return",r);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.checkSearchState=function(e,t){e!==n.searchValue&&(n.pageNo=0,n.searchResult=[]),n.searchValue=e,n.pageNo=t},n.renderSearchItem=function(e,t){return i.a.createElement(o.a,{title:"".concat(e.name.replace(/\/./g,"")," / ").concat(e.mail),placement:"right"},i.a.createElement("span",{className:"content"},i.a.createElement("span",{className:"name",dangerouslySetInnerHTML:{__html:"".concat(Object(m.D)(e.name,t),"/").concat(Object(m.D)(e.mail,t))}})))},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.data,n=e.dealSelectedItem;return i.a.createElement(D,{placeholder:"\u8f93\u5165\u90ae\u4ef6\u7ec4\u540d\u79f0/\u5730\u5740\u67e5\u8be2",unit:"\u7ec4",onReachBottom:this.onReachBottom,data:t,dealSelectedItem:n,search:this.search,existedKeys:this.props.existedKeys,renderSearchItem:this.renderSearchItem})}}])&&L(n.prototype,r),a&&L(n,a),t}()},"../client/src/containers/OpenPage/__legacy/OpenPage.js":function(e,t,n){"use strict";n.r(t);n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/back-top/style/index.js");var r,o=n("./antd/lib/back-top/index.js"),a=n.n(o),i=(n("./antd/lib/tooltip/style/index.js"),n("./antd/lib/tooltip/index.js")),c=n.n(i),s=(n("./core-js/modules/es6.promise.js"),n("./core-js/modules/es6.regexp.replace.js"),n("./core-js/modules/es6.regexp.match.js"),n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.string.iterator.js"),n("./core-js/modules/es6.set.js"),n("./core-js/modules/es7.array.includes.js"),n("./core-js/modules/es6.string.includes.js"),n("./core-js/modules/es6.regexp.search.js"),n("./core-js/modules/es6.regexp.split.js"),n("./react/index.js")),l=n.n(s),u=n("./mobx-react/index.module.js"),p=n("./lodash.throttle/index.js"),f=n.n(p),d=n("../client/src/components/ui/notification/index.js"),m=n("../client/src/components/CommonUI/NotFound/index.js"),h=n("../client/src/components/CommonUI/Deleted/index.js"),y=n("../client/src/components/CommonUI/NetWorkError/index.js"),b=n("../client/src/components/CommonUI/NoPerm/index.js"),v=n("../client/src/components/CommonUI/Loading/index.js"),g=n("../client/src/components/CrumbsNavBar/index.js"),w=n("../client/src/components/UserName/index.js"),j=n("../client/src/components/DocPageData/index.js"),O=n("../client/src/components/Toastr/index.js"),S=(n("./antd/lib/popover/style/index.js"),n("./antd/lib/popover/index.js")),E=n.n(S),P=n("../client/src/assets/svg/edit.svg"),k=n("../client/src/assets/svg/star-o.svg"),x=n("../client/src/assets/svg/star.svg"),C=n("../client/src/assets/svg/export.svg"),T=n("../client/src/assets/svg/ellipsis-large.svg"),I=n("../client/src/assets/svg/history.svg"),A=n("../client/src/assets/svg/lock.svg"),D=n("../client/src/assets/svg/inHerit.svg"),N=n("../client/src/utils/config.js"),M=n("../client/src/utils/report/lx.js"),_=n("../client/src/utils/report/lxConfig.js"),L=n("./classnames/index.js"),B=n.n(L),R=n("../client/src/history.js");function V(e){return(V="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U,K=Object(u.inject)("store")(r=Object(u.observer)(r=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=z(t).call(this,e),(n=!o||"object"!==V(o)&&"function"!==typeof o?W(r):o).handleClick=function(e){var t=n.props,r=t.onShowHistory,o=t.onExportViewData,a=t.onMove,i=t.onSort,c=t.onCopy,s=t.onDelete,l=t.placement,u="view-page-".concat("viewpage-navbar"===l?"top":"right");switch(e){case"history":r(),Object(M.a)(_.a["".concat(u,"-history")]);break;case"export":o(),Object(M.a)(_.a["".concat(u,"-export")]);break;case"sort":i(),Object(M.a)(_.a["".concat(u,"-sort")]);break;case"move":a(),Object(M.a)(_.a["".concat(u,"-move")]);break;case"copy":c(),Object(M.a)(_.a["".concat(u,"-copy")]);break;case"delete":s(),Object(M.a)(_.a["".concat(u,"-delete")])}n.handleHidePopOver()},n.toViewPage=function(){var e=R.a.location.pathname.match(/\/(diff|manage\/page)\/(\d+)/)[2];R.a.push("".concat(N.a.primaryPath,"/page/").concat(e))},n.getParentAddPerm=function(){var e=n.props.store.sideBar,t=e.pageId;if(t){var r=e.getParentData(t);if(r)return"page"===r.type?r.hasAddPerm:r.hasAddFirstLevelDocPerm}},n.handleCollect=function(){n.collectTip.onVisibleChange(!1),n.props.onCollect()},n.getDocPermTypeClsName=function(e){switch(e){case 1:return"private";case 2:return"except";case 3:return"limit";default:return"default"}},n.handleHidePopOver=n.handleHidePopOver.bind(W(n)),n.state={visible:!1},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,s["Component"]),n=t,(r=[{key:"handleHidePopOver",value:function(){if(this.docOpsRef){var e=this.docOpsRef.tooltip,t=e.onVisibleChange;e.state.visible&&t(!1)}}},{key:"componentDidMount",value:function(){var e=document.getElementById("viewPageScrollWrapper");e&&e.addEventListener("scroll",this.handleHidePopOver)}},{key:"componentWillUnmount",value:function(){var e=document.getElementById("viewPageScrollWrapper");e&&e.removeEventListener("scroll",this.handleHidePopOver)}},{key:"genCollectIcon",value:function(e){return e?x.a:k.a}},{key:"render",value:function(){var e=this,t=this.props,n=t.hasBeenCollect,r=t.onShowPermPage,o=t.placement,a="view-page-".concat("viewpage-navbar"===o?"top":"right"),i=this.props.store,s=i.ui,u=i.doc,p=s.isInDiffPage,f=s.isInDocPermPage,d=u.isPermInherit,m=u.perm,h=m.hasEditPerm,y=m.hasAdmPerm,b=this.genCollectIcon(n),v=l.a.createElement("ul",{className:"more-list"},l.a.createElement("li",{key:"history",className:"more-ops-item",onClick:function(){e.handleClick("history")}},l.a.createElement(I.a,{className:"icon"})," \u6587\u6863\u5386\u53f2"),y&&[l.a.createElement("li",{key:"export",className:"more-ops-item",onClick:function(){e.handleClick("export")}},l.a.createElement(C.a,{className:"icon"})," \u5bfc\u51fa\u6d4f\u89c8\u6570\u636e")]);return l.a.createElement("div",{className:"doc-ops-bar"},p||f?l.a.createElement("div",{className:"doc-ops diff-ops"},l.a.createElement("span",{className:"ops-item back",onClick:this.toViewPage},"\u8fd4\u56de\u6d4f\u89c8")):l.a.createElement("div",{className:"doc-ops"},h&&l.a.createElement(c.a,{placement:"bottom",title:"\u7f16\u8f91"},l.a.createElement("button",{className:"ops-item",onClick:function(){Object(M.a)(_.a["".concat(a,"-edit")]),e.props.onEdit()}},l.a.createElement(P.a,{className:"ops-icon"}))),l.a.createElement(c.a,{placement:"bottom",title:n?"\u53d6\u6d88\u6536\u85cf":"\u6536\u85cf",ref:function(t){e.collectTip=t}},l.a.createElement("button",{className:"ops-item",onClick:function(){Object(M.a)(_.a["".concat(a,"-collect")]),e.handleCollect()}},l.a.createElement(b,{className:B()("collect-icon","ops-icon",{collect:n})}))),l.a.createElement(c.a,{placement:"bottom",title:"\u6743\u9650\u7ba1\u7406"},l.a.createElement("button",{className:"ops-item",onClick:function(){Object(M.a)(_.a["".concat(a,"-manage")]),r()}},d?l.a.createElement(D.a,{className:"inherit ops-icon"}):l.a.createElement(A.a,{className:"lock ops-icon"}))),l.a.createElement(E.a,{overlayClassName:"doc-ops-more",content:v,trigger:"click",placement:"bottomRight",onVisibleChange:function(t){e.setState({visible:t})},ref:function(t){e.docOpsRef=t}},l.a.createElement("button",{className:"ops-item"},l.a.createElement(T.a,{className:"ops-icon ellipsis"})))))}}])&&H(n.prototype,r),o&&H(n,o),t}())||r)||r,q=n("../client/src/components/Modal/HistoryModal/index.js"),G=n("../client/src/components/Modal/SecretSettingModal/index.js"),Q=n("../client/src/components/Comment/index.js"),X=n("../client/src/components/SecretTag/index.js"),Y=n("../client/src/assets/svg/rocket.svg"),J=n("../client/src/assets/svg/guide-tip.svg"),Z=n("../client/src/utils/request.js"),$=n("../client/src/utils/tools.js"),ee=n("../client/src/utils/logger.js"),te=n("../client/src/utils/userInfo.js"),ne=n("../client/src/stores/Doc/handle.js"),re=n("../client/src/events/index.js"),oe=n("../client/src/consts/index.js"),ae=n("../client/src/events/type.js"),ie=n("../client/src/containers/ViewPage/PluginsToView/lazyload.js"),ce=n("../client/src/containers/ViewPage/PluginsToView/tableToView.js"),se=n("../client/src/containers/ViewPage/ImagesViewer/index.js"),le=n("../client/src/containers/ViewPage/utils.js"),ue=n("../client/src/containers/ViewPage/task.js"),pe=n("../client/src/containers/ViewPage/wikiLink.js"),fe=n("../client/src/containers/ViewPage/tableSort.js"),de=n("../client/src/containers/ViewPage/DocBody.js"),me=n("../client/src/containers/OpenPage/utils.js");function he(e){return(he="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var je=101,Oe=69,Se=Object(u.inject)("store")(U=Object(u.observer)(U=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ve(t).call(this,e),(n=!o||"object"!==he(o)&&"function"!==typeof o?ge(r):o).isMount=!0,n.editor=null,n.notitionKey=4e3*Math.random(),n.pollingTimer=null,n.pageId=0,n.state={notFound:!1,hadDeleted:!1,netWorkError:!1,historyVisible:!1,secretSettingVisible:!1,showImages:!1,viewPageImages:[],curImage:null,current:"doc",isHistoryEditor:!1,isShowSecretTip:!1,docContentLoaded:!1,isInMT:!1,isDocDeleted:!1,isShowRecoverTip:!1},n.curVersion=null,n.handleScrollListen=f()(n.handleThrottle.bind(ge(n)),100),n.config={commentHide:!1,opsHide:!1,likeHide:!1,secretHide:!1,crumbsHide:!1,editInfoHide:!1,pageDataHide:!1,secretTipHide:!1},n.setPageConfig=function(){var e=location.search.split("&")[1],t=new URLSearchParams(location.search).get("min");if(t){var r=document.getElementById("ct-layout");r&&(r.style.minWidth="".concat(t,"px"))}if(e){var o=e.includes("a"),a=e.includes("b"),i=e.includes("c"),c=e.includes("d"),s=e.includes("e"),l=e.includes("f"),u=e.includes("g"),p=e.includes("h"),f=e.includes("i");n.config={commentHide:o,opsHide:a,likeHide:i,secretHide:c,crumbsHide:s,editInfoHide:l,pageDataHide:u,secretTipHide:p,titlePHide:f}}},n.initSecretVisible=function(e){var t=n.props.store,r=t.doc,o=t.space,a=r.getIsConfirmSecret,i=r.isUnsetSecret;return o.checkIsInMT(e).then(function(e){if(n.setState({isInMT:e}),e){if(r.page.deleted)return;i?n.setState({isHistoryEditor:!0,isShowSecretTip:!0,secretSettingVisible:!0}):(n.checkIsHistoryEditor(),a(n.pageId).then(function(e){n.setState({isShowSecretTip:!e})}).catch(function(e){return Object($.t)(e)}))}})},n.checkIsHistoryEditor=function(){var e=n.props.store,t=e.doc,r=e.user;t.perm.hasEditPerm&&t.docVersions(n.pageId,0,999,!1).then(function(e){var t=r.userInfo.account,o=new Set(e.models.map(function(e){return e.modifier})),a=Array.from(o).indexOf(t)>-1;n.setState({isHistoryEditor:a})}).catch(function(e){return Object($.t)(e)})},n.handleDocDeleted=function(e){var t=n.props.store.ui,r=!!e;r&&t.sideBarVisible&&t.setSideBarVisible(!1),n.setState({isDocDeleted:r,isShowRecoverTip:r})},n.hideRecoverTip=function(){return n.setState({isShowRecoverTip:!1})},n.closeNotion=function(){d.a.close(n.notitionKey)},n.clearPolling=function(e){clearTimeout(e),n.pollingTimer=null},n.handleMouseWheel=function(e){if(e.target.closest(".cloneHeader")){var t=0;if(e.wheelDelta?t=e.wheelDelta>0?1:-1:e.detail&&(t=e.detail>0?1:-1),0!==t){var n=document.getElementById("viewPageScrollWrapper");if(!n)return;1===t?n.scrollTop-=6:n.scrollTop+=6}}},n.handleClick=function(e){if(!n.state.isDocDeleted){var t=e.target;if(t){var r=t.parentElement,o=r.parentElement,a=t.classList,i=r.classList,c=o.classList,s="img"===t.nodeName.toLowerCase()&&(i.contains("ct-image")||i.contains("ct-drawio")),l=a.contains("ct-link")||i.contains("ct-link")||i.contains("ct-edit-link"),u=!t.closest(".ct-drawio-failed")&&t.closest(".ct-drawio"),p=s&&(c.contains("ct-link")||c.contains("ct-edit-link")),f=s&&t.getAttribute("data-link"),d=a.contains("ct-task-li")||a.contains("ct-task-li-checked"),m=t.closest("th");if(d){var h=n.props.match.params.pageId;Object(ue.a)(t,h)}else if(f){if(t.closest(".ct-editor"))return;var y=t.getAttribute("data-link");window.open(y)}else if(l||p){var b=t.href||t.parentElement.href,v=t.parentElement&&t.parentElement.parentElement.href,g=l?b:v;if(!g)return;Object(pe.a)(g,e)}else if(s||u){if(t.closest(".ct-comment"))return;var w=t.getAttribute("data-origin")||t.getAttribute("data-src")||t.closest(".ct-drawio>img")&&t.closest(".ct-drawio>img").getAttribute("data-src")||t.closest(".ct-drawio")&&t.closest(".ct-drawio").getAttribute("data-src");n.setState({showImages:!0,curImage:w,viewPageImages:n.getAllImagesInContent()})}else m&&Object(fe.a)(e)}}},n.getAllImagesInContent=function(){var e=document.querySelector(".ct-editor-wrapper").querySelectorAll(".ct-image>img, .ct-drawio");return Array.from(e).filter(function(e){return!e.closest(".cloneHeader")}).map(function(e){var t=e.getAttribute("data-xml");return!e.classList.contains("ct-drawio")||"string"===typeof t&&t.includes("http")?{src:"img://".concat(e.getAttribute("data-origin")||e.getAttribute("data-src")),alt:e.alt}:{src:"svg://".concat(e.getAttribute("data-src")),alt:"drawio"}})},n.initLoadDoc=function(){var e=n.props.store,t=e.sideBar,r=e.doc,o=n.props.spaceId,a=n.props.match.params.pageId,i=r.opsState;i.loadPageState=oe.t.PENDING,o?(t.setCurrent(o,a),n.handleLoadDoc(a,o)):t.getSpaceId(a).then(function(e){t.setCurrent(e,a),n.handleLoadDoc(a,e)}).catch(function(e){i.loadPageState=oe.t.ERROR,n.handleCatchPageError(e),console.error(e.message)})},n.handleSpaceHomePage=function(e){R.a.replace("".concat(N.a.primaryPath,"/space/").concat(e))},n.handleLoadDoc=function(e,t){if(0!==t){if(e&&+t){var r=n.props.store,o=r.doc,a=r.sideBar,i=r.user,c=r.ui,s=o.setCurrentPageId,l=o.loadDoc,u=o.getDocPermDetail;n.pageId=e,s(e),n.resetState(),l(t,e).then(function(r){if(n.setState({netWorkError:!1,docContentLoaded:!0}),r){var o=r.deleted;n.initSecretVisible(t),n.handleDocDeleted(o);var s=Object($.k)().pageName;r.parentId!==oe.q||"page"!==s?(n.isMount&&(n.curVersion=null,document.title=r.title,c.isInViewPage&&!o&&c.setSideBarVisible(!0),i.checkUserInfo([r.creator,r.modifier]),a.updateTreeDataByKey(e,"updateTitle",r.title)),n.pollingUpdate()):n.handleSpaceHomePage(r.spaceId)}}).catch(n.handleCatchPageError),u(e)}}else n.handlePageNotFound()},n.resetState=function(){document.title="\u6d4f\u89c8\u6587\u6863",n.setState({notFound:!1,hadDeleted:!1,historyVisible:!1,isShowSecretTip:!1,isShowRecoverTip:!1,isHistoryEditor:!1,isInMT:!1})},n.hotKeyHandler=function(e){e.which!==je&&e.which!==Oe&&e.keyCode!==je&&e.keyCode!==Oe||"INPUT"===e.target.nodeName||"TEXTAREA"===e.target.nodeName||e.target.classList.contains("ProseMirror")||(n.props.store.doc.perm.hasEditPerm?n.toEdit():O.a.error("\u60a8\u6ca1\u6709\u6b64\u6587\u6863\u7684\u7f16\u8f91\u6743\u9650"))},n.reload=function(){var e=n.props.store,t=e.doc,r=e.sideBar,o=e.ui,a=t.loadDoc,i=t.page,c=i.spaceId,s=i.pageId;n.state.historyVisible&&n.setState({historyVisible:!1}),n.closeNotion();var l=document.getElementById("viewPageScrollWrapper");o.viewPageScrollTop=l.scrollTop,a(c,s).then(function(e){r.updateTreeDataByKey(s,"updateTitle",e.title)}).catch(n.handleCatchPageError)},n.pollingUpdate=function(){var e=n.props.store,t=e.doc,r=e.sideBar,o=e.user,a=e.ui,i=t.judgeWhetheUpdate,c=ge(n).reload,s=0;n.clearPolling(n.pollingTimer),function e(){if(!(s>=3))if(document.hidden)n.pollingTimer=setTimeout(e,1e4);else{var t=r.spaceId,l=r.pageId;i(t,l).then(function(e){if((s=0,n.pollingTimer)&&(+n.props.match.params.pageId===+l&&e.update&&e.updater!==te.a.login))return o.checkUserInfo([e.updater]).then(function(){var t=Object(le.b)(e,c,n.notitionKey);n.curVersion!==e.newVersion&&(ee.a.info("viewpage polling: curVersion,",n.curVersion,"newVersion",e.newVersion),n.closeNotion(),a.isInViewPage&&d.a.success(t),n.curVersion=e.newVersion)})}).catch(function(){s++}),n.pollingTimer=setTimeout(e,1e4)}}()},n.toEdit=function(){var e=n.props.match.params.pageId;window.open("".concat(N.a.primaryPath,"/page/").concat(e,"?action=edit"))},n.collect=function(){var e=n.props.store.doc,t=e.collectDoc,r=e.cancelCollect,o=e.hasBeenCollect,a=n.props.match.params.pageId,i=o?"\u53d6\u6d88\u6536\u85cf\u6210\u529f":"\u6536\u85cf\u6210\u529f";(o?r:t)(a).then(function(){return O.a.success(i)}).catch(function(e){Object($.t)(e,i,function(t){603===t&&O.a.error(e.message)})})},n.restoreDoc=function(){var e=n.props.store,t=e.doc,r=e.sideBar,o=t.page,a=o.spaceId,i=o.contentId;Object(ne.b)({spaceId:a,pageId:i,restoreResolve:function(){r.setShouldSetTree(!0),n.handleLoadDoc(i,a)}})},n.onExportViewData=function(){var e=n.props.store.sideBar.pageId,t=O.a.loading("\u6b63\u5728\u5bfc\u51fa");Object(Z.c)("/api/operationHistory/export/".concat(e),null,{isRedirect:!1,timeout:6e4}).then(function(e){t(),e&&Object(le.a)(e)}).catch(function(){t(O.a.error("\u5bfc\u51fa\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"))})},n.toggleHistory=function(){var e=n.state.historyVisible;n.setState({historyVisible:!e})},n.showSecretSetting=function(){n.setState({secretSettingVisible:!0})},n.cancelSecretSetting=function(){var e=n.props.store.doc;e.isUnsetSecret&&(e.isUnsetSecret=!1),n.setState({secretSettingVisible:!1})},n.recoverHistory=function(e){var t=n.props.store,r=t.doc,o=t.sideBar,a=r.recoverDoc,i=r.loadDoc,c=o.spaceId,s=o.pageId,l=o.updateTreeDataByKey,u=e.version;return a(c,s,u).then(function(){i(c,s).then(function(e){return l(s,"update",{text:e.title})}).catch(n.handleCatchPageError)}).catch(function(){return O.a.error("\u66f4\u65b0\u5931\u8d25")})},n.removeHistory=function(e){var t=n.props.store,r=t.doc,o=t.sideBar;return(0,r.deleteDoc)(o.spaceId,e.contentId).then(function(){return O.a.success("\u5220\u9664\u6210\u529f")}).catch(function(e){e.message?O.a.error(e.message):O.a.error("\u5220\u9664\u5931\u8d25")})},n.handleCatchPageError=function(e){switch(e.status){case 619:n.handlePageNoPerm();break;case 601:n.handlePageError();break;case 603:n.handlePageDeleted();break;case 627:n.handlePageNotFound();break;default:console.error(e),n.handlePageError()}},n.handlePageNoPerm=function(){n.props.store.doc.updatePagePerm({hasReadPerm:!1,hasEditPerm:!1,hasAdmPerm:!1,hasAddPerm:!1,hasDeletePerm:!1})},n.handlePageNotFound=function(){n.setState({notFound:!0})},n.handlePageError=function(){n.setState({netWorkError:!0})},n.handlePageDeleted=function(){var e=n.props.store,t=e.sideBar,r=e.ui;t.updateTreeDataByKey(t.pageId,"del"),n.setState({hadDeleted:!0}),"workspace"===r.navBarActiveLink||t.expandedKeys.length||r.setSideBarVisible(!1)},n.handleListenPageDeleted=function(){n.setState({hadDeleted:!0})},n.showVersion=function(){var e=n.props.store.sideBar.pageId;R.a.push("".concat(N.a.primaryPath,"/diff/").concat(e))},n.scrollToViewPos=function(){var e=n.props.store.ui;e.viewPageScrollTop&&(document.getElementById("viewPageScrollWrapper").scrollTop=e.viewPageScrollTop,e.viewPageScrollTop=null)},n.toViewPage=function(){var e=n.props.match.params.pageId;R.a.push("".concat(N.a.primaryPath,"/page/").concat(e))},n.toManagePage=function(){var e=n.props.match.params.pageId;R.a.push("".concat(N.a.primaryPath,"/manage/page/").concat(e))},n.setSecret=function(e){return n.props.store.doc.setSecretLevel(n.pageId,e).then(function(){return n.handleSecretChange(e)}).then(function(){O.a.success("\u5bc6\u7ea7\u8bbe\u7f6e\u6210\u529f")}).catch(function(e){601===e.status?O.a.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bbe\u7f6e\u6587\u6863\u5bc6\u7ea7\u5931\u8d25"):Object($.t)(e)})},n.confirmSecret=function(e){var t=n.props.store.doc,r=ge(n).pageId,o=t.ifNeedAddSecretForChildren(r).catch(function(){throw new Error('Method "checkChildrenIfHasSecret" call failed')}),a=n.setSecret(e);Promise.all([o,a]).then(function(n){ye(n,1)[0]&&Object(le.f)({selectedSecret:e,onOk:function(n){return t.addSecretForChildren(r,{secretLevel:e,contentId:r}).then(function(){n(),O.a.success("\u8bbe\u7f6e\u5b50\u6587\u6863\u5bc6\u7ea7\u6210\u529f")}).catch(function(e){601===e.status?O.a.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bbe\u7f6e\u5b50\u6587\u6863\u5bc6\u7ea7\u5931\u8d25"):Object($.t)(e)})}})})},n.handleSecretChange=function(e){var t=n.props.store.doc;t.isUnsetSecret&&(t.isUnsetSecret=!1),t.updateSecretLevel(e),n.setState({isShowSecretTip:!1})},n.setPageConfig(),n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(t,s["Component"]),n=t,(r=[{key:"componentWillMount",value:function(){this.props.store.doc.resetPage()}},{key:"componentDidMount",value:function(){var e=this.props.store.ui;e.setSideBarWidth(0),e.setNavBarVisible(!1),e.setSideBarControlVisible(!1),e.setFeedBackVisible(!1),e.setIsInViewPage(!0),this.isMount=!0,document.title="\u6d4f\u89c8\u6587\u6863",re.a.on(ae.o,this.handleScrollListen),re.a.on(ae.o,ce.tableHorizonScroll),re.a.on(ae.k,this.handlePageNotFound),re.a.on(ae.e,this.handleListenPageDeleted),re.a.on(ae.j,this.handlePageError),re.a.on(ae.l,this.handlePageNoPerm),document.addEventListener("keypress",this.hotKeyHandler,!1);var t=document.getElementById("page-wrapper");t.style.overflowY="hidden",t.addEventListener("click",this.handleClick,!1),t.addEventListener("mousewheel",this.handleMouseWheel),this.initLoadDoc(),Object(M.e)("c_i4v5ie50"),this.dispose=Object(me.a)(function(e){parent.postMessage({height:e},"*")})}},{key:"componentWillReceiveProps",value:function(e){var t=e.store,n=t.ui,r=t.sideBar,o=e.match.params.pageId,a=this.props.spaceId||r.spaceId;if(o!==this.pageId){this.clearPolling(this.pollingTimer),this.setState({docContentLoaded:!1}),this.handleLoadDoc(o,a),this.closeNotion();var i=document.getElementById("viewPageScrollWrapper");i&&(i.scrollTop=0),n.setViewPageNavBarVisible(!1),Object(M.e)("c_i4v5ie50")}}},{key:"componentWillUnmount",value:function(){this.isMount=!1;var e=this.props.store.ui;e.setSideBarVisible(!0),e.setIsInViewPage(!1),e.setViewPageNavBarVisible(!1),re.a.removeListener(ae.o,this.handleScrollListen),re.a.removeListener(ae.o,ce.tableHorizonScroll),re.a.removeListener(ae.k,this.handlePageNotFound),re.a.removeListener(ae.e,this.handleListenPageDeleted),re.a.removeListener(ae.j,this.handlePageError),re.a.removeListener(ae.l,this.handlePageNoPerm),this.clearPolling(this.pollingTimer),this.closeNotion(),document.removeEventListener("keypress",this.hotKeyHandler);var t=document.getElementById("page-wrapper");t.style.overflowY="auto",t.removeEventListener("click",this.handleClick,!1),t.removeEventListener("mousewheel",this.handleMouseWheel),this.dispose()}},{key:"handleThrottle",value:function(e){var t=document.getElementById("viewPageScrollWrapper");Object(ie.a)(t),Object(ce.tableHeadFixed)(e)}},{key:"render",value:function(){var e=this,t=this.state,n=t.notFound,r=t.hadDeleted,o=t.netWorkError,i=t.historyVisible,s=t.secretSettingVisible,u=t.showImages,p=t.viewPageImages,f=t.curImage,d=t.isHistoryEditor,O=t.isShowSecretTip,S=t.docContentLoaded,E=t.isInMT,P=t.isDocDeleted,k=t.isShowRecoverTip,x=this.config,C=x.commentHide,T=x.secretHide,I=x.opsHide,A=x.likeHide,D=x.crumbsHide,N=x.editInfoHide,M=x.pageDataHide,_=x.secretTipHide,L=x.titlePHide,B=this.props.store,R=B.doc,V=B.sideBar,H=B.user,z=B.ui,W=this.props.operateBar,F=R.navTrack,U=R.perm,Z=R.hasBeenCollect,ee=R.docVersions,te=R.page,ne=R.opsState,re=R.likeDoc,ae=R.cancelLikeDoc,ie=V.spaceId,ce=this.props.match.params.pageId,ue=H.userInfos,pe=te.isLike,fe=te.secretLevel;return o?l.a.createElement(y.a,{pageId:ce,showButton:!0,text:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"}):n?l.a.createElement(m.default,{text:"\u8be5\u6587\u6863\u4e0d\u5b58\u5728"}):r?l.a.createElement(h.a,null):U&&U.hasReadPerm?ne.loadPageState===oe.t.PENDING?l.a.createElement("div",{className:"ct-page ct-space"},l.a.createElement(v.a,null)):S?l.a.createElement("div",{className:"viewpage-scroll-wrapper",id:"viewPageScrollWrapper"},l.a.createElement("div",{className:"ct-view-page ".concat(P?"deleted":""),style:{paddingLeft:32}},E&&!s&&d&&O&&Object(le.e)(fe,X.a,this.confirmSecret,this.showSecretSetting),k&&Object(le.d)(this.restoreDoc,this.hideRecoverTip),!P&&(W||(D&&I?null:l.a.createElement("div",{className:"document-head"},D?l.a.createElement("div",{className:"nav"},l.a.createElement("div",{className:"crumbs-nav-bar"})):l.a.createElement("div",{className:"nav"},l.a.createElement(g.a,{track:F,sideBar:V,ui:z})),!I&&l.a.createElement("div",{className:"ops"},l.a.createElement(K,{placement:"viewpage",perm:U,hasBeenCollect:Z,onEdit:this.toEdit,onCollect:this.collect,onShowHistory:this.toggleHistory,onExportViewData:this.onExportViewData,onShowPermPage:this.toManagePage}))))),l.a.createElement("div",{className:"document-editor"},l.a.createElement("div",{className:"ct-editor-wrapper"},l.a.createElement("div",{className:"ct-title-wrapper"},!L&&l.a.createElement("p",{className:"ct-title-p"},te.title),l.a.createElement("div",{className:"ct-doc-info"},E&&!T&&l.a.createElement(X.a,{hasEditPerm:U.hasEditPerm,level:fe,showSecretSetting:this.showSecretSetting,isDocDeleted:P}),!N&&l.a.createElement("span",null,"\u521b\u5efa:"," ",l.a.createElement(w.b,{mis:te.creator,placement:P?"topLeft":"top",arrowPointAtCenter:!0}),", \u6700\u540e\u4fee\u6539: ",l.a.createElement(w.b,{mis:te.modifier}),l.a.createElement(c.a,{placement:"top",title:"\u67e5\u770b\u5386\u53f2\u7248\u672c"},l.a.createElement("span",{className:"modify-time",onClick:this.showVersion},Object($.g)(te.modifyTime)))))),l.a.createElement(de.a,{scrollToViewPos:this.scrollToViewPos,body:te.body}),u&&l.a.createElement(se.a,{images:p,curImage:f,onClose:function(){e.setState({showImages:!1})}})),!_&&l.a.createElement("div",{className:"secrecy"},l.a.createElement("span",{className:"secrecy-inner"},l.a.createElement(J.a,{className:"light-icon"}),"\u4ec5\u4f9b\u5185\u90e8\u4f7f\u7528\uff0c\u672a\u7ecf\u6388\u6743\uff0c\u5207\u52ff\u5916\u4f20")),!M&&l.a.createElement(j.a,{isDocDeleted:P,isLike:pe,opsState:ne,likeCount:te.likeCount,browseCount:te.browseCount,browseHeadCount:te.browseHeadCount,cancelLikeDoc:ae,likeDoc:re,pageId:ce,showLikeEntry:!A}),!C&&l.a.createElement(Q.a,{pageId:ce,spaceId:ie})),!P&&l.a.createElement(q.a,{show:i,onClose:this.toggleHistory,recover:this.recoverHistory,remove:this.removeHistory,onFetch:ee.bind(this,ce),userInfos:ue,checkUserInfo:H.checkUserInfo,sideBar:V}),!P&&l.a.createElement(G.a,{spaceId:ie,pageId:ce,currentSecretLevel:fe,visible:s,handleCancel:this.cancelSecretSetting,onChange:this.handleSecretChange})),l.a.createElement(a.a,{visibilityHeight:2.5*window.innerHeight,target:function(){return document.getElementById("viewPageScrollWrapper")}},l.a.createElement(Y.a,null))):null:l.a.createElement(b.a,{pageId:ce})}}])&&be(n.prototype,r),o&&be(n,o),t}())||U)||U;t.default=Se},"../client/src/containers/ViewPage/ImagesViewer/index.js":function(e,t,n){"use strict";n.d(t,"a",function(){return f});n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./core-js/modules/es6.regexp.split.js"),n("./core-js/modules/es6.array.find-index.js");var r=n("./react/index.js"),o=n.n(r),a=n("../client/src/components/Viewer/index.js");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,u(t).apply(this,arguments))}var n,i,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,r["Component"]),n=t,(i=[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.images,r=e.curImage,i=n&&n.findIndex(function(e){var t=c(e.src.split("://"),1)[0];return e.src.slice(t.length+3)===r});return o.a.createElement(a.a,{visible:!0,images:n,activeIndex:i,onClose:t,onMaskClick:t})}}])&&s(n.prototype,i),f&&s(n,f),t}()},"../client/src/containers/ViewPage/index.js":function(e,t,n){"use strict";n("./core-js/modules/es6.regexp.to-string.js"),n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./antd/lib/back-top/style/index.js");var r=n("./antd/lib/back-top/index.js"),o=n.n(r),a=(n("./antd/lib/tooltip/style/index.js"),n("./antd/lib/tooltip/index.js")),i=n.n(a),c=(n("./core-js/modules/es6.regexp.search.js"),n("./core-js/modules/es6.regexp.split.js"),n("./core-js/modules/es6.regexp.replace.js"),n("./core-js/modules/es7.array.includes.js"),n("./core-js/modules/es6.string.includes.js"),n("./core-js/modules/es6.regexp.match.js"),n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/es6.set.js"),n("./core-js/modules/es6.promise.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.string.iterator.js"),n("./react/index.js")),s=n.n(c),l=n("./mobx/lib/mobx.module.js"),u=n("./mobx-react/index.module.js"),p=n("./lodash.throttle/index.js"),f=n.n(p),d=n("./react-hot-keys/es/index.js"),m=n("../client/src/components/ui/notification/index.js"),h=n("../client/src/components/CommonUI/NotFound/index.js"),y=n("../client/src/components/CommonUI/Deleted/index.js"),b=n("../client/src/components/CommonUI/NetWorkError/index.js"),v=n("../client/src/components/CommonUI/NoPerm/index.js"),g=n("../client/src/components/CommonUI/Loading/index.js"),w=n("../client/src/components/DocRecycled/index.jsx"),j=n("../client/src/components/CrumbsNavBar/index.js"),O=n("../client/src/components/UserName/index.js"),S=(n("../client/src/components/CommonUI/like/style.styl"),n("./classnames/index.js")),E=n.n(S);function P(e){return(P="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return!t||"object"!==P(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=300,A=function(){},D=null,N=null,M=null,_=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=x(this,(e=C(t)).call.apply(e,[this].concat(o)))).state={liked:n.props.liked,likeFn:n.props.likeFn||A,cancelFn:n.props.cancelFn||A,clapCount:1,longPress:!1,shortPress:!1},n.handleMouseDown=function(){N=+new Date,D=setTimeout(function(){n.longPressAction()},I)},n.handleMouseUp=function(){+new Date-N<I?(clearInterval(D),clearInterval(M),n.clickAction()):(clearInterval(M),n.setState({longPress:!1}))},n.preventRightClick=function(e){e.preventDefault()},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,s.a.Component),n=t,(r=[{key:"setRotateDeg",value:function(){var e=Math.floor(30*Math.random()),t="".concat(e+10+Math.floor(20*Math.random()));this.setState({rotateDeg1:e,rotateDeg2:t})}},{key:"clickAction",value:function(){var e=this;if(this.state.liked)return this.state.cancelFn(),void this.setState({liked:!1});this.state.likeFn(),this.setRotateDeg(),this.setState({liked:!0,shortPress:!0}),this.clapCount.innerHTML="+1",setTimeout(function(){e.clap.className=E()("ct-clap-animation"),e.setState({shortPress:!1})},1160)}},{key:"longPressAction",value:function(){var e=this,t=1;if(this.state.liked)return this.setState({liked:!1,longPress:!1}),void this.state.cancelFn();this.setRotateDeg(),this.setState({longPress:!0,liked:!0}),M=setInterval(function(){t>=42&&clearInterval(M),e.clapCount.innerHTML="+"+t++},120),this.state.likeFn()}},{key:"componentDidMount",value:function(){window.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t={"ct-clap-animation-active-short":this.state.shortPress,"ct-clap-animation-active-long":this.state.longPress};return s.a.createElement("div",{className:E()("ct-like-btn",{"ct-clap-liked":this.state.liked})},s.a.createElement("div",{ref:function(t){e.clap=t},className:E()("ct-clap-animation",t),onMouseDown:this.handleMouseDown,onContextMenu:this.preventRightClick},s.a.createElement("div",{className:"clap-like-count"},this.props.likeComponent),s.a.createElement("div",{className:"clap-bg"},s.a.createElement("span",{className:"hand"},"\ud83d\udc4f")),s.a.createElement("div",{className:"clap-count",ref:function(t){e.clapCount=t}},"+1"),s.a.createElement("div",{className:"clap-firework-out",style:{transform:"rotate(".concat(this.state.rotateDeg1,"deg)")}},s.a.createElement("div",{className:"clap-firework-circle"})),s.a.createElement("div",{className:"clap-firework-out",style:{transform:"rotate(".concat(this.state.rotateDeg2,"deg)")}},s.a.createElement("div",{className:"clap-firework-angle"})),s.a.createElement("div",{className:"clap-joint"}),s.a.createElement("div",{className:"clap-papapa-out"},s.a.createElement("div",{className:"clap-papapa"}))))}}])&&k(n.prototype,r),o&&k(n,o),t}(),L=(n("../client/src/components/DocPageLike/style.styl"),n("../client/src/consts/index.js")),B=function(e){var t=e.isLike,n=e.opsState,r=e.cancelLikeDoc,o=e.likeDoc,a=e.pageId,i=e.isDocDeleted,c=e.likeCount;return s.a.createElement("div",{className:"page-like-data"},s.a.createElement(_,{liked:t,cancelFn:function(){n.likeState!==L.t.PENDING&&!i&&r(a)},likeFn:function(){n.likeState!==L.t.PENDING&&!i&&o(a)},likeComponent:s.a.createElement("div",{className:E()("ct-like-count",{"ct-liked":t})},c>0?"".concat(c,"\u4eba\u8d5e\u8d4f"):"\u6682\u65e0\u8d5e\u8d4f\uff0c\u9f13\u52b1\u4e00\u4e0b")}))},R=n("../client/src/components/Toastr/index.js"),V=n("../client/src/components/DocOps/index.js"),H=(n("./core-js/modules/es7.object.get-own-property-descriptors.js"),n("./core-js/modules/es6.object.keys.js"),n("./antd/lib/divider/style/index.js"),n("./antd/lib/divider/index.js")),z=n.n(H);n("./core-js/modules/es6.object.assign.js");function W(e){return(W="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t){return!t||"object"!==W(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),K(this,q(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",F({width:"20",height:"20",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},this.props),s.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},s.a.createElement("g",{id:"\\u6F14\\u793A_\\u6309esc\\u5373\\u53EF\\u9000\\u51FA\\u5168\\u5C4F",transform:"translate(-1400 -22)"},s.a.createElement("g",{id:"top"},s.a.createElement("g",{id:"\\u5168\\u5C4F",transform:"translate(1375)"},s.a.createElement("g",{id:"mtdicon/outlined/rounded/fullscreen-o",transform:"translate(25 22)"},s.a.createElement("path",{d:"M11.72 4.92L9.28 7.36l-.71-.7 2.45-2.45-.83-.83 3.19-.82-.83 3.18-.83-.82zm-6.8 6.8l.82.83-3.18.83.82-3.19.83.83 2.45-2.45.7.7-2.44 2.45zm6.1.03L8.57 9.3l.7-.7 2.46 2.44.82-.82.83 3.18-3.19-.82.83-.83zm-6.8-6.8l-.84.82-.82-3.18 3.18.82-.82.83 2.45 2.44-.71.71L4.2 4.94z",id:"Shape",fill:"#000",fillRule:"nonzero"})))))))}}])&&U(n.prototype,r),o&&U(n,o),t}();function X(e){return(X="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z(e,t){return!t||"object"!==X(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var te=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Z(this,$(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",Y({width:"20",height:"20",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},this.props),s.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},s.a.createElement("g",{id:"\\u6F14\\u793A\\u6A21\\u5F0F_\\u5185\\u5BB9\\u6700\\u5927\\u53161",transform:"translate(-1400 -22)"},s.a.createElement("g",{id:"top"},s.a.createElement("g",{id:"\\u5168\\u5C4F",transform:"translate(1375)"},s.a.createElement("g",{id:"mtdicon/outlined/rounded/exit-fullscreen-o",transform:"translate(25 22)"},s.a.createElement("path",{d:"M11.3 5.39l.83.82-3.18.83.83-3.18.82.82 2.45-2.45.7.7-2.44 2.46zM5.4 11.3l-2.45 2.44-.7-.7 2.44-2.45-.82-.82 3.18-.83-.83 3.18-.82-.82zm-.73-5.92L2.2 2.94l.7-.7 2.45 2.44.83-.82L7 7.04 3.83 6.2l.83-.82zm5.92 5.92l-.83.82-.83-3.18 3.19.83-.83.82 2.45 2.45-.7.7-2.45-2.44z",id:"Shape",fill:"#000",fillRule:"nonzero"})))))))}}])&&J(n.prototype,r),o&&J(n,o),t}(),ne=n("../client/src/assets/svg/left.svg");function re(e){return(re="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(){return(oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return!t||"object"!==re(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var le=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ie(this,ce(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",oe({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),s.a.createElement("defs",null,s.a.createElement("style",null)),s.a.createElement("path",{d:"M448 85.33h64v149.34h-64V85.33zm0 640h64v149.34h-64V725.33zM874.67 448v64H725.33v-64h149.34zm-640 0v64H85.33v-64h149.34zm501.76-269.7l45.27 45.25-105.6 105.6-45.23-45.25 105.58-105.6zm-452.5 452.53l45.22 45.24-105.58 105.6-45.24-45.24 105.6-105.6zm583.12 190.93l-45.25 45.25-404.26-404.27 45.24-45.23 404.27 404.25zM329.17 283.9l-45.24 45.23-105.6-105.58 45.24-45.25 105.6 105.6z"}),s.a.createElement("path",{d:"M384 480a96 96 0 1 0 192 0 96 96 0 1 0-192 0z"}))}}])&&ae(n.prototype,r),o&&ae(n,o),t}();function ue(e){return(ue="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t){return!t||"object"!==ue(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ye=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),de(this,me(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",pe({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),s.a.createElement("defs",null,s.a.createElement("style",null)),s.a.createElement("path",{d:"M448 85.33h64v149.34h-64V85.33zm0 640h64v149.34h-64V725.33zM874.67 448v64H725.33v-64h149.34zm-640 0v64H85.33v-64h149.34zm501.76-269.7l45.27 45.25-105.6 105.6-45.23-45.25 105.58-105.6zm-452.5 452.53l45.22 45.24-105.58 105.6-45.24-45.24 105.6-105.6zm583.12 190.93l-45.25 45.25-404.26-404.27 45.24-45.23 404.27 404.25zM329.17 283.9l-45.24 45.23-105.6-105.58 45.24-45.25 105.6 105.6z",fill:"#d81e06"}),s.a.createElement("path",{d:"M384 480a96 96 0 1 0 192 0 96 96 0 1 0-192 0z",fill:"#d81e06"}))}}])&&fe(n.prototype,r),o&&fe(n,o),t}();function be(e){return(be="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(){return(ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e,t){return!t||"object"!==be(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Se=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),we(this,je(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",ve({width:"20",height:"20",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},this.props),s.a.createElement("g",{id:"texts",fill:"none",fillRule:"evenodd"},s.a.createElement("path",{d:"M25.5 15v21h-3V15H14v-3h20v3h-8.5z",id:"\\u5F62\\u72B6\\u7ED3\\u5408",fill:"#000"})))}}])&&ge(n.prototype,r),o&&ge(n,o),t}();function Ee(e){return(Ee="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(){return(Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t){return!t||"object"!==Ee(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ie=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xe(this,Ce(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",Pe({width:"20",height:"20",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},this.props),s.a.createElement("path",{fill:"#000",d:"M25.5 12v27h-3V12H11V9h26v3z",id:"textm",fillRule:"evenodd"}))}}])&&ke(n.prototype,r),o&&ke(n,o),t}();function Ae(e){return(Ae="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(){return(De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e,t){return!t||"object"!==Ae(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Be,Re=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Me(this,_e(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(t,s.a.Component),n=t,(r=[{key:"render",value:function(){return s.a.createElement("svg",De({width:"20",height:"20",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},this.props),s.a.createElement("path",{fill:"#000",d:"M25.5 9v33h-3V9H8V6h32v3z",id:"textl",fillRule:"evenodd"}))}}])&&Ne(n.prototype,r),o&&Ne(n,o),t}(),Ve=n("../client/src/utils/screenManager.js"),He=n("../client/src/events/index.js"),ze=n("../client/src/events/type.js");n("../client/src/components/DocDemo/Adapter/style.styl");function We(e){return(We="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ue(e,t){return!t||"object"!==We(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qe(e,t){return(qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ge="demo-doc-style",Qe=Object(u.inject)("editor")(Be=Object(u.observer)(Be=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ue(this,Ke(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(t,c["Component"]),n=t,(r=[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.editor.rowNumExtension;this.props.zoomVal!==e.zoomVal&&this.zoomValDidChange(),this.props.demoMode!==e.demoMode&&(this.demoModeDidChange(),setTimeout(function(){var e=document.querySelector(".ct-table_header-fixed-container");if(e){var t=e.getAttribute("data-active-id"),n=document.querySelector('table[data-table-id="'.concat(t,'"]'));n&&(e.style.left="".concat(n.getBoundingClientRect().left-document.querySelector(".doc-demo-body").getBoundingClientRect().left+n.parentElement.scrollLeft,"px"),e.style.width="".concat(n.parentElement.clientWidth,"px"))}},0)),this.props.fixedWidth&&(this.props.demoMode?n.hideRowNum():setTimeout(function(){t.props.hasRowNum&&(n.hideRowNum(),n.showRowNum({docType:"view"}))},0))}},{key:"componentDidMount",value:function(){this.appendDocDemoStyle(),this.props.demoMode&&(document.querySelector(".ct-view-page").style.marginLeft=null,document.body.classList.add("demo-mode"))}},{key:"componentWillUnmount",value:function(){var e=document.getElementById(Ge);e&&e.remove(),document.body.classList.remove("demo-mode"),this.props.editor.rowNumExtension.hideRowNum()}},{key:"zoomValDidChange",value:function(){var e="initial"===this.props.zoomVal?1:this.props.zoomVal;He.a.emit(ze.g,e),document.body.querySelectorAll(".ct-gantt").forEach(function(t){var n=t.getAttribute("data-id"),r=t.querySelector("iframe");r&&r.contentWindow.postMessage({id:n,event:"zoom",content:e},"*")}),this.applyDocDemoStyle(e)}},{key:"appendDocDemoStyle",value:function(){if(!document.getElementById(Ge)){var e=document.createElement("style");e.setAttribute("id",Ge),document.head.append(e)}}},{key:"applyDocDemoStyle",value:function(e){var t=document.getElementById(Ge);if(1===e)t.innerHTML="";else{var n=document.documentElement.clientWidth/e-75,r=[".ct-image-container",".ct-table-wrapper"],o=[".ct-collapse",".ct-video",".ct-audio",".ct-note",".ct-blockquote",".block-wrapper > .ct-calendar","div .block-wrapper > .ct-table-wrapper","ul","ol","p"];t.innerHTML="".concat(r.map(function(e){return".".concat("demo-mode"," ").concat(e)})," {\n        max-width: ").concat(n,"px;\n      }\n      .").concat("demo-mode"," .ct-code {\n        max-width: ").concat(document.documentElement.clientWidth-75,"px;\n      }\n      .").concat("demo-mode"," .CodeMirror-scroll' {\n        max-width: ").concat(document.documentElement.clientWidth-75,"px;\n      }\n      ").concat(o.map(function(e){return".".concat("demo-mode"," ").concat(".pm-body-wrapper"," > ").concat(e)})," {\n        width: ").concat(n,"px;\n      }\n      ").concat(o.map(function(e){return"".concat(r.map(function(t){return".".concat("demo-mode"," ").concat(e," ").concat(t)})," {\n            max-width: 100%;\n          }")}).join("\n"),"\n      ")}}},{key:"demoModeDidChange",value:function(){var e=this.props.demoMode,t=document.body;e?t.classList.add("demo-mode"):t.classList.remove("demo-mode")}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,this.props.children)}}])&&Fe(n.prototype,r),o&&Fe(n,o),t}())||Be)||Be,Xe=(n("../client/src/components/DocDemo/style.styl"),n("./core-js/modules/es6.array.fill.js"),n("./react-dom/index.js")),Ye=n.n(Xe);n("../client/src/components/DocDemo/Laserpen/style.styl");function Je(e){return(Je="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $e(e,t){return!t||"object"!==Je(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nt,rt=[],ot=[".ct-html",".ct-gantt",".ct-markdown"],at=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=$e(this,et(t).call(this,e))).drawPointer=function(e,t){var r={left:e,top:t,canvas:n.$canvas.current},o=n.draw.bind(r);return rt.push(o),o},n.hidePointerinIframe=function(e){requestAnimationFrame(function(){n.$canvas.current.getContext("2d").clearRect(0,0,n.width,n.height)})},n.bindFunctionToSelector=function(e,t,n,r){document.querySelectorAll(t).forEach(function(t){t["".concat(e,"EventListener")](n,r)})},n.$canvas=s.a.createRef(),n.width=document.body.clientWidth,n.height=document.body.clientHeight,n.el=document.createElement("div"),n.props.container.appendChild(n.el),n.iframeList=[],n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(t,c["Component"]),n=t,(r=[{key:"draw",value:function(e){var t=e.clientX,n=e.clientY,r=this.canvas.getBoundingClientRect(),o=r.right-r.left,a=r.bottom-r.top,i=function(e,t,n){var r=e.getContext("2d"),o=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||1,a=t,i=n;return e.width=Math.round(a*o),e.height=Math.round(i*o),e.style.width=a+"px",e.style.height=i+"px",r.scale(o,o),r}(this.canvas,o,a),c={x:t+this.left,y:n+this.top-48,r:10};i.clearRect(0,0,o,a),function(e,t,n){var r=t.x,o=t.y;t.r;e.beginPath(),e.strokeStyle="red",e.lineWidth=4,e.arc(r,o,4,0,2*Math.PI),e.closePath(),e.restore(),e.fillStyle="white";var a=new Path2D;a.arc(r,o,2,0,2*Math.PI),e.shadowColor="red",e.shadowBlur=6,e.stroke(),e.fill(a)}(i,c)}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("mousemove",this.drawPointer(0,0)),ot.forEach(function(t){return e.bindFunctionToSelector("add",t,"mouseenter",e.hidePointerinIframe)}),this.props.container.querySelectorAll('iframe[class="ct-frame"]').forEach(function(t){var n=t.getBoundingClientRect();t.contentWindow.addEventListener("mousemove",e.drawPointer(n.x*e.props.zoom,n.y*e.props.zoom))})}},{key:"componentWillUnmount",value:function(){var e=this;this.props.container.removeChild(this.el),window.removeEventListener("mousemove",rt.shift()),ot.forEach(function(t){return e.bindFunctionToSelector("remove",t,"mouseenter",e.hidePointerinIframe)}),this.props.container.querySelectorAll('iframe[class="ct-frame"]').forEach(function(e){e.contentWindow.removeEventListener("mousemove",rt.shift())})}},{key:"render",value:function(){return Ye.a.createPortal(s.a.createElement("canvas",{id:"laser-canvas",ref:this.$canvas,width:this.width,height:this.height}),this.el)}}])&&Ze(n.prototype,r),o&&Ze(n,o),t}();function it(e){return(it="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(n,!0).forEach(function(t){lt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ut(e,t){return!t||"object"!==it(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dt(e,t,n){return t&&ft(e.prototype,t),n&&ft(e,n),e}function mt(e,t){return(mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ht=1.5,yt=[{title:"\u5c0f",val:ht,className:"sm-zoom-icon",component:Se},{title:"\u4e2d",val:1.75,className:"md-zoom-icon",component:Ie},{title:"\u5927",val:2,className:"lg-zoom-icon",component:Re}],bt=["","webkit","moz","ms"],vt=Object(u.inject)("store")(nt=Object(u.observer)(nt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ut(this,pt(t).call(this))).fullscreenElement=null,e.fullscreenChangeListeners=[],e.pointer=null,e.hotkey=function(t){var n=t.metaKey,r=t.ctrlKey,o=76===t.keyCode;27===t.keyCode&&e.state.active&&e.state.laser&&e.toggleLaser(),n&&r&&o&&e.state.active&&e.toggleLaser()},e.fullscreenChange=function(t){e.setState(st({},e.state,{isFullScreen:document["".concat(t,"fullscreenElement")]===e.fullscreenElement}))},e.toggleLaser=function(t){var n=document.querySelector("html").classList.toggle("laser-active");e.setState(st({},e.state,{laser:n}))},e.state={zoomVal:ht,isFullScreen:!1,laser:!1},e.canvas=s.a.createRef(),e.$wrapperBody=s.a.createRef(),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}(t,c["Component"]),dt(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.zoomVal;return e.active!==t.active&&(n=ht),st({},t,{active:e.active,zoomVal:n,isFullScreen:Ve.a.isFullScreen()})}}]),dt(t,[{key:"zoom",value:function(e){this.setState({zoomVal:e})}},{key:"reset",value:function(){this.setState({zoomVal:ht})}},{key:"onQuit",value:function(){this.state.isFullScreen?this.exitFullscreen():(this.setState({laser:!1}),this.reset(),this.props.onQuit(),document.querySelector("html").classList.contains("laser-active")&&document.querySelector("html").classList.toggle("laser-active"))}},{key:"fullscreen",value:function(){Ve.a.launchFullscreen(this.fullscreenElement)}},{key:"exitFullscreen",value:function(){Ve.a.exitFullscreen()}},{key:"toggleFullscreen",value:function(){this.state.isFullScreen?this.exitFullscreen():this.fullscreen()}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this.hotkey);var t=this.fullscreenChangeListeners;bt.forEach(function(n){var r=function(){var t=document["".concat(n,"fullscreenElement")],r=t===e.fullscreenElement;r?Ve.a.launchFullscreen(e.fullscreen):null===t&&Ve.a.exitFullscreen(),e.setState({isFullScreen:r})};t.push(r),document.addEventListener("".concat(n,"fullscreenchange"),r)}),this.fullscreenElement=document.body;var n=document.createElement("div");n.id="laserWrapper",document.body.appendChild(n),this.laserWrapper=n}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.hotkey);var e=this.fullscreenChangeListeners;bt.forEach(function(t,n){document.removeEventListener("".concat(t,"fullscreenchange"),e[n])});var t=document.querySelector("html");t.classList.contains("laser-active")&&t.classList.toggle("laser-active"),document.body.removeChild(this.laserWrapper)}},{key:"render",value:function(){var e=this,t=this.props.store.doc.page.hasRowNum,n=this.state,r=n.isFullScreen,o=n.active,a=o?this.state.zoomVal:"initial";return s.a.createElement("div",{ref:function(t){e.$wrapper=t},style:o?{paddingTop:48}:{},className:"doc-demo"},o?s.a.createElement("div",{key:"doc-demo-header",className:"doc-demo-header"},s.a.createElement(i.a,{title:"".concat(r?"\u70b9\u51fbesc\u53ef\u9000\u51fa\u5168\u5c4f":"\u70b9\u51fbesc\u53ef\u9000\u51fa\u6f14\u793a"),placement:"bottom",getPopupContainer:function(){return e.$wrapper},align:{offset:[0,-10]}},s.a.createElement("div",{className:"quit-btn",onClick:this.onQuit.bind(this)},s.a.createElement("div",{className:"ops-item ops-icon-wrapper "},s.a.createElement(ne.a,{className:"ops-icon"})),r?"\u9000\u51fa\u5168\u5c4f":"\u9000\u51fa\u6f14\u793a")),s.a.createElement("div",{className:"doc-demo-toolbar"},s.a.createElement(i.a,{title:"\u6fc0\u5149\u7b14",placement:"bottom",getPopupContainer:function(){return e.$wrapper}},s.a.createElement("div",{className:"ops-item ops-icon-wrapper ".concat(this.state.laser?"active":""),onClick:this.toggleLaser},this.state.laser?s.a.createElement(ye,{className:"ops-icon"}):s.a.createElement(le,{className:"ops-icon"}))),s.a.createElement(z.a,{type:"vertical",style:{height:"16px"}}),yt.map(function(t){return s.a.createElement(i.a,{key:t.val,title:t.title,placement:"bottom",getPopupContainer:function(){return e.$wrapper}},s.a.createElement("div",{className:"ops-item ops-icon-wrapper  ".concat(a===t.val?"active":""),onClick:e.zoom.bind(e,t.val)},s.a.createElement(t.component,{className:"ops-icon"})))}),s.a.createElement(z.a,{type:"vertical",style:{height:"16px"}}),s.a.createElement(i.a,{title:"".concat(r?"\u9000\u51fa\u5168\u5c4f":"\u5168\u5c4f"),placement:"bottom",getPopupContainer:function(){return e.$wrapper}},s.a.createElement("div",{className:"ops-item ops-icon-wrapper ",onClick:this.toggleFullscreen.bind(this)},r?s.a.createElement(te,{className:"ops-icon"}):s.a.createElement(Q,{className:"ops-icon"}))))):null,s.a.createElement(Qe,{demoMode:o,zoomVal:a,fixedWidth:this.props.fixedWidth,hasRowNum:t},this.state.laser?s.a.createElement(at,{key:function(){return Math.random().toFixed(5).toString()},container:this.laserWrapper,zoom:a}):null,s.a.createElement("div",{ref:this.$wrapperBody,className:"doc-demo-body",style:{zoom:a}},this.props.children)))}}]),t}())||nt)||nt,gt=n("../client/src/components/Modal/HistoryModal/index.js"),wt=n("../client/src/components/Modal/MoveDocModal/index.js"),jt=n("../client/src/components/Modal/DocSortModal/index.js"),Ot=n("../client/src/components/Modal/CollectPosChangeModal/index.js"),St=n("../client/src/components/Modal/SecretSettingModal/index.js"),Et=n("../client/src/components/Comment/index.js"),Pt=n("../client/src/components/SecretTag/index.js"),kt=n("../client/src/containers/ManagePage/index.js"),xt=n("../client/src/assets/svg/rocket.svg"),Ct=n("../client/src/assets/svg/guide-tip.svg"),Tt=n("../client/src/utils/request.js"),It=n("../client/src/utils/tools.js"),At=n("../client/src/stores/Doc/utils.js"),Dt=n("../client/src/utils/logger.js"),Nt=n("../client/src/utils/userInfo.js"),Mt=n("../client/src/utils/report/lx.js"),_t=n("../client/src/containers/ViewPage/PluginsToView/blockWrapper/popupManager.js"),Lt=n("../client/src/containers/ViewPage/PluginsToView/blockWrapper/index.js"),Bt=n("../client/src/stores/Doc/handle.js"),Rt=n("../client/src/history.js"),Vt=n("../client/src/utils/config.js"),Ht=n("../client/src/assets/svg/close.svg"),zt=n("../client/src/containers/ViewPage/PluginsToView/tableToView.js"),Wt=n("../client/src/editor/modules/catalog/utils.js");function Ft(e){return(Ft="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kt(e,t){return!t||"object"!==Ft(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qt(e){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qt="show-catalog",Xt="catalog-animating",Yt=500,Jt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Kt(this,qt(t).call(this,e))).state={linkInfos:[],showCatalogBox:!1},n.resizeObeserver=null,n.calculateCatalogBox=function(){if(n.props.fixedWidth){var e=n.catalogBtn.current.getBoundingClientRect(),t=document.body.clientWidth-(e.right+256-40);n.catalogBox.current.style.right=t>0?"".concat(t+10,"px"):"10px"}else n.catalogBox.current.style.right="10px"},n.resizeHandler=function(e){if(!document.body.classList.contains("demo-mode")){var t=n.$ctViewPage.getBoundingClientRect();n.catalogBtn.current.style.right="".concat(document.body.clientWidth-t.right,"px"),n.catalogBox.current.style.right&&"-256px"!==n.catalogBox.current.style.right&&n.calculateCatalogBox()}},n.resetCatalogBox=function(){if(!document.body.classList.contains("demo-mode")){n.$ctViewPage=document.querySelector(".ct-view-page");var e=n.$ctViewPage.getBoundingClientRect();n.catalogBtn.current.style.right="".concat(document.body.clientWidth-e.right,"px");var t=n.catalogBox.current.style.right;t&&"-256px"!==t&&n.calculateCatalogBox()}},n.toggleCatalog=function(){n.setState({showCatalogBox:!n.state.showCatalogBox});var e=n.catalogBox.current.style.right;e&&"-256px"!==e?n.catalogBox.current.style.right="-256px":n.calculateCatalogBox();var t=n.$pageWrapper.classList;t.contains(Xt)||(t.add(Xt),setTimeout(function(){t.remove(Xt),t.contains(Qt)?t.remove(Qt):t.add(Qt),Object(zt.resetFixedTableHeadRight)()},Yt))},n.onScroll=f()(function(){var e=n.state.linkInfos.filter(function(e){var t=e.$heading;return t&&t.getBoundingClientRect().y<48}),t=e.length;t>0?n.activeLink(e[t-1].$link):n.activeLink(0)},100),n.catalogBtn=s.a.createRef(),n.catalogBox=s.a.createRef(),n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(t,c["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.initLinkInfos(),this.activeLink(),this.bindEvents(),this.$pageWrapper=document.querySelector(".ct-page-wrapper"),this.$pageWrapper.classList.add("has-catalog"),this.props.fixedWidth?(requestAnimationFrame(function(){e.$ctViewPage=document.querySelector(".ct-view-page");var t=e.$ctViewPage.getBoundingClientRect();e.target=document.querySelector(".resize-box"),e.catalogBtn.current&&(e.catalogBtn.current.style.right="".concat(document.body.clientWidth-t.right,"px"),e.catalogBtn.current.style.top="".concat(96,"px"),e.resizeObeserver=new MutationObserver(e.resizeHandler),e.resizeObeserver.observe(e.target,{attributes:!0}))}),window.addEventListener("resize",this.resetCatalogBox)):this.catalogBtn.current.style.right="20px"}},{key:"componentDidUpdate",value:function(){this.initLinkInfos()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resetCatalogBox),this.resizeObeserver&&this.resizeObeserver.disconnect();var e=document.querySelector(".viewpage-scroll-wrapper"),t=this.$pageWrapper;e&&e.removeEventListener("scroll",this.onScroll),this.setState({linkInfos:[]}),t.classList.remove(Qt),t.classList.remove("has-catalog")}},{key:"componentDidUpdate",value:function(e){e.catalog!==this.props.catalog&&this.initLinkInfos()}},{key:"bindEvents",value:function(){document.querySelector(".viewpage-scroll-wrapper").addEventListener("scroll",this.onScroll)}},{key:"initLinkInfos",value:function(){var e=this;setTimeout(function(){var t=e.props.catalog,n=void 0===t?[]:t;try{var r=Object(l.toJS)(n).map(function(e){return{key:e.key,$link:document.querySelector('[data-link="'.concat((e.key||"").replace(/["\\]/g,"\\$&"),'"]')),$heading:document.getElementById(e.key.slice(1))}});e.setState({linkInfos:r})}catch(o){e.setState({linkInfos:[]}),console.error(o)}},500)}},{key:"activeLink",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.state.linkInfos;if(t&&t.length>0){var n="number"===typeof e?t[e].$link:e;t.forEach(function(e){return e.$link.classList.remove("active")}),n.classList.add("active")}}},{key:"render",value:function(){var e=this,t=this.props,n=t.catalog,r=t.maxLevel,o=t.styleName,a=this.state.showCatalogBox,c=Object(Wt.b)(r),l=n.map(function(t,n,r){var a=Math.min.apply(null,r.map(function(e){return e.level})),l=t.level-a,u="number"===o?c(t.level):o,p=Object(Wt.a)(u);return s.a.createElement("div",{key:t.key,"data-link":t.key,className:"indent-".concat(l," catalog-link-wrapper")},s.a.createElement(i.a,{placement:"left",title:t.text},p,s.a.createElement("a",{className:"catalog-link",onClick:function(t){setTimeout(function(){return e.activeLink(n)},100)},href:t.key},t.text)))});return[s.a.createElement("div",{ref:this.catalogBtn,className:"catalog-btn".concat(a?" hide":""),onClick:this.toggleCatalog.bind(this)},"\u76ee\u5f55"),s.a.createElement("div",{ref:this.catalogBox,className:"catalog-box"},s.a.createElement("div",{className:"catalog-box-header"},"\u76ee\u5f55",s.a.createElement("span",{className:"ops-icon-wrapper catalog-box-close-icon",onClick:this.toggleCatalog.bind(this)},s.a.createElement(Ht.a,null))),s.a.createElement("div",{className:"catalog-box-body"},s.a.createElement("div",{className:"catalog-links-wrapper"},l)))]}}])&&Ut(n.prototype,r),o&&Ut(n,o),t}(),Zt=n("../client/src/containers/ViewPage/PluginsToView/lazyload.js"),$t=n("../client/src/containers/ViewPage/ImagesViewer/index.js"),en=n("../client/src/containers/ViewPage/utils.js"),tn=n("../client/src/containers/ViewPage/task.js"),nn=n("../client/src/containers/ViewPage/wikiLink.js"),rn=n("../client/src/containers/ViewPage/tableSort.js"),on=n("../client/src/containers/ViewPage/DocBody.js"),an=(n("../client/src/containers/ViewPage/style.styl"),n("../client/src/stores/SideBar/utils.js")),cn=n("../client/src/stores/SideBar/index.js");function sn(e){return(sn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function un(e,t){return!t||"object"!==sn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pn(e){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dn,mn="/api/operationHistory/log";function hn(e){return(hn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gn(e,t){return(gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(t,"a",function(){return kn});var jn,On=101,Sn=69,En={top:92,right:110,position:"absolute"},Pn={top:42,right:90,position:"absolute"},kn=function(e,t,n,r){var o=e.ifNeedAddSecretForChildren(t).catch(function(){throw new Error('Method "checkChildrenIfHasSecret" call failed')}),a=r(n);return Promise.all([o,a]).then(function(r){wn(r,1)[0]&&Object(en.f)({selectedSecret:n,onOk:function(r){return e.addSecretForChildren(t,{secretLevel:n,contentId:t}).then(function(){r(),R.a.success("\u8bbe\u7f6e\u5b50\u6587\u6863\u5bc6\u7ea7\u6210\u529f")}).catch(function(e){601===e.status?R.a.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bbe\u7f6e\u5b50\u6587\u6863\u5bc6\u7ea7\u5931\u8d25"):Object(It.t)(e)})}})})},xn=Object(u.inject)("store")((jn=dn=Object(u.observer)(dn=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return r=this,o=(e=bn(t)).call.apply(e,[this].concat(c)),(n=!o||"object"!==hn(o)&&"function"!==typeof o?vn(r):o).staticBlockWrappers=Object(Lt.b)(),n.isMounting=!0,n.editor=null,n.notitionKey=4e3*Math.random(),n.pollingTimer=null,n.pageId=0,n.$blockWrappers=null,n.state={isInBlackList:!1,notFound:!1,hadDeleted:!1,netWorkError:!1,moveVisible:!1,historyVisible:!1,docSortVisible:!1,secretSettingVisible:!1,showManagePage:!1,showImages:!1,viewPageImages:[],curImage:null,current:"doc",isHistoryEditor:!1,isShowSecretTip:!1,docContentLoaded:!1,isInMT:!1,isDocDeleted:!1,isShowRecoverTip:!1,collectPosModalVisible:!1,collectPopStyle:En},n.curVersion=null,n.handleScrollListen=f()(n.handleThrottle.bind(vn(n)),100),n.leftSideBarObserver=null,n.handleDocProperty=function(e){var t=e.spaceId,r=e.data.deleted;n.initSecretVisible(t),n.handleDocDeleted(r)},n.initSecretVisible=function(e){var t=n.props.store,r=t.doc,o=t.space,a=r.getIsConfirmSecret,i=r.isUnsetSecret;return o.checkIsInMT(e).then(function(e){if(n.setState({isInMT:e}),e){if(r.page.deleted)return;i?n.setState({isHistoryEditor:!0,isShowSecretTip:!0,secretSettingVisible:!0}):(n.checkIsHistoryEditor(),a(n.pageId).then(function(e){n.setState({isShowSecretTip:!e})}).catch(function(e){return Object(It.t)(e)}))}})},n.checkIsHistoryEditor=function(){var e=n.props.store,t=e.doc,r=e.user;t.perm.hasEditPerm&&t.docVersions(n.pageId,0,99,!1).then(function(e){var t=r.userInfo.account,o=new Set(e.models.map(function(e){return e.modifier})),a=Array.from(o).indexOf(t)>-1;n.setState({isHistoryEditor:a})}).catch(function(e){return Object(It.t)(e)})},n.handleDocDeleted=function(e){var t=n.props.store.ui,r=!!e;r&&t.sideBarVisible&&t.setSideBarVisible(!1),n.setState({isDocDeleted:r,isShowRecoverTip:r})},n.closeNotion=function(){m.a.close(n.notitionKey)},n.clearPolling=function(e){clearTimeout(e),n.pollingTimer=null},n.handleMouseWheel=function(e){if(e.target.closest(".cloneHeader")){var t=0;if(e.wheelDelta?t=e.wheelDelta>0?1:-1:e.detail&&(t=e.detail>0?1:-1),0!==t){var n=document.getElementById("viewPageScrollWrapper");if(!n)return;1===t?n.scrollTop-=6:n.scrollTop+=6}}},n.handleClick=function(e){var t=n.state.isDocDeleted,r=e.target;if(r){var o=r.parentElement;if(o){var a=o.parentElement;if(a){var i=r.classList,c=o.classList,s=a.classList,l="img"===r.nodeName.toLowerCase()&&(c.contains("ct-image")||c.contains("ct-plantuml")),u=i.contains("ct-link")||c.contains("ct-link")||c.contains("ct-edit-link"),p=!r.closest(".ct-drawio-failed")&&(r.closest(".ct-drawio")||r.closest(".ct-minder")),f=l&&(s.contains("ct-link")||s.contains("ct-edit-link")),d=l&&r.getAttribute("data-link"),m=i.contains("ct-task-li")||i.contains("ct-task-li-checked"),h=r.closest("th");if(!m||t)if(d){if(r.closest(".ct-editor"))return;var y=r.getAttribute("data-link");window.open(y)}else if(u||f){var b=r.href||r.parentElement.href,v=r.parentElement&&r.parentElement.parentElement.href,g=u?b:v;if(!g)return;Object(nn.a)(g,e)}else if(l||p){if(r.closest(".ct-comment"))return;var w=r.getAttribute("data-origin")||r.getAttribute("data-src")||r.closest(".ct-drawio>img")&&r.closest(".ct-drawio>img").getAttribute("data-src")||r.closest(".ct-drawio")&&r.closest(".ct-drawio").getAttribute("data-src")||r.closest(".ct-minder")&&r.closest(".ct-minder").getAttribute("data-src");n.setState({showImages:!0,curImage:w,viewPageImages:n.getAllImagesInContent()})}else h&&Object(rn.a)(e);else{var j=n.props.match.params.pageId;Object(tn.a)(r,j)}}}}},n.getAllImagesInContent=function(){var e=document.querySelector(".ct-editor-wrapper").querySelectorAll(".ct-image>img, .ct-drawio, .ct-minder, .ct-plantuml>img");return Array.from(e).filter(function(e){return!e.closest(".cloneHeader")}).map(function(e){var t=e.getAttribute("data-xml");return!e.classList.contains("ct-drawio")||"string"===typeof t&&t.includes("http")?e.classList.contains("ct-minder")?{src:"svg://".concat(e.getAttribute("data-src")),alt:"minder"}:e.classList.contains("ct-plantuml")?{src:"img://".concat(e.getAttribute("data-src")),alt:"plantuml"}:{src:"img://".concat(e.getAttribute("data-origin")||e.getAttribute("data-src")),alt:e.alt}:{src:"svg://".concat(e.getAttribute("data-src")),alt:"drawio"}})},n.initLoadDoc=function(){var e=n.props.store,t=e.sideBar,r=e.doc,o=n.props.spaceId,a=n.props.match.params.pageId,i=r.opsState;i.loadPageState=L.t.PENDING,o?(t.setCurrent(o,a),n.handleLoadDoc(a,o)):t.getSpaceId(a).then(function(e){t.setCurrent(e,a),n.handleLoadDoc(a,e)}).catch(function(e){i.loadPageState=L.t.ERROR,n.handleCatchPageError(e),console.error(e.message)})},n.handleSpaceHomePage=function(e){Rt.a.replace("/space/".concat(e)),1===Rt.a.length&&location.reload()},n.handleUpdateCollectCrumbs=function(e){var t=n.props.store.doc,r=e;"".concat(e).includes("collect")&&(r=e.split("-")[1]),t.updataCollectCrumbsNavBar(r)},n.handleLoadDoc=function(e,t){if(0!==t){if(e&&+t){var r=n.props.store,o=r.doc,a=r.sideBar,i=r.user,c=r.ui,s=o.setCurrentPageId,l=o.loadDoc,u=o.getDocPermDetail,p=o.getCollectType;n.pageId=e,s(e),n.resetState(),_t.a.safeClear(),l(t,e).then(function(r){if(n.setState({netWorkError:!1,docContentLoaded:!0}),r){var s=r.deleted;if(r.type){document.body.classList.add("fixed-width");var l=document.querySelector(".resize-box"),u=function(e){if(!document.body.classList.contains("demo-mode")){var t=l.clientWidth,n=l.getAttribute("data-max-width"),r=document.querySelector(".ct-view-page");if(r){var o=r.parentElement;1===e&&(t>parseInt(n,10)?o.classList.contains("exceed-max-width")||(o.classList.add("exceed-max-width"),r.setAttribute("style","")):(o.classList.contains("exceed-max-width")&&o.classList.remove("exceed-max-width"),document.querySelector(".ct-view-page").style.marginLeft="-".concat(l.clientWidth,"px")))}}};u(r.type),n.leftSideBarObserver=new MutationObserver(f()(function(){return u(o.page.docType)},80)),n.leftSideBarObserver.observe(l,{attributes:!0})}else n.leftSideBarObserver&&n.leftSideBarObserver.disconnect(),document.body.classList.remove("fixed-width");n.handleDocProperty({spaceId:t,data:r});var p=Object(It.k)().pageName;r.parentId!==L.q||"page"!==p?n.isMounting&&(n.staticBlockWrappers=Object(Lt.b)(),_t.a.run(),n.curVersion=null,document.title=r.title,c.isInViewPage&&!s&&c.setSideBarVisible(!0),i.checkUserInfo([r.creator,r.modifier]),a.updateTreeDataByKey(e,"updateTitle",r.title),n.pollingUpdate()):n.handleSpaceHomePage(r.spaceId)}}).catch(n.handleCatchPageError),u(e),p(e).then(function(t){t&&n.handleUpdateCollectCrumbs(e)}).catch(function(e){console.error(e)})}}else n.handlePageNotFound()},n.resetState=function(){document.title="\u6d4f\u89c8\u6587\u6863",n.setState({notFound:!1,hadDeleted:!1,moveVisible:!1,historyVisible:!1,isShowSecretTip:!1,isShowRecoverTip:!1,isHistoryEditor:!1,isInMT:!1}),n.props.store.doc.isPermInherit=!0,n.hideManagePage()},n.hotKeyHandler=function(e){0!==e.which&&e.which!==On&&e.which!==Sn&&e.keyCode!==On&&e.keyCode!==Sn||"INPUT"===e.target.nodeName||"TEXTAREA"===e.target.nodeName||e.target.classList.contains("ProseMirror")||(n.props.store.doc.perm.hasEditPerm?n.toEdit():R.a.error("\u60a8\u6ca1\u6709\u6b64\u6587\u6863\u7684\u7f16\u8f91\u6743\u9650"))},n.reload=function(){var e=n.props.store,t=e.doc,r=e.sideBar,o=e.ui,a=t.loadDoc,i=t.page.spaceId,c=n.props.match.params.pageId;n.state.historyVisible&&n.setState({historyVisible:!1}),n.closeNotion();var s=document.getElementById("viewPageScrollWrapper");o.viewPageScrollTop=s&&s.scrollTop,a(i,c).then(function(e){if(r.updateTreeDataByKey(c,"updateTitle",e.title),0===document.querySelectorAll(".block-max").length){var t=document.querySelectorAll(".block-max-header");t.length>0&&t.forEach(function(e){e.remove()})}}).catch(n.handleCatchPageError)},n.pollingUpdate=function(){var e=n.props.store,t=e.doc,r=e.sideBar,o=e.user,a=e.ui,i=t.judgeWhetheUpdate,c=vn(n).reload,s=0;n.clearPolling(n.pollingTimer),function e(){if(!(s>=3))if(document.hidden)n.pollingTimer=setTimeout(e,1e4);else{var t=r.spaceId,l=n.props.match.params.pageId;i(t,l).then(function(e){if((s=0,n.pollingTimer)&&(+n.props.match.params.pageId===+l&&e.update&&e.updater!==Nt.a.login))return o.checkUserInfo([e.updater]).then(function(){var t=Object(en.b)(e,c,n.notitionKey);n.curVersion!==e.newVersion&&(Dt.a.info("viewpage polling: curVersion,",n.curVersion,"newVersion",e.newVersion),n.closeNotion(),a.isInViewPage&&m.a.success(t),n.curVersion=e.newVersion)})}).catch(function(){s++}),n.pollingTimer=setTimeout(e,1e4)}}()},n.toEdit=function(){var e=n.props.store,t=e.ui,r=e.sideBar,o=n.props.match.params.pageId,a=0;Array.from(document.getElementsByClassName("ct-view-catalog")).forEach(function(e){a+=e.clientHeight-15});var i=document.getElementById("viewPageScrollWrapper").scrollTop;t.viewPageScrollTop=i>0?i-a+25:0,"".concat(r.selectedKey).includes("collect-")?t.isFromCollectCreate=!0:t.isFromCollectCreate=!1,Rt.a.push("/page/".concat(o,"?action=edit"))},n.handleCollectFailed=function(e,t,r){(0,n.props.store.doc.collectDoc)(e,{contentKey:e.pageId,contentType:L.d.DOC,collectionType:L.b.OTHER_DOC}).then(function(){Object(It.E)("lastCollectPosition",{collectionType:0,folderId:0,text:"\u5176\u4ed6\u6536\u85cf"}),n.setState({collectPosModalVisible:!0,collectPopStyle:"right"===t?En:Pn}),"full"===r&&R.a.warning("\u5e38\u7528\u6536\u85cf\u5df2\u6ee1\uff0c\u5df2\u5c06\u8be5\u6587\u6863\u79fb\u5982\u5176\u4ed6\u6536\u85cf\u3002\u5982\u9700\u8c03\u6574\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u6587\u4ef6\u5939")}).catch(function(e){R.a.error(e.message)})},n.getCollectPopPostion=function(e){var t="viewpage"===e?En:Pn,n=document.getElementById("doc-ops-bar-star-".concat(e));return n&&(t.right=window.innerWidth-n.getBoundingClientRect().right,t.top=n.getBoundingClientRect().bottom+10),t},n.collect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"viewpage",t=n.props.store,r=t.doc,o=t.sideBar,a=r.hasBeenCollect,i=r.page,c=n.props.match.params.pageId,s=Object(an.h)({data:i,isCollectPage:!0}),l=a?"\u53d6\u6d88\u6536\u85cf\u6210\u529f":"\u6536\u85cf\u6210\u529f";r.toggleCollect(s,a).then(function(){if(a)R.a.success(l);else{var t=n.getCollectPopPostion(e);n.setState({collectPosModalVisible:!0,collectPopStyle:t})}}).catch(function(t){if(672===t.status||670===t.status){var a=672===t.status?"full":"deleted";n.handleCollectFailed(s,e,a)}else 666===t.status?(r.hasBeenCollect=!1,r.collectionType===L.b.COMMON_DOC&&(o.operateCommonCollectToTree({key:"collect-".concat(c)},"del"),Rt.a.push("/starred/commondoc"))):Object(It.t)(t,l,function(e){603===e&&(Object(At.c)(),n.indexPath=o.getPath("".concat(c)),n.deleteTreeData())})})},n.follow=en.c,n.copy=function(){var e=n.props.store.doc,t=e.page,r=t.parentId,o=t.contentId,a=t.spaceId;e.setCurrentPageId(o),Rt.a.push("/create/page/".concat(a,"/").concat(r,"?copyId=").concat(o))},n.delete=function(){var e=n.props.store,t=e.doc,r=e.sideBar,o=t.page,a=t.navTrack,i=t.hasBeenCollect,c=t.collectionType,s=i&&c===L.b.COMMON_DOC,l=a[a.length-1].hasChild,u=o.title,p=o.spaceId,f=o.contentId,d=r.selectedKey;Object(Bt.a)({title:u,hasChild:l,pageId:f,spaceId:p,resolve:function(){Object(At.c)(),"".concat(d).includes("collect-")&&r.updateTreeDataByKey(d,"del")},isCommonCollect:s})},n.restoreDoc=function(){var e=n.props.store,t=e.doc,r=e.sideBar,o=t.page,a=o.spaceId,i=o.contentId;Object(Bt.b)({spaceId:a,pageId:i,restoreResolve:function(){r.setShouldSetTree(!0),n.handleLoadDoc(i,a),n.reloadSideBar()}})},n.reloadSideBar=function(){He.a.emit(ze.i)},n.onExportViewData=function(){var e=n.props.store.sideBar.pageId,t=R.a.loading("\u6b63\u5728\u5bfc\u51fa");Object(Tt.c)("/api/operationHistory/export/".concat(e),null,{isRedirect:!1,timeout:6e4}).then(function(e){t(),e&&Object(en.a)(e)}).catch(function(){t(R.a.error("\u5bfc\u51fa\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"))})},n.onSetTemplate=function(){var e=n.props.match.params.pageId,t=n.props.store.sideBar.spaceId;Rt.a.push("".concat(Vt.a.primaryPath,"/create/user/template?contentId=").concat(e,"&spaceId=").concat(t))},n.showMove=function(){var e=n.props.store.sideBar;n.setState({moveVisible:!0}),n.indexPath=e.getPath("".concat(e.pageId))},n.hideMove=function(){n.setState({moveVisible:!1})},n.showDocSortModal=function(){n.setState({docSortVisible:!0})},n.handleDocSortCancel=function(){n.setState({docSortVisible:!1})},n.toggleHistory=function(){var e=n.state.historyVisible;n.setState({historyVisible:!e})},n.showSecretSetting=function(){n.setState({secretSettingVisible:!0})},n.cancelSecretSetting=function(){var e=n.props.store.doc;e.isUnsetSecret&&(e.isUnsetSecret=!1),n.setState({secretSettingVisible:!1})},n.recoverHistory=function(e){var t=n.props.store,r=t.doc,o=t.sideBar,a=r.recoverDoc,i=r.loadDoc,c=o.spaceId,s=o.pageId,l=o.updateTreeDataByKey,u=e.version;return a(c,s,u).then(function(){i(c,s).then(function(e){return l(s,"update",{text:e.title})}).catch(n.handleCatchPageError)}).catch(function(){return R.a.error("\u66f4\u65b0\u5931\u8d25")})},n.removeHistory=function(e,t){var r=n.props.store,o=r.doc,a=r.sideBar;return(0,o.deleteDoc)(a.spaceId,e.contentId).then(function(){t&&t(),R.a.success("\u5220\u9664\u6210\u529f")}).catch(function(e){e.message?R.a.error(e.message):R.a.error("\u5220\u9664\u5931\u8d25")})},n.deleteTreeData=function(){n.props.store.sideBar.updateTreeDataByIndexPath(n.indexPath,"del")},n.handleDocOps=function(e){switch(e){case"edit":n.toEdit();break;case"collect":n.collect("viewpage-navbar");break;case"showHistory":n.toggleHistory();break;case"onDemo":n.onDemo();break;case"move":n.showMove();break;case"sort":n.showDocSortModal();break;case"copy":n.copy();break;case"delete":n.delete();break;case"export":n.onExportViewData();break;case"permission":n.toManagePage();break;case"setTemplate":n.onSetTemplate()}},n.handleCatchPageError=function(e){switch(e.status){case 619:n.handlePageNoPerm();break;case 601:n.handlePageError();break;case 603:n.handlePageDeleted();break;case 627:n.handlePageNotFound();break;case 678:n.handleBlackList();break;case 702:n.handleDocRecycled();break;default:console.error(e),n.handlePageError()}},n.handlePageNoPerm=function(){n.props.store.doc.updatePagePerm({hasReadPerm:!1,hasEditPerm:!1,hasAdmPerm:!1,hasAddPerm:!1,hasDeletePerm:!1})},n.handlePageNotFound=function(){n.props.store.doc.opsState.loadPageState=L.t.DONE,n.setState({notFound:!0})},n.handleDocRecycled=function(){var e=n.props.store,t=e.doc.opsState,r=e.ui;t.loadPageState=L.t.DONE,r.setSideBarVisible(!0),n.setState({docRecycled:!0,netWorkError:!1,docContentLoaded:!0})},n.handleBlackList=function(){n.props.store.doc.opsState.loadPageState=L.t.DONE,n.setState({isInBlackList:!0})},n.resetBlackList=function(){n.setState({isInBlackList:!1})},n.resetDocRecycled=function(){return n.setState({docRecycled:!1})},n.handlePageError=function(){n.setState({netWorkError:!0})},n.handlePageDeleted=function(){var e=n.props.store,t=e.sideBar,r=e.ui;t.updateTreeDataByKey(t.pageId,"del"),n.setState({hadDeleted:!0}),r.sideBarVisible&&r.setSideBarVisible(!1)},n.handleListenPageDeleted=function(){n.setState({hadDeleted:!0})},n.showVersion=function(){var e=n.props.store.sideBar.pageId;Rt.a.push("/diff/".concat(e))},n.scrollToEditPos=function(){var e=n.props.store.ui;if(e.editPageScrollTop){var t=0;Array.from(document.getElementsByClassName("ct-view-catalog")).forEach(function(e){t+=e.clientHeight-15}),document.getElementById("viewPageScrollWrapper").scrollTop=e.editPageScrollTop+t-25,e.editPageScrollTop=null}},n.scrollToViewPos=function(){var e=n.props.store.ui;e.viewPageScrollTop&&(document.getElementById("viewPageScrollWrapper").scrollTop=e.viewPageScrollTop,e.viewPageScrollTop=null)},n.toManagePage=function(){n.props.store.doc.setManageVisible(!0),n.manageReaction=Object(l.reaction)(function(){return n.props.store.doc.manageVisible},function(){if(n.isMounting){var e=n.props.store.doc;e.page&&void 0!==e.page.title&&(document.title=e.page.title)}n.manageReaction&&n.manageReaction(),n.manageReaction=null}),window.addEventListener("popstate",n.hideManagePage)},n.hideManagePage=function(e){e&&(Rt.a.goForward(),window.removeEventListener("popstate",n.hideManagePage)),n.props.store.doc.setManageVisible(!1)},n.setSecret=function(e){return n.props.store.doc.setSecretLevel(n.pageId,e).then(function(){return n.handleSecretChange(e)}).then(function(){R.a.success("\u5bc6\u7ea7\u8bbe\u7f6e\u6210\u529f")}).catch(function(e){601===e.status?R.a.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bbe\u7f6e\u6587\u6863\u5bc6\u7ea7\u5931\u8d25"):Object(It.t)(e)})},n.confirmSecret=function(e){var t=n.props.store.doc,r=vn(n).pageId;return kn(t,r,e,n.setSecret)},n.handleSecretChange=function(e){var t=n.props.store.doc;t.isUnsetSecret&&(t.isUnsetSecret=!1),t.updateSecretLevel(e),n.setState({isShowSecretTip:!1})},n.handleCollectPosModalClose=function(){n.setState({collectPosModalVisible:!1})},n.getCatalogContent=function(){var e=n.props.store.doc,t=e.catalogInfo;if(!t)return null;var r=t.catalog,o=t.maxLevel,a=t.firstCatalogStyle;return r.length?s.a.createElement(Jt,{catalog:r,maxLevel:o,styleName:a,fixedWidth:e.getDocType()}):null},n.renderDocContent=function(){var e=n.state,t=e.historyVisible,r=e.secretSettingVisible,o=e.showImages,a=e.viewPageImages,c=e.curImage,l=e.isHistoryEditor,u=e.isShowSecretTip,p=e.isInMT,f=e.isDocDeleted,d=e.isShowRecoverTip;if(e.docRecycled)return s.a.createElement(w.a,{mis:"huangjian03"});var m=n.props.store,h=m.doc,y=m.sideBar,b=m.user,v=m.ui.docDemoMode,g=h.perm,j=h.docVersions,S=h.page,E=h.opsState,P=h.likeDoc,k=h.cancelLikeDoc,x=y.spaceId,C=n.props.match.params.pageId,T=b.userInfos,I=S.isLike,A=S.secretLevel,D=new URLSearchParams(location.search),N=D.get("lazyload")||D.get("print");return s.a.createElement("div",{className:"ct-view-page ".concat(f?"deleted":""," ").concat(v?"demo":"")},d&&Object(en.d)(n.restoreDoc),p&&l&&u&&Object(en.e)(A,Pt.a,n.confirmSecret,n.showSecretSetting),s.a.createElement("div",{className:"document-editor"},s.a.createElement("div",{className:"ct-editor-wrapper"},s.a.createElement("div",{className:"ct-title-wrapper"},s.a.createElement("p",{className:"ct-title-p"},S.title),s.a.createElement("div",{className:"ct-doc-info"},p&&s.a.createElement(Pt.a,{hasEditPerm:g.hasEditPerm,level:A,showSecretSetting:n.showSecretSetting,isDocDeleted:f}),"\u521b\u5efa:",s.a.createElement(O.b,{mis:S.creator,placement:f?"topLeft":"top",arrowPointAtCenter:!0}),", \u6700\u540e\u4fee\u6539: ",s.a.createElement(O.b,{mis:S.modifier}),s.a.createElement(i.a,{placement:"top",title:"\u67e5\u770b\u5386\u53f2\u7248\u672c"},s.a.createElement("span",{className:"modify-time",onClick:n.showVersion},Object(It.g)(S.modifyTime))))),s.a.createElement(on.a,{scrollToEditPos:n.scrollToEditPos,scrollToViewPos:n.scrollToViewPos,body:S.body,lazyload:N}),o&&s.a.createElement($t.a,{images:a,curImage:c,onClose:function(){n.setState({showImages:!1})}})),!f&&s.a.createElement("div",{className:"secrecy"},s.a.createElement("span",{className:"secrecy-inner"},s.a.createElement(Ct.a,{className:"light-icon"}),"\u4ec5\u4f9b\u5185\u90e8\u4f7f\u7528\uff0c\u672a\u7ecf\u6388\u6743\uff0c\u5207\u52ff\u5916\u4f20")),!f&&s.a.createElement(B,{isDocDeleted:f,isLike:I,opsState:E,likeCount:S.likeCount,browseCount:S.browseCount,browseHeadCount:S.browseHeadCount,cancelLikeDoc:k,likeDoc:P,pageId:C}),s.a.createElement(Et.a,{pageId:C,spaceId:x})),!f&&s.a.createElement(gt.a,{show:t,onClose:n.toggleHistory,recover:n.recoverHistory,remove:n.removeHistory,onFetch:j.bind(vn(n),C),userInfos:T,checkUserInfo:b.checkUserInfo,sideBar:y}),!f&&s.a.createElement(St.a,{spaceId:x,pageId:C,currentSecretLevel:A,visible:r,handleCancel:n.cancelSecretSetting,onChange:n.handleSecretChange}))},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}(t,c["Component"]),n=t,(r=[{key:"componentWillMount",value:function(){this.props.store.doc.resetPage()}},{key:"componentDidMount",value:function(){var e=this.props.store,t=e.ui,n=e.sideBar;"workspace"===t.navBarActiveLink||n.expandedKeys.length||t.setSideBarVisible(!1),t.setIsInViewPage(!0),this.isMounting=!0,document.title="\u6d4f\u89c8\u6587\u6863",He.a.on(ze.f,this.handleDocOps),He.a.on(ze.k,this.handlePageNotFound),He.a.on(ze.e,this.handleListenPageDeleted),He.a.on(ze.j,this.handlePageError),He.a.on(ze.l,this.handlePageNoPerm),He.a.on(ze.o,this.handleScrollListen),He.a.on(ze.r,this.handleUpdateCollectCrumbs),document.addEventListener("keypress",this.hotKeyHandler,!1);var r=document.getElementById("page-wrapper");r.style.overflowY="hidden",r.addEventListener("click",this.handleClick,!1),r.addEventListener("mousewheel",this.handleMouseWheel),this.initLoadDoc(),Object(Mt.e)("c_i4v5ie50");var o=document.querySelector(".resize-box");o&&(this.tableWidhtChangeObserver=new MutationObserver(f()(function(){var e=document.querySelector(".ct-table_header-fixed-container");if(e){var t=e.getAttribute("data-active-id"),n=document.querySelector('table[data-table-id="'.concat(t,'"]'));n&&(e.style.left="".concat(n.getBoundingClientRect().left-document.querySelector(".doc-demo-body").getBoundingClientRect().left+n.parentElement.scrollLeft,"px"),e.style.width="".concat(n.parentElement.clientWidth,"px"))}},80)),this.tableWidhtChangeObserver.observe(o,{attributes:!0}))}},{key:"componentWillReceiveProps",value:function(e){var t=e.store,n=t.ui,r=t.sideBar,o=e.match.params.pageId,a=this.props.spaceId||r.spaceId;if(o!==this.pageId){this.resetBlackList(),this.resetDocRecycled(),this.clearPolling(this.pollingTimer),this.setState({docContentLoaded:!1}),this.handleLoadDoc(o,a),this.closeNotion();var i=document.getElementById("viewPageScrollWrapper");i&&(i.scrollTop=0),n.setViewPageNavBarVisible(!1),n.clearPicPool(),Object(Mt.e)("c_i4v5ie50")}}},{key:"componentWillUnmount",value:function(){var e=this.props.store,t=e.ui;e.doc.getDocType()&&this.leftSideBarObserver&&this.leftSideBarObserver.disconnect(),this.isMounting=!1,this.hideManagePage(),_t.a.safeClear(),t.setSideBarVisible(!0),t.setIsInViewPage(!1),t.setViewPageNavBarVisible(!1),He.a.removeListener(ze.f,this.handleDocOps),He.a.removeListener(ze.k,this.handlePageNotFound),He.a.removeListener(ze.e,this.handleListenPageDeleted),He.a.removeListener(ze.j,this.handlePageError),He.a.removeListener(ze.l,this.handlePageNoPerm),He.a.removeListener(ze.o,this.handleScrollListen),He.a.removeListener(ze.r,this.handleUpdateCollectCrumbs),this.clearPolling(this.pollingTimer),this.closeNotion(),document.removeEventListener("keypress",this.hotKeyHandler);var n=document.getElementById("page-wrapper");n.style.overflowY="auto",n.removeEventListener("click",this.handleClick,!1),n.removeEventListener("mousewheel",this.handleMouseWheel),this.tableWidhtChangeObserver&&this.tableWidhtChangeObserver.disconnect()}},{key:"handleThrottle",value:function(e){var t=document.getElementById("viewPageScrollWrapper");Object(Zt.a)(t),this.staticBlockWrappers(t),Object(zt.tableHeadFixed)(e,t)}},{key:"onDemo",value:function(){_t.a.isEmpty()&&(_t.a.push(this.quitDemoMode.bind(this)),this.props.store.ui.setDocDemoMode(!0))}},{key:"quitDemoMode",value:function(){var e=this;setTimeout(function(){return e.props.store.ui.setDocDemoMode(!1)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.notFound,r=t.hadDeleted,a=t.netWorkError,i=t.moveVisible,c=t.docSortVisible,l=t.docContentLoaded,u=t.isDocDeleted,p=t.collectPosModalVisible,f=t.collectPopStyle,m=t.isInBlackList,w=(t.docRecycled,this.props.store),O=w.doc,S=w.sideBar,P=w.user,k=w.ui,x=w.starredSpace,C=k.docDemoMode,T=k.navBarActiveLink,I=this.props.operateBar,A=O.navTrack,D=O.perm,N=O.hasBeenCollect,M=O.page,_=O.opsState,B=O.manageVisible,R=S.spaceId,H=S.setCurrent,z=S.selectedKey,W=+P.spaceId===+R&&"workspace"===T?"/space":R,F=this.props.match.params.pageId,U="".concat(z).includes("collect-"),K=cn.b.get(z);if(_.loadPageState===L.t.PENDING)return s.a.createElement("div",{className:"ct-page ct-space"},s.a.createElement(g.a,null));if(m)return s.a.createElement(h.default,{text:"\u5f53\u524d\u6587\u6863\u56e0\u4e34\u65f6\u6570\u636e\u5f02\u5e38\u65e0\u6cd5\u8bbf\u95ee\uff0c\u8bf7\u7a0d\u5019\u5c1d\u8bd5\u3002\u6216\u8054\u7cfb6000\u54a8\u8be2"});if(a)return s.a.createElement(b.a,{pageId:F,showButton:!0,text:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"});if(r)return s.a.createElement(y.a,{pageId:F});if(n)return s.a.createElement(h.default,{text:"\u8be5\u6587\u6863\u4e0d\u5b58\u5728"});if(B)return s.a.createElement(kt.default,this.props);if(!D||!D.hasReadPerm)return s.a.createElement(v.a,{pageId:F});if(!l)return null;var q=O.getDocType();return s.a.createElement(d.a,{keyName:"control+command+p,ctrl+alt+p",onKeyDown:this.onDemo.bind(this)},this.getCatalogContent(),s.a.createElement("div",{className:E()("content-wrapper",{"fixed-width":q})},s.a.createElement(vt,{title:M.title,active:C,onQuit:function(){return _t.a.pop()},fixedWidth:q},s.a.createElement("div",{className:"viewpage-scroll-wrapper",id:"viewPageScrollWrapper"},!u&&(I||s.a.createElement("div",{className:"document-head document-head-fixed"},s.a.createElement("div",{className:"nav"},s.a.createElement(j.a,{track:A,sideBar:S,ui:k})),s.a.createElement("div",{className:"ops"},s.a.createElement(V.a,{placement:"viewpage",perm:D,hasBeenCollect:N,onEdit:this.toEdit,onCollect:this.collect,onShowHistory:this.toggleHistory,onMove:this.showMove,onSort:this.showDocSortModal,onExportViewData:this.onExportViewData,onCopy:this.copy,onDelete:this.delete,onFollow:this.follow,onShowPermPage:this.toManagePage,onSetTemplate:this.onSetTemplate,onDemo:this.onDemo.bind(this)})),s.a.createElement(wt.a,{sideBar:S,ui:k,visible:i,pageId:F,spaceId:R,userSpaceId:P.spaceId,starredSpaceIds:x.spaceIds,setCurrent:H,handleCancel:this.hideMove,handleDelete:function(t){t&&Object(At.c)(),e.deleteTreeData()}}),s.a.createElement(jt.a,{visible:c,spaceTreeKey:W,selectedKey:F,isInViewPage:!0,handleCancel:this.handleDocSortCancel,path:K,isCollect:U}))),this.renderDocContent(),s.a.createElement(Ot.a,{visible:p,handleClose:this.handleCollectPosModalClose,page:Object(an.h)({data:M,isCollectPage:!0}),mask:!1,width:"400px",style:f,placement:"right"})))),s.a.createElement(o.a,{visibilityHeight:2.5*window.innerHeight,target:function(){return document.getElementById("viewPageScrollWrapper")}},s.a.createElement(xt.a,null)))}}])&&yn(n.prototype,r),a&&yn(n,a),t}())||dn,dn=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=un(this,(e=pn(t)).call.apply(e,[this].concat(o)))).printMedia=null,n.printLogger=function(e){var t=e.matches,r=n.props.store;if(r){var o=r.doc.currentPageId;t&&Object(Tt.c)("".concat(mn,"/").concat(o,"?operationLogType=").concat(L.i.PRINT)).catch(function(e){return console.error(e.message)})}},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(t,c.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.printMedia=window.matchMedia("print"),this.printMedia.addListener(this.printLogger)}},{key:"componentWillUnmount",value:function(){this.printMedia&&this.printMedia.removeListener(this.printLogger)}},{key:"render",value:function(){return c.createElement(jn,this.props)}}])&&ln(n.prototype,r),o&&ln(n,o),t}()||dn))||dn;t.b=xn},"../client/src/containers/ViewPage/style.styl":function(e,t,n){},"../client/src/containers/ViewPage/tableSort.js":function(e,t,n){"use strict";n.d(t,"a",function(){return l});n("./core-js/modules/es6.array.sort.js"),n("./core-js/modules/es6.array.find.js"),n("./core-js/modules/es6.string.iterator.js"),n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.regexp.split.js");var r=n("../client/src/components/Toastr/index.js"),o=function(e,t){return e.cells[t].innerText.trim()||e.cells[t].textContent.trim()},a=function(e){return e.getAttribute("data-origin-position")},i=/^(-|\+)?\d+(\.\d+)?$/m,c=/^(\d)+(\.(\d)+)?%$/m,s=function(e,t,n){return function(r,s){if(1===+t&&n){var l=+a(r),u=+a(s);return l<u?-1:l>u?1:void 0}var p=o(r,e),f=o(s,e);if(""!==p||""!==f){if(""===p)return 1;if(""===f)return-1;if(c.test(p)&&(p=p.split("%")[0]),c.test(f)&&(f=f.split("%")[0]),i.test(p)&&i.test(f)){var d=+p,m=+f;if(d===m)return 0;if(d>m)return 1*t;if(d<m)return-1*t}return t*p.localeCompare(f,"zh-Hans-CN")}}};function l(e){var t=e.target.closest("th"),n=t.closest("table"),o=null;if(n.getAttribute("data-table-id"))o=n;else{var a=n.getAttribute("data-header-belong-id");o=document.querySelector('[data-table-id="'.concat(a,'"]'))}var i=o.querySelectorAll("td[colspan], td[rowspan], th[colspan], th[rowspan]"),c=t.clientWidth-e.offsetX<16;if(i.length&&c)return r.a.error("\u90e8\u5206\u5355\u5143\u683c\u6709\u5408\u5e76\uff0c\u65e0\u6cd5\u6392\u5e8f");if(!i.length){var l=o.getAttribute("data-has-store-pos"),u=t.getAttribute("data-reverse")||1;l||(Array.from(o.querySelectorAll("tr:nth-child(n+2)")).forEach(function(e,t){e.setAttribute("data-origin-position",t)}),o.setAttribute("data-has-store-pos","true"));var p=t.getAttribute("data-hassorted");p||t.setAttribute("data-hassorted","true");var f=Array.from(t.parentNode.children).indexOf(t),d=Array.prototype.find.call(o.querySelectorAll("tbody:not(.cloneHeaderBody)"),function(e){return e.parentElement===o});Array.from(d.querySelectorAll(":scope > tr:nth-child(n+2)")).sort(s(f,+u,p)).forEach(function(e){d.appendChild(e)}),1===+u&&p?Array.from(o.querySelectorAll("th")).forEach(function(e){e.removeAttribute("data-reverse"),e.removeAttribute("data-hassorted")}):(u=-(+u||-1),t.setAttribute("data-reverse",u))}}},"../client/src/containers/ViewPage/task.js":function(e,t,n){"use strict";n.d(t,"a",function(){return f});n("./core-js/modules/es6.regexp.replace.js"),n("./core-js/modules/es6.regexp.constructor.js");var r=n("../client/src/components/Toastr/index.js"),o=n("../client/src/stores/index.js"),a=n("../client/src/consts/index.js"),i=a.t.PENDING,c=a.t.DONE,s=a.t.ERROR,l=function(e,t){t?(e.classList.remove("ct-task-li-checked"),e.classList.add("ct-task-li")):(e.classList.remove("ct-task-li"),e.classList.add("ct-task-li-checked"))},u=function(e){var t=document.getElementById("pm-body-wrapper"),n=t&&t.querySelectorAll("li[class~=ct-task-li], li[class~=ct-task-li-checked]");if(n){var r=[].indexOf.call(n,e);return-1!==r?r:void 0}},p=function(e){var t=new RegExp('<li[^>]*?id="'.concat(e,'".*?>'),"g");return o.b.doc.page.body.replace(t,function(e){return e.replace(/class="ct-task-li(.*?)"/,function(e,t){return t?e.replace(t,""):'class="ct-task-li-checked"'})})};function f(e,t){var n=o.b.doc,a=o.b.sideBar,f=n.perm,d=n.page,m=n.opsState,h=a.spaceId;if(!f.hasEditPerm)return r.a.error("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u65e0\u7f16\u8f91\u6587\u6863\u6743\u9650\uff0c\u4e0d\u53ef\u66f4\u65b0\u4efb\u52a1\u72b6\u6001");if(m.updateState!==i){var y=e.classList.contains("ct-task-li-checked");if(void 0!==u(e)){var b,v=p(e.id),g={body:v,pageId:t,spaceId:h,version:d.version};m.updateState=i,n.judgeWhetheUpdate(h,t).then(function(e){if(b=!e.update,!e.update)return n.updateDoc(g);r.a.error("\u5f53\u524d\u6587\u6863\u4e0d\u662f\u6700\u65b0\u7248\u672c\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5")}).then(function(){b&&(l(e,y),n.updateIsTaskStatusChange(!0),n.updateDocBody(v),n.updateDocVersion(d.version+1)),m.updateState=c}).catch(function(e){m.updateState=s,636===e.status?r.a.error("\u5f53\u524d\u6587\u6863\u4e0d\u662f\u6700\u65b0\u7248\u672c\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5"):r.a.error(e.message)})}else console.error("sorry, cannot find listItem position!")}}},"../client/src/containers/ViewPage/utils.js":function(e,t,n){"use strict";n("./core-js/modules/es6.function.name.js");var r=n("./react/index.js"),o=n.n(r),a=n("../client/src/utils/tools.js"),i=n("../client/src/stores/index.js"),c=n("../client/src/stores/Follow/utils.js"),s=n("../client/src/consts/index.js"),l=n("../client/src/components/ui/modal/index.js");n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,m(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",p({width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},this.props),o.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},o.a.createElement("path",{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-5.3c-.67 0-1.2.54-1.2 1.2v4.83c0 .66.54 1.2 1.2 1.2.67 0 1.2-.54 1.2-1.2V3.9c0-.66-.54-1.2-1.2-1.2zm0 10.6a1.2 1.2 0 1 0 0-2.4 1.2 1.2 0 0 0 0 2.4z",id:"Combined-Shape",fill:"#FAAD14"})))}}])&&f(n.prototype,r),a&&f(n,a),t}();function b(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",""),t.click()}function v(e,t,n){var r=i.b.user.userInfos.get(e.updater);return{title:"\u6587\u6863\u5df2\u66f4\u65b0",description:o.a.createElement("div",{className:"notifi-content"},r&&r.avatar&&o.a.createElement("img",{alt:"",className:"notifi-avatar",src:r.avatar}),o.a.createElement("p",null,r?o.a.createElement("span",{className:"notifi-username"},"".concat(r.name,"(").concat(r.account,")")):o.a.createElement("span",{className:"notifi-username"},e.updater),"\u4e8e".concat(Object(a.g)(e.time)," \u66f4\u65b0\u4e86\u6587\u6863"))),duration:null,key:n,okText:"\u91cd\u65b0\u8f7d\u5165",onOk:t}}n.d(t,"a",function(){return b}),n.d(t,"b",function(){return v}),n.d(t,"e",function(){return w}),n.d(t,"f",function(){return j}),n.d(t,"d",function(){return O}),n.d(t,"c",function(){return S});var g={2:"\u9650\u5236\u7ea7",3:"\u673a\u5bc6\u7ea7",4:"\u7edd\u5bc6\u7ea7"},w=function(e,t,n,r){return o.a.createElement("div",{className:"view-page-tip"},o.a.createElement(y,{className:"tip-icon"}),"\u7cfb\u7edf\u5df2\u81ea\u52a8\u5c06\u8be5\u6587\u6863\u5bc6\u7ea7\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u5bc6\u7ea7\u201c",o.a.createElement(t,{level:e||s.p.SECRET,hasEditPerm:!0}),g[e||s.p.SECRET],"\u201d\uff0c\u786e\u8ba4\u4f7f\u7528\u8be5\u5bc6\u7ea7\uff1f",o.a.createElement("a",{onClick:function(){return n(e||s.p.SECRET)}},"\u786e\u8ba4"),o.a.createElement("a",{onClick:r},"\u8c03\u6574"))},j=function(e){var t=e.onOk,n=e.selectedSecret,r=e.onCancel;return l.a.warning({title:"\u5bc6\u7ea7\u53d8\u66f4\u63d0\u9192",content:"\u662f\u5426\u5c06\u8be5\u6587\u6863\u4e0b\u6240\u6709\u672a\u8bbe\u7f6e\u5bc6\u7ea7\u7684\u6587\u6863\u8bbe\u7f6e\u5bc6\u7ea7\u4e3aC-".concat(n),onCancel:r,onOk:t})},O=function(e){return o.a.createElement("div",{className:"view-page-tip above"},o.a.createElement(y,{className:"tip-icon"}),"\u8be5\u6587\u6863\u5df2\u88ab\u5220\u9664\uff0c\u662f\u5426\u6062\u590d\u8be5\u6587\u6863\uff1f",o.a.createElement("a",{onClick:e},"\u6062\u590d"))},S=function(){var e=i.b.doc.page,t=e.contentId,n=e.title,r=e.spaceId;Object(c.f)({contentId:t,title:n,spaceId:r})}},"../client/src/editor/components/Dropdown/style.styl":function(e,t,n){},"../client/src/editor/components/Editor/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/ExtraPopover/ExperimentPopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/ExtraPopover/MediaPopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/ExtraPopover/NotePopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/ExtraPopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/FontsizePopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/MorePopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/ParagraphPopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/TableModelPopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/TablePopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/TableStylePopover/style.styl":function(e,t,n){},"../client/src/editor/components/Toolbar/style.styl":function(e,t,n){},"../client/src/editor/index.js":function(e,t,n){"use strict";n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es7.object.get-own-property-descriptors.js"),n("./core-js/modules/es6.array.iterator.js"),n("./core-js/modules/es6.object.keys.js"),n("./core-js/modules/es6.object.set-prototype-of.js"),n("./core-js/modules/es6.regexp.replace.js"),n("./core-js/modules/es6.regexp.match.js"),n("./regenerator-runtime/runtime.js"),n("./core-js/modules/es6.promise.js"),n("./core-js/modules/web.dom.iterable.js"),n("./core-js/modules/es6.regexp.to-string.js"),n("./antd/lib/input/style/index.js");var r=n("./antd/lib/input/index.js"),o=n.n(r),a=n("./react/index.js"),i=n.n(a),c=n("./react-dom/index.js"),s=n.n(c),l=n("./mobx-react/index.module.js"),u=n("./@mtfe/citadel-editor/es/cursor/index.js"),p=n("./@mtfe/citadel-editor/es/editor/index.js"),f=n("./lodash.isequal/index.js"),d=n.n(f),m=n("../client/src/components/Toastr/index.js"),h=n("../client/src/editor/consts/index.js"),y=n("../client/src/editor/store/index.js"),b=n("../client/src/stores/index.js"),v=n("../client/src/utils/logger.js"),g=n("../client/src/utils/report/lx.js"),w=n("../client/src/utils/report/lxConfig.js"),j=function(e){var t=function(e){for(var t=e,n=null,r=0;t!==document.body&&!n&&r<4;)n=t.getAttribute("data-action"),t=t.parentNode,r+=1;return n?w.d[n]||w.c[n]:null}(e.target);t&&Object(g.a)(t)},O=(n("./core-js/modules/es6.string.sub.js"),n("./core-js/modules/es6.string.sup.js"),n("./mobx/lib/mobx.module.js")),S=n("./classnames/index.js"),E=n.n(S),P=n("./lodash.throttle/index.js"),k=n.n(P),x=n("./@mtfe/citadel-editor/es/utils/index.js"),C=n("../client/src/components/UploadFile/index.js"),T=n("../client/src/components/GuideToolTip/index.js"),I=n("../client/src/editor/components/EditIcon/index.js"),A=n("../client/src/editor/components/EditIcon/consts.js"),D=n("../client/src/editor/assets/svg/arrowDown.svg");n("../client/src/editor/components/Dropdown/style.styl");function N(e){return(N="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return!t||"object"!==N(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R,V=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_(this,L(t).call(this,e))).state={active:!1},n.clickOutSide=function(e){e.target===n.btn||n.btn.contains(e.target)?e.preventDefault():n.ref&&!n.ref.contains(e.target)&&n.setState({active:!1})},n.onClick=function(){n.props.disabled||n.setState({active:!n.state.active})},n.renderBody=function(){if(!n.state.active)return null;var e=n.btn?n.btn.getBoundingClientRect():{top:0,left:0,width:0,height:0},t=e.top,r=e.left,o=e.width,a=e.height,c={top:"".concat(t+a,"px"),left:"".concat(r,"px"),maxWidth:"".concat(o+100,"px")};return s.a.createPortal(i.a.createElement("div",{onClick:function(){return n.setState({active:!1})},className:"ct-dropdown-content",style:c,ref:function(e){return n.ref=e}},n.props.children),document.body)},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.clickOutSide)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.clickOutSide)}},{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,r=t.tooltip,o=t.width,a={};return o&&(a.width="".concat(o,"px")),i.a.createElement("div",null,i.a.createElement("div",{className:E()("ct-dropdown-container",{disabled:n,"ct-dropdown-open":this.state.active}),ref:function(t){return e.btn=t},onClick:this.onClick},i.a.createElement("span",{className:"ct-dropdown-selected ",style:a},i.a.createElement("span",{className:"ct-dropdown-item"},this.props.selected),i.a.createElement(D.a,null)),i.a.createElement("div",{className:"ct-toolbar-tooltip",style:{width:"70px"}},r),this.renderBody()))}}])&&M(n.prototype,r),o&&M(n,o),t}();n("../client/src/editor/components/Toolbar/ParagraphPopover/style.styl");function H(e){return(H="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return!t||"object"!==H(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var G=[{type:"paragraph",text:"\u6b63\u6587",keymap:"0"},{type:"heading_1",text:"\u6807\u9898 1",keymap:"1"},{type:"heading_2",text:"\u6807\u9898 2",keymap:"2"},{type:"heading_3",text:"\u6807\u9898 3",keymap:"3"},{type:"heading_4",text:"\u6807\u9898 4",keymap:"4"},{type:"heading_5",text:"\u6807\u9898 5",keymap:"5"},{type:"heading_6",text:"\u6807\u9898 6",keymap:"6"}],Q={"\u6b63\u6587":"\u6b63\u6587","\u4e00\u7ea7\u6807\u9898":"\u6807\u9898 1","\u4e8c\u7ea7\u6807\u9898":"\u6807\u9898 2","\u4e09\u7ea7\u6807\u9898":"\u6807\u9898 3","\u56db\u7ea7\u6807\u9898":"\u6807\u9898 4","\u4e94\u7ea7\u6807\u9898":"\u6807\u9898 5","\u516d\u7ea7\u6807\u9898":"\u6807\u9898 6"},X=Object(l.inject)("store")(R=Object(l.observer)(R=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=U(this,(e=K(t)).call.apply(e,[this].concat(o)))).state={hasTooltip:!1,isOpen:!1},n.onSelect=function(e){var t=n.props.store,r=t.schema,o=t.view,a=t.core,i=a.basicCommands,c=a.basicUtils.getAttrs(o.state);if(/heading_+/.test(e)){var s=parseInt(e[8],10);i.setTextBlockType(r.nodes.heading,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(n,!0).forEach(function(t){W(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},c,{level:s}))}else i.setTextBlockType(r.nodes.paragraph);o.focus()},n.handleMouseEnter=function(){n.state.isOpen||n.setState({hasTooltip:!0})},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.store,n=t.view,r=(t.count,t.core.basicUtils),o=r?r.getTextBlockType(n.state):null,a=!(o=Q[o]);return i.a.createElement("div",{className:"paragraph-popover"},i.a.createElement(V,{disabled:a,selected:o||"\u6b63\u6587",tooltip:"\u6bb5\u843d\u683c\u5f0f"},i.a.createElement("div",null,G.map(function(t,n){return i.a.createElement("div",{"data-action":"paragraph",key:"".concat(t.type,"-").concat(n),className:"toolbar-p-popover-item-web",onClick:function(){return e.onSelect(t.type)}},t.text)}))))}}])&&F(n.prototype,r),o&&F(n,o),t}())||R)||R,Y=n("../client/src/editor/components/Toolbar/ColorPopover/index.js");function J(e){return(J="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t){return!t||"object"!==J(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var re=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ee(this,te(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Z({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M209.92 128l184.75 320L579.4 128h73.92L431.62 512l221.71 384h-73.92L394.67 576 209.92 896h-73.9l221.7-384-221.7-384h73.9zM896 128v64h-3.63L781.53 384H896v64H704v-64h3.63l110.84-192H704v-64h192z"}))}}])&&$(n.prototype,r),o&&$(n,o),t}();function oe(e){return(oe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t){return!t||"object"!==oe(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ue,pe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ce(this,se(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",ae({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M209.92 128l184.75 320L579.4 128h73.92L431.62 512l221.71 384h-73.92L394.67 576 209.92 896h-73.9l221.7-384-221.7-384h73.9zM896 533.33v79.02L769.2 832H896v64H704v-79.06l126.78-219.6H704v-64h192z"}))}}])&&ie(n.prototype,r),o&&ie(n,o),t}();n("../client/src/editor/components/Toolbar/MorePopover/style.styl");function fe(e){return(fe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t,n){return t&&me(e.prototype,t),n&&me(e,n),e}function ye(e,t){return!t||"object"!==fe(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ve(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var we=function(e){function t(){return de(this,t),ye(this,be(t).apply(this,arguments))}return ve(t,a["Component"]),he(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.props.onGlobalClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.props.onGlobalClick)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"ct-extra-popover"},i.a.createElement("div",{"data-action":"sup",className:"ct-extra-popover-item",onClick:function(){return e.props.select("sup")}},i.a.createElement(re,null),i.a.createElement("span",null,"\u4e0a\u6807")),i.a.createElement("div",{"data-action":"sub",className:"ct-extra-popover-item",onClick:function(){return e.props.select("sub")}},i.a.createElement(pe,null),i.a.createElement("span",null,"\u4e0b\u6807")))}}]),t}(),je=Object(l.inject)("store")(ue=Object(l.observer)(ue=function(e){function t(){var e,n;de(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=ye(this,(e=be(t)).call.apply(e,[this].concat(o)))).state={hasTooltip:!1,isOpen:!1},n.onSelect=function(e){({sup:n.props.onInsertSup,sub:n.props.onInsertSub})[e](),n.onGlobalClick()},n.onGlobalClick=function(){n.setState({isOpen:!1,hasTooltip:!1})},n.handleClick=function(){n.props.store.view.focus(),n.setState({hasTooltip:!1,isOpen:!n.state.isOpen})},n.handleMouseEnter=function(){n.state.isOpen||n.setState({hasTooltip:!0})},n}return ve(t,a["Component"]),he(t,[{key:"render",value:function(){var e=this,t=this.props.disabledHandler,n=t&&t();return i.a.createElement("div",{onClick:n?null:this.handleClick,onMouseEnter:n?null:this.handleMouseEnter,onMouseLeave:function(){return e.setState({hasTooltip:!1})},className:E()("ct-toolbar-icon-wrapper",{disabled:n,"ct-toolbar-is-open":this.state.isOpen})},i.a.createElement(re,null),i.a.createElement(D.a,{className:"tool-arrow-down"}),this.state.isOpen&&i.a.createElement(we,{select:this.onSelect,onGlobalClick:this.onGlobalClick}),this.state.hasTooltip&&i.a.createElement("div",{className:"ct-toolbar-tooltip",style:{width:"70px"}},"\u6587\u5b57\u5176\u4ed6"))}}]),t}())||ue)||ue,Oe=(n("./antd/lib/popover/style/index.js"),n("./antd/lib/popover/index.js")),Se=n.n(Oe);n("../client/src/editor/components/Toolbar/TablePopover/style.styl");function Ee(e){return(Ee="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t){return!t||"object"!==Ee(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Te=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ke(this,xe(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.store.rootStore,t=e.state,n=e.view,r=e.core,o=r.tableCommands,a=r.tableUtils,c=r.tableStore,s=a.isInNumCell(t),l=a.hasTableHeader(t),u=l.hasRowHeader,p=l.hasColHeader,f=l.headerCol,d=l.hasNumCol,m=l.tableNode,h=l.startPos,y=a.canSplitCell(t),b=a.canMergeCells(t),v=a.canAddColumnBefore(t),g=a.canAddColumnAfter(t),w=a.canAddRowBefore(t),j=!0,O=!0;return u&&1===m.content.content.length&&(j=!1,O=!1),this.props.slim?i.a.createElement("div",{className:"ct-context-menu",onClick:function(){return!s&&n.focus()}},i.a.createElement("div",{"data-action":"rowHeader",className:"ct-context-item",onClick:function(){return o.toggleRowHeader(u,f,d,m,h)}},u?"\u53d6\u6d88\u8868\u5934\u884c":"\u8bbe\u7f6e\u8868\u5934\u884c"),i.a.createElement("div",{"data-action":"colHeader",className:"ct-context-item ".concat(j?"":"disabled"),onClick:function(){return j&&o.toggleColHeader(p,u,d,m,h)}},p?"\u53d6\u6d88\u8868\u5934\u5217":"\u8bbe\u7f6e\u8868\u5934\u5217"),i.a.createElement("div",{"data-action":"numCol",className:"ct-context-item split ".concat(O?"":"disabled"),onClick:function(){return O&&o.toggleNumCol(d,u,m,h)}},d?"\u53d6\u6d88\u884c\u53f7\u5217":"\u8bbe\u7f6e\u884c\u53f7\u5217")):i.a.createElement("div",{className:"ct-context-menu",onClick:function(){return!s&&n.focus()}},i.a.createElement("div",{"data-action":"rowHeaderMenu",className:"ct-context-item",onClick:function(){return o.toggleRowHeader(u,f,d,m,h)}},u?"\u53d6\u6d88\u8868\u5934\u884c":"\u8bbe\u7f6e\u8868\u5934\u884c"),i.a.createElement("div",{"data-action":"colHeaderMenu",className:"ct-context-item ".concat(j?"":"disabled"),onClick:function(){return j&&o.toggleColHeader(p,u,d,m,h)}},p?"\u53d6\u6d88\u8868\u5934\u5217":"\u8bbe\u7f6e\u8868\u5934\u5217"),i.a.createElement("div",{"data-action":"numColMenu",className:"ct-context-item split ".concat(O?"":"disabled"),onClick:function(){return O&&o.toggleNumCol(d,u,m,h)}},d?"\u53d6\u6d88\u884c\u53f7\u5217":"\u8bbe\u7f6e\u884c\u53f7\u5217"),i.a.createElement("div",{"data-action":"addRowBeforeMenu",className:"ct-context-item ".concat(w?"":"disabled"),onClick:function(){return o.addRowBefore()}},"\u4e0a\u65b9\u63d2\u5165\u884c"),i.a.createElement("div",{"data-action":"addRowAfterMenu",className:"ct-context-item",onClick:function(){return o.addRowAfter()}},"\u4e0b\u65b9\u63d2\u5165\u884c"),i.a.createElement("div",{"data-action":"deleteRowMenu",className:"ct-context-item split",onClick:function(){return o.deleteRow()}},"\u5220\u9664\u884c"),i.a.createElement("div",{"data-action":"addColumnBeforeMenu",className:"ct-context-item ".concat(v?"":"disabled"),onClick:function(){return o.addColumnBefore()}},"\u5de6\u4fa7\u63d2\u5165\u5217"),i.a.createElement("div",{"data-action":"addColumnAfterMenu",className:"ct-context-item ".concat(g?"":"disabled"),onClick:function(){return o.addColumnAfter()}},"\u53f3\u4fa7\u63d2\u5165\u5217"),i.a.createElement("div",{"data-action":"deleteColumnMenu",className:"ct-context-item split",onClick:function(){return o.deleteColumn()}},"\u5220\u9664\u5217"),i.a.createElement("div",{"data-action":"mergeCellsMenu",className:"ct-context-item ".concat(b?"":"disabled"),onClick:o.mergeCells},"\u5408\u5e76\u5355\u5143\u683c"),i.a.createElement("div",{"data-action":"splitCellMenu",className:"ct-context-item split ".concat(y?"":"disabled"),onClick:o.splitCell},"\u62c6\u5206\u5355\u5143\u683c"),i.a.createElement("div",{"data-action":"deleteTableMenu",className:"ct-context-item split",onClick:function(){return c.showModal()}},"\u8868\u683c\u5c5e\u6027"),i.a.createElement("div",{"data-action":"deleteTableMenu",className:"ct-context-item",onClick:o.deleteTable},"\u5220\u9664\u8868\u683c"))}}])&&Pe(n.prototype,r),o&&Pe(n,o),t}();function Ie(e){return(Ie="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(n,!0).forEach(function(t){Ne(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t,n){return t&&_e(e.prototype,t),n&&_e(e,n),e}function Be(e,t){return!t||"object"!==Ie(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ze={max:10,default:6,itemWidth:24};function We(e){return e<1?1:e>=ze.max?ze.max:~~e}var Fe=function(e){function t(){var e,n;Me(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Be(this,(e=Re(t)).call.apply(e,[this].concat(o)))).state={highlight:{rowNum:1,colNum:1},bound:{rowCount:ze.default,colCount:ze.default}},n.onMouseMove=function(e){e.target;var t=n.state,r=t.bound,o=r.rowCount,a=r.colCount,i=t.highlight,c=(i.rowNum,i.colNum,We((e.clientX-n.modal.offsetLeft+ze.itemWidth/2)/ze.itemWidth)),s=We((e.clientY-n.modal.offsetTop+ze.itemWidth/2)/ze.itemWidth),l=s,u=c,p=a,f=o;c>=a&&a<ze.max?p=a+1:c<a-1&&a>7&&(p=c-1),s>=o&&o<ze.max?f=o+1:s<o-1&&o>7&&(f=s-1),n.setState({highlight:{rowNum:l,colNum:u},bound:{rowCount:f,colCount:p}})},n.handleClick=function(){var e=n.state.highlight,t=e.rowNum,r=e.colNum;n.props.onClick(t,r)},n}return Ve(t,i.a.Component),Le(t,[{key:"render",value:function(){for(var e=this,t=this.state,n=t.highlight,r=n.rowNum,o=n.colNum,a=t.bound,c=a.rowCount,s=a.colCount,l=[],u=1;u<=c;u++){for(var p=[],f=1;f<=s;f++)r>=u&&o>=f?p.push(i.a.createElement("div",{key:f,"data-row":u,"data-col":f,className:"block"},i.a.createElement("span",{className:"block-inner","data-row":u,"data-col":f,style:{backgroundColor:"rgba(0, 0, 0, 0.13)"}}))):p.push(i.a.createElement("div",{key:f,"data-row":u,"data-col":f,className:"block"},i.a.createElement("span",{"data-row":u,"data-col":f,className:"block-inner"})));l.push(i.a.createElement("div",{className:"row",style:{height:"24px"},"data-row":u,key:u},p))}var d="12 + ".concat(24*s,"px");return i.a.createElement("div",{className:"ct-add-table-modal",style:De({},this.props.style,{width:d}),onClick:this.handleClick,ref:function(t){e.modal=t},onMouseMove:this.onMouseMove},i.a.createElement("div",{className:"container"},l),i.a.createElement("div",{className:"count"},"".concat(r," X ").concat(o)))}}]),t}(),Ue=function(e){function t(){var e,n;Me(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Be(this,(e=Re(t)).call.apply(e,[this].concat(o)))).state={visible:!1,style:{}},n.toggle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clientY:0,clientX:0},t=n.state.visible,r={top:"".concat(e.clientY+20,"px"),left:"".concat(e.clientX-20,"px")};n.setState({visible:!t,style:r})},n.handleVisibleChange=function(e){n.setState({visible:e})},n}return Ve(t,i.a.Component),Le(t,[{key:"render",value:function(){var e=this,t=this.props.store,n=t.pm,r=t.core.tableCommands;return i.a.createElement("div",null,i.a.createElement(Se.a,{content:this.state.visible&&i.a.createElement(Fe,{style:this.state.style,onClick:function(t,o){e.toggle(),r.insertTable(t,o),n.focus()}}),onVisibleChange:this.handleVisibleChange,visible:this.state.visible,trigger:"click",overlayClassName:"ct-table-popover-layer"},i.a.createElement("span",null,i.a.createElement(I.a,{action:"table",tooltip:"\u8868\u683c",showArrow:"true",onClick:function(t){e.toggle(t),n.focus()}}))))}}]),t}();function Ke(e){return(Ke="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(){return(qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e,t){return!t||"object"!==Ke(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xe(e){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Je=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qe(this,Xe(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",qe({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M234.67 448a64 64 0 1 1 0 128 64 64 0 0 1 0-128zM512 448a64 64 0 1 1 0 128 64 64 0 0 1 0-128zm277.33 0a64 64 0 1 1 0 128 64 64 0 0 1 0-128z"}))}}])&&Ge(n.prototype,r),o&&Ge(n,o),t}();function Ze(e){return(Ze="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(){return($e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t){return!t||"object"!==Ze(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ot=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tt(this,nt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",$e({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M896 170.67A21.33 21.33 0 0 1 917.33 192v341.33c0 151.13-71.42 285.55-182.35 371.42l-39.13-50.67c93.65-72.5 154.73-185.09 157.4-312.06l.08-8.69V512h-256A21.33 21.33 0 0 1 576 490.67V192a21.33 21.33 0 0 1 21.33-21.33H896zm-469.33 0A21.33 21.33 0 0 1 448 192v341.33h-.47c-6.4 142.4-76.2 268.3-181.89 350.08l-39.12-50.66C322.3 758.6 384 642.52 384 512H128a21.33 21.33 0 0 1-21.33-21.33V192A21.33 21.33 0 0 1 128 170.67h298.67zm426.66 64H640V448h213.33V234.67zm-469.33 0H170.67V448H384V234.67z"}))}}])&&et(n.prototype,r),o&&et(n,o),t}();function at(e){return(at="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(){return(it=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function st(e,t){return!t||"object"!==at(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),st(this,lt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",it({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M320 277.33v-64h576v64H320zM320 544v-64h576v64H320zm0 266.67v-64h576v64H320zM128 277.33v-64h106.67v64H128zM128 544v-64h106.67v64H128zm0 266.67v-64h106.67v64H128z"}))}}])&&ct(n.prototype,r),o&&ct(n,o),t}();function ft(e){return(ft="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(){return(dt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ht(e,t){return!t||"object"!==ft(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ht(this,yt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",dt({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M330.99 602.52a64 64 0 0 0 90.5 90.5l331.88-331.85a128 128 0 0 0-181.04-181.01L225.4 527.08a192 192 0 1 0 271.53 271.53l301.7-301.7 45.24 45.26-301.7 301.7c-99.96 99.98-262.05 99.98-362.02 0-100-99.98-100-262.07 0-362.04l346.94-346.96A192 192 0 1 1 798.61 406.4L466.75 738.28a128 128 0 1 1-181.03-181.03l286.61-286.62 45.27 45.27-286.61 286.62z"}))}}])&&mt(n.prototype,r),o&&mt(n,o),t}(),gt=n("../client/src/editor/assets/svg/mention.svg");function wt(e){return(wt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(){return(jt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function St(e,t){return!t||"object"!==wt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),St(this,Et(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",jt({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M362.67 384l106.66 181.33h-74.66V640H576a21.33 21.33 0 0 1 21.33 21.33v213.34A21.33 21.33 0 0 1 576 896H149.33A21.33 21.33 0 0 1 128 874.67V661.33A21.33 21.33 0 0 1 149.33 640h181.34v-74.67H256L362.67 384zM576 128a21.33 21.33 0 0 1 21.33 21.33V224h320a21.33 21.33 0 0 1 21.34 21.33v533.34A21.33 21.33 0 0 1 917.33 800H778.67v74.67L597.33 768l181.34-106.67V736h96V288H597.33v74.67A21.33 21.33 0 0 1 576 384H149.33A21.33 21.33 0 0 1 128 362.67V149.33A21.33 21.33 0 0 1 149.33 128H576zm-42.67 576H192v128h341.33V704zm0-512H192v128h341.33V192z"}))}}])&&Ot(n.prototype,r),o&&Ot(n,o),t}();function xt(e){return(xt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(){return(Ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function It(e,t){return!t||"object"!==xt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),It(this,At(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Ct({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M405.33 618.67A21.33 21.33 0 0 1 384 640H106.67a21.33 21.33 0 0 1-21.34-21.33V405.33A21.33 21.33 0 0 1 106.67 384H384a21.33 21.33 0 0 1 21.33 21.33V480h85.34V245.33A21.33 21.33 0 0 1 512 224h106.65l.02-74.67A21.33 21.33 0 0 1 640 128h277.33a21.33 21.33 0 0 1 21.34 21.33v213.34A21.33 21.33 0 0 1 917.33 384H640a21.33 21.33 0 0 1-21.33-21.33l-.02-74.67h-63.98v448h63.98l.02-74.67A21.33 21.33 0 0 1 640 640h277.33a21.33 21.33 0 0 1 21.34 21.33v213.34A21.33 21.33 0 0 1 917.33 896H640a21.33 21.33 0 0 1-21.33-21.33l-.02-74.67H512a21.33 21.33 0 0 1-21.33-21.33V544h-85.34v74.67zm-64-170.67h-192v128h192V448zm533.34-256h-192v128h192V192zm0 512h-192v128h192V704z"}))}}])&&Tt(n.prototype,r),o&&Tt(n,o),t}();function Mt(e){return(Mt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _t(){return(_t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bt(e,t){return!t||"object"!==Mt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ht=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bt(this,Rt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",_t({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M832 277.33V192H192v85.33h640zm0 64H192V832h640V341.33zM149.33 128h725.34A21.33 21.33 0 0 1 896 149.33v725.34A21.33 21.33 0 0 1 874.67 896H149.33A21.33 21.33 0 0 1 128 874.67V149.33A21.33 21.33 0 0 1 149.33 128zm160 298.67h64v64h-64v-64zm170.67 0h64v64h-64v-64zm170.67 0h64v64h-64v-64zm-341.34 128h64v64h-64v-64zm170.67 0h64v64h-64v-64zm170.67 0h64v64h-64v-64zm-341.34 128h64v64h-64v-64zm170.67 0h64v64h-64v-64z"}))}}])&&Lt(n.prototype,r),o&&Lt(n,o),t}();function zt(e){return(zt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(){return(Wt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ut(e,t){return!t||"object"!==zt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kt(e){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ut(this,Kt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Wt({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M874.67 554.67A21.33 21.33 0 0 1 896 576v298.67A21.33 21.33 0 0 1 874.67 896H149.33A21.33 21.33 0 0 1 128 874.67V576a21.33 21.33 0 0 1 21.33-21.33h725.34zm-42.67 64H192V832h640V618.67zM874.67 128A21.33 21.33 0 0 1 896 149.33v320a21.33 21.33 0 0 1-21.33 21.34H149.33A21.33 21.33 0 0 1 128 469.33v-320A21.33 21.33 0 0 1 149.33 128h725.34zM832 192H192v234.67h640V192zm-512 85.33v64h-64v-64h64zm128 0v64h-64v-64h64zm128 0v64h-64v-64h64z"}))}}])&&Ft(n.prototype,r),o&&Ft(n,o),t}();function Qt(e){return(Qt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xt(){return(Xt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jt(e,t){return!t||"object"!==Qt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zt(e){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var en=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jt(this,Zt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Xt({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M938.67 746.67v64H405.33v-64h533.34zm0-192v64H405.33v-64h533.34zm0-192v64H405.33v-64h533.34zm-597.34-192L213.33 384l-128-213.33h256zm597.34 0v64H405.33v-64h533.34z"}))}}])&&Yt(n.prototype,r),o&&Yt(n,o),t}();function tn(e){return(tn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(){return(nn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function on(e,t){return!t||"object"!==tn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function an(e){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cn(e,t){return(cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),on(this,an(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cn(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",nn({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M938.67 640v64H85.33v-64h853.34zm0-320v64H85.33v-64h853.34z"}))}}])&&rn(n.prototype,r),o&&rn(n,o),t}();function ln(e){return(ln="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function un(){return(un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t){return!t||"object"!==ln(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mn(e,t){return(mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fn(this,dn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mn(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",un({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M320 128h576v128H320V128zm170.67 320H896v128H490.67V448zM192 234.67v256h234.67v64H192v256h234.67v64H128v-704h128v64h-64zM490.67 768H896v128H490.67V768z"}))}}])&&pn(n.prototype,r),o&&pn(n,o),t}();function yn(e){return(yn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bn(){return(bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gn(e,t){return!t||"object"!==yn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wn(e){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jn(e,t){return(jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var On=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gn(this,wn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jn(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",bn({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M533.33 128v64h-320v192h256v64h-256v448h-64V128h384zM868.3 304.21l55.42 32-150.76 261.12L923.7 858.45l-55.42 32L736 661.33 603.71 890.45l-55.42-32 150.76-261.12L548.3 336.21l55.42-32L736 533.33l132.29-229.12z"}))}}])&&vn(n.prototype,r),o&&vn(n,o),t}();function Sn(e){return(Sn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(){return(En=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kn(e,t){return!t||"object"!==Sn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xn(e){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cn(e,t){return(Cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Tn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kn(this,xn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cn(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",En({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M874.67 128A21.33 21.33 0 0 1 896 149.33v725.34A21.33 21.33 0 0 1 874.67 896H149.33A21.33 21.33 0 0 1 128 874.67V149.33A21.33 21.33 0 0 1 149.33 128h725.34zM832 192H192v640h640V192zM426.67 298.67V480h170.66V298.67h64v426.66h-64V544H426.67v181.33h-64V298.67h64z"}))}}])&&Pn(n.prototype,r),o&&Pn(n,o),t}(),In=n("../client/src/editor/assets/svg/codeBlock.svg"),An=n("../client/src/editor/assets/svg/link.svg"),Dn=n("../client/src/editor/assets/svg/image.svg");function Nn(e){return(Nn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(){return(Mn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ln(e,t){return!t||"object"!==Nn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bn(e){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rn(e,t){return(Rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ln(this,Bn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rn(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Mn({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M143.47 665.56l59.09-24.62c50.86 124.59 173.23 212.4 316.14 212.4 188.5 0 341.33-152.82 341.33-341.34S707.2 170.67 518.7 170.67c-91.48 0-174.53 35.96-235.82 94.55l65.15 65.13-241.36 60.35L167 149.33l70.61 70.62A403.99 403.99 0 0 1 518.7 106.67c223.85 0 405.33 181.48 405.33 405.33S742.55 917.33 518.7 917.33c-169.52 0-314.73-104.06-375.25-251.77zM113.37 512h64-64zm419.96 8.09l139.95 139.94-45.23 45.27-149.33-149.33a32 32 0 0 1-9.39-22.64V320h64v200.09z"}))}}])&&_n(n.prototype,r),o&&_n(n,o),t}();function Hn(e){return(Hn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zn(){return(zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fn(e,t){return!t||"object"!==Hn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Un(e){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kn(e,t){return(Kn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Fn(this,Un(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kn(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",zn({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M512 938.67C276.35 938.67 85.33 747.65 85.33 512S276.35 85.33 512 85.33 938.67 276.35 938.67 512 747.65 938.67 512 938.67zm0-64c200.3 0 362.67-162.37 362.67-362.67S712.3 149.33 512 149.33 149.33 311.7 149.33 512 311.7 874.67 512 874.67zm10.67-375.92L662.6 638.7l-45.22 45.27-149.34-149.34a32 32 0 0 1-9.38-22.63V298.67h64v200.08z"}))}}])&&Wn(n.prototype,r),o&&Wn(n,o),t}();function Gn(e){return(Gn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qn(){return(Qn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yn(e,t){return!t||"object"!==Gn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jn(e){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zn(e,t){return(Zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Yn(this,Jn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zn(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Qn({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M574.72 513.28L362.67 301.27 407.9 256l242.22 242.22a21.33 21.33 0 0 1 0 30.16L407.9 770.56l-45.22-45.23 212.05-212.05z"}))}}])&&Xn(n.prototype,r),o&&Xn(n,o),t}();function er(e){return(er="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tr(){return(tr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rr(e,t){return!t||"object"!==er(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function or(e){return(or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ar(e,t){return(ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ir,cr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rr(this,or(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ar(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",tr({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M512 85.33c235.65 0 426.67 191.02 426.67 426.67S747.65 938.67 512 938.67 85.33 747.65 85.33 512 276.35 85.33 512 85.33zm0 64c-200.3 0-362.67 162.37-362.67 362.67S311.7 874.67 512 874.67 874.67 712.3 874.67 512 712.3 149.33 512 149.33zM554.67 384h-85.34v-85.33h85.34V384zm0 341.33h-85.34V448h85.34v277.33z"}))}}])&&nr(n.prototype,r),o&&nr(n,o),t}();n("../client/src/editor/components/Toolbar/ExtraPopover/NotePopover/style.styl");function sr(e){return(sr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pr(e,t,n){return t&&ur(e.prototype,t),n&&ur(e,n),e}function fr(e,t){return!t||"object"!==sr(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dr(e){return(dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hr(e,t)}function hr(e,t){return(hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yr=function(e){function t(){return lr(this,t),fr(this,dr(t).apply(this,arguments))}return mr(t,a["Component"]),pr(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{"data-action":"info",className:"ct-extra-popover-item",onClick:function(){return e.props.select("info")}},i.a.createElement("span",null,"\u4fe1\u606f")),i.a.createElement("div",{"data-action":"note",className:"ct-extra-popover-item",onClick:function(){return e.props.select("note")}},i.a.createElement("span",null,"\u8b66\u793a")),i.a.createElement("div",{"data-action":"warning",className:"ct-extra-popover-item",onClick:function(){return e.props.select("warning")}},i.a.createElement("span",null,"\u6ce8\u610f")),i.a.createElement("div",{"data-action":"tip",className:"ct-extra-popover-item",onClick:function(){return e.props.select("tip")}},i.a.createElement("span",null,"\u63d0\u793a")))}}]),t}(),br=Object(l.inject)("store")(ir=Object(l.observer)(ir=function(e){function t(){return lr(this,t),fr(this,dr(t).apply(this,arguments))}return mr(t,a["Component"]),pr(t,[{key:"render",value:function(){var e=i.a.createElement(yr,{select:this.props.select});return this.props.visible?i.a.createElement(Se.a,{placement:"right",className:"ct-extra-popover-item ct-note-select-popover-wrapper",overlayClassName:"ct-popover-item",content:e,popupAlign:{offset:[-8,54]},onClick:function(e){e.preventDefault(),e.stopPropagation()}},i.a.createElement(cr,null),i.a.createElement("span",{style:{flex:1}},"\u6837\u5f0f"),i.a.createElement($n,{className:"arrow-right-icon"})):null}}]),t}())||ir)||ir,vr=n("../client/src/utils/tools.js");function gr(e){return(gr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wr(){return(wr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Or(e,t){return!t||"object"!==gr(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sr(e){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Er(e,t){return(Er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pr,kr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Or(this,Sr(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Er(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",wr({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M512 938.67C276.35 938.67 85.33 747.65 85.33 512S276.35 85.33 512 85.33 938.67 276.35 938.67 512 747.65 938.67 512 938.67zm0-64c200.3 0 362.67-162.37 362.67-362.67S712.3 149.33 512 149.33 149.33 311.7 149.33 512 311.7 874.67 512 874.67zm-85.33-512l256 149.33-256 149.33V362.67z"}))}}])&&jr(n.prototype,r),o&&jr(n,o),t}();n("../client/src/editor/components/Toolbar/ExtraPopover/MediaPopover/style.styl");function xr(e){return(xr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ir(e,t,n){return t&&Tr(e.prototype,t),n&&Tr(e,n),e}function Ar(e,t){return!t||"object"!==xr(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dr(e){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mr(e,t)}function Mr(e,t){return(Mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _r=function(e){function t(){return Cr(this,t),Ar(this,Dr(t).apply(this,arguments))}return Nr(t,a["Component"]),Ir(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"",ref:function(t){e.mediaPopover=t}},i.a.createElement("div",{"data-action":"video",className:"ct-extra-popover-item",onClick:this.props.selectVideo},i.a.createElement("span",null,"\u89c6\u9891")),i.a.createElement("div",{"data-action":"audio",className:"ct-extra-popover-item",onClick:this.props.selectAudio},i.a.createElement("span",null,"\u97f3\u9891")))}}]),t}(),Lr=Object(l.inject)("store")(Pr=Object(l.observer)(Pr=function(e){function t(){return Cr(this,t),Ar(this,Dr(t).apply(this,arguments))}return Nr(t,a["Component"]),Ir(t,[{key:"render",value:function(){if(!this.props.visible)return null;var e=i.a.createElement(_r,{selectVideo:this.props.selectVideo,selectAudio:this.props.selectAudio,onGlobalClick:this.onGlobalClick});return i.a.createElement(Se.a,{placement:"right",content:e,className:"ct-extra-popover-item",overlayClassName:"ct-popover-item",popupAlign:{offset:[-8,17]},onClick:function(e){e.preventDefault(),e.stopPropagation()}},i.a.createElement("span",null,i.a.createElement(kr,null)," ",i.a.createElement("span",null,"\u5a92\u4f53"),i.a.createElement($n,{className:"arrow-right-icon"})))}}]),t}())||Pr)||Pr;function Br(e){return(Br="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rr(){return(Rr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hr(e,t){return!t||"object"!==Br(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zr(e){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wr(e,t){return(Wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fr,Ur=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Hr(this,zr(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wr(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Rr({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M704 128v64h-64v256l307.95 431.15a10.67 10.67 0 0 1-8.69 16.85H84.74a10.67 10.67 0 0 1-8.69-16.85L384 448V192h-64v-64h384zm-5.5 512h-373l-45.71 64h253.54v64H234.67v-.83L188.37 832h647.26L698.5 640zM576 192H448v276.5L371.2 576h281.6L576 468.5V192z"}))}}])&&Vr(n.prototype,r),o&&Vr(n,o),t}();n("../client/src/editor/components/Toolbar/ExtraPopover/ExperimentPopover/style.styl");function Kr(e){return(Kr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qr(e,t,n){return t&&Gr(e.prototype,t),n&&Gr(e,n),e}function Xr(e,t){return!t||"object"!==Kr(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yr(e){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jr(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zr(e,t)}function Zr(e,t){return(Zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $r=function(e){function t(){return qr(this,t),Xr(this,Yr(t).apply(this,arguments))}return Jr(t,a["Component"]),Qr(t,[{key:"render",value:function(){var e=this.props.select;return i.a.createElement("div",{className:""},i.a.createElement("div",{"data-action":"markdown",className:"ct-extra-popover-item",onClick:function(){return e("markdown")}},i.a.createElement("span",null,"Markdown")),i.a.createElement("div",{"data-action":"gantt",className:"ct-extra-popover-item",onClick:function(){return e("gantt")}},i.a.createElement("span",null,"\u7518\u7279\u56fe")),i.a.createElement("div",{"data-action":"plantuml",className:"ct-extra-popover-item",onClick:function(){return e("plantuml")}},i.a.createElement("span",null,"PlantUML")),i.a.createElement("div",{"data-action":"data2chart",className:"ct-extra-popover-item",onClick:function(){return e("data2chart")}},i.a.createElement("span",null,"\u6570\u636e\u56fe\u8868")))}}]),t}(),eo=Object(l.inject)("store")(Fr=Object(l.observer)(Fr=function(e){function t(){return qr(this,t),Xr(this,Yr(t).apply(this,arguments))}return Jr(t,a["Component"]),Qr(t,[{key:"render",value:function(){if(!this.props.visible)return null;var e=i.a.createElement($r,{select:this.props.select});return i.a.createElement(Se.a,{placement:"right",content:e,className:"ct-extra-popover-item ct-experiment-select-popover-wrapper",overlayClassName:"ct-popover-item",popupAlign:{offset:[-8,34]},onClick:function(e){e.preventDefault(),e.stopPropagation()}},i.a.createElement("span",null,i.a.createElement(Ur,null),i.a.createElement("span",null,"\u5b9e\u9a8c\u5ba4"),i.a.createElement($n,{className:"arrow-right-icon"})))}}]),t}())||Fr)||Fr;var to=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeout={},this.interval={},this.setTimeout=function(e,t){},this.setInterval=function(e,n){var r=Symbol(),o=Date.now();return t.interval[r]=requestAnimationFrame(function a(){t.interval[r]=requestAnimationFrame(a),Date.now()-o>=n&&(e(),o=Date.now())}),r},this.clearTimeout=function(e){return t.__clearAnimation(t.timeout[e])},this.clearInterval=function(e){return t.__clearAnimation(t.interval[e])},this.__clearAnimation=function(e){cancelAnimationFrame(e)}};function no(e){return(no="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ro(){return(ro=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ao(e,t){return!t||"object"!==no(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var so,lo,uo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ao(this,io(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",ro({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M521.9 666.77a10.67 10.67 0 0 1-18.45 0L329.98 368.02A10.67 10.67 0 0 1 339.2 352h346.94a10.67 10.67 0 0 1 9.22 16.02L521.9 666.77z",opacity:".4"}))}}])&&oo(n.prototype,r),o&&oo(n,o),t}(),po=(n("../client/src/editor/components/Toolbar/ExtraPopover/style.styl"),n("../client/src/HOC/withGuide/index.jsx")),fo=n("../client/src/utils/keyGenerator.js");function mo(e){return(mo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ho(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bo(e,t,n){return t&&yo(e.prototype,t),n&&yo(e,n),e}function vo(e,t){return!t||"object"!==mo(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function go(e){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wo(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jo(e,t)}function jo(e,t){return(jo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oo,So=Object(po.a)({guideKey:Object(fo.a)("edit-menu-scroll"),iconClose:!0,content:i.a.createElement("span",{className:"menu-scroll-container"},i.a.createElement("span",{className:"menu-btn"},"\u70b9\u51fb"),"\u6216",i.a.createElement("span",{className:"menu-btn"},"\u60ac\u505c"),"\u67e5\u770b\u66f4\u591a\u529f\u80fd"),position:"leftBottom"})(so=function(e){function t(){var e,n;ho(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=vo(this,(e=go(t)).call.apply(e,[this].concat(o)))).scrollContainer=i.a.createRef(),n.scrollInterval=null,n.state={hover:!1},n.handleForceScroll=function(e){e.stopPropagation(),n.scrollContainer.current.scrollBy(0,20)},n}return wo(t,a["Component"]),bo(t,[{key:"componentDidUpdate",value:function(){var e=this;this.state.hover?this.state.hover&&!this.scrollInterval&&(this.scrollInterval=to.setInterval(function(){e.scrollContainer.current.scrollBy(0,3)},16)):(to.clearInterval(this.scrollInterval),this.scrollInterval=null)}},{key:"render",value:function(){var e=this,t=document.body.clientHeight-176;return i.a.createElement("div",{className:"ct-extra-more-popover",style:{height:"".concat(t,"px"),minHeight:"366px",maxHeight:"676px",overflow:"hidden"}},i.a.createElement("div",{className:"scroll-container",style:{height:"".concat(t-20,"px")},ref:this.scrollContainer},i.a.createElement("div",{"data-action":"catalog",className:"ct-extra-popover-item",onClick:function(){return e.props.select("catalog")}},i.a.createElement(pt,null),i.a.createElement("span",null,"\u76ee\u5f55")),i.a.createElement("div",{"data-action":"pageTree",className:"ct-extra-popover-item",onClick:function(){return e.props.select("pageTree")}},i.a.createElement(hn,null),i.a.createElement("span",null,"\u76ee\u5f55\u6811")),i.a.createElement("div",{className:"ct-extra-split-line"}),i.a.createElement("div",{"data-action":"attachment",className:"ct-extra-popover-item",onClick:function(){return e.props.select("attachment")}},i.a.createElement(vt,null),i.a.createElement("span",null,"\u9644\u4ef6")),i.a.createElement(Lr,{visible:this.props.visible,selectVideo:function(){return e.props.select("video")},selectAudio:function(){return e.props.select("audio")}}),i.a.createElement("div",{"data-action":"mention",className:"ct-extra-popover-item",onClick:function(){return e.props.select("mention")}},i.a.createElement(gt.a,null),i.a.createElement("span",null,"\u7528\u6237\u63d0\u53ca")),i.a.createElement("div",{className:"ct-extra-split-line"}),i.a.createElement("div",{"data-action":"status",className:"ct-extra-popover-item",onClick:function(){return e.props.select("status")}},i.a.createElement(Gt,null),i.a.createElement("span",null,"\u72b6\u6001")),i.a.createElement(br,{visible:this.props.visible,select:function(t){return e.props.select("note")(t)}}),i.a.createElement("div",{"data-action":"quote",className:"ct-extra-popover-item",onClick:function(){return e.props.select("quote")}},i.a.createElement(ot,null),i.a.createElement("span",null,"\u5f15\u7528")),i.a.createElement("div",{"data-action":"collapse",className:"ct-extra-popover-item",onClick:function(){return e.props.select("collapse")}},i.a.createElement(en,null),i.a.createElement("span",null,"\u5c55\u5f00")),i.a.createElement("div",{"data-action":"hr",className:"ct-extra-popover-item",onClick:function(){return e.props.select("hr")}},i.a.createElement(sn,null),i.a.createElement("span",null,"\u6c34\u5e73\u7ebf")),i.a.createElement("div",{className:"ct-extra-split-line"}),i.a.createElement("div",{"data-action":"drawio",className:"ct-extra-popover-item",onClick:function(){return e.props.select("drawio")}},i.a.createElement(kt,null),i.a.createElement("span",null,"\u6d41\u7a0b\u56fe")),i.a.createElement("div",{"data-action":"minder",className:"ct-extra-popover-item",onClick:function(){return e.props.select("minder")}},i.a.createElement(Nt,null),i.a.createElement("span",null,"\u601d\u7ef4\u5bfc\u56fe")),i.a.createElement("div",{"data-action":"latex",className:"ct-extra-popover-item",onClick:function(){return e.props.select("latexInline")}},i.a.createElement(On,null),i.a.createElement("span",null,"\u516c\u5f0f")),i.a.createElement("div",{"data-action":"html",className:"ct-extra-popover-item",onClick:function(){return e.props.select("html")}},i.a.createElement(Tn,null),i.a.createElement("span",null,"HTML")),i.a.createElement("div",{className:"ct-extra-split-line"}),i.a.createElement("div",{"data-action":"time",className:"ct-extra-popover-item",onClick:function(){return e.props.select("time")}},i.a.createElement(qn,null),i.a.createElement("span",null,"\u65f6\u95f4")),i.a.createElement("div",{"data-action":"calendar",className:"ct-extra-popover-item",onClick:function(){return e.props.select("calendar")}},i.a.createElement(Ht,null),i.a.createElement("span",null,"\u65e5\u5386")),i.a.createElement("div",{className:"ct-extra-split-line"}),i.a.createElement("div",{"data-action":"spaceupdate",className:"ct-extra-popover-item",onClick:function(){return e.props.select("spaceUpdate")}},i.a.createElement(Vn,null),i.a.createElement("span",null,"\u6700\u8fd1\u66f4\u65b0")),i.a.createElement(eo,{visible:this.props.visible,select:function(t){return e.props.select(t)}}),i.a.createElement("div",{"data-action":"code_block",className:"ct-extra-popover-item",onClick:function(){return e.props.select("code_block")}},i.a.createElement(In.a,null),i.a.createElement("span",null,"\u4ee3\u7801\u5757")),i.a.createElement("div",{"data-action":"link",className:"ct-extra-popover-item",onClick:function(){return e.props.select("link")}},i.a.createElement(An.a,null),i.a.createElement("span",null,"\u94fe\u63a5")),i.a.createElement("div",{"data-action":"image",className:"ct-extra-popover-item",onClick:function(){return e.props.select("image")}},i.a.createElement(Dn.a,null),i.a.createElement("span",null,"\u56fe\u7247"))),i.a.createElement("div",{className:"down-btn",onClick:this.handleForceScroll,onMouseEnter:function(){return e.setState({hover:!0})},onMouseLeave:function(){return e.setState({hover:!1})}},i.a.createElement(uo,null)))}}]),t}())||so,Eo=Object(l.inject)("store")(lo=Object(l.observer)(lo=function(e){function t(){var e,n;ho(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=vo(this,(e=go(t)).call.apply(e,[this].concat(o)))).state={hasTooltip:!1,isOpen:!1},n.onSelect=function(e){console.log("onselect");var t=n.props.handler,r=void 0===t?{}:t;if(n.setState({isOpen:!1}),"function"===typeof r[e])return r[e]()},n.handleClick=function(){var e=n.props.store.view;e&&e.focus(),n.setState({hasTooltip:!1,isOpen:!n.state.isOpen})},n.handleMouseEnter=function(){n.state.isOpen||n.setState({hasTooltip:!0})},n.handleVisibleChange=function(){n.setState({isOpen:!n.state.isOpen})},n}return wo(t,a["Component"]),bo(t,[{key:"render",value:function(){var e=this,t=this.props.disabledHandler,n=t&&t();return i.a.createElement("div",{onClick:n?null:this.handleClick,onMouseEnter:n?null:this.handleMouseEnter,onMouseLeave:function(){return e.setState({hasTooltip:!1})},className:E()("ct-extra-pop-wrapper",{disabled:n,"ct-toolbar-is-open":this.state.isOpen})},i.a.createElement(Se.a,{content:i.a.createElement(So,{select:this.onSelect,visible:this.state.isOpen}),popupAlign:{offset:[-12,8]},trigger:"click",visible:this.state.isOpen,onVisibleChange:this.handleVisibleChange,overlayClassName:"ct-extra-popover-layer"},i.a.createElement(Je,null)),this.state.hasTooltip&&i.a.createElement("div",{className:"ct-toolbar-tooltip",style:{width:"70px"}},"\u63d2\u5165\u5176\u4ed6"))}}]),t}())||lo)||lo;n("../client/src/editor/components/Toolbar/TableModelPopover/style.styl");function Po(e){return(Po="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ko(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Co(e,t,n){return t&&xo(e.prototype,t),n&&xo(e,n),e}function To(e,t){return!t||"object"!==Po(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Io(e){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ao(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Do(e,t)}function Do(e,t){return(Do=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var No=function(e){function t(){return ko(this,t),To(this,Io(t).apply(this,arguments))}return Ao(t,a["Component"]),Co(t,[{key:"componentDidMount",value:function(){var e=this.props.onGlobalClick;document.addEventListener("click",e)}},{key:"componentWillUnmount",value:function(){var e=this.props.onGlobalClick;document.removeEventListener("click",e)}},{key:"render",value:function(){var e=this.props,t=e.setResponsive,n=e.setFixed;return i.a.createElement("div",{className:"ct-extra-popover"},i.a.createElement("div",{"data-action":"tableFixed",className:"ct-extra-popover-item",onClick:n},i.a.createElement("span",null,"\u56fa\u5b9a\u5bbd\u5ea6")),i.a.createElement("div",{"data-action":"tableResponsive",className:"ct-extra-popover-item",onClick:t},i.a.createElement("span",null,"\u81ea\u9002\u5e94")))}}]),t}(),Mo=Object(l.inject)("store")(Oo=Object(l.observer)(Oo=function(e){function t(){var e,n;ko(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=To(this,(e=Io(t)).call.apply(e,[this].concat(o)))).state={isOpen:!1},n.onGlobalClick=function(){n.setState({isOpen:!1})},n.handleClick=function(){var e=n.props.store.view,t=n.state.isOpen;e.focus(),n.setState({isOpen:!t})},n}return Ao(t,a["Component"]),Co(t,[{key:"render",value:function(){var e=this.props,t=e.isResponsive,n=e.setResponsive,r=e.setFixed,o=this.state.isOpen;return i.a.createElement("div",{onClick:this.handleClick,className:E()("ct-p-extra-pop-wrapper","ct-table-model-pop-wrapper-web",{"ct-table-model-pop-wrapper-open":o})},t()?"\u81ea\u9002\u5e94":"\u56fa\u5b9a\u5bbd\u5ea6",i.a.createElement(D.a,null),o&&i.a.createElement(No,{setResponsive:n,setFixed:r,onGlobalClick:this.onGlobalClick}))}}]),t}())||Oo)||Oo;n("../client/src/editor/components/Toolbar/TableStylePopover/style.styl");function _o(e){return(_o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lo(){return(Lo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ro(e,t){return!t||"object"!==_o(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vo(e){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ho(e,t){return(Ho=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zo,Wo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ro(this,Vo(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ho(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Lo({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("path",{d:"M429.7 647.15L756.84 320l45.25 45.25-357.31 357.33a21.33 21.33 0 0 1-30.17 0L213.33 521.26 258.58 476l171.12 171.1z"}))}}])&&Bo(n.prototype,r),o&&Bo(n,o),t}(),Fo=n("../client/src/editor/assets/svg/tableAttrs.svg"),Uo=n("../client/src/assets/svg/arrow-down.svg");function Ko(e){return(Ko="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qo(e,t,n){return t&&Go(e.prototype,t),n&&Go(e,n),e}function Xo(e,t){return!t||"object"!==Ko(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yo(e){return(Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jo(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zo(e,t)}function Zo(e,t){return(Zo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $o,ea={borderStyle:[{style:{borderStyle:"dashed"},render:function(e){return i.a.createElement("div",{style:{borderTopWidth:"".concat(e.boderWidth,"px"),borderTopColor:"".concat(e.borderColor),borderTopStyle:"dashed"}})}},{style:{borderStyle:"solid"},render:function(e){return i.a.createElement("div",{style:{borderTopWidth:"".concat(e.boderWidth,"px"),borderTopColor:"".concat(e.borderColor)}})}}],borderWidth:[{style:{borderWidth:"0"},render:function(e){return i.a.createElement("div",{style:{borderWidth:"0px",boxShadow:"none"}},"\u65e0\u8fb9\u6846 ")}},{style:{borderWidth:"1"},render:function(e){return i.a.createElement("div",{style:{borderWidth:"1px",borderColor:e.borderColor}})}},{style:{borderWidth:"2"},render:function(e){return i.a.createElement("div",{style:{borderWidth:"2px",borderColor:e.borderColor}})}},{style:{borderWidth:"3"},render:function(e){return i.a.createElement("div",{style:{borderWidth:"3px",borderColor:e.borderColor}})}},{style:{borderWidth:"4"},render:function(e){return i.a.createElement("div",{style:{borderWidth:"4px",borderColor:e.borderColor}})}}]},ta=function(e){function t(){return qo(this,t),Xo(this,Yo(t).apply(this,arguments))}return Jo(t,a["Component"]),Qo(t,[{key:"buildItems",value:function(e,t){var n=this;return ea[e].map(function(r,o){return i.a.createElement("div",{className:E()("ct-extra-table-popover-item",{"ct-popover-white-bg":"#fff"===t.borderColor}),onClick:function(e){e.stopPropagation(),n.props.select(r.style)},key:"tablePopover"+o},r.render(t)," ",t[e]===r.style[e]?i.a.createElement(Wo,null):"")})}},{key:"render",value:function(){var e=this,t=this.props.tableAttrs||{};return i.a.createElement("div",{className:"ct-extra-table-style-popover"},i.a.createElement("p",{className:"ct-extra-table-popover-title"},"\u8fb9\u6846\u7c7b\u578b"),this.buildItems("borderStyle",t),i.a.createElement("div",{className:"ct-extra-table-popover-splice-line"}),i.a.createElement("p",{className:"ct-extra-table-popover-title"},"\u8fb9\u6846\u5c3a\u5bf8"),this.buildItems("borderWidth",t),i.a.createElement("div",{className:"ct-extra-table-popover-splice-line",style:{marginBottom:"0"}}),i.a.createElement("div",{className:"ct-extra-table-popover-title",id:"color-border-setting",onClick:function(e){e.stopPropagation()}},i.a.createElement("span",null,"\u8fb9\u6846\u989c\u8272"),i.a.createElement("div",{className:"ct-color-popover-inner"},i.a.createElement(Y.a,{type:"border",setColor:function(t){e.props.select({borderColor:t})},setDefaultColor:function(){e.props.select({borderColor:"#ddd"})},disabledHandler:function(){return!1},selected:t.borderColor,setSelected:function(t){return e.setState({borderColor:t})}},i.a.createElement("div",{className:"color-popover-inner"},i.a.createElement("span",{className:"ct-color-popover-block",style:{background:t.borderColor||"#333"}}),i.a.createElement(Uo.a,null))))))}}]),t}(),na=Object(l.inject)("store")(zo=Object(l.observer)(zo=function(e){function t(){var e,n;qo(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Xo(this,(e=Yo(t)).call.apply(e,[this].concat(o)))).state={hasTooltip:!1,isOpen:!1},n.onSelect=function(e){n.props.setBorderStyle(e)},n.handleClick=function(){n.props.store.view.focus(),n.setState({hasTooltip:!1,isOpen:!n.state.isOpen})},n.handleMouseEnter=function(){n.state.isOpen||n.setState({hasTooltip:!0})},n.handleVisibleChange=function(){n.setState({isOpen:!n.state.isOpen})},n}return Jo(t,a["Component"]),Qo(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.disabledHandler,r=(0,t.selectedTableAttrs)(),o=n&&n();return i.a.createElement("div",{onMouseEnter:o?null:this.handleMouseEnter,onMouseLeave:function(){return e.setState({hasTooltip:!1})},className:E()("ct-toolbar-icon-wrapper",{disabled:o,"ct-toolbar-is-open":this.state.isOpen})},i.a.createElement(Se.a,{content:i.a.createElement(ta,{select:this.onSelect,tableAttrs:r}),popupAlign:{offset:[60,5]},trigger:"click",visible:this.state.isOpen,onVisibleChange:this.handleVisibleChange,overlayClassName:"ct-table-style-popover-layer"},i.a.createElement("div",{className:"ct-toolbar-icon-item ct-table-style-popover"},i.a.createElement(Fo.a,null),i.a.createElement(D.a,{className:"tool-arrow-down"}))),this.state.hasTooltip&&i.a.createElement("div",{className:"ct-toolbar-tooltip",style:{width:"70px"}},"\u8868\u683c\u5c5e\u6027"))}}]),t}())||zo)||zo;n("../client/src/editor/components/Toolbar/FontsizePopover/style.styl");function ra(e){return(ra="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aa(e,t){return!t||"object"!==ra(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ia(e){return(ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ca(e,t){return(ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sa,la=[{type:"12",text:"9",keymap:"0"},{type:"13",text:"10",keymap:"1"},{type:"14",text:"11",keymap:"2"},{type:"16",text:"12",keymap:"3"},{type:"19",text:"14",keymap:"4"},{type:"22",text:"16",keymap:"5"},{type:"24",text:"18",keymap:"6"},{type:"29",text:"22",keymap:"7"},{type:"32",text:"24",keymap:"8"},{type:"40",text:"30",keymap:"9"},{type:"48",text:"36",keymap:"10"}],ua=Object(l.inject)("store")($o=Object(l.observer)($o=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=aa(this,(e=ia(t)).call.apply(e,[this].concat(o)))).onSelect=function(e){var t=n.props.store.core,r=t.basicCommands,o=t.view,a=o.state,i=a.selection,c=a.doc;if(r.setFontsize(e),i.isRowSelection){var s=i.$headCell;if(c.nodeAt(s.pos).attrs.numCell)return}o.focus()},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ca(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.store,n=(t.count,t.state),r=t.core.basicUtils;if(!r)return null;var o,a=r.getTextFontsize(n),c=null===(o=a)?{text:"11"}:" - "===o?{text:" - "}:28===o?{text:21}:20===o?{text:15}:la.filter(function(e){return e.type===o.toString()})[0],s=!r||!r.canSetFontsize(n)||!c;return i.a.createElement("div",{className:"font-size-popover"},i.a.createElement(V,{selected:c.text,disabled:s,tooltip:"\u5b57\u4f53\u5927\u5c0f"},la.map(function(t,n){return i.a.createElement("div",{key:"".concat(t.text,"-").concat(n),className:"fs-dp-item",onClick:function(){return e.onSelect(t.type)}},t.text)})))}}])&&oa(n.prototype,r),o&&oa(n,o),t}())||$o)||$o,pa=n("../client/src/editor/assets/svg/alignLeft.svg"),fa=n("../client/src/editor/assets/svg/alignRight.svg"),da=n("../client/src/editor/assets/svg/alignCenter.svg");function ma(e){return(ma="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ha(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ya(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ba(e,t,n){return t&&ya(e.prototype,t),n&&ya(e,n),e}function va(e,t){return!t||"object"!==ma(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ga(e){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wa(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ja(e,t)}function ja(e,t){return(ja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oa,Sa=function(e){function t(){return ha(this,t),va(this,ga(t).apply(this,arguments))}return wa(t,a["Component"]),ba(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.props.onGlobalClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.props.onGlobalClick)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"ct-extra-popover  ct-extra-popover-pro"},i.a.createElement("div",{className:"ct-extra-popover-item",onClick:function(){return e.props.select("left")}},i.a.createElement(pa.a,null),i.a.createElement("span",null,"\u5de6\u5bf9\u9f50")),i.a.createElement("div",{className:"ct-extra-popover-item",onClick:function(){return e.props.select("center")}},i.a.createElement(da.a,null),i.a.createElement("span",null,"\u5c45\u4e2d")),i.a.createElement("div",{className:"ct-extra-popover-item",onClick:function(){return e.props.select("right")}},i.a.createElement(fa.a,null),i.a.createElement("span",null,"\u53f3\u5bf9\u9f50")))}}]),t}(),Ea=Object(l.inject)("store")(sa=Object(l.observer)(sa=function(e){function t(){var e,n;ha(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=va(this,(e=ga(t)).call.apply(e,[this].concat(o)))).state={hasTooltip:!1,isOpen:!1},n.onSelect=function(e){({left:n.props.setAlignLeft,right:n.props.setAlignRight,center:n.props.setAlignCenter})[e](),n.onGlobalClick()},n.onGlobalClick=function(){n.setState({isOpen:!1,hasTooltip:!1})},n.handleClick=function(){n.props.store.view.focus(),n.setState({hasTooltip:!1,isOpen:!n.state.isOpen})},n.handleMouseEnter=function(){n.state.isOpen||n.setState({hasTooltip:!0})},n}return wa(t,a["Component"]),ba(t,[{key:"render",value:function(){var e=this,t=this.props.disabledHandler,n=t&&t();return i.a.createElement("div",{onClick:n?null:this.handleClick,onMouseEnter:n?null:this.handleMouseEnter,onMouseLeave:function(){return e.setState({hasTooltip:!1})},className:E()("ct-toolbar-icon-wrapper",{disabled:n,"ct-toolbar-is-open":this.state.isOpen})},i.a.createElement(pa.a,null),i.a.createElement(D.a,{className:"tool-arrow-down"}),this.state.isOpen&&i.a.createElement(Sa,{select:this.onSelect,onGlobalClick:this.onGlobalClick}),this.state.hasTooltip&&i.a.createElement("div",{className:"ct-toolbar-tooltip",style:{width:"70px"}},"\u5de6\u53f3\u5bf9\u9f50"))}}]),t}())||sa)||sa;function Pa(e){return(Pa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ka(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ca(e,t,n){return t&&xa(e.prototype,t),n&&xa(e,n),e}function Ta(e,t){return!t||"object"!==Pa(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ia(e){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Aa(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Da(e,t)}function Da(e,t){return(Da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Na,Ma=function(e){function t(){return ka(this,t),Ta(this,Ia(t).apply(this,arguments))}return Aa(t,a["Component"]),Ca(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.props.onGlobalClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.props.onGlobalClick)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"ct-extra-popover ct-extra-popover-pro"},i.a.createElement("div",{"data-action":"sup",className:"ct-extra-popover-item",onClick:function(){return e.props.select("alignTop")}},A.a.alignTop,i.a.createElement("span",null,"\u9876\u90e8\u5bf9\u9f50")),i.a.createElement("div",{"data-action":"sub",className:"ct-extra-popover-item",onClick:function(){return e.props.select("alignMiddle")}},A.a.alignMiddle,i.a.createElement("span",null,"\u5c45\u4e2d\u5bf9\u9f50")),i.a.createElement("div",{"data-action":"sub",className:"ct-extra-popover-item",onClick:function(){return e.props.select("alignBottom")}},A.a.alignBottom,i.a.createElement("span",null,"\u5e95\u90e8\u5bf9\u9f50")))}}]),t}(),_a=Object(l.inject)("store")(Oa=Object(l.observer)(Oa=function(e){function t(){var e,n;ka(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Ta(this,(e=Ia(t)).call.apply(e,[this].concat(o)))).state={hasTooltip:!1,isOpen:!1},n.onSelect=function(e){({alignTop:n.props.setAlignTop,alignMiddle:n.props.setAlignMiddle,alignBottom:n.props.setAlignBottom})[e](),n.onGlobalClick()},n.onGlobalClick=function(){n.setState({isOpen:!1,hasTooltip:!1})},n.handleClick=function(){n.props.store.view.focus(),n.setState({hasTooltip:!1,isOpen:!n.state.isOpen})},n.handleMouseEnter=function(){n.state.isOpen||n.setState({hasTooltip:!0})},n}return Aa(t,a["Component"]),Ca(t,[{key:"render",value:function(){var e=this,t=this.props.disabledHandler,n=t&&t();return i.a.createElement("div",{onClick:n?null:this.handleClick,onMouseEnter:n?null:this.handleMouseEnter,onMouseLeave:function(){return e.setState({hasTooltip:!1})},className:E()("ct-toolbar-icon-wrapper",n,{"ct-toolbar-is-open":this.state.isOpen})},A.a.alignMiddle,i.a.createElement(D.a,{className:"tool-arrow-down"}),this.state.isOpen&&i.a.createElement(Ma,{select:this.onSelect,onGlobalClick:this.onGlobalClick}),this.state.hasTooltip&&i.a.createElement("div",{className:"ct-toolbar-tooltip",style:{width:"70px"}},"\u4e0a\u4e0b\u5bf9\u9f50"))}}]),t}())||Oa)||Oa;n("../client/src/editor/components/Toolbar/style.styl");function La(e){return(La="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ba(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ra(e,t){return!t||"object"!==La(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Va(e){return(Va=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ha(e,t){return(Ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var za=function(){},Wa=Object(l.inject)("store","rowNumExtension","ctStore")(Na=Object(l.observer)(Na=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ra(this,Va(t).call(this))).tablePopover=null,e.checkTableToolbarDisposer=null,e.state={hasCoverPage:!1},e.checkTableToolbarAutoruner=function(){var t=e.props.store,n=t.config,r=t.count,o=t.core.tableStore;za(r);var a=document.getElementById(n.pageWrapperId);a&&(o&&o.isShowPopover?a.classList.add("hasTableToolbar"):a.classList.remove("hasTableToolbar"))},e.handlePageScroll=function(t){var n=e.state.hasCoverPage,r=t.target.scrollTop;r>5&&!n?e.setState({hasCoverPage:!0}):r<=5&&n&&e.setState({hasCoverPage:!1})},e.handlePageScrollThrottle=k()(e.handlePageScroll,150),e.guideContainer=document.createElement("div"),e.guideContainer.classList.add("ct-quick-toolbar-guide"),document.body.appendChild(e.guideContainer),e}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ha(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.store,t=document.getElementById(e.config.pageWrapperId);t&&t.addEventListener("scroll",this.handlePageScrollThrottle),this.checkTableToolbarDisposer=Object(O.autorun)(this.checkTableToolbarAutoruner)}},{key:"componentWillUnmount",value:function(){var e=this.props.store,t=document.getElementById(e.config.pageWrapperId);t&&t.removeEventListener("scroll",this.handlePageScrollThrottle),this.checkTableToolbarDisposer&&this.checkTableToolbarDisposer(),t&&t.classList.remove("hasTableToolbar"),document.body.removeChild(this.guideContainer)}},{key:"renderToolbarGuide",value:function(){var e=this.props.store.core,t=e.view,n=e.keymapDocStore;return Object(c.createPortal)(i.a.createElement(I.a,{tooltip:"\u5feb\u6377\u952e",activeHandler:function(){return n&&n.isShow},onClick:function(e){if(e.nativeEvent.stopImmediatePropagation(),e.stopPropagation(),t.focus(),!e.target.transform)return!1;n.toggleShow()},type:"quick-guide"},i.a.createElement(T.a,{content:"\u7f16\u8f91\u6587\u6863\u65f6\uff0c\u6709\u5927\u91cf\u5feb\u6377\u952e\u4f9b\u4f7f\u7528",placement:"bottomRight",className:"ct-guide-keymap-tooltip",arrowPointAtCenter:!0,localStorageKey:"guide-page-keymap",onClose:function(){return t.focus()}},A.a.help)),this.guideContainer)}},{key:"render",value:function(){var e=this,t=this.state.hasCoverPage,n=this.props,r=n.store,o=n.ctStore,a=n.menuTop,c=n.rowNumExtension,s=c.toggleRowNumStatus,l=c.rowNumStatus,u=o.doc.page.docType,p=r.count,f=r.marks,d=r.nodes,y=r.state,b=r.dispatch,v=r.config,g=r.core,w=g.view,j=g.basicUtils,O=g.historyUtils,S=g.listUtils,P=g.linkUtils,k=g.linkStore,T=g.imageStore,A=g.attachmentStore,D=g.calendarStore,N=g.basicCommands,M=g.historyCommands,_=g.listCommands,L=g.codeCommands,B=g.codeUtils,R=g.statusCommands,V=g.collapseCommands,H=g.noteCommands,z=g.quoteCommands,W=g.tableCommands,F=g.audioStore,U=g.videoStore,K=g.catalogCommands,q=g.mentionStore,G=g.drawioStore,Q=g.data2chartStore,J=g.minderStore,Z=g.ganttStore,$=(g.keymapDocStore,g.tableUtils),ee=g.tableStore,te=g.htmlStore,ne=g.spaceUpdateStore,re=g.plantumlStore,oe=g.pageTreeStore,ae=g.timeStore;za(p);var ie=h.g,ce=d.ordered_list,se=d.bullet_list,le=d.task_list,ue=(d.list_item,d.task_item,function(e){_&&(S.judgeListType(y,e)?_.unwrapList():S.isInList(y)?_.transformList(e):_.wrapInList(e),w.focus())}),pe=$?$.hasTableHeader(y):{},fe=pe.hasRowHeader,de=pe.hasColHeader,me=pe.headerCol,he=pe.hasNumCol,ye=pe.tableNode,be=pe.startPos,ve=B&&B.isInCode(y),ge=j&&j.isInHeading(y);return i.a.createElement("div",{className:E()("ct-toolbar",{hasCoverPage:t}),style:{top:a}},i.a.createElement("div",{className:"ct-toolbar-wrapper"},i.a.createElement("div",{className:"ct-toolbar-container"},i.a.createElement("div",{className:"ct-toolbar-primary"},i.a.createElement(I.a,{action:"undo",tooltip:"\u64a4\u9500 (".concat(ie,"-Z)"),onClick:function(){return M.undo()},disabledHandler:function(){return!O||0===O.undoDepth(y)}}),i.a.createElement(I.a,{action:"redo",tooltip:"\u91cd\u505a (".concat(ie,"-\u21e7-Z)"),onClick:function(){return M.redo()},disabledHandler:function(){return!O||0===O.redoDepth(y)}}),i.a.createElement(I.a,{action:"clear_format",tooltip:"\u6e05\u9664\u683c\u5f0f",disabledHandler:function(){return ve||N&&!j.isTextBlock(y)},onClick:function(){return N.clearFormat()}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(X,{meta:ie}),i.a.createElement(ua,{meta:ie}),i.a.createElement(I.a,{action:"bold",tooltip:"\u7c97\u4f53 (".concat(ie,"-B)"),activeHandler:function(){return j&&(j.hasMark(y,f.strong)||j.isInHeading(y))},disabledHandler:function(){return ve||ge},onClick:function(){return N.toggleMark(f.strong)}}),i.a.createElement(I.a,{action:"italic",tooltip:"\u659c\u4f53 (".concat(ie,"-I)"),activeHandler:function(){return j&&j.hasMark(y,f.em)},disabledHandler:function(){return ve},onClick:function(){return N.toggleMark(f.em)}}),i.a.createElement(I.a,{action:"strikethrough",tooltip:"\u4e2d\u5212\u7ebf (".concat(ie,"-\u21e7-S)"),activeHandler:function(){return j&&j.hasMark(y,f.strikethrough)},disabledHandler:function(){return ve},onClick:function(){return N.toggleMark(f.strikethrough)}}),i.a.createElement(I.a,{action:"underline",tooltip:"\u4e0b\u5212\u7ebf (".concat(ie,"-U)"),activeHandler:function(){return j&&j.hasMark(y,f.underline)},disabledHandler:function(){return ve},onClick:function(){return N.toggleMark(f.underline)}}),i.a.createElement(Y.a,{type:"font",setColor:function(e){return N.setTextColor(e)},setDefaultColor:function(){return N.setTextDefaultColor()},disabledHandler:function(){return ve}}),i.a.createElement(je,{onInsertSup:function(){return N.toggleSuMark(f.sup)},onInsertSub:function(){return N.toggleSuMark(f.sub)},disabledHandler:function(){return ve}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(Ea,{setAlignLeft:function(){return N.setAlign("left")},setAlignRight:function(){return N.setAlign("right")},setAlignCenter:function(){return N.setAlign("center")},disabledHandler:function(){return!N||!j.canAlign(y,w)},activeHandler:function(){return j&&j.isAlignedBlock(y,w,"center")}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(I.a,{action:"ul_list",tooltip:"\u65e0\u5e8f\u5217\u8868 (".concat(ie,"-\u21e7-U)"),disabledHandler:function(){return y&&!Object(x.e)(y)},activeHandler:function(){return S&&S.judgeListType(y,se)},onClick:function(){ue(se)}}),i.a.createElement(I.a,{action:"ol_list",tooltip:"\u6709\u5e8f\u5217\u8868  (".concat(ie,"-\u21e7-O)"),disabledHandler:function(){return y&&!Object(x.e)(y)},activeHandler:function(){return S&&S.judgeListType(y,ce)},onClick:function(){ue(ce)}}),i.a.createElement(I.a,{action:"task_list",tooltip:"\u4efb\u52a1\u5217\u8868",disabledHandler:function(){return y&&!Object(x.e)(y)},activeHandler:function(){return S&&S.judgeListType(y,le)},onClick:function(){ue(le)}}),i.a.createElement(I.a,{action:"indent_less",tooltip:"\u51cf\u5c11\u7f29\u8fdb",disabledHandler:function(){return!j||!S.isInList(w.state)&&(!$.canIndent(w.state,"less")&&!j.canIndent(w.state,"less"))},onClick:function(){_.liftListItem()||W.reduceIndent()||N.setIndent("less"),w.focus()}}),i.a.createElement(I.a,{action:"indent_more",tooltip:"\u589e\u52a0\u7f29\u8fdb",disabledHandler:function(){return!j||!S.isInList(w.state)&&(!$.canIndent(w.state,"more")&&!j.canIndent(w.state,"more"))},onClick:function(){_.sinkListItem()||W.increaseIndent()||N.setIndent("more"),w.focus()}}),!!u&&i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(I.a,{onClick:s,activeHandler:function(){return l},visible:!!u,tooltip:"\u6bb5\u843d\u53f7"},"\u6bb5\u843d\u53f7"),!!u&&i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(Ue,{store:r}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(I.a,{action:"image",tooltip:"\u56fe\u7247",disabledHandler:function(){return y&&!Object(x.e)(y)},onClick:function(){var e=document.createElement("input");e.accept="image/*",e.multiple=!0,e.addEventListener("change",function(t){t.target.files.length>9?m.a.error("\u6587\u4ef6\u6570\u4e0d\u5f97\u8d85\u8fc79\u4e2a"):T.insertFiles(t.target.files),e.remove()}),e.type="file",e.click()}}),i.a.createElement(I.a,{action:"link",tooltip:"\u94fe\u63a5  (".concat(ie,"-K)"),activeHandler:function(){return P&&P.hasLink(y)},disabledHandler:function(){return y&&!Object(x.e)(y)},onClick:function(){var e=P.getLinkAttrs(y,b);e&&k.openModal(e,0)}}),i.a.createElement(I.a,{action:"code_block",tooltip:"\u4ee3\u7801\u5757",onClick:function(){return L.insert()}}),i.a.createElement(Eo,{handler:{quote:function(){return z.toggle(y)},catalog:function(){return K.insert()},mention:function(){return q.insertMention()},spaceUpdate:function(){return ne.create()},drawio:function(){return G.create()},data2chart:function(){return Q.create()},minder:function(){return J.create()},calendar:function(){return D.insert()},gantt:function(){return Z.create()},plantuml:function(){return re.create()},status:function(){return R.insert()},hr:function(){return N.insertHr()},collapse:function(){return V.insert()},note:function(){return function(e){return H.insert(e)}},html:function(){return te.create(w.state.schema.nodes.html,"html")},markdown:function(){return te.create(w.state.schema.nodes.markdown,"markdown")},latexBlock:function(){return te.create(w.state.schema.nodes.latex_block,"latex")},latexInline:function(){return te.create(w.state.schema.nodes.latex_inline,"latex_inline")},pageTree:function(){return oe.showModal()},code_block:function(){return L.insert()},time:function(){return ae.insertTime()},link:function(){var e=P.getLinkAttrs(y,b);e&&k.openModal(e,0)},attachment:function(){var e=document.createElement("input");e.multiple=!0,e.addEventListener("change",function(t){t.target.files.length>9?m.a.error("\u6587\u4ef6\u6570\u4e0d\u5f97\u8d85\u8fc79\u4e2a"):A.insertFiles(t.target.files),e.remove()}),e.type="file",e.click()},video:function(){e.uploadVideoRef.input.dispatchEvent(new MouseEvent("click"))},audio:function(){e.uploadAudioRef.input.dispatchEvent(new MouseEvent("click"))},image:function(){var e=document.createElement("input");e.multiple=!0,e.accept="image/*",e.multiple=!0,e.addEventListener("change",function(t){t.target.files.length>9?m.a.error("\u6587\u4ef6\u6570\u4e0d\u5f97\u8d85\u8fc79\u4e2a"):T.insertFiles(t.target.files),e.remove()}),e.type="file",e.click()}},disabledHandler:function(){return ve}})),this.renderToolbarGuide())),i.a.createElement("div",{className:"ct-toolbar-wrapper"},i.a.createElement("div",{className:"ct-toolbar-container"},i.a.createElement("div",{className:"ct-toolbar-secondary"},i.a.createElement(I.a,{action:"addRowBefore",tooltip:"\u4e0a\u65b9\u63d2\u5165\u884c",onClick:function(){return W.addRowBefore()},disabledHandler:function(){return $&&!$.canAddRowBefore(y)}}),i.a.createElement(I.a,{action:"addRowAfter",tooltip:"\u4e0b\u65b9\u63d2\u5165\u884c",onClick:function(){return W.addRowAfter()}}),i.a.createElement(I.a,{action:"deleteRow",tooltip:"\u5220\u9664\u884c",onClick:function(){return W.deleteRow()}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(I.a,{action:"addColumnBefore",tooltip:"\u5de6\u4fa7\u63d2\u5165\u5217",onClick:function(){return W.addColumnBefore()},disabledHandler:function(){return $&&!$.canAddColumnBefore(y)}}),i.a.createElement(I.a,{action:"addColumnAfter",tooltip:"\u53f3\u4fa7\u63d2\u5165\u5217",onClick:function(){return W.addColumnAfter()},disabledHandler:function(){return $&&!$.canAddColumnAfter(y)}}),i.a.createElement(I.a,{action:"deleteColumn",tooltip:"\u5220\u9664\u5217",onClick:function(){return W.deleteColumn()}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(I.a,{action:"mergeCells",tooltip:"\u5408\u5e76\u5355\u5143\u683c",onClick:function(){return W.mergeCells()},disabledHandler:function(){return $&&!$.canMergeCells(y)}}),i.a.createElement(I.a,{action:"splitCell",tooltip:"\u62c6\u5206\u5355\u5143\u683c",onClick:function(){return W.splitCell()},disabledHandler:function(){return $&&!$.canSplitCell(y)}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(_a,{setAlignTop:function(){return W.setPosition("top")},setAlignMiddle:function(){return W.setPosition("middle")},setAlignBottom:function(){return W.setPosition("bottom")}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(I.a,{action:"tableRow",tooltip:fe?"\u53d6\u6d88\u8868\u5934\u884c":"\u8bbe\u7f6e\u8868\u5934\u884c",onClick:function(){return W.toggleRowHeader(fe,me,he,ye,be)}}),i.a.createElement(I.a,{action:"tableCol",tooltip:de?"\u53d6\u6d88\u8868\u5934\u5217":"\u8bbe\u7f6e\u8868\u5934\u5217",onClick:function(){return W.toggleColHeader(de,fe,he,ye,be)},disabledHandler:function(){return fe&&1===ye.content.content.length}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(Y.a,{disabledHandler:function(){return!1},selected:ee&&ee.selected,setSelected:function(e){ee.selected=e},type:"bg",setColor:function(e){return W.setBgColor(e)},setDefaultColor:function(){return W.setBgDefaultColor()}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(na,{setBorderStyle:function(e){return W.setTableAttrsCommand(e)},selectedTableAttrs:function(){return $&&$.getTableAttrs(y)}}),i.a.createElement(I.a,{action:"deleteTable",tooltip:"\u5220\u9664\u8868\u683c",onClick:function(){return W.deleteTable()}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement(Mo,{isResponsive:function(){return $&&!$.isResponsive(y)},setResponsive:function(){return W.setResponsive()},setFixed:function(){return W.setFixed()}}),i.a.createElement("div",{className:"ct-toolbar-split"}),i.a.createElement("div",{className:E()("ct-toolbar-numcol",{"ct-toolbar-numcol-selected":he}),onClick:function(){return W.toggleNumCol(he,fe,ye,be)}},"\u663e\u793a\u8868\u683c\u884c\u53f7\u5217")))),i.a.createElement(C.a,{multiple:!0,accept:"image/*",limitSize:50,ref:function(t){e.uploadImageRef=t},uploadUrl:v.url.image,beforeUpload:function(e){return T.beforeUpload(e)},onProgress:function(e,t){return T.onProgress(e,t)},finishUpload:function(e){return T.finishUpload(e)},errorHandle:function(e,t){return T.errorHandle(e,t)}},i.a.createElement("div",{hidden:!0})),i.a.createElement(C.a,{multiple:!0,limitSize:100,ref:function(t){e.uploadAttachmentRef=t},uploadUrl:v.url.file,beforeUpload:function(e){return A.beforeUpload(e)},onProgress:function(e,t){return A.onProgress(e,t)},finishUpload:function(e){return A.finishUpload(e)},errorHandle:function(e,t){return A.errorHandle(e,t)}},i.a.createElement("div",{hidden:!0})),i.a.createElement(C.a,{multiple:!0,suffixes:["mp3","wma","m4a","acc","amr"],limitSize:1024,ref:function(t){e.uploadAudioRef=t},uploadUrl:v.url.media,beforeUpload:function(e){return F.beforeUpload(e)},onProgress:function(e,t){return F.onProgress(e,t)},finishUpload:function(e){return F.finishUpload(e)},errorHandle:function(e,t){return F.errorHandle(e,t)}},i.a.createElement("div",{hidden:!0})),i.a.createElement(C.a,{multiple:!0,suffixes:["3gp","afs","avi","dat","dv","flv","f4v","m2t","m3u8","m4v","mj2","mjpeg","mkv","mov","mp4","mp4v","m4v","mpe","mpg","mpeg","mts","ogg","qt","rm","rmvb","swf","ts","vob","wmv","webm","wm","asx","ra","ram"],limitSize:1024,ref:function(t){e.uploadVideoRef=t},uploadUrl:v.url.media,beforeUpload:function(e){return U.beforeUpload(e)},onProgress:function(e,t){return U.onProgress(e,t)},finishUpload:function(e){return U.finishUpload(e)},errorHandle:function(e,t){return U.errorHandle(e,t)}},i.a.createElement("div",{hidden:!0})))}}])&&Ba(n.prototype,r),o&&Ba(n,o),t}())||Na)||Na;Wa.defaultProps={menuTop:0};var Fa=n("../client/src/editor/components/Editor/utils.js"),Ua=n("./prosemirror-state/dist/index.js"),Ka=n("../client/src/utils/request.js");var qa=n("./@mtfe/citadel-editor/es/attachment/index.js"),Ga=n("./@mtfe/citadel-editor/es/catalog/index.js"),Qa=n("./@mtfe/citadel-editor/es/drawio/index.js"),Xa=n("./@mtfe/citadel-editor/es/html/index.js"),Ya=n("./@mtfe/citadel-editor/es/mention/index.js"),Ja=n("./@mtfe/citadel-editor/es/minder/index.js"),Za=n("./@mtfe/citadel-editor/es/wash/index.js"),$a=n("./@mtfe/citadel-editor/es/shortcut/index.js"),ei=n("./@mtfe/citadel-editor/es/plantuml/index.js"),ti=n("../client/src/editor/modules/anchor/index.js"),ni=(n("./core-js/modules/es6.string.iterator.js"),n("./core-js/modules/es6.array.from.js"),n("./core-js/modules/es6.function.name.js"),n("./core-js/modules/es7.array.includes.js"),n("./core-js/modules/es6.string.includes.js"),{nodes:{audio:{group:"block",atom:!0,draggable:!0,dragBlock:!0,insertBlock:!0,alignBlock:!0,allowGapCursor:!0,braceWidth:540,attrs:{url:{default:""},size:{default:""},name:{default:""},align:{default:"left"},dataDiffId:{default:null}},parseDOM:[{tag:'div[class~="ct-audio"]',getAttrs:function(e){var t="left";return e.className.includes("center")?t="center":e.className.includes("right")&&(t="right"),{url:e.getAttribute("data-url"),name:e.getAttribute("data-name"),size:e.getAttribute("data-size"),align:t,dataDiffId:e.getAttribute("data-diff-id")}}}],toDOM:function(e){var t=e.attrs,n=t.url,r=t.name,o=t.size,a=t.align,i={class:"ct-audio","data-url":n,"data-name":r,"data-size":o,contenteditable:!1,"data-diff-id":t.dataDiffId||"ct-diff-id-".concat(Object(x.J)())};"center"===a?i.class+=" align-center":"right"===a&&(i.class+=" align-right");return["div",i,["audio",{controls:!1,preload:"meta"},"\u672c\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 HTML5 audio \u6807\u7b7e"]]}}}}),ri=(n("./core-js/modules/es6.regexp.split.js"),n("./uuid/index.js")),oi=n.n(ri),ai=n("../client/src/editor/utils/index.js");function ii(e){return(ii="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ci(){return(ci=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function si(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function li(e,t){return!t||"object"!==ii(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ui(e){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pi(e,t){return(pi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fi=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),li(this,ui(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pi(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",ci({width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},this.props),i.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},i.a.createElement("g",{id:"V1.2_Icon\\u6C47\\u603B",transform:"translate(-70 -386)"},i.a.createElement("g",{id:"\\u97F3\\u9891",transform:"translate(70 386)"},i.a.createElement("path",{d:"M12.74 2.04l-5.7 1.6c-.7.18-1.25.83-1.25 1.46v5.47s-.42-.25-1.34-.13C3.1 10.62 2 11.56 2 12.54c0 1 1.1 1.6 2.45 1.43 1.36-.18 2.34-1.09 2.34-2.08V6.61c0-.44.59-.63.59-.63l5.04-1.44s.56-.17.56.3V9.2s-.5-.27-1.43-.17c-1.36.15-2.45 1.08-2.45 2.07 0 .99 1.1 1.61 2.45 1.47C12.9 12.4 14 11.49 14 10.5V2.85c0-.62-.57-.98-1.26-.8z",id:"Shape",fill:"#666",fillRule:"nonzero"})))))}}])&&si(n.prototype,r),o&&si(n,o),t}(),di=n("../client/src/editor/assets/svg/error.svg");n("../client/src/editor/modules/audio/ProgressBar/style.styl");function mi(e){return(mi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yi(e,t){return!t||"object"!==mi(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bi(e){return(bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vi(e,t){return(vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gi=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yi(this,bi(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vi(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.data,n=e.reupload,r=t.name,o=void 0===r?"\u672a\u547d\u540d":r,a=t.total,c=t.loaded,s=t.size,l=t.done,u=a?"".concat((c/a*100).toFixed(2),"%"):"0%",p=c===a;return i.a.createElement("div",{className:"ct-upload-audio"},i.a.createElement("div",{className:"audio-icon"},i.a.createElement(fi,null)),i.a.createElement("div",{className:"right"},i.a.createElement("div",{className:"top"},i.a.createElement("span",{className:"name"},o)),!n&&i.a.createElement("div",{className:"bottom"},!l&&i.a.createElement("span",{className:"progress-wrapper"},i.a.createElement("span",{className:"progress",style:{width:u}})),i.a.createElement("span",{className:"size"},Object(ai.b)(c)," / ",Object(ai.b)(a||s)),!l&&i.a.createElement("span",{className:"percent"},p&&a?"99%":u))),n&&i.a.createElement("div",{className:"bottom reupload"},i.a.createElement("span",null,i.a.createElement(di.a,null),"\u4e0a\u4f20\u5931\u8d25\uff0c"),i.a.createElement("a",{onClick:n},"\u91cd\u8bd5")))}}])&&hi(n.prototype,r),o&&hi(n,o),t}();var wi=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map={},this.createPlaceholder=function(e,t){n.rootStore.core.trigger("afterInsert",{braceWidth:540});var r=n.rootStore,o=r.state,a=r.view,c=r.dispatch,l=o.tr,u=o.doc;l.selection.empty||l.deleteSelection();var p=o.config.pluginsByKey.audio$,f=l.selection.$to,d=f.nodeBefore,m=f.nodeAfter,h=f.pos;d&&!m&&u.content.size>h&&(h+=1);var y=!d&&!m;l.setMeta(p,{add:{key:e,pos:h}}).insertText("\u200b",h).setSelection(Ua.TextSelection.create(l.doc,h+1)),c(l.scrollIntoView()),a.focus();var b=Object(ai.e)(p.getState(a.state),e);if(b){var v=b.node,g={src:"",size:t.size,name:t.name,total:100,loaded:0,done:!1};n.map[e]={node:v,isBlankLine:y,file:t},s.a.render(i.a.createElement(gi,{readOnly:!1,data:g,removeNode:function(){}}),v)}else console.warn("the progress node may be deleted")},this.beforeUpload=function(e){var t=e.file,r=oi()();return n.createPlaceholder(r,t),r},this.onProgress=function(e,t){var r=e.key,o=e.file,a={src:"",size:o.size,name:o.name,total:t.total,loaded:t.loaded,done:!1};s.a.render(i.a.createElement(gi,{readOnly:!1,data:a,removeNode:function(){}}),n.map[r].node)},this.finishUpload=function(e){var t=e.res,r=(e.src,e.file),o=e.size,a=e.key;if(t.data&&1!==t.status){var i=t.data.jobId,c=function(e){var t={url:Object(ai.g)(e.url,1),size:Object(ai.b)(o),name:r.name},i=n.rootStore,c=i.state,s=i.dispatch,l=c.tr,u=c.config.pluginsByKey.audio$,p=Object(ai.e)(u.getState(c),a);if(p){var f=p.pos,d=f;n.map[a].isBlankLine&&(d-=1),l.replaceWith(d,f+1,c.schema.nodes.audio.create(t)).setMeta(u,{remove:{key:a}}),s(l),delete n.map[a]}};if(i){var s=r.name.split(".").reverse().slice(1).reverse().join(".");n.getJobDetail(i,a,c,s)}else c(t.data)}else n.errorHandle(t,a)},this.getJobDetail=function(e,t,r,o){var a=n.rootStore.config,i=a.pageId,c=a.isTemplate;Object(Ka.c)("/api/file/jobDetail",{query:{jobId:e,contentId:i,type:c?1:0,fileName:o}}).then(function(a){var i=a.transcodeStatus;return 0===i?r(a):3===i||4===i?n.errorHandle({status:9},t):void setTimeout(function(){n.getJobDetail(e,t,r,o)},300)}).catch(function(e){return n.errorHandle(e,t)})},this.errorHandle=function(e,t){n.rootStore.view.dom.parentElement&&(401===e.status||"auth failed"===e.message?m.a.error("\u4e0a\u4f20\u5931\u8d25\uff0c\u767b\u5f55\u4fe1\u606f\u5931\u6548"):9===e.status?m.a.error("\u8f6c\u7801\u5931\u8d25\uff0c\u8bf7\u8c03\u6574\u683c\u5f0f"):window.navigator.onLine?m.a.error("\u4e0a\u4f20\u5931\u8d25"):m.a.error("\u7f51\u7edc\u5f02\u5e38"),console.error("error message: ",e),n.reupload(t))},this.reupload=function(e){var t=n.map[e];if(t){var r=t.node,o=t.file,a={src:"",size:o.size,name:o.name,total:100,loaded:0,done:!1};s.a.render(i.a.createElement(gi,{readOnly:!1,data:a,removeNode:function(){},reupload:function(){var t=n.rootStore.config.url.media,r={onProgress:n.onProgress,finishUpload:n.finishUpload,errorHandle:n.errorHandle};Object(ai.m)(o,e,t,r)}}),r)}},this.rootStore=t},ji=(n("./core-js/modules/es6.array.find.js"),n("./prosemirror-view/dist/index.js")),Oi=n("../client/src/editor/modules/audio/Audio/index.js");function Si(){return(Si=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Ei=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=t,this.view=n,this.getPos=r,this.store=o,this.dom=document.createElement("div");var a="ct-audio";"center"===t.attrs.align?a+=" align-center":"right"===t.attrs.align&&(a+=" align-right"),this.dom.className=a,s.a.render(i.a.createElement(Oi.a,Si({},t.attrs,{store:o,downloadInNewTable:!0})),this.dom)};var Pi=new Ua.PluginKey("audio");function ki(e){return[new Ua.Plugin({key:Pi,state:{init:function(){return ji.DecorationSet.empty},apply:function(e,t){t=t.map(e.mapping,e.doc);var n=e.getMeta(this);if(n&&n.add){var r=n.add,o=r.pos,a=r.key,i=function(){var e=document.createElement("div");return e.style.outline="none",e.setAttribute("data-type","ct-progress"),e}(),c=ji.Decoration.widget(o,i,{key:a});t=t.add(e.doc,[c])}else n&&n.remove&&(t=t.remove(t.find(null,null,function(e){return e.key===n.remove.key})));return t}},props:{decorations:function(e){return this.getState(e)},nodeViews:{audio:function(t,n,r){return new Ei(t,n,r,e)}}}})]}function xi(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ci=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="audio",this.schema=ni,this.store=new wi(n),this.plugins=xi(ki(this.store))};Ci.moduleName="audio";n("./core-js/modules/es7.object.values.js");var Ti=n("../client/src/editor/modules/calendar/api/server.js"),Ii=function(e){return function(t,n,r,o){var a=t.schema.nodes.calendar.create(e),i=Object(ai.i)(t,a).transaction;return!!i&&(n(i.scrollIntoView()),"function"===typeof o&&o("afterInsert",{draggable:!1,braceWidth:960}),!0)}};function Ai(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Di(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ai(n,!0).forEach(function(t){Ni(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ai(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=document.createElement("div");return o.className="ct-calendar-loading",r&&(o.style.zIndex=9),o.innerHTML='\n    <div class="loading-container">\n      <div class="loading-icon"><i></i><i></i><i></i></div>\n      '.concat(t?'<div class="loading-tips">'.concat(t,"</div>"):"","\n      ").concat(n?'<div class="loading-cancel"><a class="btn-cancel">\u53d6\u6d88</a></div>':"","\n    </div>"),n&&o.querySelector(".btn-cancel").addEventListener("click",n,!1),e.appendChild(o),o}var _i=function(e){return function e(t,n){for(var r=0;r<t.length;r++){var o=t[r];if("calendar"===o.type.name)o.attrs=Di({},o.attrs,{paste:1});else if(n<5){var a=o.content.content;a.length>0&&e(a,n+1)}}}(e.content.content,0),e};n("../client/src/editor/modules/calendar/style.styl");function Li(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Bi(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Li(a,r,o,i,c,"next",e)}function c(e){Li(a,r,o,i,c,"throw",e)}i(void 0)})}}var Ri=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.preventKeyboardEvent=!1,this.clickOn=null,this.doms={},this.insert=Bi(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Mi(document.body,"\u65e5\u5386\u5b8f\u521b\u5efa\u4e2d"),r=n.rootStore.config.pageId,o=Object(Ti.a)(r),e.prev=3,a=n.rootStore,i=a.state,c=a.dispatch,s=a.pm,l=a.core.trigger,e.next=7,o.createCalendar();case 7:u=e.sent,Ii({id:u,docId:r,view:"month"})(i,c,s,l),t.remove(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(3),t.remove(),m.a.error("\u65e5\u5386\u5b8f\u521b\u5efa\u5931\u8d25");case 17:case"end":return e.stop()}},e,null,[[3,13]])})),this.select=function(e,t){var r=n.doms[e];r&&r.setAttribute("class","ct-calendar ct-calendar-".concat(t?"":"un","selected"))},this.clearSelected=function(){Object.values(n.doms).forEach(function(e){e&&e.setAttribute("class","ct-calendar")})},this.rootStore=t},Vi={nodes:{calendar:{group:"block",allowGapCursor:!0,insertBlock:!0,dragBlock:!0,braceWidth:900,draggable:!1,selectable:!1,atom:!0,attrs:{id:{default:0},view:{default:"month"},docId:{default:0},paste:{default:0},dataDiffId:{default:null}},parseDOM:[{tag:'div[class~="ct-calendar"]',getAttrs:function(e){return{id:parseInt(e.getAttribute("data-id"),10),docId:parseInt(e.getAttribute("data-doc-id"),10),paste:parseInt(e.getAttribute("data-paste"),10),view:e.getAttribute("data-view"),dataDiffId:e.getAttribute("data-diff-id")}}}],toDOM:function(e){var t=e.attrs,n=t.id,r=t.docId,o=t.paste,a=t.view,i=t.dataDiffId,c=a;return"month"!==a&&"week"!==a&&(c="month"),["div",{class:"ct-calendar","data-id":"".concat(n),"data-view":"".concat(c),"data-doc-id":"".concat(r),"data-paste":"".concat(o),"data-diff-id":i||"ct-diff-id-".concat(Object(x.J)())}]}}}},Hi=n("../client/src/editor/modules/calendar/Calendar/index.js");function zi(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fi=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=o.rootStore.config.pageId,c=t.attrs.id,l=t.attrs.view?t.attrs.view:"month",u=t.attrs.docId,p=t.attrs.paste,f="".concat(u)!=="".concat(a)||p?u:null;this.id=c,this.node=t,this.paste=p,this.store=o,this.api=Object(Ti.a)(a,c),this.portals=document.createElement("div"),this.dom=document.createElement("div");var d=this.node.dataDiffId;d&&this.dom.setAttribute("data-diff-id",d),this.dom.setAttribute("data-id",c),this.dom.setAttribute("data-docId",u),this.dom.setAttribute("class","ct-calendar"),0===p&&(this.store.doms[this.id]=this.dom);var m={store:o,getPos:r,contentId:a,projectId:c,copyId:f,dom:this.portals,view:l};document.body.appendChild(this.portals),s.a.render(i.a.createElement(Hi.a,m),this.dom)}var t,n,r;return t=e,(n=[{key:"update",value:function(e){var t=this.node.attrs,n=(t.view,zi(t,["view"])),r=e.attrs,o=(r.view,zi(r,["view"]));if(d()(n,o))return!0}},{key:"destroy",value:function(){this.portals.remove()}}])&&Wi(t.prototype,n),r&&Wi(t,r),e}(),Ui=new Ua.PluginKey("calendar"),Ki=null;n("../client/src/editor/modules/calendar/view/index.js");var qi=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="calendar",this.schema=Vi,this.store=new Ri(n),this.plugins=function(e){return[new Ua.Plugin({key:Ui,props:{handleClickOn:function(t,n,r,o,a){if("calendar"===r.type.name){Ki=a.target;var i=t.state,c=t.dispatch,s=Ua.NodeSelection.create(i.doc,o);return"ct-calendar-header"===a.target.className&&c(i.tr.setSelection(s)),e.clickOn=r.attrs.id,setTimeout(function(){e.clickOn=null},0),e.clearSelected(),"ct-calendar-header"!==a.target.className?(e.preventKeyboardEvent=!0,e.select(e.clickOn,!1)):(e.preventKeyboardEvent=!1,e.select(e.clickOn,!0)),!0}},handleClick:function(){e.preventKeyboardEvent=!1,e.clearSelected(),null!==e.clickOn&&e.select(e.clickOn,!0),e.clickOn=null},handleDOMEvents:{keydown:function(t,n){e.preventKeyboardEvent&&n.preventDefault()},dragover:function(e,t){t.target.closest(".ct-calendar")&&t.preventDefault()}},transformPasted:_i,nodeViews:{calendar:function(t,n,r){return new Fi(t,n,r,e)}}},view:function(){return{update:function(t){var n=t.state.selection;if(n instanceof Ua.NodeSelection){var r=t.state.doc.nodeAt(n.from);"calendar"===r.type.name&&Ki&&!Ki.closest(".ct-calendar-btn")&&e.select(r.attrs.id,!0),e.clickOn||(e.preventKeyboardEvent=!1)}}}}})]}(this.store)};qi.moduleName="calendar";var Gi=n("../client/src/editor/modules/comment/index.js");n("../client/src/editor/modules/contextmenu/Popover/style.styl");function Qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contextmenuPopover=document.createElement("div"),this.contextmenuPopover.className="ct-contextmenu-popover";var n=t.dom.parentNode;n&&n.appendChild(this.contextmenuPopover)}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){this.contextmenuPopover.remove()}}])&&Qi(t.prototype,n),r&&Qi(t,r),e}();function Yi(e){var t=null,n=new Ua.PluginKey("contextmenu");return new Ua.Plugin({key:n,props:{handleDOMEvents:{mousedown:function(e){t=e.state.selection},contextmenu:function(n,r){var o=r.clientX,a=r.clientY,i=n.state,c=n.dispatch,s=n.docView,l=e.rootStore.core.tableUtils,u=l.isInTable(i);if(u&&t&&"CellSelection"===t.constructor.name)c(i.tr.setSelection(t));else if(i.selection.empty){var p=s.posFromDOM(r.target),f=Ua.TextSelection.create(i.tr.doc,p),d=i.tr.setSelection(f);c(d);var m=i.apply(d);u=l.isInTable(m)}if(!u)return e.hideMenu(),!1;r.preventDefault(),n.focus();var h=u?"table":"basic";e.showMenu(h,o,a)}}},view:function(e){return new Xi(e)}})}function Ji(e){return(Ji="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $i(e,t){return!t||"object"!==Ji(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ec(e){return(ec=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tc(e,t){return(tc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nc,rc=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$i(this,ec(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tc(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.store.rootStore,t=e.state,n=e.view,r=e.core,o=r.basicCommands,a=r.basicUtils.isTextBlock(t)?"":"disabled";return i.a.createElement("div",{className:"ct-context-menu"},i.a.createElement("div",{className:"ct-context-item",onClick:function(){n.focus(),document.execCommand("cut")}},"\u526a\u5207"),i.a.createElement("div",{className:"ct-context-item",onClick:function(){n.focus(),document.execCommand("copy")}},"\u590d\u5236"),i.a.createElement("div",{className:"ct-context-item split",onClick:function(){var e=h.f?"\u2318":"Ctrl";m.a.error("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u7c98\u8d34\uff0c\u8bf7\u4f7f\u7528 ".concat(e,"-V \u7c98\u8d34"))}},"\u7c98\u8d34"),i.a.createElement("div",{className:"ct-context-item split ".concat(a),onClick:function(){n.focus(),o.clearFormat(t)}},"\u6e05\u9664\u683c\u5f0f"))}}])&&Zi(n.prototype,r),o&&Zi(n,o),t}();n("../client/src/editor/modules/contextmenu/Menu/style.styl");function oc(e){return(oc="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ic(e,t){return!t||"object"!==oc(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cc(e){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sc(e,t){return(sc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lc,uc,pc=Object(l.inject)("store")(nc=Object(l.observer)(nc=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=ic(this,(e=cc(t)).call.apply(e,[this].concat(o)))).onGlobalClick=function(){n.props.store.hideMenu()},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sc(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onGlobalClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onGlobalClick)}},{key:"render",value:function(){var e=this.props.store;e.rootStore.count;return"table"===e.type?i.a.createElement(Te,{store:e}):"table-slim"===e.type?i.a.createElement(Te,{store:e,slim:!0}):i.a.createElement(rc,{store:e})}}])&&ac(n.prototype,r),o&&ac(n,o),t}())||nc)||nc;var fc=(uc=function(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}((lc=function e(t){var n,r,o,a,c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isShow=!1,n=this,r="type",a=this,(o=uc)&&Object.defineProperty(n,r,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(a):void 0}),this.beforeUnmount=function(){var e=document.getElementById(c.rootStore.config.pageWrapperId);e&&e.removeEventListener("scroll",c.hideMenu)},this.calculate=function(e,t,n){var r="auto",o="auto",a="auto",i="auto",c="table"===n?370:130,s=window.innerWidth,l=window.innerHeight;return e+130>s?o="".concat(10,"px"):i="".concat(e,"px"),t+c>l-60?a="".concat(70,"px"):r="".concat(t,"px"),{top:r,right:o,bottom:a,left:i}},this.showMenu=function(e,t,n){var r=document.querySelector(".ct-contextmenu-popover");if(r){var o=c.calculate(t,n,e),a=o.top,u=o.right,p=o.bottom,f=o.left;r.style.display="block",r.style.left=f,r.style.right=u,r.style.top=a,r.style.bottom=p;var d=i.a.createElement(l.Provider,{store:c},i.a.createElement(pc,null));s.a.render(d,r),c.type=e,c.isShow=!0}},this.hideMenu=function(){var e=document.querySelector(".ct-contextmenu-popover");e&&(e.style.display="none",s.a.render(null,e),c.type=null,c.isShow=!1)},this.rootStore=t,t.showMenu=this.showMenu;var u=document.getElementById(t.config.pageWrapperId);u&&u.addEventListener("scroll",this.hideMenu)}).prototype,"type",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lc);var dc=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="contextmenu",this.store=new fc(n),this.plugins=[Yi(this.store)]};dc.moduleName="contextmenu";var mc={nodes:{spaceupdate:{group:"block",content:"text*",atom:!0,allowGapCursor:!0,insertBlock:!0,dragBlock:!0,draggable:!0,braceWidth:200,attrs:{spaceId:""},parseDOM:[{tag:'div[class="ct-space-update"]',getAttrs:function(e){return{spaceId:e.getAttribute("data-space-id")||""}}}],toDOM:function(e){return["div",{class:"ct-space-update","data-space-id":e.attrs.spaceId,contenteditable:!1},0]}}}},hc=(n("./antd/lib/tooltip/style/index.js"),n("./antd/lib/tooltip/index.js")),yc=n.n(hc),bc=n("../client/src/utils/element.js"),vc=n("../client/src/editor/assets/svg/edit.svg"),gc=(n("./core-js/modules/es6.regexp.search.js"),n("./lodash.debounce/index.js")),wc=n.n(gc),jc=(n("../client/src/assets/svg/input-question.svg"),n("../client/src/components/ui/modal/index.js")),Oc=n("../client/src/components/ui/search/index.js"),Sc=(n("../client/src/assets/svg/error-circle.svg"),n("../client/src/components/Avatar/index.js")),Ec=n("../client/src/consts/index.js");n("../client/src/editor/modules/spaceUpdate/Modal/style.styl");function Pc(e){return(Pc="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kc(n,!0).forEach(function(t){Cc(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kc(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Cc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tc(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Ic(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Tc(a,r,o,i,c,"next",e)}function c(e){Tc(a,r,o,i,c,"throw",e)}i(void 0)})}}function Ac(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Dc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nc(e,t){return!t||"object"!==Pc(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mc(e){return(Mc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _c(e,t){return(_c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lc=Ec.t.PENDING,Bc=Ec.t.DONE,Rc=Ec.t.ERROR,Vc=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Nc(this,Mc(t).call(this,e))).isMount=!0,n.selectSpace=function(e){var t=n.state,r=t.recentSpaces,o=t.starredSpaces,a=t.currentSpace,i=t.searchRes,c=[].concat(Ac(r),Ac(o),Ac(a),Ac(i)).find(function(t){return t.spaceId===e});n.setState({selectedSpaceId:e,selected:c})},n.getCurrentSpace=Ic(regeneratorRuntime.mark(function e(){var t,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=n.props.spaceId){e.next=4;break}return e.abrupt("return");case 4:return r=b.b.space,e.next=7,r.getSpaceDataWithNoAuth(t);case 7:o=e.sent,n.isMount&&n.setState({currentSpace:[xc({},o,{spaceId:t})]},function(){return n.selectSpace(t)}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),Object(vr.t)(e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])})),n.search=function(){var e=Ic(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(0,b.b.search.searchSpaceByName)(t).then(function(e){if(t===n.state.searchKey){var r=e.models;n.setState({searchRes:r,searchState:Bc})}}).catch(function(e){t===n.state.searchKey&&n.setState({searchState:Rc}),console.error(e)});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.handleSearchInput=function(e,t){e.persist();var r=e.target.value.trim();r?(n.setState({hasSearch:!0,searchKey:r,searchRes:[],searchState:Lc}),t?n.search(r):n.searchDebounce(r)):n.clearSearch()},n.clearSearch=function(){n.setState({hasSearch:!1,searchKey:"",searchRes:[],searchState:Bc})},n.getRecentSpace=Ic(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.b.recent.getSpaceRecent();case 2:if(n.isMount){e.next=4;break}return e.abrupt("return");case 4:t=b.b.recent.spaceData,r=t.slice(0,9).map(function(e){return xc({key:e.spaceId,name:e.spaceName},e)}),n.setState({recentSpaces:r});case 7:case"end":return e.stop()}},e)})),n.getStarredSpace=Ic(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.b.starredSpace.getStarredSpace();case 2:(t=e.sent)&&b.b.sideBar.setStarredSpaceTree(t,!0),n.isMount&&n.setState({starredSpaces:b.b.starredSpace.showData});case 5:case"end":return e.stop()}},e)})),n.renderSpaceBlock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=n.state.selectedSpaceId;return e.map(function(e){return i.a.createElement(yc.a,{key:e.spaceId,title:e.spaceName||e.name,mouseEnterDelay:.6,getPopupContainer:function(){return n.srcoll}},i.a.createElement("div",{className:E()("block",{selected:+t===+e.spaceId}),onClick:function(){return n.selectSpace(e.spaceId)}},i.a.createElement("div",{className:"avatar"},i.a.createElement(Sc.a,{src:e.headImg,spaceId:e.spaceId,spaceKey:e.spaceKey})),i.a.createElement("div",{className:"name"},e.spaceName||e.name)))})},n.getSelectedInfo=function(){var e=n.state.selected;if(e)return i.a.createElement("div",{className:"block"},i.a.createElement("div",{className:"avatar"},i.a.createElement(Sc.a,{src:e.headImg,spaceId:e.spaceId,spaceKey:e.spaceKey})),i.a.createElement("div",{className:"name"},e.spaceName||e.name))},n.renderBody=function(){var e=n.state,t=e.recentSpaces,r=e.starredSpaces,o=e.currentSpace,a=e.searchRes;return e.hasSearch?i.a.createElement("div",{className:"ct-space-update-modal-body",ref:function(e){n.srcoll=e}},i.a.createElement("div",{className:"ct-space-update-count"},"\u641c\u7d22\u7ed3\u679c\uff1a",a.length),i.a.createElement("div",{className:"ct-space-update-category-content"},n.renderSpaceBlock(a))):i.a.createElement("div",{className:"ct-space-update-modal-body",ref:function(e){n.srcoll=e}},!!o.length&&i.a.createElement("div",{className:"ct-space-update-category"},i.a.createElement("div",{className:"ct-space-update-category-item"},"\u5f53\u524d\u7a7a\u95f4"),i.a.createElement("div",{className:"ct-space-update-category-content"},n.renderSpaceBlock(o))),i.a.createElement("div",{className:"ct-space-update-category"},!!t.length&&i.a.createElement("div",{className:"ct-space-update-category-item"},"\u6700\u8fd1\u8bbf\u95ee\u7a7a\u95f4"),i.a.createElement("div",{className:"ct-space-update-category-content"},n.renderSpaceBlock(t))),i.a.createElement("div",{className:"ct-space-update-category"},!!r.length&&i.a.createElement("div",{className:"ct-space-update-category-item"},"\u6536\u85cf\u7a7a\u95f4"),i.a.createElement("div",{className:"ct-space-update-category-content"},n.renderSpaceBlock(r))))},n.state={recentSpaces:[],starredSpaces:[],currentSpace:[],searchRes:[],hasSearch:!1,searchState:Bc,searchKey:"",selected:null,selectedSpaceId:e.spaceId},n.searchDebounce=wc()(n.search,1e3),n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_c(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){this.isMount=!0,this.getRecentSpace(),this.getCurrentSpace(),this.getStarredSpace()}},{key:"componentWillUnmount",value:function(){this.isMount=!1}},{key:"render",value:function(){var e=this,t=this.state,n=t.searchKey,r=(t.hasSearch,t.selectedSpaceId),o=this.props,a=o.onCancel,c=o.onOk;return i.a.createElement(jc.a,{visible:!0,border:!0,title:"\u6700\u8fd1\u66f4\u65b0",className:"ct-space-update-modal",onCancel:a,onOk:function(){return c({spaceId:r},a)}},i.a.createElement("div",{className:"ct-space-update-modal-header"},"\u63d2\u5165\u540e\uff0c\u5c06\u5728\u6587\u6863\u4e2d\u5c55\u793a\u5df2\u9009\u7a7a\u95f4\u7684\u6700\u8fd1\u66f4\u65b0\u5185\u5bb9\u3002"),i.a.createElement("div",{className:"ct-space-update-modal-selected"},i.a.createElement("span",null,"\u5df2\u9009\u7a7a\u95f4:"),i.a.createElement("span",null,this.getSelectedInfo())),i.a.createElement(Oc.a,{placeholder:"\u8bf7\u8f93\u5165\u7a7a\u95f4\u540d\u79f0\u8fdb\u884c\u641c\u7d22",onChange:this.handleSearchInput,onKeyUp:function(t){13===t.keyCode&&e.handleSearchInput(t,!0)},onClear:this.clearSearch,value:n}),this.renderBody())}}])&&Dc(n.prototype,r),o&&Dc(n,o),t}(),Hc=function(e){var t=e.offsetParent,n=e.dom,r=e.toolboxHeight,o=n.getBoundingClientRect(),a=o.x,i=o.y,c=t.getBoundingClientRect();return{left:a-c.x,top:i-c.y-r-2}},zc=function(e){var t=e.onClick,n=e.$popover,r=e.inTable;s.a.render(i.a.createElement(yc.a,{title:"\u7f16\u8f91",placement:"bottom"},i.a.createElement("div",{className:E()("menu-item",{"in-table":r}),onClick:t},i.a.createElement(vc.a,{style:{marginLeft:"5px",marginTop:"5px"}}))),n)},Wc=function(e){e.firstChildElement&&(s.a.unmountComponentAtNode(e.firstChildElement)&&e.removeChild(e.firstChildElement))};function Fc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Uc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fc(n,!0).forEach(function(t){Kc(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fc(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Kc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gc=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=null,this.$popover=null,this.isShowPopover=!1,this.tableWrapper=null,this.setSpaceUpdate=function(e,t){n.node?n.updateAttrs(e,t):n.createNode(e,t)},this.updateAttrs=function(e,t){var r=n.rootStore,o=r.state,a=r.dispatch,i=r.pm,c=o.tr,s=n.node.pos;try{c.setNodeMarkup(s,null,Uc({},e));var l=Ua.NodeSelection.create(c.doc,s);c.setSelection(l),a(c.scrollIntoView()),n.node.attrs=e;var u=i.domAtPos(s+1).node;n.node.dom=u,t()}catch(p){console.error("update spaceupdate failed",p)}},this.createNode=function(e,t){var r=n.rootStore,o=r.state,a=r.dispatch,i=(r.trigger,n.rootStore.schema.nodes.spaceupdate.create(e));try{var c=Object(ai.i)(o,i).transaction;if(!c)throw new Error("macro spaceupdate insert failed");a(c.scrollIntoView()),t()}catch(s){console.error(s)}},this.reSetPopover=function(e,t){t||(t=Uc({},n.node)),n.hidePopover(),n.showPopover(t)},this.showPopover=function(e){if(e&&!n.isShowPopover){n.node=e;var t=n.node.dom,r=n.rootStore.pm.dom.parentNode,o=Hc({offsetParent:r,dom:t,toolboxHeight:36}),a=o.left,i=o.top;n.$popover.style.left="".concat(a,"px"),n.$popover.style.top="".concat(i,"px"),n.$popover.style.display="block",n.updatePopverHeight();var c=!1,s=t.closest(".ct-table-wrapper");s&&(c=!0,n.tableWrapper=s,n.tableWrapper.addEventListener("scroll",n.reSetPopover)),zc({$popover:n.$popover,onClick:function(){return n.create(n.node)},inTable:c}),n.isShowPopover=!0}},this.updatePopverHeight=function(){if(n.node){var e=n.node.dom;n.$popover.style.height="".concat(e.offsetHeight+36,"px")}},this.hidePopover=function(){n.isShowPopover&&(Wc(n.$popover),n.node=null,n.tableWrapper&&(n.tableWrapper.removeEventListener("scroll",n.reSetPopover),n.tableWrapper=null),n.$popover.style.display="none",n.isShowPopover=!1)},this.rootStore=t,this.reSetPopover=k()(this.reSetPopover,16)}var t,n,r;return t=e,(n=[{key:"create",value:function(e){var t=this.rootStore.config.spaceId;e&&(this.node=e,t=e.attrs.spaceId),function(e){var t=e.onOk,n=e.spaceId,r=Object(bc.a)(),o=r.div,a=r.close;s.a.render(i.a.createElement(Vc,{onOk:t,onCancel:a,spaceId:n}),o)}({onOk:this.setSpaceUpdate,spaceId:t})}}])&&qc(t.prototype,n),r&&qc(t,r),e}(),Qc=n("../client/src/editor/modules/spaceUpdate/NodeView/index.js");function Xc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yc=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=t,this.view=n,this.getPos=r,this.store=o;var a=this.node.attrs.spaceId;this.dom=document.createElement("div"),this.dom.setAttribute("class","ct-space-update"),s.a.render(i.a.createElement(Qc.a,{spaceId:a,onLoaded:this.store.updatePopverHeight}),this.dom)}var t,n,r;return t=e,(n=[{key:"update",value:function(e){var t=this;return!Object.keys(e.attrs).some(function(n){return e.attrs[n]!==t.node.attrs[n]})}},{key:"destory",value:function(){s.a.unmountComponentAtNode(this.dom)}}])&&Xc(t.prototype,n),r&&Xc(t,r),e}(),Jc="spaceUpdate";n("../client/src/editor/modules/spaceUpdate/Popover/style.styl");function Zc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=n,this.editorPopover=document.createElement("div"),this.editorPopover.className="ct-space-update-popover";var r=t.dom.parentNode;r&&r.appendChild(this.editorPopover),this.store.$popover=this.editorPopover}var t,n,r;return t=e,(n=[{key:"update",value:function(e,t){var n=e.state,r=n.selection;if(n.tableColumnResizing$.dragging||!r.eq(t.selection))if(r.node&&r.node.type.name===Jc.toLowerCase())try{var o=r.$from,a=o.pos,i=o.nodeAfter,c=e.domAtPos(a+1).node;this.store.reSetPopover(null,{dom:c,pos:a,attrs:i.attrs})}catch(s){console.error("spaceupdate showPopover failed",s)}else this.store.hidePopover()}},{key:"destroy",value:function(){this.store.hidePopover(),this.editorPopover.remove()}}])&&Zc(t.prototype,n),r&&Zc(t,r),e}(),es=new Ua.PluginKey(Jc);n("../client/src/editor/modules/spaceUpdate/style.styl");var ts=function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=Jc,this.store=new Gc(t.store),this.plugins=(n=this.store,[new Ua.Plugin({key:es,props:{nodeViews:{spaceupdate:function(e,t,r){return new Yc(e,t,r,n)}},handleDoubleClickOn:function(e,t,r,o){if(r.type.name===Jc.toLocaleLowerCase())try{var a=e.domAtPos(t).node;n.create({dom:a,attrs:r.attrs,pos:o})}catch(i){console.error(i)}}},view:function(e){return new $c(e,n)}})]),this.schema=mc};ts.pluginName=Jc;var ns=function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.destroy=function(){r.toolbar.remove(),r.tooltip.remove()},this.store=n,this.toolbar=document.createElement("div"),this.tooltip=document.createElement("div"),this.toolbar.className="ct-gantt-toolbar ct-gantt-scroll ct-editor-popover",this.tooltip.className="ct-gantt-tooltip ct-gantt-scroll ct-editor-popover";var o=t.dom.parentNode;o&&o.appendChild(this.toolbar),o&&o.appendChild(this.tooltip)},rs=n("../client/src/editor/modules/gantt/api/server.js"),os=n("../client/src/editor/modules/gantt/pm/utils.js"),as=n("../client/src/editor/modules/gantt/Gantt/utils.js"),is=n("../client/src/editor/modules/gantt/consts.js");n("../client/src/editor/modules/gantt/Gantt/style.styl");function cs(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function ss(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){cs(a,r,o,i,c,"next",e)}function c(e){cs(a,r,o,i,c,"throw",e)}i(void 0)})}}function ls(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var us=function(){function e(t,n,r,o){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.destroy=function(){a.destroyed=!0,a.hideLoading(),a.hideLoadingFailed(),a.store.hideToolbar(),a.hideTooltip(),window.removeEventListener("message",a.receive)},this.showLoading=function(){a.loading||(a.loading=Object(as.g)(a.dom,is.q,null,!0))},this.hideLoading=function(){a.loading&&(Object(as.e)(a.loading),a.dom.border="0")},this.showLoadingFailed=function(){a.loadingFailed||(a.loadingFailed=Object(as.h)(a.dom,a.retry))},this.hideLoadingFailed=function(){a.loadingFailed&&Object(as.f)(a.loading)},this.append=function(){var e=ss(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.reSave(t,a.version<0);case 3:return n=e.sent,e.next=6,Object(rs.b)(a.pageId,n);case 6:if(r=e.sent,!a.destroyed){e.next=9;break}return e.abrupt("return");case 9:o=30*r.tasks.length+54,a.content=r,a.iframe=document.createElement("iframe"),a.dom.style.height="".concat(o,"px"),a.dom.appendChild(a.iframe),a.dom.classList.add("ct-gantt"),a.modifyFrame(r),window.addEventListener("message",a.receive),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),a.errorHandler(e.t0);case 22:case"end":return e.stop()}},e,null,[[0,19]])}));return function(t){return e.apply(this,arguments)}}(),this.modifyFrame=function(e){var t=30*e.tasks.length+54;a.height!==t&&(a.dom.style.height="".concat(t,"px")),a.iframe.setAttribute("class","ct-frame"),a.iframe.src=is.o,a.iframe.style.height="".concat(t,"px"),a.iframe.onload=function(){a.postMessage({id:a.id,height:t,event:"init",content:e})},a.iframe.onerror=function(e){a.errorHandler(e),console.error(is.i,e)}},this.reSave=function(){var e=ss(regeneratorRuntime.mark(function e(t,n){var r,o,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.prev=1,e.next=4,Object(rs.d)(t,a.pageId,n);case 4:r=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:o=a.store.rootStore,i=o.state.tr,c=o.dispatch,a.id=r,a.version=0;try{c(i.setNodeMarkup(i.mapping(a.getPos()),null,{id:r,version:0,height:a.height,dataDiffId:a.dataDiffId}))}catch(s){}return e.abrupt("return",r);case 15:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}(),this.retry=ss(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.showLoading(),e.prev=1,e.next=4,Object(rs.b)(a.pageId,a.id);case 4:t=e.sent,n=30*t.tasks.length+54,a.dom.style.height="".concat(n,"px"),a.iframe.style.height="".concat(n,"px"),a.postMessage({id:a.id,height:n,event:"init",content:t}),a.content=t,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),a.errorHandler(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])})),this.errorHandler=function(e){window.navigator.onLine?m.a.error(is.h):m.a.error(is.t),console.error(e),a.hideLoading(),a.showLoadingFailed()},this.postMessage=function(e){a.iframe&&a.iframe.contentWindow.postMessage(e,"*")},this.receive=function(e){var t=e.data;if("gantt"===t.nodeType&&t.id===a.id)switch(t.event){case"clipboard":a.onClipboard(t.content);break;case"finish":a.onFinish();break;case"click":a.onClick();break;case"dblclick":a.onDblclick();break;case"keydown":a.onKeydown(t.content);break;case"showTooltip":a.showTooltip(t.content);break;case"hideTooltip":a.hideTooltip()}},this.onClipboard=function(e){if("cut"===e){var t=a.editorView,n=t.state;(0,t.dispatch)(n.tr.deleteSelection())}},this.onFinish=function(){a.hideLoading()},this.onClick=function(){var e=a.getPos();if(void 0!==e){a.store.createSelection(a.editorView,e),a.store.showToolbar(a.dom,e,a.id,a.version,a.zoomIn,a.zoomOut);var t=a.store.rootStore.core,n=t.noteStore,r=t.tableStore;n.hidePopover(),r.hidePopover()}},this.onDblclick=function(){a.store.hideToolbar(),Object(os.b)(),a.store.edit(a.id,a.version,a.getPos(),a.dataDiffId)},this.onKeydown=function(e){var t=a.store.hideToolbar,n=a.editorView,r=n.state,o=n.dispatch,i=r.tr,c=r.schema;if(8===e.which||8===e.keyCode||46===e.which||46===e.keyCode)i.selection.empty||(i.deleteSelection(),o(i),t(),a.editorView.focus());else if(Object(ai.l)(e)){var s=a.getPos();o(i.replaceWith(s+1,s+1,c.text(e.key))),t(),Object(os.b)(),a.editorView.focus()}},this.showTooltip=function(e){Object(os.d)(a.dom,e,a.content)},this.hideTooltip=function(){Object(os.b)()},this.zoomIn=function(){a.postMessage({id:a.id,event:"zoomIn"})},this.zoomOut=function(){a.postMessage({id:a.id,event:"zoomOut"})},this.node=t,this.editorView=n,this.getPos=r,this.store=o,this.pageId=this.store.rootStore.config.pageId,this.iframe=null,this.content=null,this.loading=null,this.loadingFailed=null,this.destroyed=!1;var i=this.node.attrs,c=i.id,s=i.height,l=i.version,u=i.dataDiffId,p=document.createElement("div");this.id=c,this.height=s,this.version=l,this.dataDiffId=u,this.dom=p,this.dom.style.position="relative",this.dom.style.height="".concat(s,"px"),this.dom.setAttribute("data-id","".concat(c)),this.dom.setAttribute("data-height","".concat(s)),this.dom.setAttribute("data-version","".concat(l)),this.showLoading(),this.append(c)}var t,n,r;return t=e,(n=[{key:"update",value:function(e){var t=this;if(e.type!==this.node.type)return!0;if(0===this.store.loadingStatus)return!0;if(2===this.store.loadingStatus)return this.store.loadingStatus=1,!0;if(this.node.attrs===e.attrs)return!0;this.node=e;var n=this.node.attrs,r=n.id,o=n.version;return this.id=r,this.version=o,this.showLoading(),Object(rs.b)(this.pageId,this.id).then(function(e){if(t.dom.parentNode&&e.tasks){var n=30*e.tasks.length+54;t.dom.style.height="".concat(n,"px"),t.dom.setAttribute("data-id","".concat(t.id)),t.dom.setAttribute("data-height","".concat(n)),t.dom.setAttribute("data-version","".concat(t.version)),t.iframe&&(t.iframe.style.height="".concat(n,"px"),t.iframe.contentWindow?(t.postMessage({id:t.id,height:n,event:"init",content:e}),t.content=e):(t.iframe.onload=function(){t.postMessage({id:t.id,height:n,event:"init",content:e}),t.content=e},t.iframe.onerror=function(e){t.errorHandler(e),console.error(is.i,e)}))}}).catch(this.errorHandler),!0}}])&&ls(t.prototype,n),r&&ls(t,r),e}(),ps=new Ua.PluginKey("gantt");var fs={nodes:{gantt:{group:"block",content:"inline*",atom:!0,allowGapCursor:!0,insertBlock:!0,dragBlock:!0,attrs:{id:{default:""},height:{default:"0"},version:{default:"0"},dataDiffId:{default:null}},parseDOM:[{tag:'div[class~="ct-gantt"]',getAttrs:function(e){return{id:e.getAttribute("data-id"),height:parseInt(e.getAttribute("data-height"),10),version:parseInt(e.getAttribute("data-version"),10),dataDiffId:e.getAttribute("data-diff-id")}}}],toDOM:function(e){var t=e.attrs,n=t.id,r=t.height,o=t.version,a=t.dataDiffId;return["div",{class:"ct-gantt","data-id":"".concat(n),"data-height":"".concat(r),"data-version":"".concat(o),style:"{height: ".concat(r,"px}"),"data-diff-id":a||"ct-diff-id-".concat(Object(x.J)())}]}}}},ds=n("../client/src/utils/userInfo.js"),ms=function(e){return i.a.createElement(jc.a,{visible:!0,type:"small",className:"ct-drafting-modal",okText:"\u4f7f\u7528",onOk:function(){return e.applyDraft(e.close.bind(void 0))},cancelText:"\u5e9f\u5f03",onCancel:function(){return e.cancelDraft(e.close.bind(void 0))},title:"\u662f\u5426\u4f7f\u7528\u672c\u5730\u8349\u7a3f?"},i.a.createElement("div",{className:"ct-modal-content"},"\u5b58\u5728\u4e00\u4efd\u4e8e\xa0",Object(vr.g)(e.time),"\xa0\u8fdb\u884c\u4e86\u7f16\u8f91\u4f46\u672a\u4fdd\u5b58\u7684\u8349\u7a3f\uff0c\u662f\u5426\u7ee7\u7eed\u7f16\u8f91"))},hs=n("../client/src/editor/utils/editorDB.js");function ys(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function bs(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){ys(a,r,o,i,c,"next",e)}function c(e){ys(a,r,o,i,c,"throw",e)}i(void 0)})}}var vs=ds.a.login,gs=hs.a&&hs.a.gantt,ws=function(){var e=bs(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(vs,"_").concat(t),e.next=3,gs.get(n);case 3:if(!(r=e.sent)){e.next=7;break}return r.project=Object(as.c)(r.project),e.abrupt("return",r);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),js=function(){var e=bs(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gs.add({contentId:"".concat(vs,"_").concat(t),saveTime:Date.now(),project:Object(as.b)(n)});case 2:return e.next=4,gs.count();case 4:e.sent>5&&gs.orderBy("saveTime").limit(1).delete();case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Os=function(e,t){return gs.put({contentId:"".concat(vs,"_").concat(e),saveTime:Date.now(),project:Object(as.b)(t)})},Ss=function(e){var t="".concat(vs,"_").concat(e);return gs.delete(t)};function Es(){return(Es=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ps(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function ks(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Ps(a,r,o,i,c,"next",e)}function c(e){Ps(a,r,o,i,c,"throw",e)}i(void 0)})}}function xs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cs=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iframe=null,this.initialContent={tasks:[]},this.id=null,this.onSave=function(){},this.create=ks(regeneratorRuntime.mark(function e(){var t,r,o,a,i,c,s,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:function(){},r=l.length>1&&void 0!==l[1]?l[1]:0,o=l.length>2&&void 0!==l[2]?l[2]:"",a=l.length>3?l[3]:void 0,n.loading=Object(as.g)(document.body,is.r,n.close),e.prev=5,n.pageId=n.store.rootStore.config.pageId,n.contentIsNew="create"===n.store.rootStore.config.pageType?0:1,n.cacheId="create"===n.store.rootStore.config.pageType?"parent_".concat(n.store.rootStore.config.parentId):n.pageId,n.handleSave=t,n.id=o,n.version=r,n.dataDiffId=a,!(o&&o.length>0)){e.next=25;break}return e.next=16,Object(rs.c)(n.pageId,o);case 16:if(i=e.sent,c=ds.a.login,s=ds.a.tenantId,!i||i.tenantId!==s||i.editor===c){e.next=22;break}return m.a.error("".concat(i.editor).concat(is.u)),n.close(),e.abrupt("return");case 22:return e.next=24,Object(rs.b)(n.pageId,o,n.contentIsNew);case 24:n.initialContent=e.sent;case 25:n.open(),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(5),n.toastrError(is.k);case 31:case"end":return e.stop()}},e,null,[[5,28]])})),this.open=function(){n.iframe=document.createElement("iframe"),document.body.appendChild(n.iframe),n.iframe.setAttribute("frameborder","0"),n.iframe.setAttribute("class","ct-gantt-frame"),n.iframe.setAttribute("data-type","ct-frame"),n.iframe.src=is.p,n.iframe.style.opacity=0,window.addEventListener("message",n.receive),window.addEventListener("popstate",n.close),window.addEventListener("resize",n.resizeGantt),n.iframe.onload=function(){n.onLoaded(function(){n.iframe.focus(),n.iframe.style.opacity=1,Object(as.e)(n.loading)})},n.iframe.onerror=function(){n.close()}},this.close=function(){n.autoSaveTimer&&clearTimeout(n.autoSaveTimer),window.removeEventListener("message",n.receive),window.removeEventListener("popstate",n.close),window.removeEventListener("resize",n.resizeGantt),n.iframe&&document.body.removeChild(n.iframe),n.loading&&Object(as.e)(n.loading),n.iframe=null,n.handleSave=function(){},n.id&&Object(rs.a)(n.pageId,n.id)},this.receive=function(e){var t=e.data;if(!("gantt"!==t.nodeType||t.id&&t.id.length>0&&t.id!==n.id))switch(t.event){case"delRootTask":n.onDelRootTask();break;case"errorToastr":n.onErrorToastr();break;case"exit":n.onExit(t.content);break;case"save":n.onSave(t.content);break;case"autoSave":n.onAutoSave(t.content)}},this.postMessage=function(e){n.iframe.contentWindow.postMessage(e,is.p)},this.startAutoSave=function(){n.autoSaveTimer=setTimeout(function(){n.postMessage({event:"startAutoSave"})},4e3)},this.cancelDraft=function(e){Ss(n.cacheId),n.startAutoSave(),e()},this.applyDraft=function(e){return function(t){n.postMessage({event:"draft",content:e}),n.startAutoSave(),t()}},this.resizeGantt=function(){n.postMessage({event:"resizeGantt"})},this.onErrorToastr=function(){m.a.error(is.l)},this.onLoaded=function(){var e=ks(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ws(n.cacheId);case 2:r=e.sent,n.id&&n.postMessage({id:n.id,event:"init",content:n.initialContent}),r?n.showDraftModal({time:r.saveTime,cancelDraft:n.cancelDraft,applyDraft:n.applyDraft(r.project)}):n.startAutoSave(),t();case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.onAutoSave=function(){var e=ks(regeneratorRuntime.mark(function e(t){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ws(n.cacheId);case 2:r=e.sent,o=r?r.project:null,!Object(as.a)(o,t)&&t.tasks.length>0&&(r?Os(n.cacheId,t):js(n.cacheId,t),n.id&&Object(rs.g)(n.pageId,n.id));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.onExit=function(e){if(Object(as.a)(n.initialContent,e))n.close();else{var t=n.close,r=n.cacheId;jc.a.warning({title:is.x,content:is.v,okText:is.w,onOk:function(e){Ss(r),t(),e()}})}},this.onSave=function(){var e=ks(regeneratorRuntime.mark(function e(t){var r,o,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.loading=Object(as.g)(document.body,is.s),r=n.pageId,o=n.contentIsNew,a=30*t.tasks.length+54,e.prev=3,n.id){e.next=11;break}return e.next=7,Object(rs.e)(r,t,o);case 7:i=e.sent,n.id=i,e.next=13;break;case 11:return e.next=13,Object(rs.f)(r,n.id,t,n.contentIsNew);case 13:Ss(n.cacheId),n.handleSave(n.id,a,n.version+1,n.dataDiffId),Object(as.e)(n.loading),n.close(),m.a.success(is.n),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(3),n.toastrError(is.m),Object(as.e)(n.loading);case 24:case"end":return e.stop()}},e,null,[[3,20]])}));return function(t){return e.apply(this,arguments)}}(),this.showDraftModal=function(e){var t=Object(as.d)(),n=t.div,r=t.close;s.a.render(i.a.createElement(ms,Es({},e,{close:r})),n)},this.store=t}var t,n,r;return t=e,(n=[{key:"onDelRootTask",value:function(){m.a.error(is.j)}},{key:"toastrError",value:function(e){window.navigator.onLine?m.a.error(e):m.a.error(is.t)}}])&&xs(t.prototype,n),r&&xs(t,r),e}();function Ts(e){return function(t,n,r,o){var a=t.schema.nodes.gantt.create(e),i=Object(ai.i)(t,a).transaction;return!!i&&(n(i.scrollIntoView()),"function"===typeof o&&o("afterInsert",{draggable:!0}),!0)}}var Is=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingStatus=1,this.ganttEditor=new Cs(this),this.create=function(){n.ganttEditor.create(n.insert,0)},this.edit=function(e,t,r,o){n.ganttEditor.create(n.update(r),t,e,o)},this.insert=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=n.rootStore,a=o.state,i=o.dispatch,c=o.pm,s=o.trigger,l=Ts({id:e,height:t,version:r});l(a,i,c,s)},this.update=function(e){return function(t,r,o,a){var i=n.rootStore,c=i.state,s=i.dispatch,l=i.pm,u=i.trigger;(function(e,t){return function(n,r){var o=n.tr,a=n.schema;r(o.setNodeMarkup(t,a.nodes.gantt,e).scrollIntoView())}})({id:t,height:r,version:o,dataDiffId:a},e)(c,s,l,u)}},this.createSelection=function(e,t){var n=e.state,r=e.dispatch,o=Ua.NodeSelection.create(n.doc,t);r(n.tr.setSelection(o))},this.showToolbar=function(e,t,r,o,a,i){Object(os.c)(e,a,i,function(){return n.edit(r,o,t)})},this.hideToolbar=function(){Object(os.a)()},this.rootStore=t};n("../client/src/editor/modules/gantt/style.styl"),n("../client/src/editor/modules/gantt/view/index.js");var As=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="gantt",this.schema=fs,this.store=new Is(n),this.plugins=function(e){return[new Ua.Plugin({key:ps,props:{handleClickOn:function(t,n,r,o){if("gantt"===r.type.name){var a=t.state,i=t.dispatch,c=Ua.NodeSelection.create(a.doc,o);i(a.tr.setSelection(c));var s=r.attrs,l=s.id,u=s.version,p=t.docView.domFromPos(o+1).node;return e.createSelection(t,o),e.showToolbar(p,o,l,u),e.rootStore.core.dragButtonStore.showPopover(p,o),!0}return!1},handleDoubleClickOn:function(t,n,r,o){if("gantt"===r.type.name){var a=t.state,i=t.dispatch,c=Ua.NodeSelection.create(a.doc,o);i(a.tr.setSelection(c));var s=r.attrs,l=s.id,u=s.version;return e.hideToolbar(),e.edit(l,u,o),!0}return!1},handleClick:function(){e.hideToolbar()},handleDrop:function(){e.hideToolbar(),e.loadingStatus=2},transformPasted:os.e,nodeViews:{gantt:function(t,n,r){return new us(t,n,r,e)}}},view:function(t){return new ns(t,e)}})]}(this.store)};As.moduleName="gantt",As.pluginName="gantt";n("./antd/lib/icon/style/index.js");var Ds=n("./antd/lib/icon/index.js"),Ns=n.n(Ds),Ms=(n("./core-js/modules/es6.string.link.js"),n("./core-js/modules/es6.string.bold.js"),{header:"\u6587\u5b57\u683c\u5f0f",key:"text",children:[{icon:A.a.bold,description:"\u7c97\u4f53",keymap:["Mod","B"]},{icon:A.a.italic,description:"\u659c\u4f53",keymap:["Mod","I"]},{icon:A.a.strikethrough,description:"\u4e2d\u5212\u7ebf",keymap:["Mod","Shift","S"]},{icon:A.a.underline,description:"\u4e0b\u5212\u7ebf",keymap:["Mod","U"]},{icon:A.a.link,description:"\u94fe\u63a5",keymap:["Mod","K"]},{icon:A.a.indent_more,description:"\u589e\u52a0\u7f29\u8fdb",keymap:["Tab"]},{icon:A.a.indent_less,description:"\u51cf\u5c11\u7f29\u8fdb",keymap:["Shift","Tab"]}]}),_s={header:"\u8868\u683c",key:"table",children:[{icon:A.a.addRowBefore,description:"\u4e0a\u65b9\u63d2\u5165\u884c",keymap:["Alt","\u2191"]},{icon:A.a.addRowAfter,description:"\u4e0b\u65b9\u63d2\u5165\u884c",keymap:["Alt","\u2193"]},{icon:A.a.addColumnBefore,description:"\u5de6\u4fa7\u63d2\u5165\u884c",keymap:["Alt","\u2190"]},{icon:A.a.addColumnAfter,description:"\u53f3\u4fa7\u63d2\u5165\u884c",keymap:["Alt","\u2192"]},{icon:A.a.alignTop,description:"\u9876\u90e8\u5bf9\u9f50",keymap:["\u2318","Shift","h"]},{icon:A.a.alignMiddle,description:"\u5c45\u4e2d\u5bf9\u9f50",keymap:["\u2318","Shift","m"]},{icon:A.a.alignBottom,description:"\u5e95\u90e8\u5bf9\u9f50",keymap:["\u2318","Shift","d"]}]},Ls={header:"\u5217\u8868",key:"list",children:[{icon:A.a.ol_list,description:"\u6709\u5e8f\u5217\u8868",keymap:["Mod","Shift","O"]},{icon:A.a.ul_list,description:"\u65e0\u5e8f\u5217\u8868",keymap:["Mod","Shift","U"]}]},Bs=n("../client/src/editor/assets/svg/table.svg"),Rs={width:20,height:20},Vs={quote:i.a.createElement(ot,Rs),mention:i.a.createElement(gt.a,Rs),hr:i.a.createElement(sn,Rs),sup:i.a.createElement(re,Rs),sub:i.a.createElement(pe,Rs),table:i.a.createElement(Bs.a,Rs),time:i.a.createElement(qn,Rs)},Hs={header:"\u5176\u4ed6",key:"other",children:[{icon:Vs.mention,description:"\u63d0\u53ca\u4ed6\u4eba",keymap:["@"]},{icon:Vs.quote,description:"\u5f15\u7528",keymap:[">","Space"]},{icon:A.a.code_block,description:"\u4ee3\u7801\u5757",keymap:["```","Enter"]},{icon:"",description:"",keymap:["Ctrl","Alt","C"]},{icon:Vs.time,description:"\u65f6\u95f4",keymap:["Mod","Alt","T"]}]};var zs,Ws,Fs={header:"\u6bb5\u843d\u683c\u5f0f",key:"paragraph",children:[{icon:"",description:"\u6b63\u6587",keymap:["Mod","0"]}].concat((zs=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"].map(function(e,t){return{icon:"",description:"".concat(e,"\u7ea7\u6807\u9898"),keymap:["Mod",t+1]}}),function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(zs)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(zs)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()),[{icon:Vs.quote,description:"\u5f15\u7528",keymap:["Mod","8"]},{icon:A.a.align_left,description:"\u5de6\u5bf9\u9f50",keymap:["Mod","Shift","L"]},{icon:A.a.align_center,description:"\u5c45\u4e2d\u5bf9\u9f50",keymap:["Mod","Shift","C"]},{icon:A.a.align_right,description:"\u53f3\u5bf9\u9f50",keymap:["Mod","Shift","R"]}])},Us={header:"\u7f16\u8f91",key:"edit",children:[{icon:A.a.undo,description:"\u64a4\u9500",keymap:["Mod","Z"]},{icon:A.a.redo,description:"\u91cd\u505a",keymap:["Mod","Y"]},{icon:"",description:"\u4fdd\u5b58\u8349\u7a3f",keymap:["Mod","S"]},{icon:"",description:"\u4fdd\u5b58",keymap:["Mod","Alt/Ctrl","S"]},{icon:"",description:"\u6362\u884c",keymap:["Shift","Enter"]},{icon:"",description:"\u5feb\u901f\u9009\u4e2d",keymap:["Mod","Shift","A"]},{icon:"",description:"\u590d\u5236",keymap:["Mod","C"]},{icon:"",description:"\u6837\u5f0f\u590d\u5236",keymap:["Mod","Alt/Ctrl","C"]}]},Ks=[Ms,_s,Ls,Hs,Fs,{header:"markdown\u683c\u5f0f",key:"markdown",children:[{icon:"",description:"\u4e00\u7ea7\u6807\u9898",keymap:["#","Space"]},{icon:"",description:"\u4e8c\u7ea7\u6807\u9898",keymap:["##","Space"]},{icon:"",description:"\u4e09\u7ea7\u6807\u9898",keymap:["###","Space"]},{icon:"",description:"\u56db\u7ea7\u6807\u9898",keymap:["####","Space"]},{icon:"",description:"\u4e94\u7ea7\u6807\u9898",keymap:["#####","Space"]},{icon:"",description:"\u516d\u7ea7\u6807\u9898",keymap:["######","Space"]},{icon:A.a.ol_list,description:"\u6709\u5e8f\u5217\u8868",keymap:["1.","Space"]},{icon:A.a.ul_list,description:"\u65e0\u5e8f\u5217\u8868",keymap:["* \u6216 -","Space"]},{icon:A.a.task_list,description:"todo",keymap:["[]","Space"]},{icon:Vs.quote,description:"\u5f15\u7528",keymap:[">","Space"]},{icon:Vs.table,description:"\u8868\u683c",keymap:["| A | B | C |","Enter"]},{icon:A.a.code_block,description:"\u4ee3\u7801\u5757",keymap:["```","Enter"]},{icon:Vs.hr,description:"\u6c34\u5e73\u7ebf",keymap:["---","Enter"]},{icon:A.a.bold,description:"\u7c97\u4f53",keymap:["**\u7c97\u4f53**","Space"]},{icon:A.a.italic,description:"\u659c\u4f53",keymap:["_\u659c\u4f53_","Space"]},{icon:A.a.strikethrough,description:"\u4e2d\u5212\u7ebf",keymap:["~~\u4e2d\u5212\u7ebf~~","Space"]},{icon:Vs.sup,description:"\u4e0a\u6807",keymap:["^\u4e0a\u6807^","Space"]},{icon:Vs.sub,description:"\u4e0b\u6807",keymap:["~\u4e0b\u6807~","Space"]}]},Us],qs=(n("./antd/lib/card/style/index.js"),n("./antd/lib/card/index.js")),Gs=n.n(qs),Qs=(n("./antd/lib/collapse/style/index.js"),n("./antd/lib/collapse/index.js")),Xs=n.n(Qs);function Ys(e){var t=e.data,n=t.description,r=t.keymap,o=t.icon;return i.a.createElement("div",{className:"item-details"},i.a.createElement("span",{className:"item-description"},i.a.createElement("span",{className:"item-icon"},o),i.a.createElement("span",{className:"item-desc"},n)),i.a.createElement("span",{className:"item-action"},r.map(function(e,t){return"Alt"===e&&(e=h.b),"Mod"===e&&(e=h.g),"Alt/Ctrl"===e&&(e=h.a),i.a.createElement("span",{key:e},i.a.createElement("div",{className:"action-key"},e),t!==r.length-1&&i.a.createElement("span",{className:"action-operation"},"+"))})))}function Js(e){return(Js="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $s(e){return($s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function el(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tl(e,t){return(tl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nl,rl,ol,al=Xs.a.Panel,il=Object(l.inject)("store")(Ws=Object(l.observer)(Ws=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return r=this,o=(e=$s(t)).call.apply(e,[this].concat(i)),(n=!o||"object"!==Js(o)&&"function"!==typeof o?el(r):o).state={activeKey:""},n.clickOutSide=function(e){var t=s.a.findDOMNode(el(n));return e.target&&t&&t.contains(e.target)?(n.props.store.rootStore.pm.focus(),null):n.props.store.isShow?void(n.props.clickOutSide&&n.props.clickOutSide()):null},n.handleChange=function(e){var t=n.state.activeKey,r=e.filter(function(e){return-1===t.indexOf(e)});n.setState({activeKey:r})},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tl(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props.docData;this.setState({activeKey:e.map(function(e){return e.key})}),document.addEventListener("click",this.clickOutSide,!1)}},{key:"render",value:function(){var e=this.props,t=e.docData,n=e.store,r=e.extra,o=E()({"ct-editor-doc":!0,hide:!n.isShow});return i.a.createElement("div",{className:o},i.a.createElement(Gs.a,{title:"\u5feb\u6377\u952e",extra:r,className:"ct-editor-doc-card"},i.a.createElement("div",null,i.a.createElement(Xs.a,{bordered:!1,activeKey:this.state.activeKey,disabled:!0,forceRender:!0},t.map(function(e){return i.a.createElement(al,{header:e.header,key:e.key},e.children.map(function(e){return i.a.createElement(Ys,{data:e,key:e.keymap})}))})))))}}])&&Zs(n.prototype,r),o&&Zs(n,o),t}())||Ws)||Ws;function cl(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function sl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ll(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var ul=(rl=ll((nl=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),cl(this,"isShow",rl,this),this.docElContaiener=null,cl(this,"toggleShow",ol,this),this.rootStore=t,this.disposeToggleShow=Object(O.autorun)(function(){n.handleShowChange(n.isShow)})}var t,n,r;return t=e,(n=[{key:"handleShowChange",value:function(e){var t=this;if(e&&!this.docElContaiener){this.docElContaiener=document.createElement("div"),document.querySelector(".ct-edit-page").appendChild(this.docElContaiener);var n=function(){return t.toggleShow(!1)},r=i.a.createElement(l.Provider,{store:this},i.a.createElement(il,{docData:Ks,clickOutSide:n,extra:i.a.createElement(Ns.a,{type:"close",onClick:n})}));s.a.render(r,this.docElContaiener)}}}])&&sl(t.prototype,n),r&&sl(t,r),e}()).prototype,"isShow",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ol=ll(nl.prototype,"toggleShow",[O.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isShow="boolean"===typeof t?t:!e.isShow,e.rootStore.update()}}}),nl);n("../client/src/editor/modules/keymapDoc/style.styl");var pl=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="keymapDoc",this.store=new ul(n)};pl.moduleName="keymapDoc";var fl=n("../client/src/editor/modules/notsupport/index.js"),dl=n("../client/src/editor/modules/pageTree/Tree/index.js");function ml(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hl,yl=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=t,this.view=n,this.getPos=r;var a=this.node.attrs,c=a.spaceId,l=a.pageId,u=a.maxDepth,p=document.createElement("div");p.className="ct-page-tree",s.a.render(i.a.createElement(dl.a,{spaceId:c,pageId:"self"===l?o.config.pageId:l,maxDepth:parseInt(u,10),onClick:function(){}}),p),this.dom=p}var t,n,r;return t=e,(n=[{key:"update",value:function(e){var t=this;return!Object.keys(e.attrs).some(function(n){return e.attrs[n]!==t.node.attrs[n]})}}])&&ml(t.prototype,n),r&&ml(t,r),e}(),bl=(n("./antd/lib/button/style/index.js"),n("./antd/lib/button/index.js")),vl=n.n(bl),gl=(n("./antd/lib/select/style/index.js"),n("./antd/lib/select/index.js")),wl=n.n(gl),jl=n("../client/src/components/Modal/MoveDocModal/SelectDocPosition/SelectSpace/index.js"),Ol=n("../client/src/components/Modal/MoveDocModal/SelectDocPosition/SelectPage/index.js");n("../client/src/editor/modules/pageTree/Modal/style.styl");function Sl(e){return(Sl="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function El(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Pl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?El(n,!0).forEach(function(t){kl(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):El(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function kl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cl(e,t){return!t||"object"!==Sl(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tl(e){return(Tl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Il(e,t){return(Il=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Al,Dl=wl.a.Option,Nl=Object(l.inject)("store")(hl=Object(l.observer)(hl=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Cl(this,Tl(t).call(this,e))).getMySpace=function(){var e=b.b.space,t=b.b.user.spaceId;t&&e.getSpaceDataWithNoAuth(t).then(function(e){var r=e.spaceName,o=e.headImg,a=Pl({},e,{spaceId:t,name:r,headImg:o,spaceType:"myspace"});n.isMount&&n.setState({mySpace:a})}).catch(function(e){console.error(e)})},n.getStarredSpace=function(){Object(Ka.c)("/api/collection/collection",{query:{collectionType:0,contentTypes:1}}).then(function(e){var t=e.contentVOList.map(function(e){return Pl({},e,{spaceId:e.contentKey,name:e.title,headImg:e.headImg})});n.isMount&&n.setState({starredSpace:t})}).catch(function(e){console.error(e)})},n.handleSearchInput=function(e,t){e.persist();var r=e.target.value.trim();r?(n.setState({hasSearch:!0,searchKey:r,searchRes:[],searchState:Ec.t.PENDING}),t?n.search(r):n.searchDebounce(r)):n.clearSearch()},n.search=function(e){var t=n.props.store.core.pageTreeStore.spaceId,r=n.state.moveType,o=b.b.search,a=o.searchSpaceByName,i=o.searchDocPath;0===r?a(e).then(function(t){if(e===n.state.searchKey&&r===n.state.moveType){var o=t.models.map(function(e){return Pl({},e,{spaceId:e.spaceId,spanName:e.spaceName,name:e.spaceName.replace(/<span class='highlight'>/g,"").replace(/<\/span>/g,""),headImg:e.headImg})});n.setState({searchRes:o,searchState:Ec.t.DONE})}}).catch(function(t){e===n.state.searchKey&&r===n.state.moveType&&n.setState({searchState:Ec.t.ERROR}),console.error(t)}):i(t,e).then(function(t){if(e===n.state.searchKey&&r===n.state.moveType){var o=t.contentTitleVOS.map(function(e){return{pageId:e.contentId,title:e.title,parentPath:e.parentPath}});n.setState({searchRes:o,searchState:Ec.t.DONE})}}).catch(function(t){e===n.state.searchKey&&r===n.state.moveType&&n.setState({searchState:Ec.t.ERROR}),console.error(t)})},n.clearSearch=function(){n.setState({hasSearch:!1,searchKey:"",searchRes:[]})},n.handleStep=function(e){var t=n.props.store.core.pageTreeStore,r=n.state,o=r.moveType,a=r.mySpace;1!==o||a||(n.getMySpace(),n.getStarredSpace()),t.setAttr("pageId",0),t.setState("selectedPath",[e.name]),n.setState({moveType:1===o?0:1,hasSearch:!1,searchKey:"",selectedPath:[e.name]})},n.handleOk=function(){var e=n.props.store.core,t=e.pageTreeCommands,r=e.pageTreeStore,o=r.pos,a=r.spaceId,i=r.pageId,c=r.maxDepth,s=i===b.b.doc.currentPageId?"self":i;if(a||i){var l={spaceId:s?"":a,pageId:s||"",maxDepth:c||0};o?t.updateAttrs(o,l):t.insert(l),n.handleCancel()}else m.a.error("\u8bf7\u9009\u62e9\u6839\u76ee\u5f55\u6587\u6863")},n.handleCancel=function(){n.props.store.core.pageTreeStore.closeModal(),n.setState({moveType:1,hasSearch:!1,searchKey:"",searchState:Ec.t.DONE,mySpace:null,starredSpace:[],searchRes:[]})},n.selectSpace=function(e){var t=n.props.store.core.pageTreeStore,r=e.selectedSpaceId,o=e.selectedSpace,a=e.selectedPath;t.setAttr("spaceId",r),t.setState({selectedSpace:o,selectedPath:a}),n.setState({selectedTitle:a[a.length-1]}),n.handleStep(o)},n.selectPage=function(e){var t=n.props.store.core.pageTreeStore,r=e.selectedPageId,o=e.selectedPath;t.setAttr("pageId",r),n.setState({selectedTitle:o[o.length-1]}),t.setState({selectedPath:o})},n.state={moveType:1,hasSearch:!1,searchKey:"",searchState:Ec.t.DONE,mySpace:null,starredSpace:[],searchRes:[],selectedTitle:null},n.isVisible=!1,n.isMount=!0,n.searchDebounce=wc()(n.search,1e3),n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Il(e,t)}(t,a["Component"]),n=t,(r=[{key:"componentWillUnmount",value:function(){this.isMount=!1}},{key:"render",value:function(){var e=this,t=this.props.store,n=t.core.pageTreeStore;t.count;if(!n||!n.isShowModal)return null;var r=n.spaceId,o=n.pageId,a=n.maxDepth,c=n.newCreatePageTitle,s=n.state,l=s.selectedSpace,u=s.currentSpace,p=this.state,f=p.moveType,d=p.hasSearch,m=p.searchKey,h=p.searchRes,y=p.mySpace,b=p.starredSpace,v=p.selectedTitle||c;return i.a.createElement(jc.a,{visible:!0,className:"ct-page-tree-modal",title:"\u76ee\u5f55\u6811",onCancel:this.handleCancel,footer:null},i.a.createElement("div",{className:"ct-page-tree-container"},i.a.createElement("div",{className:"ct-page-tree-tips"},"\u8bf7\u9009\u62e9\u76ee\u5f55\uff0c\u786e\u5b9a\u540e\u5c06\u4f5c\u4e3a\u6839\u76ee\u5f55\u5c55\u793a\u5728\u6587\u6863\u4e2d\u3002"),i.a.createElement("div",{className:"ct-page-tree-sub-tips"},i.a.createElement("div",{className:"sub-tips-selected"},i.a.createElement("span",null,"\u5df2\u9009\u76ee\u5f55\u6811:"),i.a.createElement("span",null,v)),i.a.createElement("div",{className:"sub-tips-level"},i.a.createElement("span",null,"\u76ee\u5f55\u6811\u663e\u793a\u5c42\u7ea7:"),i.a.createElement(wl.a,{size:"small",value:parseInt(a,10)||0,dropdownStyle:{height:"200px"},onChange:function(e){n.setAttr("maxDepth",e)}},i.a.createElement(Dl,{value:0,key:0},"\u4e0d\u9650"),[1,2,3,4,5].map(function(e){return i.a.createElement(Dl,{value:e,key:e},e)})))),i.a.createElement("div",{className:"ct-content-wrap"},i.a.createElement(Oc.a,{placeholder:f?"\u8f93\u5165\u672c\u7a7a\u95f4\u5185\u6587\u6863\u540d\u79f0\u8fdb\u884c\u641c\u7d22":"\u8bf7\u8f93\u5165\u7a7a\u95f4\u540d\u79f0",value:m,onChange:this.handleSearchInput,onKeyUp:function(t){13===t.keyCode&&e.handleSearchInput(t,!0)},onClear:this.clearSearch}),1!==f||l?null:i.a.createElement("div",{className:"move-content-body"},i.a.createElement("span",{className:"loading"}),i.a.createElement("span",{className:"loading-text"},"\u52a0\u8f7d\u4e2d")),1===f&&l?i.a.createElement(Ol.a,{hasSearch:d,selectedSpaceId:r,selectedPageId:o||0,selectedSpace:l,searchKey:m,searchRes:h,selectPage:this.selectPage}):null,0===f?i.a.createElement(jl.a,{hasSearch:d,selectedSpaceId:r,selectedSpace:l,currentSpace:u,mySpace:y,starredSpace:b,searchRes:h,selectSpace:this.selectSpace}):null),i.a.createElement("div",{className:"ct-page-tree-footer"},i.a.createElement("div",{className:"ct-page-tree-footer-left"},f?i.a.createElement(vl.a,{onClick:this.handleStep},"\u5176\u4ed6\u7a7a\u95f4"):i.a.createElement(vl.a,{onClick:this.handleStep},"\u4e0a\u4e00\u6b65")),i.a.createElement(vl.a,{onClick:this.handleCancel},"\u53d6\u6d88"),f?i.a.createElement(vl.a,{type:"primary",onClick:this.handleOk},"\u786e\u5b9a"):null)))}}])&&xl(n.prototype,r),o&&xl(n,o),t}())||hl)||hl;n("../client/src/editor/modules/pageTree/Popover/style.styl");function Ml(e){return(Ml="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bl(e,t,n){return t&&Ll(e.prototype,t),n&&Ll(e,n),e}function Rl(e,t){return!t||"object"!==Ml(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vl(e){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hl(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zl(e,t)}function zl(e,t){return(zl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wl=45,Fl=function(e){function t(){var e,n;_l(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Rl(this,(e=Vl(t)).call.apply(e,[this].concat(o)))).state={hasTooltip:!1},n}return Hl(t,a["Component"]),Bl(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.icon,r=t.tip,o=t.onClick;return i.a.createElement("div",{className:"menu-item",onMouseEnter:function(){return e.setState({hasTooltip:!0})},onMouseLeave:function(){return e.setState({hasTooltip:!1})},onClick:o,style:{marginTop:"5px",marginLeft:"5px"}},n,this.state.hasTooltip&&i.a.createElement("span",{className:"ct-toolbar-tooltip"},r))}}]),t}(),Ul=function(e){function t(){var e,n;_l(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Rl(this,(e=Vl(t)).call.apply(e,[this].concat(o)))).onGlobalClick=function(e){var t=n.props.store.core.pageTreeStore;if(t.isShowPopover){Object(ai.c)(e.target,function(e){return e===t.domNode})||t.closePopover()}},n.handleEdit=function(){var e=n.props.store.core.pageTreeStore,t=e.node;t&&t.attrs&&e.showModal(t.attrs)},n}return Hl(t,a["Component"]),Bl(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){var t=e.props.store,n=document.getElementById(t.config.pageWrapperId);document.addEventListener("click",e.onGlobalClick),n&&n.addEventListener("scroll",e.props.store.core.pageTreeStore.closePopover)},10)}},{key:"componentWillUnmount",value:function(){var e=this.props.store,t=document.getElementById(e.config.pageWrapperId);document.removeEventListener("click",this.onGlobalClick),t&&t.removeEventListener("scroll",this.props.store.core.pageTreeStore.closePopover)}},{key:"render",value:function(){var e=function(e){var t=Wl,n=e.getBoundingClientRect();return{top:n.top-t,left:n.left}}(this.props.store.core.pageTreeStore.domNode);return i.a.createElement("div",{className:"page-tree-popover",style:e},i.a.createElement(Fl,{tip:"\u7f16\u8f91",icon:i.a.createElement(vc.a,null),onClick:this.handleEdit}))}}]),t}(),Kl=Object(l.inject)("store")(Al=Object(l.observer)(Al=function(e){function t(){return _l(this,t),Rl(this,Vl(t).apply(this,arguments))}return Hl(t,i.a.Component),Bl(t,[{key:"render",value:function(){var e=this.props.store,t=e.core.pageTreeStore;e.count;return t&&t.isShowPopover?i.a.createElement(Ul,{store:this.props.store}):null}}]),t}())||Al)||Al;function ql(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gl(e){var t=new Ua.PluginKey("pageTree");return new Ua.Plugin({key:t,props:{handleClick:function(t){var n=e.state,r=e.core.pageTreeStore,o=e.update,a=n.selection,i=n.schema.nodes.page_tree;if(a instanceof Ua.NodeSelection&&a.node.type===i){var c=t.dom.querySelector(".ProseMirror-selectednode");r.showPopover(c,a.node,a.from);var s=Ua.NodeSelection.create(t.state.doc,a.from);t.dispatch(t.state.tr.setSelection(s)),o()}return!1},handleDoubleClick:function(){var t=e.state,n=e.core.pageTreeStore,r=t.selection,o=t.schema.nodes.page_tree;return r instanceof Ua.NodeSelection&&r.node.type===o&&(n.setPos(r.from),n.setNode(r.node),n.showModal(r.node.attrs),!0)},nodeViews:{page_tree:function(t,n,r){return new yl(t,n,r,e)}}},view:function(){return new mu(e)}})}var Ql,Xl,Yl,Jl,Zl,$l,eu,tu,nu,ru,ou,au,iu,cu,su,lu,uu,pu,fu,du,mu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.$node=document.createElement("div");var n=document.getElementById(t.editorId);n&&n.appendChild(this.$node),s.a.render(i.a.createElement(l.Provider,{store:this.store},i.a.createElement("div",null,i.a.createElement(Nl,null),i.a.createElement(Kl,null))),this.$node)}var t,n,r;return t=e,(n=[{key:"update",value:function(e){var t=this.store.core.pageTreeStore,n=e.state.selection.node;n&&"page_tree"===n.type.name||t.closePopover()}},{key:"unMountNode",value:function(){try{s.a.unmountComponentAtNode(this.$node)}catch(e){console.log(e)}}},{key:"destroy",value:function(){this.unMountNode(),this.$node.remove()}}])&&ql(t.prototype,n),r&&ql(t,r),e}(),hu={nodes:{page_tree:{group:"block",content:"text*",atom:!0,allowGapCursor:!0,insertBlock:!0,dragBlock:!0,draggable:!0,braceWidth:200,attrs:{spaceId:"",pageId:"",maxDepth:0},parseDOM:[{tag:'div[class="ct-page-tree"]',preserveWhitespace:"full",getAttrs:function(e){return{spaceId:e.getAttribute("data-space-id")||"",pageId:e.getAttribute("data-page-id")||"",maxDepth:e.getAttribute("data-max-depth")||0}}}],toDOM:function(e){var t=e.attrs;return["div",{class:"ct-page-tree","data-space-id":t.spaceId,"data-page-id":t.pageId,"data-max-depth":t.maxDepth,contenteditable:!1},0]}}}};function yu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yu(n,!0).forEach(function(t){vu(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yu(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gu(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function wu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ju(e,t,n,r,o){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var Ou=/\/create\/page\/(\d+)\/(\d+)/,Su=/\/page\/(\d+)/,Eu=/\/create\/.+\/template/,Pu=(Ql=O.action.bound,Xl=O.action.bound,Yl=O.action.bound,Jl=O.action.bound,Zl=O.action.bound,$l=O.action.bound,eu=O.action.bound,tu=O.action.bound,ru=ju((nu=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),gu(this,"isShowModal",ru,this),gu(this,"newCreatePageTitle",ou,this),gu(this,"isShowPopover",au,this),gu(this,"domNode",iu,this),gu(this,"node",cu,this),gu(this,"pos",su,this),gu(this,"spaceId",lu,this),gu(this,"pageId",uu,this),gu(this,"maxDepth",pu,this),gu(this,"sequenceId",fu,this),gu(this,"state",du,this),this.getCurrentPath=function(e,t){var r=n.sequenceId;if(t){var o=Ou.test(location.pathname)&&+t===+b.b.doc.newContentId,a=o?location.pathname.match(Ou)[2]:t;Object(Ka.c)("/api/pages/catelog/".concat(a)).then(function(t){if(r===n.sequenceId){var a=[e.name];if(t.forEach(function e(t){t.children&&(a.push(t.content.title),t.children.forEach(e))}),o){var i=document.querySelector(".ct-title-input").value;a.push(i)}n.setState({selectedPath:a})}}).catch(function(e){console.error(e)})}else{var i=[e.name];n.setState({selectedPath:i})}},this.getCurrentSpace=function(e,t){var r=b.b.space,o=n.sequenceId;r.getSpaceDataWithNoAuth(e).then(function(r){if(o===n.sequenceId){var a=r.spaceName,i=r.headImg,c=bu({},r,{spaceId:e,name:a,headImg:i,spaceType:"current"});n.getCurrentPath(c,t),n.setState({currentSpace:c,selectedSpace:c})}}).catch(function(e){console.error(e)})},this.editorStore=t}var t,n,r;return t=e,(n=[{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.spaceId=t.spaceId||"",this.pageId="self"===t.pageId?this.editorStore.config.pageId:t.pageId,this.maxDepth=t.maxDepth||0,this.sequenceId+=1,this.state={selectedPath:[],selectedSpace:null,currentSpace:null};var n=Ou.test(location.pathname),r=Eu.test(location.pathname);if(this.spaceId||this.pageId||(n?(this.spaceId=location.pathname.match(Ou)[1],this.pageId=b.b.doc.newContentId):r?this.spaceId=b.b.user.spaceId:(this.pageId=Su.test(location.pathname)?location.pathname.match(Su)[1]:"",b.b.doc.page.parentId===Ec.q&&(this.spaceId=b.b.doc.page.spaceId,this.pageId=""))),n)this.spaceId=this.spaceId||location.pathname.match(Ou)[1],this.newCreatePageTitle=(document.querySelector(".ct-title-input")||{}).value,this.getCurrentSpace(this.spaceId,this.pageId);else{var o=this.spaceId?Promise.resolve(this.spaceId):Object(Ka.c)("/api/pages/".concat(this.pageId,"/spaceId"));o.then(function(t){e.spaceId=t,e.getCurrentSpace(e.spaceId,e.pageId)}).catch(function(){})}this.isShowModal=!0}},{key:"closeModal",value:function(){this.isShowModal=!1}},{key:"showPopover",value:function(e,t,n){this.domNode=e,this.node=t,this.setPos(n),this.isShowPopover=!0}},{key:"closePopover",value:function(){this.domNode=null,this.node=null,this.isShowPopover=!1,this.isShowModal||this.setPos(null)}},{key:"setPos",value:function(e){this.pos=e}},{key:"setNode",value:function(e){this.node=e}},{key:"setAttr",value:function(e,t){this[e]=t}},{key:"setState",value:function(e){this.state=bu({},this.state,{},e)}}])&&wu(t.prototype,n),r&&wu(t,r),e}()).prototype,"isShowModal",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ou=ju(nu.prototype,"newCreatePageTitle",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\u65e0\u6807\u9898"}}),au=ju(nu.prototype,"isShowPopover",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),iu=ju(nu.prototype,"domNode",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cu=ju(nu.prototype,"node",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),su=ju(nu.prototype,"pos",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lu=ju(nu.prototype,"spaceId",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),uu=ju(nu.prototype,"pageId",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),pu=ju(nu.prototype,"maxDepth",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),fu=ju(nu.prototype,"sequenceId",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),du=ju(nu.prototype,"state",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{selectedPath:[],selectedSpace:null,currentSpace:null}}}),ju(nu.prototype,"showModal",[Ql],Object.getOwnPropertyDescriptor(nu.prototype,"showModal"),nu.prototype),ju(nu.prototype,"closeModal",[Xl],Object.getOwnPropertyDescriptor(nu.prototype,"closeModal"),nu.prototype),ju(nu.prototype,"showPopover",[Yl],Object.getOwnPropertyDescriptor(nu.prototype,"showPopover"),nu.prototype),ju(nu.prototype,"closePopover",[Jl],Object.getOwnPropertyDescriptor(nu.prototype,"closePopover"),nu.prototype),ju(nu.prototype,"setPos",[Zl],Object.getOwnPropertyDescriptor(nu.prototype,"setPos"),nu.prototype),ju(nu.prototype,"setNode",[$l],Object.getOwnPropertyDescriptor(nu.prototype,"setNode"),nu.prototype),ju(nu.prototype,"setAttr",[eu],Object.getOwnPropertyDescriptor(nu.prototype,"setAttr"),nu.prototype),ju(nu.prototype,"setState",[tu],Object.getOwnPropertyDescriptor(nu.prototype,"setState"),nu.prototype),nu);function ku(e){return function(t,n,r,o){var a=t.schema.nodes.page_tree.create(e),i=Object(ai.i)(t,a).transaction;return!!i&&(n(i.scrollIntoView()),"function"===typeof o&&o("afterInsert",{draggable:!0,braceWidth:200}),!0)}}function xu(e,t){return function(n,r){var o=n.tr,a=n.schema.nodes.page_tree;return r(o.setNodeMarkup(e,a,t).scrollIntoView()),!0}}n("../client/src/editor/modules/pageTree/style.styl"),n("../client/src/editor/modules/pageTree/view/index.js");var Cu=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="pageTree",this.schema=hu,this.store=new Pu(n),this.plugins=[Gl(n)],this.commands={insert:ku,updateAttrs:xu}};Cu.moduleName="pageTree",Cu.pluginName="pageTree",Cu.components=[Nl,Kl];var Tu=n("../client/src/editor/modules/react/index.js"),Iu=n("../client/src/editor/modules/time/index.js"),Au={nodes:{include:{group:"block",atom:!0,draggable:!1,allowGapCursor:!0,attrs:{source:{default:""},contentId:{default:""},src:{default:""}},parseDOM:[{tag:'div[class="ct-include"]',getAttrs:function(e){return{src:e.getAttribute("data-src")||"",source:e.getAttribute("data-source")||"",contentId:e.getAttribute("data-contentid")||""}}}],toDOM:function(e){var t=e.attrs,n=t.source,r=t.contentId;return["div",{class:"ct-include","data-src":t.src,"data-source":n,"data-contentid":r},["p",{},"\u4e0d\u652f\u6301\u5c55\u793a\u7684include\u5b8f\uff0c\u5efa\u8bae\u60a8\u524d\u5f80\u6e90\u6587\u6863\u67e5\u770b\u8be5\u5185\u5bb9"]]}}}};n("../client/src/editor/modules/include/style.styl");var Du=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="include",this.schema=Au};Du.pluginName="include";var Nu={nodes:{video:{group:"block",atom:!0,draggable:!0,dragBlock:!0,insertBlock:!0,alignBlock:!0,allowGapCursor:!0,braceWidth:540,attrs:{url:{default:""},size:{default:""},name:{default:""},width:{default:0},height:{default:0},align:{default:"left"},dataDiffId:{default:null}},parseDOM:[{tag:'div[class~="ct-video"]',getAttrs:function(e){var t="left";return e.className.includes("center")?t="center":e.className.includes("right")&&(t="right"),{url:e.getAttribute("data-url"),name:e.getAttribute("data-name"),size:e.getAttribute("data-size"),width:e.getAttribute("data-width")||0,height:e.getAttribute("data-height")||0,align:t,dataDiffId:e.getAttribute("data-diff-id")}}}],toDOM:function(e){var t=e.attrs,n=t.url,r=t.name,o=t.size,a=t.width,i=t.height,c=t.align,s={class:"ct-video","data-url":n,"data-name":r,"data-size":o,"data-width":a,"data-height":i,"data-diff-id":t.dataDiffId||"ct-diff-id-".concat(Object(x.J)())};"center"===c?s.class+=" align-center":"right"===c&&(s.class+=" align-right");return["div",s,["video",{controls:!1,preload:"meta"},"\u672c\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 HTML5 video \u6807\u7b7e"]]}}}};function Mu(e){return(Mu="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _u(){return(_u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Lu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bu(e,t){return!t||"object"!==Mu(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ru(e){return(Ru=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vu(e,t){return(Vu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hu=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bu(this,Ru(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vu(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",_u({width:"24",height:"20",viewBox:"0 0 24 20",xmlns:"http://www.w3.org/2000/svg"},this.props),i.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},i.a.createElement("g",{id:"Artboard-3",transform:"translate(-86 -30)",fill:"#BDC2C7"},i.a.createElement("g",{id:"Group-3",transform:"translate(86 30)"},i.a.createElement("path",{d:"M1 0h22a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1zm1 2v16h20V2H2z",id:"Combined-Shape"}),i.a.createElement("path",{d:"M4 6H2V4h2V2h2v16H4v-2H2v-2h2v-3H2V9h2V6zm16 5v3h2v2h-2v2h-2V2h2v2h2v2h-2v3h2v2h-2zM9.8 5.56l5.63 4.03a.5.5 0 0 1 0 .82l-5.64 4.03a.5.5 0 0 1-.79-.41V5.97a.5.5 0 0 1 .8-.4z",id:"Combined-Shape"})))))}}])&&Lu(n.prototype,r),o&&Lu(n,o),t}();n("../client/src/editor/modules/video/ProgressBar/style.styl");function zu(e){return(zu="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fu(e,t){return!t||"object"!==zu(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uu(e){return(Uu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ku(e,t){return(Ku=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qu=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Fu(this,Uu(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ku(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.data,n=e.reupload,r=t.name,o=void 0===r?"\u672a\u547d\u540d":r,a=t.total,c=t.loaded,s=t.size,l=t.done,u=t.transcoding,p=a?"".concat((c/a*100).toFixed(2),"%"):"0%",f=c===a;return i.a.createElement("div",{className:"ct-upload-video"},i.a.createElement("div",{className:"icon"},i.a.createElement(Hu,null)),i.a.createElement("div",{className:"name"},o),!n&&i.a.createElement("div",{className:"info"},i.a.createElement("span",{className:"size"},Object(ai.b)(c)," / ",Object(ai.b)(a||s)),!!l&&i.a.createElement("span",{className:"percent"},f&&a?"99%":p)),!n&&i.a.createElement("div",{className:"progress-container"},!l&&i.a.createElement("span",{className:"progress-wrapper"},i.a.createElement("span",{className:"progress",style:{width:p}}))),!l&&u&&i.a.createElement("div",{className:"name"},"\u89c6\u9891\u6b63\u5728\u8f6c\u7801\u4e2d\uff0c\u5982\u6587\u4ef6\u8f83\u5927\u53ef\u80fd\u65f6\u95f4\u8f83\u957f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u2026"),n&&i.a.createElement("div",{className:"reupload"},i.a.createElement("span",null,i.a.createElement(di.a,null),"\u4e0a\u4f20\u5931\u8d25\uff0c"),i.a.createElement("a",{onClick:n},"\u91cd\u8bd5")))}}])&&Wu(n.prototype,r),o&&Wu(n,o),t}();var Gu=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map={},this.isClickOn=!1,this.createPlaceholder=function(e,t){n.rootStore.core.trigger("afterInsert",{braceWidth:540});var r=n.rootStore,o=r.state,a=r.view,c=r.dispatch,l=o.tr,u=o.doc;l.selection.empty||l.deleteSelection();var p=o.config.pluginsByKey.video$,f=l.selection.$to,d=f.nodeBefore,m=f.nodeAfter,h=f.pos;d&&!m&&u.content.size>h&&(h+=1);var y=!d&&!m;l.setMeta(p,{add:{key:e,pos:h}}).insertText("\u200b",h).setSelection(Ua.TextSelection.create(l.doc,h+1)),c(l.scrollIntoView()),a.focus();var b=Object(ai.e)(p.getState(a.state),e);if(b){var v=b.node,g={src:"",size:t.size,name:t.name,total:100,loaded:0,done:!1};n.map[e]={node:v,isBlankLine:y,file:t},s.a.render(i.a.createElement(qu,{readOnly:!1,data:g,removeNode:function(){}}),v)}else console.warn("the progress node may be deleted")},this.beforeUpload=function(e){var t=e.file,r=oi()();return n.createPlaceholder(r,t),r},this.onProgress=function(e,t){var r=e.key,o=e.file,a={src:"",size:o.size,name:o.name,total:t.total,loaded:t.loaded,done:!1};s.a.render(i.a.createElement(qu,{readOnly:!1,data:a,removeNode:function(){}}),n.map[r].node)},this.finishUpload=function(e){var t=e.res,r=e.file,o=e.size,a=e.key;if(t.data&&1!==t.status){var i=t.data.jobId,c=function(e){var t={url:Object(ai.g)(e.url,1),size:Object(ai.b)(o),name:r.name},i=n.rootStore,c=i.state,s=i.dispatch,l=c.tr,u=c.config.pluginsByKey.video$,p=Object(ai.e)(u.getState(c),a);if(p){var f=p.pos,d=f;n.map[a].isBlankLine&&(d-=1),l.replaceWith(d,f+1,c.schema.nodes.video.create(t)).setMeta(u,{remove:{key:a}}),s(l),delete n.map[a]}};i?n.getJobDetail(i,a,c,r):c(t.data)}else n.errorHandle(t,a)},this.getJobDetail=function(e,t,r,o){var a=o.name.split(".").reverse().slice(1).reverse().join("."),c=n.rootStore.config,l=c.pageId,u=c.isTemplate;Object(Ka.c)("/api/file/jobDetail",{query:{jobId:e,contentId:l,type:u?1:0,filename:a}}).then(function(c){var l=c.transcodeStatus;return 0===l?r(c):(1===l&&s.a.render(i.a.createElement(qu,{readOnly:!1,data:{name:a,src:"",size:o.size,total:o.size,loaded:o.size,done:!1,transcoding:!0},removeNode:function(){}}),n.map[t].node),3===l||4===l?n.errorHandle({status:9},t):void setTimeout(function(){n.getJobDetail(e,t,r,o)},300))}).catch(function(e){return n.errorHandle(e,t)})},this.errorHandle=function(e,t){n.rootStore.view.dom.parentElement&&(401===e.status||"auth failed"===e.message?m.a.error("\u4e0a\u4f20\u5931\u8d25\uff0c\u767b\u5f55\u4fe1\u606f\u5931\u6548"):9===e.status?m.a.error("\u8f6c\u7801\u5931\u8d25\uff0c\u8bf7\u8c03\u6574\u683c\u5f0f"):window.navigator.onLine?m.a.error("\u4e0a\u4f20\u5931\u8d25"):m.a.error("\u7f51\u7edc\u5f02\u5e38"),console.error("error message: ",e),n.reupload(t))},this.reupload=function(e){var t=n.map[e];if(t){var r=t.node,o=t.file,a={src:"",size:o.size,name:o.name,total:100,loaded:0,done:!1};s.a.render(i.a.createElement(qu,{readOnly:!1,data:a,removeNode:function(){},reupload:function(){var t=n.rootStore.config.url.media,r={onProgress:n.onProgress,finishUpload:n.finishUpload,errorHandle:n.errorHandle};Object(ai.m)(o,e,t,r)}}),r)}},this.onMousDown=function(e){var t=e.target.classList;if(t.contains("resizer"))if(n.$imageInfo){e.preventDefault();var r=t.contains("resizer-lt"),o=t.contains("resizer-lb"),a=t.contains("resizer-rt"),i=t.contains("resizer-rb"),c=a||i;r?n.$imageInfo.className="info info-lt":o?n.$imageInfo.className="info info-lb":a?n.$imageInfo.className="info info-rt":i&&(n.$imageInfo.className="info info-rb");var s=n.node.dom.parentElement.parentElement;if(s){var l=s.clientWidth-h.m;s.classList.contains("ProseMirror")&&(l-=60),n.resizer={maxWidth:l,isAdd:c,isResizing:!1,startX:e.clientX,startY:e.clientY,originalWidth:n.node.dom.clientWidth,originalHeight:n.node.dom.clientHeight}}}else n.hideHelper()},this.onMouseMove=function(e){if(n.resizer){var t=n.resizer,r=t.isAdd,o=t.startX,a=t.startY,i=t.originalWidth,c=t.originalHeight,s=t.maxWidth,l=Object(x.d)(i,e.clientX-o,r,s,h.l),u=Object(x.d)(c,e.clientY-a,r,1/0,h.k);n.resizer.width=l,n.resizer.height=u,n.node.dom.style.width="".concat(l,"px"),n.node.dom.style.height="".concat(u,"px");var p=n.node.dom.querySelector(".progress-bar");p&&(p.style="overflow: hidden;"),n.toggleDisplayOfImageInfo(),n.resizer.isResizing=!0}},this.onMouseUp=function(){if(n.resizer)if(n.resizer.isResizing){var e=n.resizer,t=e.isResizing,r=e.width;t&&r&&(n.resizer.isResizing=!1,n.updateAttrs({width:n.node.dom.clientWidth+2,height:n.node.dom.clientHeight+2}))}else n.resizer=null},this.toggleDisplayOfImageInfo=function(){var e=n.node.dom.clientWidth,t=n.node.dom.clientHeight;e<h.j||t<h.j?n.$imageInfo.style.display="none":(n.$imageInfo.style.display="block",n.$imageInfo.textContent="".concat(e," \xd7 ").concat(t))},this.reShowHelper=function(){n.node&&n.showHelper(n.node)},this.showHelper=function(e){n.hideHelper(),n.node=e;var t=n.node.dom,r=function(e){var t=document.createElement("div");return t.className="ct-image-editor",t.innerHTML='\n      <span class="resizer resizer-lt"></span>\n      <span class="resizer resizer-lb"></span>\n      <span class="resizer resizer-rt"></span>\n      <span class="resizer resizer-rb"></span>\n      <span class="info info-rb"></span>\n    ',t.addEventListener("mousedown",e,!1),t}(n.onMousDown);t.appendChild(r),n.$imageInfo=r.querySelector(".info"),n.toggleDisplayOfImageInfo()},this.hideHelper=function(){if(n.$imageInfo){var e=document.querySelector(".ct-image-editor");e&&e.parentElement.removeChild(e),n.onMouseUp(),n.node=null,n.resizer=null,n.$imageInfo=null}},this.updateAttrs=function(e){var t=n.rootStore,r=t.state,o=t.dispatch,a=t.view,i=r.tr,c=r.doc,s=r.schema.nodes.video,l=Object.assign({},n.node.attrs,e),u=n.node.pos,p=Ua.NodeSelection.create(c,u);o(i.setNodeMarkup(u,s,l).setSelection(p));var f=a.docView.domAfterPos(u).firstChild;f&&n.showHelper({dom:f,attrs:l,pos:u})},this.rootStore=t,window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1)},Qu=n("../client/src/editor/modules/video/Video/index.js");function Xu(){return(Xu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Yu=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=t,this.view=n,this.getPos=r,this.store=o,this.dom=document.createElement("div");var a="ct-video";"center"===t.attrs.align?a+=" align-center":"right"===t.attrs.align&&(a+=" align-right"),this.dom.className=a;var c=t.attrs,l=c.width,u=c.height;l=+l<512?512:l,u=+u<288?288:u,s.a.render(i.a.createElement(Qu.a,Xu({},t.attrs,{width:l,height:u,parent:this.dom,store:o,downloadInNewTable:!0})),this.dom)};var Ju=new Ua.PluginKey("video");function Zu(e){return[new Ua.Plugin({key:Ju,state:{init:function(){return ji.DecorationSet.empty},apply:function(e,t){t=t.map(e.mapping,e.doc);var n=e.getMeta(this);if(n&&n.add){var r=n.add,o=r.pos,a=r.key,i=function(){var e=document.createElement("div");return e.style.outline="none",e.setAttribute("data-type","ct-progress"),e}(),c=ji.Decoration.widget(o,i,{key:a});t=t.add(e.doc,[c])}else n&&n.remove&&(t=t.remove(t.find(null,null,function(e){return e.key===n.remove.key})));return t}},props:{decorations:function(e){return this.getState(e)},nodeViews:{video:function(t,n,r){return new Yu(t,n,r,e)}},handleDOMEvents:{drop:function(){e.hideHelper()}},handleClickOn:function(t,n,r,o,a){if("video"===r.type.name){var i=t.state,c=t.dispatch,s=Ua.NodeSelection.create(i.doc,o);c(i.tr.setSelection(s));var l=a.target.closest(".ct-video-view");e.showHelper({dom:l,attrs:r.attrs,pos:o}),e.isClickOn=!0}return!1},handleClick:function(){e.isClickOn||e.hideHelper(),e.isClickOn=!1},handleKeyDown:function(t,n){return!n.metaKey&&!n.ctrlKey&&(e.hideHelper(),!1)}}})]}function $u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ep=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="video",this.schema=Nu,this.store=new Gu(n),this.plugins=$u(Zu(this.store))};ep.moduleName="video";var tp=n("../client/src/mobile/components/CommonUI/Loading/index.js"),np=n("../client/src/editor/modules/data2chart/chart.js");function rp(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function op(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function ap(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ip=function(){function e(t,n,r,o){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init=function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var n,r,o,c,l,u,p,f,d,m,h,y,b,v,g,w,j,O,S;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.chartData,o=t.config,c=t.pageId,l=t.height,u=t.width,p=t.isPaste,a.showLoading(l,u),f=a.store,d=f.updateAttrs,m=f.rootStore.config.pageId,h={},y="",!(n&&r&&o)){e.next=9;break}h={id:n,chartData:r,config:o},e.next=26;break;case 9:if(!p&&"".concat(m)==="".concat(c)){e.next=21;break}return e.next=12,Object(Ka.b)("/api/charts/copy/".concat(c),{chartIds:[n]});case 12:return b=e.sent,y=b[n],v="/api/charts/".concat(c,"/").concat(y),e.next=17,Object(Ka.c)(v);case 17:g=e.sent,h=g.data,e.next=26;break;case 21:return w="/api/charts/".concat(c,"/").concat(n),e.next=24,Object(Ka.c)(w);case 24:j=e.sent,h=j.data;case 26:s.a.render(i.a.createElement(np.a,{chartId:y,data:h,pos:a.pos,updateAttrs:d,height:parseInt(l,10),width:parseInt(u,10)}),a.dom),p&&(O=a.store.rootStore.pm,S=O.state.tr,(0,O.dispatch)(S.scrollIntoView()));case 28:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){op(a,r,o,i,c,"next",e)}function c(e){op(a,r,o,i,c,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),this.showLoading=function(e,t){s.a.render(i.a.createElement("div",{className:"ct-data2chart-loading-wrapper",style:{height:"".concat(e,"px"),width:"".concat(t,"px")}},i.a.createElement(tp.default,null)),a.dom)},this.node=t,this.view=n,this.getPos=r,this.pos=r(),this.store=o;var c=t.attrs;this.dom=document.createElement("span"),this.dom.setAttribute("class","ct-data2chart"),this.store.setEndMoveCb(function(){return a.init(c)}),this.init(c)}var t,n,r;return t=e,(n=[{key:"update",value:function(e){var t=this.node.attrs,n=(t.view,t.chartId,rp(t,["view","chartId"])),r=e.attrs,o=(r.view,r.chartId,rp(r,["view","chartId"]));if(d()(n,o))return!0}}])&&ap(t.prototype,n),r&&ap(t,r),e}(),cp=n("./preact/dist/preact.mjs");n("./core-js/modules/es7.object.entries.js");function sp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var lp=function(e){var t=e.$popover,n=e.dom,r=e.customStyle,o=e.offsetParent,a=e.toolboxHeight,i=e.bottomFirst,c=e.popoverWidth;if(t.style.display="block",n){var s=n.offsetHeight+a;if(!o||!t)return;var l=function(e){var t=e.offsetParent,n=e.dom,r=e.toolboxHeight,o=e.bottomFirst,a=void 0!==o&&o,i=e.popoverWidth,c=0,s=0,l="auto",u=n.getBoundingClientRect(),p=u.left,f=u.top,d=u.bottom,m=t.getBoundingClientRect(),h=m.left,y=m.top,b=m.right,v=window.innerHeight;return c=f-y,s=p-h,b-p<i&&(s="auto",l=0),s<0&&(s=0,l="auto"),{left:s,top:c=a&&v-d-50>r?d-y+2:c-r-2,right:l}}({offsetParent:o,dom:n,toolboxHeight:a,bottomFirst:i,popoverWidth:c});Object.entries(l).forEach(function(e){var n=sp(e,2),r=n[0],o=n[1];/[0-9]+/.test(o)?t.style[r]="".concat(o,"px"):t.style[r]="".concat(o)}),t.style.height="".concat(s,"px")}else r&&Object.keys(r).forEach(function(e){t.style[e]=r[e]})},up=function(e){e.firstElementChild&&Object(cp.d)(null,e,e.firstElementChild)};function pp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mp=34,hp=function(){function e(t){var n=this,r=t.view,o=t.store,a=t.className,i=t.height,c=t.autoControl,s=void 0===c||c,l=t.bottomFirst,u=void 0!==l&&l,p=t.sticky,f=void 0===p||p,d=t.getToolboxHeightFn;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setPopoverState=function(e){n.popoverState=e},this.checkTable=function(e){e&&(n.tableWrapper=e.closest(".ct-table-wrapper"))},this.fixTableScroll=function(){n.isAutoControl&&n.$popover.firstElementChild&&(n.tableWrapper?(n.$popover.firstElementChild.classList.add("in-table"),n.tableWrapper.addEventListener("scroll",n.updatePopover)):(n.tableOffset=null,n.$popover.firstElementChild.classList.remove("in-table")))},this.updatePopover=function(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pp(n,!0).forEach(function(t){fp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pp(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n.store.node);n.store.hidePopover(),n.store.showPopover(e)},this.toolboxHeight=i||mp,this.getToolboxHeightFn=d,this.isAutoControl=s,this.isBottomFirst=u,this.isSticky=f,this.updatePopover=k()(this.updatePopover,16),this.tableOffset=null,this.store=o,this.view=r,this.$popover=document.createElement("div"),this.$popover.className="ct-toolbox-popover ".concat(a||""),this.store.ctPopover=this,r.dom.parentElement&&r.dom.parentElement.appendChild(this.$popover)}var t,n,r;return t=e,(n=[{key:"show",value:function(e){var t=e.dom,n=e.content,r=e.customStyle,o=e.forceUpdate,a=void 0!==o&&o;if("show"!==this.popoverState||a){if("hide"===this.popoverState){var i=this.view.dom.parentElement;this.checkTable(t);var c=this.toolboxHeight;this.getToolboxHeightFn&&(c=this.getToolboxHeightFn()),lp({$popover:this.$popover,dom:t,customStyle:r,offsetParent:i,toolboxHeight:c,bottomFirst:this.isBottomFirst,popoverWidth:this.popoverWidth})}if(a&&up(this.$popover),Object(cp.d)(n,this.$popover),this.$popover.firstElementChild){var s=this.$popover.firstElementChild;s.classList.add("ct-toolbox"),this.isSticky||s.classList.add("nosticky"),this.fixTableScroll(),this.setPopoverState("show")}this.popoverWidth||this.updatePopover()}}},{key:"hide",value:function(){"hide"!==this.popoverState&&(this.popoverWidth=this.$popover.offsetWidth,up(this.$popover),this.isAutoControl&&this.tableWrapper&&this.tableWrapper.removeEventListener("scroll",this.updatePopover),this.$popover.setAttribute("style",""),this.$popover.style.display="none",this.setPopoverState("hide"))}},{key:"destroy",value:function(){this.$popover.remove()}},{key:"update",value:function(e){var t=e.state.selection,n=t.node;if(this.store.handleViewUpdate)this.store.handleViewUpdate({view:e,selNode:n,selection:t});else if(this.isAutoControl&&this.store.pluginName)try{var r=this.store.pluginName.toLowerCase(),o=null,a={},i=null;if(t.node&&t.node.type.name.toLowerCase()===r){var c=t.$from;o=c.pos,a=c.nodeAfter.attrs}if(null===o){var s=Object(ai.d)(t.$anchor.path,function(e){return e.type&&e.type.name===r});s&&(o=s.pos,a=s.node.attrs)}(i=e.nodeDOM(o))&&i.classList&&!i.classList.contains("failed")?(this.store.hidePopover(),this.store.showPopover({dom:i,pos:o,attrs:a,view:e})):this.store.hidePopover&&this.store.hidePopover()}catch(l){console.error("showPopover failed",l)}}}])&&dp(t.prototype,n),r&&dp(t,r),e}(),yp=new Ua.PluginKey("data2chart"),bp=function e(t){t.forEach(function(t){"data2chart"===t.type.name?t.attrs.isPaste=!0:t.content&&t.content.content&&t.content.content.length&&e(t.content)})};var vp,gp={nodes:{data2chart:{group:"inline",inline:!0,atom:!0,allowGapCursor:!0,dragBlock:!0,attrs:{id:{default:""},config:{default:""},chartData:{default:""},pageId:{default:""},chartId:{default:""},height:{default:400},width:{default:600}},parseDOM:[{tag:'span[class~="ct-data2chart"]',getAttrs:function(e){return{id:e.getAttribute("data-data2chart-id"),pageId:e.getAttribute("data-data2chart-page-id"),config:e.getAttribute("data-config"),chartData:e.getAttribute("data-chartData"),chartId:e.getAttribute("data-data2chart-chartId"),height:e.getAttribute("data-height"),width:e.getAttribute("data-width")}}}],toDOM:function(e){var t=e.attrs,n=t.id,r=t.pageId,o=t.chartId,a=t.height,i=t.width;return["span",{class:"ct-data2chart","data-data2chart-id":"".concat(n),"data-data2chart-page-id":"".concat(r),"data-data2chart-chartId":o?"".concat(o):"","data-height":a,"data-width":i}]}}}},wp=function(e){return function(t,n,r,o){var a=t.schema.nodes.data2chart.create(e),i=Object(ai.j)(t,a).transaction;return!!i&&(n(i.scrollIntoView()),"function"===typeof o&&o("afterInsert",{draggable:!0}),!0)}};n("../client/src/editor/modules/data2chart/data2chart.styl");function jp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Op(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jp(n,!0).forEach(function(t){Sp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jp(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Sp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ep(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pp={dev:"http://data2chart.data.dev.sankuai.com",test:" http://data2chart.data.test.sankuai.com",staging:"http://data2chart.new.data.st.sankuai.com",production:"https://chart.sankuai.com"},kp=Object(x.F)(vp=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.create=function(e){var t=Pp[window.__CLIENT_CONFIG__.env];n.loading=Object(as.g)(document.body,is.r,n.close),n.iframe=document.createElement("iframe"),n.iframe.setAttribute("frameborder","0"),n.iframe.setAttribute("class","ct-data2chart-frame"),n.iframe.setAttribute("data-type","ct-data2chart"),n.iframe.src=e||"".concat(t,"/edit?embed=1&system=101"),n.iframe.onload=function(){n.iframe.focus(),n.iframe.style.opacity=1,Object(as.e)(n.loading)},window.addEventListener("message",n.receive),window.addEventListener("popstate",n.close),document.body.appendChild(n.iframe)},this.receive=function(e){var t=e.data,r=t.type,o=t.data;switch(r){case"save":n.save(o);break;case"exit":n.onExit()}},this.save=function(e){var t=e.detail,r=t.id,o=t.chartData,a=t.config,i=n.rootStore,c=i.state,s=i.dispatch,l=i.pm,u=i.trigger,p=i.config.pageId,f={};n.width&&n.height&&(f={height:n.height,width:n.width}),wp(Op({id:r,pageId:p,chartData:o,config:a},f))(c,s,l,u),n.close()},this.close=function(){window.removeEventListener("popstate",n.close),window.removeEventListener("message",n.receive),document.body.removeChild(n.iframe),n.iframe=null},this.onExit=function(){n.close()},this.goToEdit=function(e,t,r,o){var a=Pp[window.__CLIENT_CONFIG__.env];n.rootStore.pm.dom.blur(),n.width=r,n.height=o,n.create("".concat(a,"/edit/").concat(e,"?embed=1&system=101&authParams=").concat(t))},this.showLoading=function(e,t){s.a.render(i.a.createElement("div",{className:"ct-data2chart-loading-wrapper",style:{height:"".concat(e,"px"),width:"".concat(t,"px")}},i.a.createElement(tp.default,null)),n.node.dom)},this.setEndMoveCb=function(e){n.setEndMoveCallback(e)},this.updateAttrs=function(e,t){void 0===t&&(t=n.node.pos);var r=n.view,o=r.state,a=r.dispatch,i=o.tr,c=o.doc,s=o.schema,l=i.doc.nodeAt(t);if(l){var u=Op({},l.attrs,{},e);i.setNodeMarkup(t,s.nodes.data2chart,u);var p=Ua.NodeSelection.create(c,t);i.setSelection(p),a(i)}},this.init=function(e){var t=e.view;n.view=t},this.pluginName="data2chart",this.iframe=null,this.loading=null,this.rootStore=t,this.height=null,this.width=null}var t,n,r;return t=e,(n=[{key:"showPopover",value:function(e){var t=this;this.hidePopover(),this.node=e,this.setStartMoveCallback(function(e,n){t.showLoading(e,n)}),this.ctShowResizer({type:"div"})}},{key:"hidePopover",value:function(){this.ctHideResizer()}}])&&Ep(t.prototype,n),r&&Ep(t,r),e}())||vp;function xp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cp=function(){function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="data2chart",this.schema=gp,this.store=new kp(n),this.plugins=function(e){return[new Ua.Plugin({key:yp,props:{handleDoubleClickOn:function(t,n,r){if(r&&r.type&&"data2chart"===r.type.name){var o=r.attrs,a=o.id,i=o.pageId,c=o.chartId,s=o.width,l=o.height;return e.goToEdit(c||a,i,s,l),!0}},nodeViews:{data2chart:function(t,n,r){return new ip(t,n,r,e)}},transformPasted:function(e){var t=e;return t.content.content&&bp(t.content.content),t}},view:function(t){return new hp({view:t,store:e,className:"ct-image-editor-popover"})}})]}(this.store)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this.editor=e,this.store.init(e)}}])&&xp(t.prototype,n),r&&xp(t,r),e}();Cp.moduleName="data2chart";var Tp=n("./react-draggable/build/web/react-draggable.min.js"),Ip=n.n(Tp),Ap=n("./react-jss/dist/react-jss.esm.js"),Dp=n("../client/src/assets/svg/close.svg");function Np(e){return(Np="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mp(){return(Mp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lp(e,t){return!t||"object"!==Np(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bp(e){return(Bp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rp(e,t){return(Rp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vp=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Lp(this,Bp(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rp(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Mp({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("defs",null,i.a.createElement("style",null)),i.a.createElement("path",{d:"M512 938.67C276.35 938.67 85.33 747.65 85.33 512S276.35 85.33 512 85.33 938.67 276.35 938.67 512 747.65 938.67 512 938.67zm-42.67-277.34v85.34h85.34v-85.34h-85.34zm0-384v320h85.34v-320h-85.34z",fill:"#F5BA31"}))}}])&&_p(n.prototype,r),o&&_p(n,o),t}();n("../client/src/editor/modules/sensitiveWord/component/style.styl");function Hp(e){return(Hp="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zp(){return(zp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Wp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fp(e,t){return!t||"object"!==Hp(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Up(e){return(Up=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kp(e,t){return(Kp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qp=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Fp(this,Up(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kp(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",zp({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("defs",null,i.a.createElement("style",null)),i.a.createElement("path",{d:"M509.53 578.47l212.05-212.05 45.23 45.27-242.2 242.22a21.33 21.33 0 0 1-30.17 0L252.22 411.69l45.27-45.25L509.53 578.5z",fill:"#1C6CDC"}))}}])&&Wp(n.prototype,r),o&&Wp(n,o),t}();function Gp(e){return(Gp="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qp(){return(Qp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Xp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yp(e,t){return!t||"object"!==Gp(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jp(e){return(Jp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zp(e,t){return(Zp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Yp(this,Jp(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zp(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",Qp({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("defs",null,i.a.createElement("style",null)),i.a.createElement("path",{d:"M509.53 448.1L297.47 660.17l-45.22-45.27 242.17-242.2a21.33 21.33 0 0 1 30.17 0L766.8 614.9l-45.27 45.27-212.06-212.05z",fill:"#1C6CDC"}))}}])&&Xp(n.prototype,r),o&&Xp(n,o),t}();function ef(e){return(ef="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tf(){return(tf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function nf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rf(e,t){return!t||"object"!==ef(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function of(e){return(of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function af(e,t){return(af=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cf=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rf(this,of(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&af(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",tf({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("defs",null,i.a.createElement("style",null)),i.a.createElement("path",{d:"M509.53 578.47l212.05-212.05 45.23 45.27-242.2 242.22a21.33 21.33 0 0 1-30.17 0L252.22 411.69l45.27-45.25L509.53 578.5z",fill:"#fff"}))}}])&&nf(n.prototype,r),o&&nf(n,o),t}();function sf(e){return(sf="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lf(){return(lf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function uf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pf(e,t){return!t||"object"!==sf(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ff(e){return(ff=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function df(e,t){return(df=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mf=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),pf(this,ff(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&df(e,t)}(t,i.a.Component),n=t,(r=[{key:"render",value:function(){return i.a.createElement("svg",lf({className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},this.props),i.a.createElement("defs",null,i.a.createElement("style",null)),i.a.createElement("path",{d:"M509.53 448.1L297.47 660.17l-45.22-45.27 242.17-242.2a21.33 21.33 0 0 1 30.17 0L766.8 614.9l-45.27 45.27-212.06-212.05z",fill:"#fff"}))}}])&&uf(n.prototype,r),o&&uf(n,o),t}();function hf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var yf=function(e){var t=e.type,n=e.click,r=hf(Object(a.useState)(!1),2),o=r[0],c=r[1],s=hf(Object(a.useState)("#ffffff"),2),l=s[0],u=s[1];return i.a.createElement(vl.a,{onClick:function(){n()},style:{background:l},onMouseEnter:function(){c(!0),u("#1C6CDC")},onMouseLeave:function(){c(!1),u("#ffffff")},onMouseDown:function(){u("#1253B5")},onMouseUp:function(){u(o?"#1C6CDC":"#ffffff")}},"up"===t?o?i.a.createElement(mf,null):i.a.createElement($p,null):o?i.a.createElement(cf,null):i.a.createElement(qp,null))};function bf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vf(n,!0).forEach(function(t){wf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vf(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jf={display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},Of=Object(Ap.a)({ctSensitivePopover:{width:"348px",background:"#FFFFFF",boxShadow:"0 2px 4px 0 rgba(0,0,0,0.02), 0 4px 6px 6px rgba(0,0,0,0.02), 0 4px 6px 0 rgba(0,0,0,0.06)",borderRadius:"10px",padding:"16px 26px 18px 24px","& .header":gf({},jf,{marginBottom:"9px","& .left":gf({},jf,{"& div":{marginLeft:"8px",fontFamily:"PingFangSC-Medium",fontSize:"16px",color:"rgba(0,0,0,0.87)",letterSpacing:"0",lineHeight:"24px"}})}),"& .ops":gf({},jf,{"& .left":{"& button":{height:"24px",borderRadius:"4px",marginLeft:"28px",fontFamily:"PingFangSC-Regular",fontSize:"12px",letterSpacing:"0",textAlign:"center",lineHeight:"20px",cursor:"pointer"}},"& .right":gf({},jf,{"& p":{margin:"0 7px 0 0"},"& button":{height:"24px",background:"#FFFFFF",border:"1px solid #1C6CDC",cursor:"pointer",marginLeft:"5px",minWidth:"1px"}})})},title:{color:"rgba(0,0,0,0.87)",fontSize:"14px",lineHeight:"22px",height:"22px",fontWeight:"500"},body:{color:"rgba(0,0,0,0.60)",fontSize:"14px",lineHeight:"22px",height:"fit-content",maxWidth:"100%",overflowWrap:"break-word"},left28:{margin:"0 0 8px 28px"},closeIcon:{display:"flex",justifyContent:"center",alignItems:"center",width:"28px",height:"28px",borderRadius:"50%",cursor:"pointer",background:"transparent","&:hover":{background:"rgba(0,0,0,0.07)"}}}),Sf=function(e){var t=e.words,n=e.current,r=e.editorView,o=e.click,a=e.save,c=e.title,s=r.dispatch,l=r.state.tr,u=Of(),p=function(e){var t=r.dispatch,n=r.state,o=n.tr,a=n.doc,i=Ua.NodeSelection.create(a,e).$anchor,c=Object(ai.d)(i.path,function(e){return e.type&&"collapse"===e.type.name});if(c){var s=c.node.attrs,l=c.pos;s.active||setTimeout(function(){o.setMeta(Pf,{action:"collapse"}),o.setNodeMarkup(l,null,gf({},s,{active:!0})).scrollIntoView(),t(o)},0)}o.setSelection(Ua.TextSelection.create(a,e));var u=r.domAtPos(e).node;if(u){var p=u.getBoundingClientRect(),f=document.querySelector("#page-wrapper");f&&f.scrollBy(0,p.top-200);var d=u.closest("table"),m=document.querySelector('div[class~="ProseMirror"]'),h=m.getBoundingClientRect();if(d&&m){var y=d.clientWidth;if(y>m.clientWidth){var b=p.left-h.left>0?Math.min(p.left-(h.left+150),y-m.clientWidth):p.left-(h.left+150);d.parentElement.scrollBy(b,0)}}}t(o)};return i.a.createElement(Ip.a,null,i.a.createElement("div",{className:u.ctSensitivePopover},i.a.createElement("div",{className:"header"},i.a.createElement("div",{className:"left"},i.a.createElement(Vp,null),i.a.createElement("div",null," ","\u68c0\u6d4b\u5230\u654f\u611f\u4fe1\u606f")),i.a.createElement("div",{className:u.closeIcon},i.a.createElement(Dp.a,{onClick:o}))),i.a.createElement("div",null,c?i.a.createElement("div",{className:u.left28},i.a.createElement("div",{className:u.title},"\u6807\u9898\uff1a"),i.a.createElement("div",{className:u.body,dangerouslySetInnerHTML:{__html:c}})):null,t.length>0?i.a.createElement("div",{className:u.left28},i.a.createElement("div",{className:u.title},"\u6b63\u6587\uff1a"),i.a.createElement("div",{className:u.body},"\u68c0\u6d4b\u5230".concat(t.length,"\u4e2a\u654f\u611f\u8bcd"))):null),i.a.createElement("div",{className:"ops"},i.a.createElement("div",{className:"left"},i.a.createElement(vl.a,{onClick:a},"\u7ee7\u7eed\u4fdd\u5b58")),i.a.createElement("div",{className:"right"},i.a.createElement("p",null,"".concat(0===t.length?0:n+1,"/").concat(t.length)),i.a.createElement(yf,{type:"up",click:function(){return l.setMeta(Pf,{action:"prev",scrollIntoView:p}),void s(l)}}),i.a.createElement(yf,{type:"down",click:function(){return l.setMeta(Pf,{action:"next",scrollIntoView:p}),void s(l)}})))))},Ef=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=n;var r=document.querySelector("#ct-sensitive-popover");r?this.container=r:(this.container=document.createElement("div"),this.container.style.display="none",this.container.id="ct-sensitive-popover"),this.store.container=this.container,this.store.view=t,t.dom.parentElement&&t.dom.parentElement.appendChild(this.container)}var t,n,r;return t=e,(n=[{key:"update",value:function(e,t){this.store.renderPopover(e)}},{key:"destroy",value:function(){s.a.unmountComponentAtNode(this.container)}}])&&bf(t.prototype,n),r&&bf(t,r),e}();var Pf=new Ua.PluginKey("sensitiveWord"),kf=function(e){return[new Ua.Plugin({key:Pf,state:{init:function(t,n){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(t);var r=[],o=n.schema.nodes,a=o.sensitive_word,i=o.text,c=n.doc;return c.descendants(function(e,t,n){if(e.type===a){var o=e.content.content[0],c={start:t,end:t+e.nodeSize,content:o,id:e.attrs.id};o.type===i&&(c.text=o.text),r.push(c)}}),e.initWordList(r),e.generateDecos(c)},apply:function(t,n,r,o){if(t.docChanged){var a=o.selection,i=a.$cursor,c=a.$anchor,s=t.getMeta(Pf);if(s){var l=s.action;if(l&&"collapse"===l)return n}var u=i?i.pos:c.pos,p=e.findInWord(u);return p?(e.removeWordFromList(p),e.prev(),e.calculateWordPosition(o),e.generateDecos(o.doc)):(e.calculateWordPosition(o),e.generateDecos(o.doc))}var f=t.getMeta(Pf);if(!f)return n;var d=f.action,m=f.scrollIntoView;return"prev"===d?e.prev(m):"next"===d&&e.next(m),e.generateDecos(o.doc)}},props:{decorations:function(e){return this.getState(e)}},view:function(t){return new Ef(t,e)}})]};n("./core-js/modules/es6.set.js");var xf=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.title="",this.wordList=[],this.currentIndex=0,this.removedWordIndexList=[],this.wordspool=new Set,this.initWordList=function(e){n.wordList=e,n.currentIndex=0,n.wordList.forEach(function(e){n.wordspool.add(e.text)})},this.setSensitiveTitle=function(e){n.title=e},this.resetWordList=function(e){n.wordList=e,n.currentIndex=0},this.removeWordFromList=function(e){n.removedWordIndexList.push(e.id)},this.calculateWordPosition=function(e){var t=[],r=e.schema.nodes,o=r.sensitive_word,a=r.text;e.doc.descendants(function(e,r){if(e.type===o){var i=e.content.content[0],c={start:r,end:r+e.nodeSize,content:i,id:e.attrs.id};i.type===a&&(c.text=i.text),n.canInsertToList(c.id)&&t.push(c)}}),n.wordList=[].concat(t)},this.generateDecos=function(e){if(0===n.wordList.length)return ji.DecorationSet.empty;var t=[];return n.wordList.forEach(function(e,r){var o=ji.Decoration.inline(e.start,e.end,{class:r===n.currentIndex?"ct-sensitive-word-focus":"ct-sensitive-word"},{index:r,active:r===n.currentIndex,content:e.content,start:e.start});t.push(o)}),ji.DecorationSet.create(e,[].concat(t))},this.canInsertToList=function(e){return!(n.removedWordIndexList.indexOf(e)>=0)},this.findInWord=function(e){return n.wordList.find(function(t){return t.start<=e&&t.end>=e})},this.prev=function(e){if(n.currentIndex>0){n.currentIndex--;var t=n.wordList[n.currentIndex].start;e&&e(t)}},this.next=function(e){if(n.currentIndex<n.wordList.length-1){n.currentIndex++;var t=n.wordList[n.currentIndex].start;e&&e(t)}},this.renderPopover=function(e){var t=n.rootStore.config.sensitiveWord,r=t.onClose,o=t.onSave;s.a.render(i.a.createElement(Sf,{editorView:e,words:n.wordList,current:n.currentIndex,titleList:n.titleList,title:n.title,click:r,save:o}),n.container)},this.show=function(){n.renderPopover(n.view),n.container.style.display="block"},this.hide=function(){n.container.style.display="none"},this.rootStore=t},Cf={nodes:{sensitive_word:{group:"inline",inline:!0,content:"text*",priority:90,attrs:{id:""},parseDOM:[{tag:'span[data-type="sensitive"]',getAttrs:function(e){return{id:Object(x.J)()}}}],toDOM:function(e){return["span",{"data-type":"sensitive","data-id":e.attrs.id},0]}}}};n("../client/src/editor/modules/sensitiveWord/style.styl");function Tf(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var If=function e(t){var n=t.store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="sensitiveWord",this.store=new xf(n),this.plugins=Tf(kf(this.store)),this.schema=Cf};If.moduleName="sensitiveWord";var Af=function(e){return new Tu.a({store:e})},Df=function(e){return[new If({store:e}),new ei.a,new qa.AttachmentModule,new Qa.DrawioModule,new Ga.a,new Xa.HtmlModule,new Ya.a,new Ja.a,new ti.a,new Ci({store:e}),new qi({store:e}),new Gi.a,new dc({store:e}),new As({store:e}),new pl({store:e}),new fl.a,new Cu({store:e}),new $a.a({store:e}),new Iu.a({store:e}),new ts({store:e}),new Du({store:e}),new ep({store:e}),new Za.a,new Cp({store:e})]},Nf=n("../client/src/editor/components/Editor/config/index.js");n("../client/src/editor/components/Editor/style.styl");function Mf(e){return(Mf="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _f(){return(_f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Lf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Bf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lf(n,!0).forEach(function(t){Rf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lf(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Rf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vf(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function Hf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zf(e,t){return!t||"object"!==Mf(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wf(e){return(Wf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ff(e,t){return(Ff=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Uf=o.a.TextArea,Kf=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=zf(this,(e=Wf(t)).call.apply(e,[this].concat(o)))).titleRef=null,n.store=y.a.store,n.editorId="editor-".concat(Math.random().toString().substr(10)),n.onMouseDown=!1,n.state={titleChanged:!1},n.initEditor=function(e,t){var r=document.getElementById(n.editorId),o=document.getElementById(n.store.config.pageWrapperId),a=n.fixContent(e);n.editor=new p.a(r,{scroll:o,defaultValue:a,reactModule:Af(n.store),appendModules:Df(n.store),moduleConfigs:Object(Nf.a)(n.props.config),fixedWidth:t}),n.editor.on("tableError",function(e){m.a.error(e)})},n.beforeUnmount=function(){document.getElementById(n.editorId).querySelectorAll(".ct-editor-popover").forEach(function(e){s.a.unmountComponentAtNode(e)})},n.setFirstCursor=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=n.editor.view,r=t.dispatch,o=t.state;r(o.tr.setSelection(new u.b(o.doc.resolve(0)))),e&&t.focus()},n.serialize=function(e){return new Promise(function(){var t,r=(t=regeneratorRuntime.mark(function t(r){var o,a,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e&&(o=n.editor.view.dom,a=o.querySelector("[data-type=ct-progress]"),i=document.querySelectorAll("[data-type=ct-frame]").length,a?r({status:h.h.UPLOADING,uploadingDOM:a}):i&&r({status:h.h.FRAME})),t.next=3,n.store.serialize(e);case 3:c=t.sent,n.titleRef&&r(Bf({title:Object(Fa.b)(n.titleRef.value)},c)),r(Bf({title:n.props.defaultTitle},c));case 6:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(e){Vf(a,r,o,i,c,"next",e)}function c(e){Vf(a,r,o,i,c,"throw",e)}i(void 0)})});return function(e){return r.apply(this,arguments)}}())},n.fixContent=function(e){var t=n.props.config,r=/\d+/.test(t.url.file)?t.url.file.match(/\d+/)[0]:null,o=document.createElement("div");if(o.innerHTML=e.replace(/\u200B/g,"").replace(/(class="ct-status"[^>]*>)/g,"$1\u200b"),!r)return o.innerHTML;o.querySelectorAll(".ct-link").forEach(function(e){e.href&&(e.href=e.href.replace("123.sankuai.com/km","km.sankuai.com"),e.innerHTML=e.innerHTML.replace("123.sankuai.com/km","km.sankuai.com"))}),o.querySelectorAll(".ct-image img").forEach(function(e){var t=e.getAttribute("data-src"),n=e.getAttribute("data-small"),r=e.getAttribute("data-origin");e.setAttribute("data-src",t&&t.replace("123.sankuai.com/km","km.sankuai.com")),e.setAttribute("data-small",n&&n.replace("123.sankuai.com/km","km.sankuai.com")),e.setAttribute("data-origin",r&&r.replace("123.sankuai.com/km","km.sankuai.com"))}),o.querySelectorAll(".ct-drawio img").forEach(function(e){var t=e.getAttribute("data-src"),n=e.getAttribute("data-xml");e.setAttribute("data-src",t&&t.replace("123.sankuai.com/km","km.sankuai.com")),n&&e.setAttribute("data-xml",n.replace("123.sankuai.com/km/api/file","km.sankuai.com/api/file/attachment"))}),o.querySelectorAll(".ct-attachment").forEach(function(e){var t=e.getAttribute("data-src");e.setAttribute("data-src",t&&t.replace("123.sankuai.com/km/api/file","km.sankuai.com/api/file/attachment"))});return o.querySelectorAll('.ct-not-support[data-macro="children"], .ct-not-support[data-macro="pagetree"]').forEach(function(e){e.className="ct-page-tree",e.setAttribute("data-page-id",r)}),o.innerHTML},n.handleTitleFocus=function(e){"\u65e0\u6807\u9898"===e.target.value&&(n.titleRef.value=""),n.setFirstCursor(!1)},n.handleTitleBlur=function(e){""===e.target.value&&(n.titleRef.value="\u65e0\u6807\u9898")},n.handleDragover=function(e){var t=document.getElementById(n.props.config.pageWrapperId);t&&(e.clientY>window.innerHeight-80?t.scrollTop+=24:e.clientY<90&&(t.scrollTop-=24))},n.handleKeyDown=function(e){n.chineseInput=229===e.keyCode},n.handleKeyUp=function(e){var t=n.editor.view;n.state.titleWarning&&(n.store.core.sensitiveWordStore.title="",t.dispatch(t.state.tr)),n.chineseInput||13!==e.keyCode||(t.focus(),n.props.onTitleEnter&&n.props.onTitleEnter())},n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ff(e,t)}(t,i.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.config,n=e.defaultBody,r=void 0===n?"":n,o=e.fixedWidth,a=e.hasRowNum;this.store.setConfig(t),this.store.editorId=this.editorId,this.initEditor(r,o),this.store.setStore(this.editor),function(e){var t=e.config,n=e.view,r=e.core,o=r.imageStore,a=r.attachmentStore,i=n.dom;i.addEventListener("compositionstart",function(){e.composing=!0}),i.addEventListener("compositionend",function(){e.composing=!1}),i.addEventListener("dragenter",function(e){e.preventDefault()},!1),i.addEventListener("dragover",function(e){e.dataTransfer.dropEffect="",e.preventDefault()},!1),i.addEventListener("dragleave",function(e){e.preventDefault()}),i.addEventListener("drop",function(e){e.preventDefault();var r=e.dataTransfer,i=[];if(void 0!==r.items)for(var c=0;c<r.items.length;c++){var s=r.items[c];if("file"===s.kind&&s.webkitGetAsEntry().isFile){var l=s.getAsFile();i.push(l)}}else for(var u=0;u<r.files.length;u++)i.push(r.files[u]);if(i.length)if(i.length>9)m.a.error("\u4e00\u6b21\u4e0a\u4f20\u4e0d\u5f97\u8d85\u8fc7".concat(9,"\u4e2a\u6587\u4ef6"));else{for(var p=0,f=i;p<f.length;p++){if(f[p].size/1048576>50)return void m.a.error("\u6587\u4ef6\u4e0d\u5f97\u5927\u4e8e".concat(50,"M"))}try{var d=n.state,h=n.dispatch,y=n.docView.posFromDOM(e.target);"TD"===e.target.tagName.toUpperCase()&&y--;var b=Ua.TextSelection.create(d.tr.doc,y);h(d.tr.setSelection(b))}catch(v){console.error("set selection error when drop file\uff0c error: ",v)}i.forEach(function(e){0===e.type.indexOf("image/")?Object(Fa.a)(o,e,t.url.image):Object(Fa.a)(a,e,t.url.file)})}},!1)}(this.store),window.onerror=function(e,t,n,r,o){v.a.error("citadelError-".concat(o.message),o.stack)},document.addEventListener("unhandledrejection",function(e){v.a.error("unhandledrejection-".concat(e.reason),e.stack)}),document.addEventListener("dragover",this.handleDragover),a&&y.a.rowNumExtension.showRowNum()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props;d()(e.config,t.config)||this.store.setConfig(e.config),t.titleWarning!==e.titleWarning&&!0===e.titleWarning&&this.setState({titleWarning:!0})}},{key:"componentDidUpdate",value:function(e){var t=this.props;if(t.defaultTitle&&t.defaultTitle!==e.defaultTitle&&t.defaultTitle!==this.titleRef.value&&(this.titleRef.value=t.defaultTitle||"\u65e0\u6807\u9898"),t.defaultBody&&t.defaultBody!==e.defaultBody){var n=this.fixContent(t.defaultBody);this.editor.value(n),setTimeout(this.setFirstCursor,200)}t.hasRowNum!==e.hasRowNum&&t.hasRowNum&&(y.a.rowNumExtension.hideRowNum(),y.a.rowNumExtension.showRowNum())}},{key:"componentWillUnmount",value:function(){var e=this.editor.view;e.destroy&&e.destroy(),this.editor.destroy(),this.beforeUnmount(),document.removeEventListener("dragover",this.handleDragover),y.a.rowNumExtension.hideRowNum()}},{key:"render",value:function(){var e=this,t=this.store,n=this.editorId,r=this.props,o=r.secret;return i.a.createElement("div",{className:"ct-editor-wrapper",onClick:j,onBlur:function(){return t.update()}},i.a.createElement("div",{className:"ct-title-wrapper"},this.props.fixedWidth?i.a.createElement(Uf,{onChange:this.changeTitle,spellCheck:!1,placeholder:"\u65e0\u6807\u9898",ref:function(t){e.titleRef=t&&t.textAreaRef},autoSize:!0,readOnly:!r.titleEditable,onFocus:this.handleTitleFocus,onBlur:this.handleTitleBlur,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onPressEnter:function(e){return e.preventDefault()},className:"ct-title-input"}):i.a.createElement("input",{defaultValue:r.defaultTitle,placeholder:"\u65e0\u6807\u9898",spellCheck:!1,ref:function(t){e.titleRef=t},readOnly:!r.titleEditable,onFocus:this.handleTitleFocus,onBlur:this.handleTitleBlur,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,className:"ct-title-input"}),i.a.createElement("div",{className:"ct-title-split"}),r.children,o),i.a.createElement("div",{id:n,className:"ct-editor"}),i.a.createElement(l.Provider,_f({},y.a,{ctStore:b.b}),i.a.createElement(Wa,{menuTop:r.menuTop})))}}])&&Hf(n.prototype,r),o&&Hf(n,o),t}();Kf.STATUS=h.h;var qf=Kf;Kf.defualtProps={defaultTitle:"",defaultBody:"",menuTop:0};t.a=qf},"../client/src/editor/modules/audio/ProgressBar/style.styl":function(e,t,n){},"../client/src/editor/modules/calendar/style.styl":function(e,t,n){},"../client/src/editor/modules/catalog/utils.js":function(e,t,n){"use strict";var r=n("./react/index.js"),o=n.n(r);n("./core-js/modules/es7.symbol.async-iterator.js"),n("./core-js/modules/es6.symbol.js"),n("./core-js/modules/es6.object.assign.js"),n("./core-js/modules/es6.object.set-prototype-of.js");function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",i({width:"8",height:"8",viewBox:"0 0 8 8",xmlns:"http://www.w3.org/2000/svg"},this.props),o.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},o.a.createElement("g",{id:"Artboard-4",transform:"translate(-63 -20)",fill:"#333"},o.a.createElement("circle",{id:"Oval",cx:"67",cy:"24",r:"4"}))))}}])&&c(n.prototype,r),a&&c(n,a),t}();function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),h(this,y(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",d({width:"8",height:"8",viewBox:"0 0 8 8",xmlns:"http://www.w3.org/2000/svg"},this.props),o.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},o.a.createElement("g",{id:"Artboard-4",transform:"translate(-20 -20)",fill:"#333"},o.a.createElement("g",{id:"Group-6",transform:"translate(20 20)"},o.a.createElement("path",{d:"M4 8a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z",id:"Combined-Shape"})))))}}])&&m(n.prototype,r),a&&m(n,a),t}();function g(e){return(g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return!t||"object"!==g(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var P=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),O(this,S(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",w({width:"8",height:"8",viewBox:"0 0 8 8",xmlns:"http://www.w3.org/2000/svg"},this.props),o.a.createElement("g",{id:"Page-1",fill:"none",fillRule:"evenodd"},o.a.createElement("g",{id:"Artboard-4",transform:"translate(-41 -20)",fill:"#333"},o.a.createElement("path",{id:"Rectangle",d:"M41 20h8v8h-8z"}))))}}])&&j(n.prototype,r),a&&j(n,a),t}();n.d(t,"b",function(){return k}),n.d(t,"a",function(){return x});var k=function(e){var t=[0,0,0,0,0,0,0];return function(n){for(var r=1;r<n;r++)0===t[r]&&(t[r]=1);t[n]+=1;for(var o=n+1;o<7;o++)t[o]=0;return"".concat(t.slice(e,n+1).join(".")," ")}},x=function(e){var t="";switch(e){case"none":t="";break;case"point":t=o.a.createElement(p,null);break;case"circle":t=o.a.createElement(v,null);break;case"rect":t=o.a.createElement(P,null);break;default:t=e}return t}},"../client/src/editor/modules/contextmenu/Menu/style.styl":function(e,t,n){},"../client/src/editor/modules/contextmenu/Popover/style.styl":function(e,t,n){},"../client/src/editor/modules/data2chart/data2chart.styl":function(e,t,n){},"../client/src/editor/modules/gantt/style.styl":function(e,t,n){},"../client/src/editor/modules/include/style.styl":function(e,t,n){},"../client/src/editor/modules/keymapDoc/style.styl":function(e,t,n){},"../client/src/editor/modules/pageTree/Modal/style.styl":function(e,t,n){},"../client/src/editor/modules/pageTree/Popover/style.styl":function(e,t,n){},"../client/src/editor/modules/pageTree/style.styl":function(e,t,n){},"../client/src/editor/modules/sensitiveWord/component/style.styl":function(e,t,n){},"../client/src/editor/modules/sensitiveWord/style.styl":function(e,t,n){},"../client/src/editor/modules/spaceUpdate/Modal/style.styl":function(e,t,n){},"../client/src/editor/modules/spaceUpdate/Popover/style.styl":function(e,t,n){},"../client/src/editor/modules/spaceUpdate/style.styl":function(e,t,n){},"../client/src/editor/modules/video/ProgressBar/style.styl":function(e,t,n){},"../client/src/pages/index/PageWrapper.jsx":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});n("./core-js/modules/es6.regexp.search.js");var r=n("./react/index.js"),o=n.n(r),a=n("../client/src/containers/ViewPage/index.js"),i=n("../client/src/containers/EditPage/index.js"),c=n("../client/src/containers/OpenPage/__legacy/OpenPage.js");function s(e){var t=new URLSearchParams(e.location.search),n=t.get("action")||"view",r=t.get("open");return"view"!==n||r?"edit"===n?o.a.createElement(i.default,e):"view"===n&&r?o.a.createElement(c.default,e):void 0:o.a.createElement(a.b,e)}},"../client/src/utils/screenManager.js":function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=["","webkit","moz","ms"],a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.__isFullScreen=!1}var t,n,a;return t=e,(n=[{key:"isFullScreen",value:function(){return this.__isFullScreen}},{key:"resetFullScreen",value:function(){this.__isFullScreen=!1}},{key:"launchFullscreen",value:function(e){this.__isFullScreen=!0,e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"exitFullscreen",value:function(){this.__isFullScreen=!1,o.some(function(e){return null!==document["".concat(e,"fullscreenElement")]&&void 0!==document["".concat(e,"fullscreenElement")]})&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}}])&&r(t.prototype,n),a&&r(t,a),e}();t.a=new a},"./antd/lib/divider/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(e){if(e&&e.__esModule)return e;var t=c();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}}n.default=e,t&&t.set(e,n);return n}(n("./react/index.js")),a=(r=n("./classnames/index.js"))&&r.__esModule?r:{default:r},i=n("./antd/lib/config-provider/index.js");function c(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},p=function(e){return o.createElement(i.ConfigConsumer,null,function(t){var n,r=t.getPrefixCls,i=e.prefixCls,c=e.type,p=void 0===c?"horizontal":c,f=e.orientation,d=void 0===f?"center":f,m=e.className,h=e.children,y=e.dashed,b=u(e,["prefixCls","type","orientation","className","children","dashed"]),v=r("divider",i),g=d.length>0?"-".concat(d):d,w=(0,a.default)(m,v,"".concat(v,"-").concat(p),(l(n={},"".concat(v,"-with-text").concat(g),h),l(n,"".concat(v,"-dashed"),!!y),n));return o.createElement("div",s({className:w},b,{role:"separator"}),h&&o.createElement("span",{className:"".concat(v,"-inner-text")},h))})};t.default=p},"./antd/lib/divider/style/index.js":function(e,t,n){"use strict";n("./antd/lib/style/index.less"),n("./antd/lib/divider/style/index.less")},"./antd/lib/divider/style/index.less":function(e,t,n){},"./core-js/modules/es6.reflect.own-keys.js":function(e,t,n){var r=n("./core-js/modules/_export.js");r(r.S,"Reflect",{ownKeys:n("./core-js/modules/_own-keys.js")})},"./core-js/modules/es6.string.ends-with.js":function(e,t,n){"use strict";var r=n("./core-js/modules/_export.js"),o=n("./core-js/modules/_to-length.js"),a=n("./core-js/modules/_string-context.js"),i="".endsWith;r(r.P+r.F*n("./core-js/modules/_fails-is-regexp.js")("endsWith"),"String",{endsWith:function(e){var t=a(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=o(t.length),c=void 0===n?r:Math.min(o(n),r),s=String(e);return i?i.call(t,s,c):t.slice(c-s.length,c)===s}})},"./lodash.intersection/index.js":function(e,t,n){e.exports=n("dll-reference vendor_06bda8a72edc3f5d4aae")("./node_modules/lodash.intersection/index.js")},"./react-hot-keys/es/index.js":function(e,t,n){"use strict";var r=n("./react/index.js"),o=(n("./prop-types/index.js"),"undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0);function a(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on".concat(t),function(){n(window.event)})}function i(e,t){for(var n=t.slice(0,t.length-1),r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function c(e){e||(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function s(e,t){for(var n=e.length>=t.length?e:t,r=e.length>=t.length?t:e,o=!0,a=0;a<n.length;a++)-1===r.indexOf(n[a])&&(o=!1);return o}for(var l={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"\u21ea":20,",":188,".":190,"/":191,"`":192,"-":o?173:189,"=":o?61:187,";":o?59:186,"'":222,"[":219,"]":221,"\\":220},u={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":o?224:91,cmd:o?224:91,command:o?224:91},p={16:"shiftKey",18:"altKey",17:"ctrlKey"},f={16:!1,18:!1,17:!1},d={},m=1;m<20;m++)l["f".concat(m)]=111+m;p[o?224:91]="metaKey",f[o?224:91]=!1;var h=[],y="all",b=[],v=function(e){return l[e.toLowerCase()]||u[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function g(e){y=e||"all"}function w(){return y||"all"}function j(e,t,n){var r;if(t.scope===n||"all"===t.scope){for(var o in r=t.mods.length>0,f)Object.prototype.hasOwnProperty.call(f,o)&&(!f[o]&&t.mods.indexOf(+o)>-1||f[o]&&-1===t.mods.indexOf(+o))&&(r=!1);(0!==t.mods.length||f[16]||f[18]||f[17]||f[91])&&!r&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function O(e){var t=d["*"],n=e.keyCode||e.which||e.charCode;if(S.filter.call(this,e)){if(93!==n&&224!==n||(n=91),-1===h.indexOf(n)&&229!==n&&h.push(n),n in f){for(var r in f[n]=!0,u)u[r]===n&&(S[r]=!0);if(!t)return}for(var o in f)Object.prototype.hasOwnProperty.call(f,o)&&(f[o]=e[p[o]]);var a=w();if(t)for(var i=0;i<t.length;i++)t[i].scope===a&&("keydown"===e.type&&t[i].keydown||"keyup"===e.type&&t[i].keyup)&&j(e,t[i],a);if(n in d)for(var c=0;c<d[n].length;c++)if(("keydown"===e.type&&d[n][c].keydown||"keyup"===e.type&&d[n][c].keyup)&&d[n][c].key){for(var s=d[n][c].key.split("+"),l=[],m=0;m<s.length;m++)l.push(v(s[m]));(l=l.sort()).join("")===h.sort().join("")&&j(e,d[n][c],a)}}}function S(e,t,n){var r=c(e),o=[],s="all",l=document,p=0,m=!1,y=!0;for(void 0===n&&"function"===typeof t&&(n=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(s=t.scope),t.element&&(l=t.element),t.keyup&&(m=t.keyup),void 0!==t.keydown&&(y=t.keydown)),"string"===typeof t&&(s=t);p<r.length;p++)o=[],(e=r[p].split("+")).length>1&&(o=i(u,e)),(e="*"===(e=e[e.length-1])?"*":v(e))in d||(d[e]=[]),d[e].push({keyup:m,keydown:y,scope:s,mods:o,shortcut:r[p],method:n,key:r[p]});"undefined"!==typeof l&&!function(e){return b.indexOf(e)>-1}(l)&&window&&(b.push(l),a(l,"keydown",function(e){O(e)}),a(window,"focus",function(){h=[]}),a(l,"keyup",function(e){O(e),function(e){var t=e.keyCode||e.which||e.charCode,n=h.indexOf(t);if(n>=0&&h.splice(n,1),e.key&&"meta"===e.key.toLowerCase()&&h.splice(0,h.length),93!==t&&224!==t||(t=91),t in f)for(var r in f[t]=!1,u)u[r]===t&&(S[r]=!1)}(e)}))}var E={setScope:g,getScope:w,deleteScope:function(e,t){var n,r;for(var o in e||(e=w()),d)if(Object.prototype.hasOwnProperty.call(d,o))for(n=d[o],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++;w()===e&&g(t||"all")},getPressedKeyCodes:function(){return h.slice(0)},isPressed:function(e){return"string"===typeof e&&(e=v(e)),-1!==h.indexOf(e)},filter:function(e){var t=e.target||e.srcElement,n=t.tagName,r=!0;return!t.isContentEditable&&"TEXTAREA"!==n&&("INPUT"!==n&&"TEXTAREA"!==n||t.readOnly)||(r=!1),r},unbind:function(e,t,n){var r,o,a=c(e),l=[];"function"===typeof t&&(n=t,t="all");for(var p=0;p<a.length;p++){if(l=(r=a[p].split("+")).length>1?i(u,r):[],e="*"===(e=r[r.length-1])?"*":v(e),t||(t=w()),!d[e])return;for(var f=0;f<d[e].length;f++){o=d[e][f],(!n||o.method===n)&&o.scope===t&&s(o.mods,l)&&(d[e][f]={})}}}};for(var P in E)Object.prototype.hasOwnProperty.call(E,P)&&(S[P]=E[P]);if("undefined"!==typeof window){var k=window.hotkeys;S.noConflict=function(e){return e&&window.hotkeys===S&&(window.hotkeys=k),S},window.hotkeys=S}var x=S;n.d(t,"a",function(){return C});var C=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,e.call(this,n));return r.onKeyDown=r.onKeyDown.bind(r),r.onKeyUp=r.onKeyUp.bind(r),r.handleKeyUpEvent=r.handleKeyUpEvent.bind(r),r.isKeyDown=!1,r.handle={},r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e=this.props.filter;x.filter=e,x.unbind(this.props.keyName),x(this.props.keyName,this.onKeyDown),document.addEventListener("keyup",this.handleKeyUpEvent)},t.prototype.componentWillUnmount=function(){x.unbind(this.props.keyName),this.isKeyDown=!0,this.handle={},document.removeEventListener("keyup",this.handleKeyUpEvent)},t.prototype.onKeyUp=function(e,t){var n=this.props.onKeyUp;n(t.shortcut,e,t)},t.prototype.onKeyDown=function(e,t){var n=this.props.onKeyDown;this.isKeyDown||(this.isKeyDown=!0,this.handle=t,n(t.shortcut,e,t))},t.prototype.handleKeyUpEvent=function(e){this.isKeyDown&&(this.isKeyDown=!1,this.props.keyName.indexOf(this.handle.shortcut)<0||(this.onKeyUp(e,this.handle),this.handle={}))},t.prototype.render=function(){return this.props.children||null},t}(r.Component);C.propTypes={},C.defaultProps={filter:function(e){var t=(e.target||e.srcElement).tagName;return!(t.isContentEditable||"INPUT"==t||"SELECT"==t||"TEXTAREA"==t)},onKeyUp:function(){},onKeyDown:function(){}}},"./string-similarity/compare-strings.js":function(e,t,n){e.exports=n("dll-reference vendor_06bda8a72edc3f5d4aae")("./node_modules/string-similarity/compare-strings.js")}}]);